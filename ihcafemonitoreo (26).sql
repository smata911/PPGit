-- phpMyAdmin SQL Dump
-- version 5.0.2
-- https://www.phpmyadmin.net/
--
-- Servidor: 127.0.0.1
-- Tiempo de generación: 29-12-2021 a las 21:45:11
-- Versión del servidor: 10.4.14-MariaDB
-- Versión de PHP: 7.4.10

SET SQL_MODE = "NO_AUTO_VALUE_ON_ZERO";
START TRANSACTION;
SET time_zone = "+00:00";


/*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
/*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
/*!40101 SET @OLD_COLLATION_CONNECTION=@@COLLATION_CONNECTION */;
/*!40101 SET NAMES utf8mb4 */;

--
-- Base de datos: `ihcafemonitoreo`
--

DELIMITER $$
--
-- Procedimientos
--
CREATE DEFINER=`root`@`localhost` PROCEDURE `BeneficiarioActividad` (IN `pfechaInicio` VARCHAR(25), IN `pfechaFinal` VARCHAR(25))  BEGIN
#es probable que en produccion no funciones porque esta relacionada con productor
	

																					
	SELECT etiqueta,totales from
(
SELECT ga.actividad_productora as etiqueta,
(COUNT(ga.cod_actividad_pro))
as totales from tbl_general_h_actividad_pro ha
INNER JOIN tbl_general_actividad_pro ga on ha.cod_actividad_pro=ga.cod_actividad_pro

INNER JOIN tbl_bene_productor bp on ha.cod_identidad=bp.cod_identidad
INNER JOIN tbl_beneficiario_ficha bf on bp.cod_identidad=bf.cod_identidad

INNER JOIN tbl_general_municipio gm on bp.cod_municipio=gm.cod_municipio
INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart

WHERE bf.fecha_visita BETWEEN pfechaInicio and pfechaFinal 
and gd.cod_depart in(4,12,13,14)
GROUP BY ga.cod_actividad_pro

UNION all 

SELECT ga.actividad_productora as etiqueta,0 as 'totales' from tbl_general_actividad_pro ga ) as T
	GROUP BY etiqueta;

END$$

CREATE DEFINER=`root`@`localhost` PROCEDURE `BeneficiarioApoyo` (IN `pfechaInicio` VARCHAR(25), IN `pfechaFinal` VARCHAR(25))  BEGIN
	#Routine body goes here...SELECT CONVERT('25 euros', SIGNED)

																					
	SELECT etiqueta,totales from
(
SELECT ta.tipo_apoyo as etiqueta,
(COUNT(ta.cod_tipo_apoyo))

as totales from tbl_bene_h_tipo_apoyo he
INNER JOIN tbl_bene_tipo_apoyo ta on he.cod_tipo_apoyo=ta.cod_tipo_apoyo
INNER JOIN tbl_bene_vivienda bv on he.cod_vivienda=bv.cod_vivienda

INNER JOIN tbl_beneficiario_ficha bf on bv.cod_beneficiario=bf.cod_beneficiario

INNER JOIN tbl_bene_productor bp on bf.cod_identidad=bp.cod_identidad

INNER JOIN tbl_general_municipio gm on bp.cod_municipio=gm.cod_municipio
INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart

WHERE gd.cod_depart in(4,12,13,14) and bf.fecha_visita BETWEEN pfechaInicio and pfechaFinal

						GROUP BY ta.cod_tipo_apoyo
UNION all 

SELECT ta.tipo_apoyo as etiqueta,0 as 'totales' from tbl_bene_tipo_apoyo ta ) as T
	GROUP BY etiqueta;

END$$

CREATE DEFINER=`root`@`localhost` PROCEDURE `BeneficiarioEstufa` (IN `pfechaInicio` VARCHAR(25), IN `pfechaFinal` VARCHAR(25))  BEGIN
	#Routine body goes here...SELECT CONVERT('25 euros', SIGNED)

	
SELECT etiqueta,totales from
(
SELECT te.tipo_estufa as etiqueta,(COUNT(te.cod_tipo_estufa))

as totales from tbl_bene_h_tipo_estufa he
INNER JOIN tbl_bene_tipo_estufa te on he.cod_tipo_estufa=te.cod_tipo_estufa
INNER JOIN tbl_bene_vivienda bv on he.cod_vivienda=bv.cod_vivienda

INNER JOIN tbl_beneficiario_ficha bf on bv.cod_beneficiario=bf.cod_beneficiario

INNER JOIN tbl_bene_productor bp on bf.cod_identidad=bp.cod_identidad

INNER JOIN tbl_general_municipio gm on bp.cod_municipio=gm.cod_municipio
INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
INNER JOIN tbl_bene_proyecto_beneficia pv on bf.cod_pro_beneficia=pv.cod_pro_beneficia

WHERE pv.cod_pro_beneficia=2 and bf.fecha_visita BETWEEN pfechaInicio and pfechaFinal

						GROUP BY te.cod_tipo_estufa
UNION all 

SELECT te.tipo_estufa as etiqueta,0 as 'totales' from tbl_bene_tipo_estufa te ) as T
	GROUP BY etiqueta;

END$$

CREATE DEFINER=`root`@`localhost` PROCEDURE `beneficiarioEtnia` (IN `pfechaInicio` VARCHAR(25), IN `pfechaFinal` VARCHAR(25))  BEGIN


SELECT etiqueta,total from 
(
SELECT ge.etnias as etiqueta,
count(ge.cod_etnias) as total from tbl_beneficiario_ficha bf 
INNER JOIN tbl_bene_productor bp on bf.cod_identidad=bp.cod_identidad
INNER JOIN tbl_general_etnias ge on bp.cod_etnias=ge.cod_etnias


INNER JOIN tbl_general_municipio gm on bp.cod_municipio=gm.cod_municipio
INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
INNER JOIN tbl_bene_proyecto_beneficia pv on bf.cod_pro_beneficia=pv.cod_pro_beneficia


WHERE pv.cod_pro_beneficia=2 and bf.fecha_visita BETWEEN pfechaInicio and pfechaFinal
GROUP BY ge.etnias

union all
SELECT ge.etnias,0 as total from tbl_general_etnias ge) as t
GROUP BY etiqueta

;

	
	
	
	
	

END$$

CREATE DEFINER=`root`@`localhost` PROCEDURE `BeneficiarioGenero` (IN `pfechaInicio` VARCHAR(25), IN `pfechaFina` VARCHAR(25))  BEGIN
	#Routine body goes here...SELECT CONVERT('25 euros', SIGNED)

																												
																																																	
SELECT etiqueta,totales from
(
SELECT etiqueta,COUNT(totales) as totales from  (SELECT gg.genero as etiqueta,COUNT(bbf.cod_beneficiario) as totales

						from tbl_bene_finca bf
						
						INNER JOIN tbl_bene_productor bp on bf.cod_identidad=bp.cod_identidad
						INNER JOIN tbl_general_genero gg on bp.cod_genero=gg.cod_genero
						
						INNER JOIN tbl_beneficiario_ficha bbf on bbf.cod_identidad=bp.cod_identidad
						
						INNER JOIN tbl_bene_proyecto_beneficia pv on bbf.cod_pro_beneficia=pv.cod_pro_beneficia

						WHERE  pv.cod_pro_beneficia=2 and bbf.fecha_visita BETWEEN pfechaInicio and pfechaFina
						GROUP BY bbf.cod_beneficiario) as totales
						GROUP BY etiqueta

UNION all 

SELECT gg.genero as etiqueta,0 as 'totales' from tbl_general_genero gg ) as T
	GROUP BY etiqueta
	order by totales DESC;

END$$

CREATE DEFINER=`root`@`localhost` PROCEDURE `beneficiarioGrupoComunitario` (IN `pfechaInicio` VARCHAR(25), IN `pfechaFinal` VARCHAR(25))  BEGIN


SELECT etiqueta,total from 
(
SELECT gc.grupo_comunitario as etiqueta,
count(gc.cod_grupo) as total from tbl_beneficiario_ficha bf 
INNER JOIN tbl_bene_productor bp on bf.cod_identidad=bp.cod_identidad
INNER JOIN tbl_bene_grupo_comunitario gc on bf.cod_grupo=gc.cod_grupo


INNER JOIN tbl_general_municipio gm on bp.cod_municipio=gm.cod_municipio
INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
INNER JOIN tbl_bene_proyecto_beneficia pv on bf.cod_pro_beneficia=pv.cod_pro_beneficia

WHERE pv.cod_pro_beneficia=2 and bf.fecha_visita BETWEEN pfechaInicio and pfechaFinal
GROUP BY gc.grupo_comunitario

union all
SELECT gc.grupo_comunitario,0 as total from tbl_bene_grupo_comunitario gc) as t
GROUP BY etiqueta

;

	
	
	
	
	

END$$

CREATE DEFINER=`root`@`localhost` PROCEDURE `BeneficiariolServicios` (IN `pfechaInicio` VARCHAR(25), IN `pfechaFinal` VARCHAR(25))  BEGIN
	#Routine body goes here...SELECT CONVERT('25 euros', SIGNED)
																				
	SELECT etiqueta,totales from
(
SELECT ts.tipo_servicio as etiqueta,
(COUNT(ts.cod_tipo_servicio))
as totales from tbl_bene_h_tipo_servicios_p hp
						INNER JOIN tbl_bene_tipo_servicio ts on hp.cod_tipo_servicio=ts.cod_tipo_servicio
						INNER JOIN tbl_bene_vivienda bv on hp.cod_vivienda=bv.cod_vivienda

INNER JOIN tbl_beneficiario_ficha bf on bv.cod_beneficiario=bf.cod_beneficiario

INNER JOIN tbl_bene_productor bp on bf.cod_identidad=bp.cod_identidad

INNER JOIN tbl_general_municipio gm on bp.cod_municipio=gm.cod_municipio
INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
INNER JOIN tbl_bene_proyecto_beneficia pv on bf.cod_pro_beneficia=pv.cod_pro_beneficia

WHERE pv.cod_pro_beneficia=2 and bf.fecha_visita BETWEEN pfechaInicio and pfechaFinal

						GROUP BY hp.cod_tipo_servicio
UNION all 

SELECT ts.tipo_servicio as etiqueta,0 as 'totales' from tbl_bene_tipo_servicio ts ) as T
	GROUP BY etiqueta;

END$$

CREATE DEFINER=`root`@`localhost` PROCEDURE `beneficiarioNumPlantasCafe` (IN `pfechaInicio` VARCHAR(25), IN `pfechaFinal` VARCHAR(25))  BEGIN



SELECT SUM(total) from (SELECT 'Area Cafe' as etiqueta,
			bf.num_plantas_cafe as total 
		from tbl_bene_finca bf
		INNER JOIN tbl_bene_productor bp on bf.cod_identidad=bp.cod_identidad
		INNER JOIN tbl_beneficiario_ficha bbf on bp.cod_identidad=bbf.cod_identidad
INNER JOIN tbl_bene_proyecto_beneficia pv on bbf.cod_pro_beneficia=pv.cod_pro_beneficia
WHERE pv.cod_pro_beneficia=2 and bbf.fecha_visita BETWEEN pfechaInicio and pfechaFinal
GROUP BY bbf.cod_beneficiario) as total;
	
	
	
	
	

END$$

CREATE DEFINER=`root`@`localhost` PROCEDURE `BeneficiarioRubro` (IN `pfechaInicio` VARCHAR(25), IN `pfechaFina` VARCHAR(25))  BEGIN
																																			
SELECT etiqueta,totales from
(
SELECT br.rubro as etiqueta,(COUNT(br.cod_rubro)) as totales 
	from tbl_bene_h_rubros hr
						INNER JOIN tbl_bene_rubro br on hr.cod_rubro=br.cod_rubro	
						
				
						INNER JOIN tbl_bene_finca bf on hr.cod_finca=bf.cod_finca
						
						INNER JOIN tbl_bene_productor bp on bf.cod_identidad=bp.cod_identidad
						INNER JOIN tbl_beneficiario_ficha bbf on bbf.cod_identidad=bp.cod_identidad
						INNER JOIN tbl_bene_proyecto_beneficia pv on bbf.cod_pro_beneficia=pv.cod_pro_beneficia
						
					

WHERE  pv.cod_pro_beneficia=2 and bbf.fecha_visita BETWEEN pfechaInicio and pfechaFina
	GROUP BY br.cod_rubro
UNION all 

SELECT br.rubro as etiqueta,0 as 'totales' from tbl_bene_rubro br ) as T
	GROUP BY etiqueta;

END$$

CREATE DEFINER=`root`@`localhost` PROCEDURE `beneficiarioSumarCafe` (IN `pfechaInicio` VARCHAR(25), IN `pfechaFinal` VARCHAR(25))  BEGIN



SELECT SUM(total) from (SELECT 'Area Cafe' as etiqueta,
			bf.area_cafe as total 
		from tbl_bene_finca bf
		INNER JOIN tbl_bene_productor bp on bf.cod_identidad=bp.cod_identidad
		INNER JOIN tbl_beneficiario_ficha bbf on bp.cod_identidad=bbf.cod_identidad
INNER JOIN tbl_bene_proyecto_beneficia pv on bbf.cod_pro_beneficia=pv.cod_pro_beneficia
WHERE pv.cod_pro_beneficia=2 and bbf.fecha_visita BETWEEN pfechaInicio and pfechaFinal
GROUP BY bbf.cod_beneficiario) as total;
	
	

END$$

CREATE DEFINER=`root`@`localhost` PROCEDURE `beneficiarioTenencia` (IN `pfechaInicio` VARCHAR(25), IN `pfechaFinal` VARCHAR(25))  BEGIN


SELECT etiqueta,total from  

(SELECT etiqueta,COUNT(total) as total from
	
	(SELECT bt.tenencia as etiqueta,count(bbf.cod_beneficiario) as total from tbl_bene_finca bf
	INNER JOIN tbl_bene_productor bp on bf.cod_identidad=bp.cod_identidad
	INNER JOIN tbl_bene_tenencia bt on bf.cod_tenencia=bt.cod_tenencia
	INNER JOIN tbl_beneficiario_ficha bbf on bf.cod_identidad=bbf.cod_identidad
	
INNER JOIN tbl_bene_proyecto_beneficia pv on bbf.cod_pro_beneficia=pv.cod_pro_beneficia

	WHERE  pv.cod_pro_beneficia=2 and bbf.fecha_visita BETWEEN pfechaInicio and pfechaFinal
	GROUP BY bbf.cod_beneficiario) as total
	GROUP BY etiqueta
	
	
	union all
	
	SELECT bt.tenencia as etiqueta,0 as total from tbl_bene_tenencia bt)t
	GROUP BY etiqueta
	;


	

	

END$$

CREATE DEFINER=`root`@`localhost` PROCEDURE `BeneficiarioTipoVivienda` (IN `pFechaInicio` VARCHAR(25), IN `pFechaFinal` VARCHAR(25))  BEGIN


SELECT etiqueta,totales from
	(
	
	SELECT tv.tipo_vivienda as etiqueta,
		COUNT(tv.cod_tipo_vivienda) as 'totales'
		
	 from tbl_bene_vivienda bv
	INNER JOIN tbl_bene_tipo_vivienda tv on bv.cod_tipo_vivienda=tv.cod_tipo_vivienda
	INNER JOIN tbl_beneficiario_ficha bf on bv.cod_beneficiario=bf.cod_beneficiario
	
	INNER JOIN tbl_bene_productor bp on bf.cod_identidad=bp.cod_identidad

INNER JOIN tbl_bene_proyecto_beneficia pv on bf.cod_pro_beneficia=pv.cod_pro_beneficia
	
	WHERE fecha_visita BETWEEN pFechaInicio and pFechaFinal and
	pv.cod_pro_beneficia=2
	GROUP BY tv.tipo_vivienda
	
	
	
	UNION all 

SELECT tv.tipo_vivienda as etiqueta,0 as 'totales' from tbl_bene_tipo_vivienda tv ) as T
	GROUP BY etiqueta;
	
	

	
END$$

CREATE DEFINER=`root`@`localhost` PROCEDURE `BeneficiarioVariedades` (IN `pfechaInicio` VARCHAR(25), IN `pfechaFina` VARCHAR(25))  BEGIN
	#Routine body goes here...SELECT CONVERT('25 euros', SIGNED)

																												
																																																	
SELECT etiqueta,totales from
(
SELECT etiqueta,COUNT(totales) as totales from  (SELECT vv.variedad as etiqueta,COUNT(hv.cod_h_variedad) as totales

						from tbl_bene_h_variedades hv
						INNER JOIN tbl_vulnerabilidad_variedades vv on hv.cod_variedad=vv.cod_variedad
						
				
						INNER JOIN tbl_bene_finca bf on hv.cod_finca=bf.cod_finca
						
						INNER JOIN tbl_bene_productor bp on bf.cod_identidad=bp.cod_identidad
						INNER JOIN tbl_beneficiario_ficha bbf on bbf.cod_identidad=bp.cod_identidad
						
						INNER JOIN tbl_bene_proyecto_beneficia pv on bbf.cod_pro_beneficia=pv.cod_pro_beneficia

						WHERE  pv.cod_pro_beneficia=2 and bbf.fecha_visita BETWEEN pfechaInicio and pfechaFina
						GROUP BY hv.cod_h_variedad) as totales
						GROUP BY etiqueta

UNION all 

SELECT br.rubro as etiqueta,0 as 'totales' from tbl_bene_rubro br ) as T
	GROUP BY etiqueta
	order by totales DESC;

END$$

CREATE DEFINER=`root`@`localhost` PROCEDURE `BeneficiaroLargoTecho` (IN `pFechaInicio` VARCHAR(25), IN `pFechaFinal` VARCHAR(25))  BEGIN


SELECT etiqueta,totales from
	(
	
	SELECT tt.tipo_techo as etiqueta,
		COUNT(tt.cod_tipo_techo) as 'totales'
		
	 from tbl_bene_vivienda bv
	INNER JOIN tbl_bene_tipo_techo tt on bv.cod_tipo_techo=tt.cod_tipo_techo
	
	INNER JOIN tbl_beneficiario_ficha bf on bv.cod_beneficiario=bf.cod_beneficiario
		INNER JOIN tbl_bene_productor bp on bf.cod_identidad=bp.cod_identidad
		
INNER JOIN tbl_bene_proyecto_beneficia pv on bf.cod_pro_beneficia=pv.cod_pro_beneficia
	
	WHERE fecha_visita BETWEEN pFechaInicio and pFechaFinal and
	pv.cod_pro_beneficia=2
	GROUP BY tt.tipo_techo
	
	
	UNION all 

SELECT br.tipo_techo as etiqueta,0 as 'totales' from tbl_bene_tipo_techo br ) as T
	GROUP BY etiqueta;
	
	
END$$

CREATE DEFINER=`root`@`localhost` PROCEDURE `BeneficiaroPiso` (IN `pFechaInicio` VARCHAR(25), IN `pFechaFinal` VARCHAR(25))  BEGIN

 SELECT etiqueta, totales FROM
	(
	
	SELECT tp.tipo_piso as etiqueta,
		COUNT(tp.cod_tipo_piso) as 'totales'
		
	 from tbl_bene_vivienda bv
	INNER JOIN tbl_bene_tipo_piso tp on bv.cod_tipo_piso=tp.cod_tipo_piso
	INNER JOIN tbl_beneficiario_ficha bf on bv.cod_beneficiario=bf.cod_beneficiario
	INNER JOIN tbl_bene_productor bp on bf.cod_identidad=bp.cod_identidad
		
INNER JOIN tbl_bene_proyecto_beneficia pv on bf.cod_pro_beneficia=pv.cod_pro_beneficia
	
	WHERE fecha_visita BETWEEN pFechaInicio and pFechaFinal and
	pv.cod_pro_beneficia=2
	GROUP BY tp.tipo_piso
	
	
	UNION ALL

	SELECT tp.tipo_piso as etiqueta,0 as 'totales' from tbl_bene_tipo_piso tp ) as T
	GROUP BY etiqueta;
 COMMIT;
 
END$$

CREATE DEFINER=`root`@`localhost` PROCEDURE `BeneficiaroTecho` (IN `pFechaInicio` VARCHAR(25), IN `pFechaFinal` VARCHAR(25))  BEGIN

SELECT etiqueta, totales from
	(
	
	SELECT tt.tipo_techo as etiqueta,
		COUNT(tt.cod_tipo_techo) as 'totales'
		
	 from tbl_bene_vivienda bv
	INNER JOIN tbl_bene_tipo_techo tt on bv.cod_tipo_techo=tt.cod_tipo_techo
	
	INNER JOIN tbl_beneficiario_ficha bf on bv.cod_beneficiario=bf.cod_beneficiario
		INNER JOIN tbl_bene_productor bp on bf.cod_identidad=bp.cod_identidad
		
INNER JOIN tbl_bene_proyecto_beneficia pv on bf.cod_pro_beneficia=pv.cod_pro_beneficia
	WHERE fecha_visita BETWEEN pFechaInicio and pFechaFinal and
pv.cod_pro_beneficia=2
	GROUP BY tt.tipo_techo
	
		
	UNION ALL

	SELECT tt.tipo_techo as etiqueta,0 as 'totales' from tbl_bene_tipo_techo tt ) as T
	GROUP BY etiqueta;
 COMMIT;

	
END$$

CREATE DEFINER=`root`@`localhost` PROCEDURE `BeneficiaroTipoPared` (IN `pFechaInicio` VARCHAR(25), IN `pFechaFinal` VARCHAR(25))  BEGIN


SELECT etiqueta,totales from 
	(
	
	SELECT tp.tipo_pared as etiqueta,
		COUNT(tp.cod_tipo_pared) as 'totales'
		
	 from tbl_bene_vivienda bv
	INNER JOIN tbl_bene_tipo_pared tp on bv.cod_tipo_pared=tp.cod_tipo_pared
	
	
	INNER JOIN tbl_beneficiario_ficha bf on bv.cod_beneficiario=bf.cod_beneficiario
		INNER JOIN tbl_bene_productor bp on bf.cod_identidad=bp.cod_identidad
		
INNER JOIN tbl_bene_proyecto_beneficia pv on bf.cod_pro_beneficia=pv.cod_pro_beneficia
	WHERE fecha_visita BETWEEN pFechaInicio and pFechaFinal and
	pv.cod_pro_beneficia=2
	GROUP BY tp.tipo_pared 
	
	
	
		
	UNION ALL

	SELECT tp.tipo_pared as etiqueta,0 as 'totales' from tbl_bene_tipo_pared tp ) as T
	GROUP BY etiqueta;
 COMMIT;
	
	
	
	
	

	
END$$

CREATE DEFINER=`root`@`localhost` PROCEDURE `bene_contar_finca` (IN `pfechaInicio` VARCHAR(25), IN `pfechaFinal` VARCHAR(25), IN `pfiltro` INT(1))  BEGIN


set @totalFichas=(SELECT COUNT(total) from 
	(SELECT count(bbf.cod_beneficiario) as total from tbl_bene_finca bf
	INNER JOIN tbl_bene_productor bp on bf.cod_identidad=bp.cod_identidad
	INNER JOIN tbl_bene_tenencia bt on bf.cod_tenencia=bt.cod_tenencia
	INNER JOIN tbl_beneficiario_ficha bbf on bf.cod_identidad=bbf.cod_identidad
	GROUP BY bbf.cod_beneficiario) as total
	
	);
	
if pfiltro=1 then 
		
	set @tenencia=(SELECT COUNT(total) from
	(SELECT count(bbf.cod_beneficiario) as total from tbl_bene_finca bf
	INNER JOIN tbl_bene_productor bp on bf.cod_identidad=bp.cod_identidad
	INNER JOIN tbl_bene_tenencia bt on bf.cod_tenencia=bt.cod_tenencia
	INNER JOIN tbl_beneficiario_ficha bbf on bf.cod_identidad=bbf.cod_identidad
	
INNER JOIN tbl_bene_proyecto_beneficia pv on bbf.cod_pro_beneficia=pv.cod_pro_beneficia

	WHERE  pv.cod_pro_beneficia=2 and bbf.fecha_visita BETWEEN pfechaInicio and pfechaFinal
	GROUP BY bbf.cod_beneficiario) as total
	);
	
	SELECT  CONCAT(@tenencia,'/',@totalFichas);
	
elseif	pfiltro=2 then
	set @variedad=(SELECT COUNT(total) from  (SELECT COUNT(bbf.cod_beneficiario) as total

						from tbl_bene_h_variedades hv
						INNER JOIN tbl_vulnerabilidad_variedades vv on hv.cod_variedad=vv.cod_variedad
						
				
						INNER JOIN tbl_bene_finca bf on hv.cod_finca=bf.cod_finca
						
						INNER JOIN tbl_bene_productor bp on bf.cod_identidad=bp.cod_identidad
						INNER JOIN tbl_beneficiario_ficha bbf on bbf.cod_identidad=bp.cod_identidad
						
INNER JOIN tbl_bene_proyecto_beneficia pv on bbf.cod_pro_beneficia=pv.cod_pro_beneficia

						WHERE  pv.cod_pro_beneficia=2 and bbf.fecha_visita BETWEEN pfechaInicio and pfechaFinal
						GROUP BY bbf.cod_beneficiario)as total 
						) ;
						
						
SELECT CONCAT(@variedad,'/',@totalFichas);	

ELSEIF pfiltro=3 then
					set @rubro=	(SELECT COUNT(totales) from  (SELECT COUNT(bbf.cod_beneficiario) as totales 
						from tbl_bene_h_rubros hr
						INNER JOIN tbl_bene_rubro br on hr.cod_rubro=br.cod_rubro	
						
				
						INNER JOIN tbl_bene_finca bf on hr.cod_finca=bf.cod_finca
						
						INNER JOIN tbl_bene_productor bp on bf.cod_identidad=bp.cod_identidad
						INNER JOIN tbl_beneficiario_ficha bbf on bbf.cod_identidad=bp.cod_identidad
						
INNER JOIN tbl_bene_proyecto_beneficia pv on bbf.cod_pro_beneficia=pv.cod_pro_beneficia

						WHERE pv.cod_pro_beneficia=2  and bbf.fecha_visita BETWEEN pfechaInicio and pfechaFinal
							GROUP BY bbf.cod_beneficiario)as totales);
							
SELECT CONCAT(@rubro,'/',@totalFichas);							
	
end if;
END$$

CREATE DEFINER=`root`@`localhost` PROCEDURE `bene_contar_otros` (IN `pfechaInicio` VARCHAR(25), IN `pfechaFinal` VARCHAR(25), IN `pfiltro` INT(1))  BEGIN


set @totalFichas=(SELECT COUNT(total) from 
	(SELECT count(bbf.cod_beneficiario) as total from tbl_bene_finca bf
	INNER JOIN tbl_bene_productor bp on bf.cod_identidad=bp.cod_identidad
	INNER JOIN tbl_bene_tenencia bt on bf.cod_tenencia=bt.cod_tenencia
	INNER JOIN tbl_beneficiario_ficha bbf on bf.cod_identidad=bbf.cod_identidad
	GROUP BY bbf.cod_beneficiario) as total
	
	);
	
if pfiltro=1 then 
		
	set @grupo=(
	SELECT count(bf.cod_beneficiario) as total from tbl_beneficiario_ficha bf 
INNER JOIN tbl_bene_productor bp on bf.cod_identidad=bp.cod_identidad
INNER JOIN tbl_bene_grupo_comunitario gc on bf.cod_grupo=gc.cod_grupo


INNER JOIN tbl_bene_proyecto_beneficia pv on bf.cod_pro_beneficia=pv.cod_pro_beneficia
WHERE pv.cod_pro_beneficia=2 and bf.fecha_visita BETWEEN pfechaInicio and pfechaFinal



	);
	
	SELECT  CONCAT(@grupo,'/',@totalFichas);
	
elseif	pfiltro=2 then
	set @etnia=(
	
	SELECT 
count(bp.cod_identidad) as total from tbl_beneficiario_ficha bf 
INNER JOIN tbl_bene_productor bp on bf.cod_identidad=bp.cod_identidad
INNER JOIN tbl_general_etnias ge on bp.cod_etnias=ge.cod_etnias


INNER JOIN tbl_bene_proyecto_beneficia pv on bf.cod_pro_beneficia=pv.cod_pro_beneficia
WHERE pv.cod_pro_beneficia=2 and bf.fecha_visita BETWEEN pfechaInicio and pfechaFinal


						) ;
												
SELECT CONCAT(@etnia,'/',@totalFichas) as total;	

elseif	pfiltro=3 then
	set @genero=(
	
SELECT COUNT(totales) as totales from  (SELECT COUNT(bbf.cod_beneficiario) as totales

						from tbl_bene_finca bf
						
						INNER JOIN tbl_bene_productor bp on bf.cod_identidad=bp.cod_identidad
						INNER JOIN tbl_general_genero gg on bp.cod_genero=gg.cod_genero
						
						INNER JOIN tbl_beneficiario_ficha bbf on bbf.cod_identidad=bp.cod_identidad
						
						INNER JOIN tbl_bene_proyecto_beneficia pv on bbf.cod_pro_beneficia=pv.cod_pro_beneficia

						WHERE  pv.cod_pro_beneficia=2 and bbf.fecha_visita BETWEEN pfechaInicio and pfechaFinal
						GROUP BY bbf.cod_beneficiario) as totales
						
						) ;
						
						
SELECT CONCAT(@genero,'/',@totalFichas) as total;	

					

					
	
end if;
END$$

CREATE DEFINER=`root`@`localhost` PROCEDURE `bene_contar_vivienda` (IN `pfechaInicio` VARCHAR(25), IN `pfechaFinal` VARCHAR(25), IN `pfiltro` INT(1))  BEGIN


set @totalFichas=(SELECT COUNT(total) from 
	(SELECT count(bbf.cod_beneficiario) as total from tbl_bene_finca bf
	INNER JOIN tbl_bene_productor bp on bf.cod_identidad=bp.cod_identidad
	INNER JOIN tbl_bene_tenencia bt on bf.cod_tenencia=bt.cod_tenencia
	INNER JOIN tbl_beneficiario_ficha bbf on bf.cod_identidad=bbf.cod_identidad
	GROUP BY bbf.cod_beneficiario) as total
	
	);
	
if pfiltro=1 then 
		
	set @tipoVivienda=(
	
		select COUNT(bf.cod_beneficiario) as 'totales'		
 from tbl_bene_vivienda bv
	INNER JOIN tbl_bene_tipo_vivienda tv on bv.cod_tipo_vivienda=tv.cod_tipo_vivienda
	INNER JOIN tbl_beneficiario_ficha bf on bv.cod_beneficiario=bf.cod_beneficiario
	
	INNER JOIN tbl_bene_productor bp on bf.cod_identidad=bp.cod_identidad
	
INNER JOIN tbl_bene_proyecto_beneficia pv on bf.cod_pro_beneficia=pv.cod_pro_beneficia
	
	WHERE fecha_visita BETWEEN pFechaInicio and pFechaFinal and
	pv.cod_pro_beneficia=2
	
	);
	
	SELECT  CONCAT(@tipoVivienda,'/',@totalFichas);
	
elseif	pfiltro=2 then
	set @tipoPared=(SELECT COUNT(bf.cod_beneficiario) as 'totales'
		
	 from tbl_bene_vivienda bv
	INNER JOIN tbl_bene_tipo_pared tp on bv.cod_tipo_pared=tp.cod_tipo_pared
	
	
	INNER JOIN tbl_beneficiario_ficha bf on bv.cod_beneficiario=bf.cod_beneficiario
		INNER JOIN tbl_bene_productor bp on bf.cod_identidad=bp.cod_identidad
		
INNER JOIN tbl_bene_proyecto_beneficia pv on bf.cod_pro_beneficia=pv.cod_pro_beneficia
	WHERE fecha_visita BETWEEN pFechaInicio and pFechaFinal and
	pv.cod_pro_beneficia=2
	
	);
						
						
SELECT CONCAT(@tipoPared,'/',@totalFichas);	

ELSEIF pfiltro=3 then
					set @tipoTecho=	(SELECT COUNT(bf.cod_beneficiario) as 'totales'
		
	 from tbl_bene_vivienda bv
	INNER JOIN tbl_bene_tipo_techo tt on bv.cod_tipo_techo=tt.cod_tipo_techo
	
	INNER JOIN tbl_beneficiario_ficha bf on bv.cod_beneficiario=bf.cod_beneficiario
		INNER JOIN tbl_bene_productor bp on bf.cod_identidad=bp.cod_identidad
INNER JOIN tbl_bene_proyecto_beneficia pv on bf.cod_pro_beneficia=pv.cod_pro_beneficia
	
	WHERE fecha_visita BETWEEN pFechaInicio and pFechaFinal and
	pv.cod_pro_beneficia=2
	
							);
SELECT CONCAT(@tipoTecho,'/',@totalFichas);	

ELSEIF pfiltro=4 then
					set @tipoPiso=	
					(SELECT COUNT(bf.cod_beneficiario) as 'totales' 
	from tbl_bene_vivienda bv
	INNER JOIN tbl_bene_tipo_piso tp on bv.cod_tipo_piso=tp.cod_tipo_piso
	INNER JOIN tbl_beneficiario_ficha bf on bv.cod_beneficiario=bf.cod_beneficiario
	INNER JOIN tbl_bene_productor bp on bf.cod_identidad=bp.cod_identidad
INNER JOIN tbl_bene_proyecto_beneficia pv on bf.cod_pro_beneficia=pv.cod_pro_beneficia
	
	WHERE fecha_visita BETWEEN pFechaInicio and pFechaFinal and
	pv.cod_pro_beneficia=2
	
							);
SELECT CONCAT(@tipoPiso,'/',@totalFichas);	



ELSEIF pfiltro=5 then
					set @tipoEstufa=	(SELECT count(totales) from
					(SELECT COUNT(bv.cod_vivienda)

as totales from tbl_bene_h_tipo_estufa he
INNER JOIN tbl_bene_tipo_estufa te on he.cod_tipo_estufa=te.cod_tipo_estufa
INNER JOIN tbl_bene_vivienda bv on he.cod_vivienda=bv.cod_vivienda

INNER JOIN tbl_beneficiario_ficha bf on bv.cod_beneficiario=bf.cod_beneficiario

INNER JOIN tbl_bene_productor bp on bf.cod_identidad=bp.cod_identidad

INNER JOIN tbl_bene_proyecto_beneficia pv on bf.cod_pro_beneficia=pv.cod_pro_beneficia

WHERE pv.cod_pro_beneficia=2 and bf.fecha_visita BETWEEN pfechaInicio and pfechaFinal

						GROUP BY bv.cod_vivienda) as totales
							);
SELECT CONCAT(@tipoEstufa,'/',@totalFichas);	

ELSEIF pfiltro=6 then
					set @tipoServicio=	(	SELECT count(totales) from
(SELECT COUNT(bv.cod_vivienda) 
as totales from tbl_bene_h_tipo_servicios_p hp
						INNER JOIN tbl_bene_tipo_servicio ts on hp.cod_tipo_servicio=ts.cod_tipo_servicio
						INNER JOIN tbl_bene_vivienda bv on hp.cod_vivienda=bv.cod_vivienda

						INNER JOIN tbl_beneficiario_ficha bf on bv.cod_beneficiario=bf.cod_beneficiario

						INNER JOIN tbl_bene_productor bp on bf.cod_identidad=bp.cod_identidad

						INNER JOIN tbl_bene_proyecto_beneficia pv on bf.cod_pro_beneficia=pv.cod_pro_beneficia

						WHERE pv.cod_pro_beneficia=2 and bf.fecha_visita 
						BETWEEN pfechaInicio and pfechaFinal

						GROUP BY bv.cod_vivienda) AS totales
							);
SELECT CONCAT(@tipoServicio,'/',@totalFichas);	
	
	
end if;
END$$

CREATE DEFINER=`root`@`localhost` PROCEDURE `bene_delete_toda_data` ()  BEGIN
DELETE from tbl_general_h_actividad_pro;
ALTER TABLE tbl_general_h_actividad_pro AUTO_INCREMENT=1;

DELETE from tbl_bene_h_tipo_apoyo;
ALTER TABLE tbl_bene_h_tipo_apoyo AUTO_INCREMENT=1;

DELETE from tbl_bene_h_tipo_estufa;
ALTER TABLE tbl_bene_h_tipo_estufa AUTO_INCREMENT=1;

DELETE from tbl_bene_h_tipo_servicios_p;	
ALTER TABLE tbl_bene_h_tipo_servicios_p AUTO_INCREMENT=1;

DELETE from tbl_bene_vivienda;
ALTER TABLE tbl_bene_vivienda AUTO_INCREMENT=1;

DELETE from tbl_beneficiario_ficha;
ALTER TABLE tbl_beneficiario_ficha AUTO_INCREMENT=1;

DELETE from tbl_bene_h_rubros;
ALTER TABLE tbl_bene_h_rubros AUTO_INCREMENT=1;

DELETE from tbl_bene_h_variedades;
ALTER TABLE tbl_bene_h_variedades AUTO_INCREMENT=1;

DELETE from tbl_bene_finca;
ALTER TABLE tbl_bene_finca AUTO_INCREMENT=1;

END$$

CREATE DEFINER=`root`@`localhost` PROCEDURE `bene_sl_ficha_beneficiario` ()  BEGIN
	
	SELECT gp.nombre,
	gc.grupo_comunitario,
	bf.grupo,
	oc.organizacion_cafetale,
	ta.tipo_apoyo,
	pb.proyecto_beneficia,
	bf.fecha_visita,
	bf.fecha_envio,
	gt.nombre,
	bfin.nombre_fuente_agua,bfin.latitud,bfin.longitud,
	bt.tenencia,
	#vv.variedad,
	tv.tipo_vivienda,
	td.tipo_documentacion,
	tp.tipo_pared,
	tt.tipo_techo,
	tpiso.tipo_piso
	#tss.tipo_servicio
	#be.tipo_estufa
	from tbl_beneficiario_ficha bf 
	INNER JOIN tbl_bene_org_cafetalera oc on bf.cod_org_cafetalera=oc.cod_org_cafetalera
	INNER JOIN tbl_bene_grupo_comunitario gc on bf.cod_grupo=gc.cod_grupo
	INNER JOIN tbl_general_productor gp on bf.cod_identidad=gp.cod_identidad
	INNER JOIN tbl_bene_tipo_apoyo ta on bf.cod_tipo_apoyo=ta.cod_tipo_apoyo
	INNER JOIN tbl_bene_proyecto_beneficia pb on bf.cod_pro_beneficia=pb.cod_pro_beneficia
	INNER JOIN tbl_general_tecnico gt on bf.cod_tecnico=gt.cod_tecnico
		#finca
	INNER JOIN tbl_bene_finca bfin on bf.cod_finca=bfin.cod_finca
	INNER JOIN tbl_bene_tenencia bt on bfin.cod_tenencia=bt.cod_tenencia
	
	#variedades y rubros
	#INNER JOIN tbl_bene_h_variedades hv on bfin.cod_finca=hv.cod_finca
	#INNER JOIN tbl_vulnerabilidad_variedades vv on hv.cod_variedad=vv.cod_variedad
	
	#vivienda
	INNER JOIN tbl_bene_vivienda bv on bf.cod_beneficiario=bv.cod_beneficiario
	INNER JOIN tbl_bene_tipo_vivienda tv on bv.cod_tipo_vivienda=tv.cod_tipo_vivienda
	INNER JOIN tbl_bene_tipo_documentacion td on bv.cod_tipo_doc=td.cod_tipo_doc
	INNER JOIN tbl_bene_tipo_pared tp on bv.cod_tipo_pared=tp.cod_tipo_pared
	INNER JOIN tbl_bene_tipo_techo tt on bv.cod_tipo_techo=tt.cod_tipo_techo
	INNER JOIN tbl_bene_tipo_piso tpiso on bv.cod_tipo_piso=tpiso.cod_tipo_piso
	##servicio publico de vivienda y estufa 
	
	#INNER JOIN tbl_bene_h_tipo_servicios_p hs on bv.cod_vivienda=hs.cod_vivienda#
	#INNER JOIN tbl_bene_tipo_servicio tss on hs.cod_tipo_servicio=tss.cod_tipo_servicio #
	
	#INNER JOIN tbl_bene_h_tipo_estufa he on bv.cod_vivienda=he.cod_vivienda
	#INNER JOIN tbl_bene_tipo_estufa be on he.cod_tipo_estufa=be.cod_tipo_estufa
	

	
	
	
	
	
	
	
	
	
	;
	
	
	

END$$

CREATE DEFINER=`root`@`localhost` PROCEDURE `bene_sl_ficha_beneficiario_estufas` ()  BEGIN
	
	SELECT 
bv.cod_vivienda,
te.tipo_estufa,
gp.cod_identidad,
gp.nombre
	#servicio publico
	from tbl_bene_h_tipo_estufa he
	
	INNER JOIN tbl_bene_vivienda bv on he.cod_vivienda=bv.cod_vivienda
	INNER JOIN tbl_bene_tipo_estufa te on he.cod_tipo_estufa=te.cod_tipo_estufa
	
	INNER JOIN tbl_beneficiario_ficha bf on bv.cod_beneficiario=bf.cod_beneficiario
	INNER JOIN tbl_general_productor gp on bf.cod_identidad=gp.cod_identidad
	
	#INNER JOIN tbl_bene_h_tipo_estufa he on bv.cod_vivienda=he.cod_vivienda
	#INNER JOIN tbl_bene_tipo_estufa be on he.cod_tipo_estufa=be.cod_tipo_estufa
	

	
	
	
	
	
	
	
	
	
	;
	
	
	

END$$

CREATE DEFINER=`root`@`localhost` PROCEDURE `bene_sl_ficha_beneficiario_rubros` ()  BEGIN
	
	SELECT 
	br.rubro,bf.cod_finca,gp.cod_identidad,gp.nombre
	from tbl_bene_h_rubros hr
	INNER JOIN tbl_bene_rubro br on hr.cod_rubro=br.cod_rubro
	
	
	INNER JOIN tbl_bene_finca bf on hr.cod_finca=bf.cod_finca
	INNER JOIN tbl_general_productor gp on bf.cod_identidad=gp.cod_identidad

	
	
	
	
	
	
	
	
	
	;
	
	
	

END$$

CREATE DEFINER=`root`@`localhost` PROCEDURE `bene_sl_ficha_beneficiario_servicios` ()  BEGIN
	
	SELECT 
bv.cod_vivienda,
tss.tipo_servicio,
gp.cod_identidad,
gp.nombre
	#servicio publico
	from tbl_bene_h_tipo_servicios_p hs
	
	INNER JOIN tbl_bene_vivienda bv on hs.cod_vivienda=bv.cod_vivienda
	INNER JOIN tbl_bene_tipo_servicio tss on hs.cod_tipo_servicio=tss.cod_tipo_servicio 
	
	INNER JOIN tbl_beneficiario_ficha bf on bv.cod_beneficiario=bf.cod_beneficiario
	INNER JOIN tbl_general_productor gp on bf.cod_identidad=gp.cod_identidad
	
	#INNER JOIN tbl_bene_h_tipo_estufa he on bv.cod_vivienda=he.cod_vivienda
	#INNER JOIN tbl_bene_tipo_estufa be on he.cod_tipo_estufa=be.cod_tipo_estufa
	

	
	
	
	
	
	
	
	
	
	;
	
	
	

END$$

CREATE DEFINER=`root`@`localhost` PROCEDURE `bene_sl_ficha_beneficiario_variedades` ()  BEGIN
	
	SELECT 
	
hv.cod_finca,gp.cod_identidad,gp.nombre,vv.variedad
	#variedades y rubros
	from tbl_bene_h_variedades hv 
	INNER JOIN tbl_vulnerabilidad_variedades vv on hv.cod_variedad=vv.cod_variedad
	INNER JOIN tbl_beneficiario_ficha bf on hv.cod_finca=bf.cod_finca 
	INNER JOIN tbl_general_productor gp on bf.cod_identidad=gp.cod_identidad
	
	
	##servicio publico de vivienda y estufa 
	
	#INNER JOIN tbl_bene_h_tipo_servicios_p hs on bv.cod_vivienda=hs.cod_vivienda#
	#INNER JOIN tbl_bene_tipo_servicio tss on hs.cod_tipo_servicio=tss.cod_tipo_servicio #
	
	#INNER JOIN tbl_bene_h_tipo_estufa he on bv.cod_vivienda=he.cod_vivienda
	#INNER JOIN tbl_bene_tipo_estufa be on he.cod_tipo_estufa=be.cod_tipo_estufa
	

	
	
	
	
	
	
	
	
	
	;
	
	
	

END$$

CREATE DEFINER=`root`@`localhost` PROCEDURE `CODIGODECISION` (IN `p1cambios_temperatura` VARCHAR(15))  BEGIN
	

	
DECLARE variable INT(5);
set variable=	(SELECT vr.cod_respuesta  FROM ihcafemonitoreo.tbl_vulnerabilidad_respuesta vr 
			INNER JOIN ihcafemonitoreo.tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			WHERE d.desisicon=UPPER(p1cambios_temperatura) and  vr.cod_pregunta=2 LIMIT 1
			);
			
SELECT variable;
END$$

CREATE DEFINER=`root`@`localhost` PROCEDURE `datosAgencias` ()  BEGIN
	#Routine body goes here...

SELECT a.cod_agencia,a.agencia from tbl_general_agencia a;
END$$

CREATE DEFINER=`root`@`localhost` PROCEDURE `delete_toda_data_vulnerabilidades` ()  NO SQL
BEGIN
START TRANSACTION;

DELETE from tbl_vulnerabilidad_h_variedad;
ALTER TABLE tbl_vulnerabilidad_h_variedad AUTO_INCREMENT=1;


DELETE from tbl_vulnerabilidades_ficha;
ALTER TABLE tbl_vulnerabilidades_ficha AUTO_INCREMENT=1;

DELETE FROM tbl_h_respuestas;
ALTER TABLE tbl_h_respuestas AUTO_INCREMENT=1;
DELETE from tbl_general_finca;
ALTER TABLE tbl_general_finca AUTO_INCREMENT=1;

COMMIT;
END$$

CREATE DEFINER=`root`@`localhost` PROCEDURE `diversificacion_contador_todos` (IN `fechaInicio` VARCHAR(15), IN `fechaFinal` VARCHAR(15), IN `filtro` VARCHAR(1))  BEGIN
set @totalFicha=(SELECT COUNT(lf.cod_ficha) from tbl_lideres_ficha lf);


 if filtro='1' then 
		SELECT CONCAT_WS('/',COUNT(gg.cod_genero),@totalFicha) as totales FROM tbl_lider_productor lp 
		LEFT JOIN  tbl_general_genero gg ON gg.cod_genero = lp.cod_genero
		LEFT JOIN  tbl_lideres_ficha lf ON lp.cod_identidad = lf.cod_identidad
		LEFT JOIN tbl_bene_proyecto_beneficia bpb ON bpb.cod_pro_beneficia = lf.cod_pro_beneficia
		WHERE lf.fecha_inicio BETWEEN fechaInicio and fechaFinal and bpb.cod_pro_beneficia=2
		GROUP BY gg.cod_genero;

elseif filtro='2' then 
		SELECT CONCAT(COUNT(vv.cod_variedad),'/',@totalFicha)  as totales FROM tbl_lider_productor lp 

		LEFT JOIN tbl_lideres_ficha lf ON lp.cod_identidad = lf.cod_identidad
		LEFT JOIN tbl_lider_fincas lfi ON lfi.cod_identidad = lp.cod_identidad
		LEFT JOIN tbl_lider_parcela lpar ON lpar.cod_finca = lfi.cod_finca
		LEFT JOIN tbl_vulnerabilidad_variedades vv ON vv.cod_variedad = lpar.cod_variedad
		LEFT JOIN tbl_bene_proyecto_beneficia bpb ON bpb.cod_pro_beneficia = lf.cod_pro_beneficia

		WHERE lf.fecha_inicio BETWEEN fechaInicio and fechaFinal and bpb.cod_pro_beneficia=2;

elseif filtro='3' then 
	
		SELECT CONCAT( COUNT(lg.cod_grupo),'/',@totalFicha) as totales FROM tbl_lider_productor lp 

		LEFT JOIN tbl_lideres_ficha lf ON lp.cod_identidad = lf.cod_identidad
		LEFT JOIN tbl_lider_grupo lg ON lg.cod_grupo = lf.cod_grupo
		 
		LEFT JOIN tbl_bene_proyecto_beneficia bpb ON bpb.cod_pro_beneficia = lf.cod_pro_beneficia
		WHERE lf.fecha_inicio BETWEEN fechaInicio and fechaFinal and bpb.cod_pro_beneficia=2


		;

			
elseif filtro='4' then
			SELECT CONCAT( COUNT(lpr.cod_problema),'/',@totalFicha) as totales FROM tbl_lider_productor lp 
		LEFT JOIN tbl_lideres_ficha lf ON lp.cod_identidad = lf.cod_identidad
		LEFT JOIN tbl_lider_problema lpr ON lpr.cod_problema = lf.cod_problema 
		LEFT JOIN tbl_bene_proyecto_beneficia bpb ON bpb.cod_pro_beneficia = lf.cod_pro_beneficia

		WHERE lf.fecha_inicio BETWEEN fechaInicio and fechaFinal and bpb.cod_pro_beneficia=2


		;
elseif filtro='5' then

		SELECT CONCAT(COUNT(lgc.cod_comunal),'/',@totalFicha) as totales FROM tbl_lider_productor lp 

		LEFT JOIN tbl_lideres_ficha lf ON lp.cod_identidad = lf.cod_identidad
		LEFT JOIN tbl_lider_h_comunal lhco ON lhco.cod_ficha = lf.cod_ficha
		LEFT JOIN tbl_lider_grupo_comunal lgc ON lgc.cod_comunal = lhco.cod_comunal 
		LEFT JOIN tbl_bene_proyecto_beneficia bpb ON bpb.cod_pro_beneficia = lf.cod_pro_beneficia
		WHERE lf.fecha_inicio BETWEEN fechaInicio and fechaFinal and bpb.cod_pro_beneficia=2

		;
  
end if;



END$$

CREATE DEFINER=`root`@`localhost` PROCEDURE `diversificacion_contador_todos_g` (IN `fechaInicio` VARCHAR(20), IN `fechaFinal` VARCHAR(20), IN `evento` VARCHAR(2))  BEGIN
#donde fecha inicio es la fecha de visita
if evento=1 then

SELECT etiqueta,totales from 
(
SELECT gg.genero etiqueta,COUNT(dp.cod_identidad) totales from tbl_div_ficha f 

INNER JOIN tbl_div_productor dp on f.cod_identidad=dp.cod_identidad
INNER JOIN tbl_general_genero gg on dp.cod_genero=gg.cod_genero
INNER JOIN tbl_bene_proyecto_beneficia pb on f.cod_pro_beneficia=pb.cod_pro_beneficia
WHERE f.fecha_visita BETWEEN fechaInicio and fechaFinal and pb.cod_pro_beneficia=2
GROUP BY gg.cod_genero
union all
SELECT gg.genero as etiqueta,0 as totales from tbl_general_genero gg) as t
GROUP BY etiqueta 

;
	
elseif evento=2 then
SELECT etiqueta,totales from 
(
SELECT ti.tipo_ingreso as etiqueta,COUNT(ti.cod_ingreso) as totales from tbl_div_ficha f 
INNER JOIN tbl_bene_proyecto_beneficia pb on f.cod_pro_beneficia=pb.cod_pro_beneficia
INNER JOIN tbl_div_h_ingresos hi on f.cod_ficha=hi.cod_ficha
INNER JOIN tbl_div_tipo_ingreso ti on hi.cod_ingreso=ti.cod_ingreso
WHERE f.fecha_visita BETWEEN fechaInicio and fechaFinal and pb.cod_pro_beneficia=2
GROUP BY ti.cod_ingreso
UNION ALL
SELECT ti.tipo_ingreso as etiqueta,0 as totales from tbl_div_tipo_ingreso ti)  t
GROUP BY etiqueta
;

elseif evento=3 then
		SELECT etiqueta,totales from 
			(
				SELECT br.rubro as etiqueta,COUNT(br.cod_rubro) as totales from tbl_div_ficha f 
			INNER JOIN tbl_div_rubro br on f.cod_rubro=br.cod_rubro
			INNER JOIN tbl_bene_proyecto_beneficia pb on f.cod_pro_beneficia=pb.cod_pro_beneficia

			WHERE f.fecha_visita BETWEEN fechaInicio and fechaFinal and pb.cod_pro_beneficia=2
			GROUP BY br.cod_rubro

			UNION all
			SELECT br.rubro as etiqueta,0 as totales from tbl_div_rubro br) as t
			GROUP BY etiqueta

			;
elseif evento=4 then
SELECT etiqueta,totales from 
(
SELECT dd.decision etiqueta,count(dd.cod_dicision) totales from tbl_div_ficha f 


INNER JOIN tbl_bene_proyecto_beneficia pb on f.cod_pro_beneficia=pb.cod_pro_beneficia
INNER JOIN tbl_div_decision dd on f.cod_dicision=dd.cod_dicision
WHERE f.fecha_visita BETWEEN fechaInicio and fechaFinal and pb.cod_pro_beneficia=2
GROUP BY dd.cod_dicision
union all
SELECT dd.decision as etiqueta,0 as totales from tbl_div_decision dd)as t
GROUP BY etiqueta;

elseif evento=5 then
SELECT etiqueta,totales from 
(
SELECT mi.modo etiqueta,count(mi.cod_modo) totales from tbl_div_ficha f 


INNER JOIN tbl_bene_proyecto_beneficia pb on f.cod_pro_beneficia=pb.cod_pro_beneficia
INNER JOIN tbl_div_decision dd on f.cod_dicision=dd.cod_dicision
INNER JOIN tbl_div_modo_imp mi on f.cod_modo=mi.cod_modo
WHERE f.fecha_visita BETWEEN fechaInicio and fechaFinal and pb.cod_pro_beneficia=2
GROUP BY dd.cod_dicision
union all
SELECT mi.modo etiqueta,0 as totales from tbl_div_modo_imp mi)as t
GROUP BY etiqueta;

elseif evento=6 then
SELECT etiqueta,totales from 
(
SELECT gm.mes etiqueta,count(gm.cod_mes) totales from tbl_div_ficha f 


INNER JOIN tbl_div_productor dp on f.cod_identidad=dp.cod_identidad
INNER JOIN tbl_bene_proyecto_beneficia pb on f.cod_pro_beneficia=pb.cod_pro_beneficia
INNER JOIN tbl_div_finca df on dp.cod_identidad=df.cod_identidad
INNER JOIN tbl_div_h_meses hm on hm.cod_finca=df.cod_finca
INNER JOIN tbl_general_meses gm on hm.cod_mes=gm.cod_mes
WHERE f.fecha_visita BETWEEN fechaInicio and fechaFinal and pb.cod_pro_beneficia=2
GROUP BY gm.cod_mes
UNION all 
SELECT gm.mes etiqueta,0 as totales from tbl_general_meses gm) as t
GROUP BY etiqueta ;

elseif evento=7 then 
SELECT etiqueta,totales from 
(
SELECT gm.mes as etiqueta,COUNT(gm.cod_mes) as totales from tbl_div_ficha f 
INNER JOIN tbl_bene_proyecto_beneficia pb on f.cod_pro_beneficia=pb.cod_pro_beneficia


INNER JOIN tbl_div_h_familia_mes hfm on hfm.cod_ficha=f.cod_ficha
INNER JOIN tbl_general_meses gm on hfm.cod_mes=gm.cod_mes
WHERE f.fecha_visita BETWEEN fechaInicio and fechaFinal and pb.cod_pro_beneficia=2
GROUP BY gm.cod_mes
union all

SELECT gm.mes etiqueta,0 as totales from tbl_general_meses gm) as t
;

			
elseif evento=8 then 
SELECT etiqueta,totales from 
(
SELECT p.porcentaje as etiqueta,COUNT(p.cod_porcentaje) as totales from tbl_div_ficha f 
INNER JOIN tbl_div_productor dp on f.cod_identidad=dp.cod_identidad
INNER JOIN tbl_bene_proyecto_beneficia pb on f.cod_pro_beneficia=pb.cod_pro_beneficia
INNER JOIN tbl_div_finca df on dp.cod_identidad=df.cod_identidad
INNER JOIN tbl_div_porcentajes p on df.cod_porcentaje=p.cod_porcentaje
INNER JOIN tbl_div_tipo_suelo ts on df.cod_tipo_suelo=ts.cod_tipo_suelo
WHERE f.fecha_visita BETWEEN fechaInicio and fechaFinal and pb.cod_pro_beneficia=2
GROUP BY p.cod_porcentaje
UNION all
 SELECT p.porcentaje as etiqueta,0 as totales from tbl_div_porcentajes p)as t
 GROUP BY etiqueta
;

elseif evento=9 then 
SELECT etiqueta,totales from 
(
SELECT ts.tipo_suelo etiqueta,COUNT(ts.cod_tipo_suelo) totales from tbl_div_ficha f 

INNER JOIN tbl_bene_rubro br on f.cod_rubro=br.cod_rubro
INNER JOIN tbl_div_productor dp on f.cod_identidad=dp.cod_identidad
INNER JOIN tbl_bene_proyecto_beneficia pb on f.cod_pro_beneficia=pb.cod_pro_beneficia
INNER JOIN tbl_div_finca df on dp.cod_identidad=df.cod_identidad
INNER JOIN tbl_div_tipo_suelo ts on df.cod_tipo_suelo=ts.cod_tipo_suelo
WHERE f.fecha_visita BETWEEN fechaInicio and fechaFinal and pb.cod_pro_beneficia=2
GROUP BY ts.cod_tipo_suelo

union all
 SELECT ts.tipo_suelo as etiqueta,0 as totales from tbl_div_tipo_suelo ts) as t
GROUP BY etiqueta 	
;
 			
end if;
END$$

CREATE DEFINER=`root`@`localhost` PROCEDURE `diversificacion_totales_todos_g` (IN `fechaInicio` VARCHAR(20), IN `fechaFinal` VARCHAR(20), IN `evento` VARCHAR(2))  BEGIN
#donde fecha inicio es la fecha de visita
set @totalFichas=(SELECT COUNT(cod_ficha) from tbl_div_ficha);
if evento=1 then

SELECT CONCAT(COUNT(dp.cod_identidad),"/",@totalFichas) totales from tbl_div_ficha f 

INNER JOIN tbl_div_productor dp on f.cod_identidad=dp.cod_identidad
INNER JOIN tbl_general_genero gg on dp.cod_genero=gg.cod_genero
INNER JOIN tbl_bene_proyecto_beneficia pb on f.cod_pro_beneficia=pb.cod_pro_beneficia
WHERE f.fecha_visita BETWEEN fechaInicio and fechaFinal and pb.cod_pro_beneficia=2



;
	
elseif evento=2 then

SELECT CONCAT(COUNT(ti.cod_ingreso),"/",@totalFichas) as totales from tbl_div_ficha f 
INNER JOIN tbl_bene_proyecto_beneficia pb on f.cod_pro_beneficia=pb.cod_pro_beneficia
INNER JOIN tbl_div_h_ingresos hi on f.cod_ficha=hi.cod_ficha
INNER JOIN tbl_div_tipo_ingreso ti on hi.cod_ingreso=ti.cod_ingreso
WHERE f.fecha_visita BETWEEN fechaInicio and fechaFinal and pb.cod_pro_beneficia=2
;

elseif evento=3 then
		
				SELECT CONCAT(COUNT(br.cod_rubro),"/",@totalFichas) as totales from tbl_div_ficha f 
			INNER JOIN tbl_div_rubro br on f.cod_rubro=br.cod_rubro
			INNER JOIN tbl_bene_proyecto_beneficia pb on f.cod_pro_beneficia=pb.cod_pro_beneficia

			WHERE f.fecha_visita BETWEEN fechaInicio and fechaFinal and pb.cod_pro_beneficia=2
		
			;
elseif evento=4 then

SELECT CONCAT(count(dd.cod_dicision),"/",@totalFichas) totales from tbl_div_ficha f 

INNER JOIN tbl_bene_proyecto_beneficia pb on f.cod_pro_beneficia=pb.cod_pro_beneficia
INNER JOIN tbl_div_decision dd on f.cod_dicision=dd.cod_dicision
WHERE f.fecha_visita BETWEEN fechaInicio and fechaFinal and pb.cod_pro_beneficia=2;

elseif evento=5 then

SELECT CONCAT(count(mi.cod_modo),"/",@totalFichas) totales from tbl_div_ficha f 


INNER JOIN tbl_bene_proyecto_beneficia pb on f.cod_pro_beneficia=pb.cod_pro_beneficia
INNER JOIN tbl_div_decision dd on f.cod_dicision=dd.cod_dicision
INNER JOIN tbl_div_modo_imp mi on f.cod_modo=mi.cod_modo
WHERE f.fecha_visita BETWEEN fechaInicio and fechaFinal and pb.cod_pro_beneficia=2;

elseif evento=6 then

SELECT CONCAT(count(gm.cod_mes),"/",@totalFichas) totales from tbl_div_ficha f 


INNER JOIN tbl_div_productor dp on f.cod_identidad=dp.cod_identidad
INNER JOIN tbl_bene_proyecto_beneficia pb on f.cod_pro_beneficia=pb.cod_pro_beneficia
INNER JOIN tbl_div_finca df on dp.cod_identidad=df.cod_identidad
INNER JOIN tbl_div_h_meses hm on hm.cod_finca=df.cod_finca
INNER JOIN tbl_general_meses gm on hm.cod_mes=gm.cod_mes
WHERE f.fecha_visita BETWEEN fechaInicio and fechaFinal and pb.cod_pro_beneficia=2
;

elseif evento=7 then 

SELECT CONCAT(COUNT(gm.cod_mes),"/",@totalFichas) as totales from tbl_div_ficha f 
INNER JOIN tbl_bene_proyecto_beneficia pb on f.cod_pro_beneficia=pb.cod_pro_beneficia

INNER JOIN tbl_div_h_familia_mes hfm on hfm.cod_ficha=f.cod_ficha
INNER JOIN tbl_general_meses gm on hfm.cod_mes=gm.cod_mes
WHERE f.fecha_visita BETWEEN fechaInicio and fechaFinal and pb.cod_pro_beneficia=2


;

			
elseif evento=8 then 
SELECT CONCAT(COUNT(p.cod_porcentaje),"/",@totalFichas) as totales from tbl_div_ficha f 
INNER JOIN tbl_div_productor dp on f.cod_identidad=dp.cod_identidad
INNER JOIN tbl_bene_proyecto_beneficia pb on f.cod_pro_beneficia=pb.cod_pro_beneficia
INNER JOIN tbl_div_finca df on dp.cod_identidad=df.cod_identidad
INNER JOIN tbl_div_porcentajes p on df.cod_porcentaje=p.cod_porcentaje
INNER JOIN tbl_div_tipo_suelo ts on df.cod_tipo_suelo=ts.cod_tipo_suelo
WHERE f.fecha_visita BETWEEN fechaInicio and fechaFinal and pb.cod_pro_beneficia=2
;

elseif evento=9 then 
SELECT CONCAT(COUNT(ts.cod_tipo_suelo),"/",@totalFichas) totales from tbl_div_ficha f 

INNER JOIN tbl_bene_rubro br on f.cod_rubro=br.cod_rubro
INNER JOIN tbl_div_productor dp on f.cod_identidad=dp.cod_identidad
INNER JOIN tbl_bene_proyecto_beneficia pb on f.cod_pro_beneficia=pb.cod_pro_beneficia
INNER JOIN tbl_div_finca df on dp.cod_identidad=df.cod_identidad
INNER JOIN tbl_div_tipo_suelo ts on df.cod_tipo_suelo=ts.cod_tipo_suelo
WHERE f.fecha_visita BETWEEN fechaInicio and fechaFinal and pb.cod_pro_beneficia=2

;
 			
end if;
END$$

CREATE DEFINER=`root`@`localhost` PROCEDURE `diver_delete_toda_data` ()  BEGIN

delete from tbl_div_h_meses;
alter TABLE tbl_div_h_meses AUTO_INCREMENT=1;

delete from tbl_div_h_familia_mes;
alter TABLE tbl_div_h_familia_mes AUTO_INCREMENT=1;

DELETE from tbl_div_h_ingresos;
alter TABLE tbl_div_h_ingresos AUTO_INCREMENT=1;

delete from tbl_div_h_frutas;##aun no se agregado por falta de informacion 
alter TABLE tbl_div_h_frutas AUTO_INCREMENT=1;

DELETE from tbl_div_finca;
alter TABLE tbl_div_finca AUTO_INCREMENT=1;

DELETE FROM tbl_div_recomendacion;
alter TABLE tbl_div_recomendacion AUTO_INCREMENT=1;

DELETE from tbl_div_ficha;
alter TABLE tbl_div_ficha AUTO_INCREMENT=1;
#DELETE from  tbl_div_productor;
END$$

CREATE DEFINER=`root`@`localhost` PROCEDURE `estadistiBeneficiariocanivelnacionalApoyo` ()  BEGIN
	#Routine body goes here...SELECT CONVERT('25 euros', SIGNED)

																					
	SELECT etiqueta,totales from
(
SELECT ta.tipo_apoyo as etiqueta,
(COUNT(ta.cod_tipo_apoyo))

as totales from tbl_bene_h_tipo_apoyo he
INNER JOIN tbl_bene_tipo_apoyo ta on he.cod_tipo_apoyo=ta.cod_tipo_apoyo
						GROUP BY ta.cod_tipo_apoyo
UNION all 

SELECT ta.tipo_apoyo as etiqueta,0 as 'totales' from tbl_bene_tipo_apoyo ta ) as T
	GROUP BY etiqueta;

END$$

CREATE DEFINER=`root`@`localhost` PROCEDURE `estadistiBeneficiariocanivelnacionalEstufa` ()  BEGIN
	#Routine body goes here...SELECT CONVERT('25 euros', SIGNED)

	set @restarGas=(
	SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) 
						from (
						select COUNT(te.cod_tipo_estufa) as total from tbl_bene_h_tipo_estufa he
						INNER JOIN tbl_bene_tipo_estufa te on he.cod_tipo_estufa=te.cod_tipo_estufa
						WHERE  te.cod_tipo_estufa=1
						GROUP BY te.cod_tipo_estufa HAVING COUNT(*)>1
						) as total limit 1
								);
								
	set @restarElectrica=(
	SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) 
						from (
						select COUNT(te.cod_tipo_estufa) as total from tbl_bene_h_tipo_estufa he
						INNER JOIN tbl_bene_tipo_estufa te on he.cod_tipo_estufa=te.cod_tipo_estufa
						WHERE  te.cod_tipo_estufa=2
						GROUP BY te.cod_tipo_estufa HAVING COUNT(*)>1
						) as total limit 1
								);
									
	set @restarHornilla=(
	SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) 
						from (
						select COUNT(te.cod_tipo_estufa) as total from tbl_bene_h_tipo_estufa he
						INNER JOIN tbl_bene_tipo_estufa te on he.cod_tipo_estufa=te.cod_tipo_estufa
						WHERE  te.cod_tipo_estufa=3
						GROUP BY te.cod_tipo_estufa HAVING COUNT(*)>1
						) as total limit 1
								);									
								
set @restarEcofogon=(
	SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) 
						from (
						select COUNT(te.cod_tipo_estufa) as total from tbl_bene_h_tipo_estufa he
						INNER JOIN tbl_bene_tipo_estufa te on he.cod_tipo_estufa=te.cod_tipo_estufa
						WHERE  te.cod_tipo_estufa=4
						GROUP BY te.cod_tipo_estufa HAVING COUNT(*)>1
						) as total limit 1
								);			
								
set @restarPendiente=(
	SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) 
						from (
						select COUNT(te.cod_tipo_estufa) as total from tbl_bene_h_tipo_estufa he
						INNER JOIN tbl_bene_tipo_estufa te on he.cod_tipo_estufa=te.cod_tipo_estufa
						WHERE  te.cod_tipo_estufa=5
						GROUP BY te.cod_tipo_estufa HAVING COUNT(*)>1
						) as total limit 1
								);			
																					
	SELECT etiqueta,totales from
(
SELECT te.tipo_estufa as etiqueta,
(COUNT(te.cod_tipo_estufa))

as totales from tbl_bene_h_tipo_estufa he
INNER JOIN tbl_bene_tipo_estufa te on he.cod_tipo_estufa=te.cod_tipo_estufa
						GROUP BY te.cod_tipo_estufa
UNION all 

SELECT te.tipo_estufa as etiqueta,0 as 'totales' from tbl_bene_tipo_estufa te ) as T
	GROUP BY etiqueta;

END$$

CREATE DEFINER=`root`@`localhost` PROCEDURE `estadistiBeneficiariocanivelnacionalRubro` ()  BEGIN
	#Routine body goes here...SELECT CONVERT('25 euros', SIGNED)

	set @restarMaderable=(
	SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) 
						from (
						select COUNT(hr.cod_rubro) as total from tbl_bene_h_rubros hr
						INNER JOIN tbl_bene_rubro br on hr.cod_rubro=br.cod_rubro
						WHERE  br.cod_rubro=1
						GROUP BY hr.cod_rubro HAVING COUNT(*)>1
						) as total limit 1
								);
								
	set @restarfrutales=(
	SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) 
						from (
						select COUNT(hr.cod_rubro) as total from tbl_bene_h_rubros hr
						INNER JOIN tbl_bene_rubro br on hr.cod_rubro=br.cod_rubro
						WHERE  br.cod_rubro=2
						GROUP BY hr.cod_rubro HAVING COUNT(*)>1
						) as total limit 1
								);
									
	set @restarMusaceas=(
	SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) 
						from (
						select COUNT(hr.cod_rubro) as total from tbl_bene_h_rubros hr
						INNER JOIN tbl_bene_rubro br on hr.cod_rubro=br.cod_rubro
						WHERE  br.cod_rubro=3
						GROUP BY hr.cod_rubro HAVING COUNT(*)>1
						) as total limit 1
								);									
								
set @restarCerdos=(
	SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) 
						from (
						select COUNT(hr.cod_rubro) as total from tbl_bene_h_rubros hr
						INNER JOIN tbl_bene_rubro br on hr.cod_rubro=br.cod_rubro
						WHERE  br.cod_rubro=4
						GROUP BY hr.cod_rubro HAVING COUNT(*)>1
						) as total limit 1
								);			
								
set @restarGallinas=(
	SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) 
						from (
						select COUNT(hr.cod_rubro) as total from tbl_bene_h_rubros hr
						INNER JOIN tbl_bene_rubro br on hr.cod_rubro=br.cod_rubro
						WHERE  br.cod_rubro=5
						GROUP BY hr.cod_rubro HAVING COUNT(*)>1
						) as total limit 1
								);
															
set @restarPeces=(
	SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) 
						from (
						select COUNT(hr.cod_rubro) as total from tbl_bene_h_rubros hr
						INNER JOIN tbl_bene_rubro br on hr.cod_rubro=br.cod_rubro
						WHERE  br.cod_rubro=6
						GROUP BY hr.cod_rubro HAVING COUNT(*)>1
						) as total limit 1
								);
								
	set @restarAbejas=(
	SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) 
						from (
						select COUNT(hr.cod_rubro) as total from tbl_bene_h_rubros hr
						INNER JOIN tbl_bene_rubro br on hr.cod_rubro=br.cod_rubro
						WHERE  br.cod_rubro=7
						GROUP BY hr.cod_rubro HAVING COUNT(*)>1
						) as total limit 1
								);
									
	set @restarGanado=(
	SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) 
						from (
						select COUNT(hr.cod_rubro) as total from tbl_bene_h_rubros hr
						INNER JOIN tbl_bene_rubro br on hr.cod_rubro=br.cod_rubro
						WHERE  br.cod_rubro=8
						GROUP BY hr.cod_rubro HAVING COUNT(*)>1
						) as total limit 1
								);									
								
set @restarNinguno=(
	SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) 
						from (
						select COUNT(hr.cod_rubro) as total from tbl_bene_h_rubros hr
						INNER JOIN tbl_bene_rubro br on hr.cod_rubro=br.cod_rubro
						WHERE  br.cod_rubro=9
						GROUP BY hr.cod_rubro HAVING COUNT(*)>1
						) as total limit 1
								);			
								
set @restarGranosB=(
	SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) 
						from (
						select COUNT(hr.cod_rubro) as total from tbl_bene_h_rubros hr
						INNER JOIN tbl_bene_rubro br on hr.cod_rubro=br.cod_rubro
						WHERE  br.cod_rubro=10
						GROUP BY hr.cod_rubro HAVING COUNT(*)>1
						) as total limit 1
								);			
												
												
	set @restarPendiente=(
	SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) 
						from (
						select COUNT(hr.cod_rubro) as total from tbl_bene_h_rubros hr
						INNER JOIN tbl_bene_rubro br on hr.cod_rubro=br.cod_rubro
						WHERE  br.cod_rubro=11
						GROUP BY hr.cod_rubro HAVING COUNT(*)>1
						) as total limit 1
								);									
								
set @restarCaña=(
	SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) 
						from (
						select COUNT(hr.cod_rubro) as total from tbl_bene_h_rubros hr
						INNER JOIN tbl_bene_rubro br on hr.cod_rubro=br.cod_rubro
						WHERE  br.cod_rubro=12
						GROUP BY hr.cod_rubro HAVING COUNT(*)>1
						) as total limit 1
								);			
								
set @restarTurismo=(
	SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) 
						from (
						select COUNT(hr.cod_rubro) as total from tbl_bene_h_rubros hr
						INNER JOIN tbl_bene_rubro br on hr.cod_rubro=br.cod_rubro
						WHERE  br.cod_rubro=13
						GROUP BY hr.cod_rubro HAVING COUNT(*)>1
						) as total limit 1
								);																		
																					
	SELECT etiqueta,totales from
(
SELECT br.rubro as etiqueta,
if(br.cod_rubro=1,FORMAT((ROUND(COUNT(br.cod_rubro)-@restarMaderable)),0,'en_US'),
if(br.cod_rubro=2,FORMAT((ROUND(COUNT(br.cod_rubro)-@restarfrutales)),0,'en_US'),

if(br.cod_rubro=3,FORMAT((ROUND(COUNT(br.cod_rubro)-@restarMusaceas)),0,'en_US'),
if(br.cod_rubro=4,FORMAT((ROUND(COUNT(br.cod_rubro)-@restarCerdos)),0,'en_US'),

if(br.cod_rubro=5,FORMAT((ROUND(COUNT(br.cod_rubro)-@restarGallinas)),0,'en_US'),
if(br.cod_rubro=6,FORMAT((ROUND(COUNT(br.cod_rubro)-@restarPeces)),0,'en_US'),
if(br.cod_rubro=7,FORMAT((ROUND(COUNT(br.cod_rubro)-@restarAbejas)),0,'en_US'),
if(br.cod_rubro=8,FORMAT((ROUND(COUNT(br.cod_rubro)-@restarGanado)),0,'en_US'),
if(br.cod_rubro=9,FORMAT((ROUND(COUNT(br.cod_rubro)-@restarNinguno)),0,'en_US'),
if(br.cod_rubro=10,FORMAT((ROUND(COUNT(br.cod_rubro)-@restarGranosB)),0,'en_US'),
if(br.cod_rubro=11,FORMAT((ROUND(COUNT(br.cod_rubro)-@restarPendiente)),0,'en_US'),
if(br.cod_rubro=12,FORMAT((ROUND(COUNT(br.cod_rubro)-@restarCaña)),0,'en_US'),
if (br.cod_rubro=13,FORMAT((ROUND(COUNT(br.cod_rubro)-@restarTurismo)),0,'en_US'),'no_gusta_el_else')) )))))))))))
as totales 
	from tbl_bene_h_rubros hr
	INNER JOIN tbl_bene_rubro br on hr.cod_rubro=br.cod_rubro
	GROUP BY hr.cod_rubro
UNION all 

SELECT br.rubro as etiqueta,0 as 'totales' from tbl_bene_rubro br ) as T
	GROUP BY etiqueta;

END$$

CREATE DEFINER=`root`@`localhost` PROCEDURE `estadistiBeneficiariocanivelnacionalServicios` ()  BEGIN
	#Routine body goes here...SELECT CONVERT('25 euros', SIGNED)

	set @restarAgua=(
	SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) 
						from (
						select COUNT(hp.cod_tipo_servicio) as total from tbl_bene_h_tipo_servicios_p hp
						INNER JOIN tbl_bene_tipo_servicio ts on hp.cod_tipo_servicio=ts.cod_tipo_servicio
						WHERE  hp.cod_tipo_servicio=1
						GROUP BY hp.cod_tipo_servicio HAVING COUNT(*)>1
						) as total limit 1
								);
								
	set @restarElectricidad=(
	SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) 
						from (
						select COUNT(hp.cod_tipo_servicio) as total from tbl_bene_h_tipo_servicios_p hp
						INNER JOIN tbl_bene_tipo_servicio ts on hp.cod_tipo_servicio=ts.cod_tipo_servicio
						WHERE  hp.cod_tipo_servicio=2
						GROUP BY hp.cod_tipo_servicio HAVING COUNT(*)>1
						) as total limit 1
								);
									
	set @restarAlcantarilla=(
	SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) 
						from (
					select COUNT(hp.cod_tipo_servicio) as total from tbl_bene_h_tipo_servicios_p hp
						INNER JOIN tbl_bene_tipo_servicio ts on hp.cod_tipo_servicio=ts.cod_tipo_servicio
						WHERE  hp.cod_tipo_servicio=3
						GROUP BY hp.cod_tipo_servicio HAVING COUNT(*)>1
						) as total limit 1
								);									
								
set @restarLetrina=(
	SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) 
						from (
						select COUNT(hp.cod_tipo_servicio) as total from tbl_bene_h_tipo_servicios_p hp
						INNER JOIN tbl_bene_tipo_servicio ts on hp.cod_tipo_servicio=ts.cod_tipo_servicio
						WHERE  hp.cod_tipo_servicio=4
						GROUP BY hp.cod_tipo_servicio HAVING COUNT(*)>1
						) as total limit 1
								);			
								
set @restarPendiente=(
	SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) 
						from (
						select COUNT(hp.cod_tipo_servicio) as total from tbl_bene_h_tipo_servicios_p hp
						INNER JOIN tbl_bene_tipo_servicio ts on hp.cod_tipo_servicio=ts.cod_tipo_servicio
						WHERE  hp.cod_tipo_servicio=5
						GROUP BY hp.cod_tipo_servicio HAVING COUNT(*)>1
						) as total limit 1
								);			
																					
	SELECT etiqueta,totales from
(
SELECT ts.tipo_servicio as etiqueta,
if(ts.cod_tipo_servicio=1,FORMAT((ROUND(COUNT(ts.cod_tipo_servicio)-@restarAgua)),0,'en_US'),##ojo solo applique un round
if(ts.cod_tipo_servicio=2,FORMAT((ROUND(COUNT(ts.cod_tipo_servicio)-@restarElectricidad)),0,'en_US'),##
if(ts.cod_tipo_servicio=3,FORMAT((ROUND(COUNT(ts.cod_tipo_servicio)-@restarAlcantarilla)),0,'en_US'), 
if(ts.cod_tipo_servicio=4,FORMAT((ROUND(COUNT(ts.cod_tipo_servicio)-@restarLetrina)),0,'en_US'),
if (ts.cod_tipo_servicio=5,FORMAT((ROUND(COUNT(ts.cod_tipo_servicio)-@restarPendiente)),0,'en_US'),'no_gusta_el_else')) )))
as totales from tbl_bene_h_tipo_servicios_p hp
						INNER JOIN tbl_bene_tipo_servicio ts on hp.cod_tipo_servicio=ts.cod_tipo_servicio
						GROUP BY hp.cod_tipo_servicio
UNION all 

SELECT ts.tipo_servicio as etiqueta,0 as 'totales' from tbl_bene_tipo_servicio ts ) as T
	GROUP BY etiqueta;

END$$

CREATE DEFINER=`root`@`localhost` PROCEDURE `estadistiBeneficiariocanivelnacionalVariedades` ()  BEGIN
	#Routine body goes here...SELECT CONVERT('25 euros', SIGNED)

	set @restarCatimor=(
				SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) 
						from (
						select COUNT(hv.cod_variedad) as total from tbl_bene_h_variedades hv
						INNER JOIN tbl_vulnerabilidad_variedades vv on hv.cod_variedad=vv.cod_variedad
						WHERE  hv.cod_variedad=1
						GROUP BY hv.cod_variedad HAVING COUNT(*)>1
						) as total limit 1
								);
								
	set @restarCatuai=(
				SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) 
						from (
						select COUNT(hv.cod_variedad) as total from tbl_bene_h_variedades hv
						INNER JOIN tbl_vulnerabilidad_variedades vv on hv.cod_variedad=vv.cod_variedad
						WHERE  hv.cod_variedad=2
						GROUP BY hv.cod_variedad HAVING COUNT(*)>1
						) as total limit 1
								);
									
	set @restarCaturra=(
				SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) 
						from (
						select COUNT(hv.cod_variedad) as total from tbl_bene_h_variedades hv
						INNER JOIN tbl_vulnerabilidad_variedades vv on hv.cod_variedad=vv.cod_variedad
						WHERE  hv.cod_variedad=3
						GROUP BY hv.cod_variedad HAVING COUNT(*)>1
						) as total limit 1
								);									
								
set @restarIhcafe=(
			SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) 
						from (
						select COUNT(hv.cod_variedad) as total from tbl_bene_h_variedades hv
						INNER JOIN tbl_vulnerabilidad_variedades vv on hv.cod_variedad=vv.cod_variedad
						WHERE  hv.cod_variedad=4
						GROUP BY hv.cod_variedad HAVING COUNT(*)>1
						) as total limit 1
								);			
								
set @restarLempira=(
			SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) 
						from (
						select COUNT(hv.cod_variedad) as total from tbl_bene_h_variedades hv
						INNER JOIN tbl_vulnerabilidad_variedades vv on hv.cod_variedad=vv.cod_variedad
						WHERE  hv.cod_variedad=5
						GROUP BY hv.cod_variedad HAVING COUNT(*)>1
						) as total limit 1
								);	
								
								
								
	set @restarPacas=(
				SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) 
						from (
						select COUNT(hv.cod_variedad) as total from tbl_bene_h_variedades hv
						INNER JOIN tbl_vulnerabilidad_variedades vv on hv.cod_variedad=vv.cod_variedad
						WHERE  hv.cod_variedad=6
						GROUP BY hv.cod_variedad HAVING COUNT(*)>1
						) as total limit 1
								);
								
	set @restarParaneima=(
				SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) 
						from (
						select COUNT(hv.cod_variedad) as total from tbl_bene_h_variedades hv
						INNER JOIN tbl_vulnerabilidad_variedades vv on hv.cod_variedad=vv.cod_variedad
						WHERE  hv.cod_variedad=7
						GROUP BY hv.cod_variedad HAVING COUNT(*)>1
						) as total limit 1
								);
									
	set @restarTipica=(
				SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) 
						from (
						select COUNT(hv.cod_variedad) as total from tbl_bene_h_variedades hv
						INNER JOIN tbl_vulnerabilidad_variedades vv on hv.cod_variedad=vv.cod_variedad
						WHERE  hv.cod_variedad=8
						GROUP BY hv.cod_variedad HAVING COUNT(*)>1
						) as total limit 1
								);									
								
set @restarIcatu=(
			SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) 
						from (
						select COUNT(hv.cod_variedad) as total from tbl_bene_h_variedades hv
						INNER JOIN tbl_vulnerabilidad_variedades vv on hv.cod_variedad=vv.cod_variedad
						WHERE  hv.cod_variedad=9
						GROUP BY hv.cod_variedad HAVING COUNT(*)>1
						) as total limit 1
								);			
								
set @restarObata=(
			SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) 
						from (
						select COUNT(hv.cod_variedad) as total from tbl_bene_h_variedades hv
						INNER JOIN tbl_vulnerabilidad_variedades vv on hv.cod_variedad=vv.cod_variedad
						WHERE  hv.cod_variedad=10
						GROUP BY hv.cod_variedad HAVING COUNT(*)>1
						) as total limit 1
								);		
								
	set @restarPendiente=(
				SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) 
						from (
						select COUNT(hv.cod_variedad) as total from tbl_bene_h_variedades hv
						INNER JOIN tbl_vulnerabilidad_variedades vv on hv.cod_variedad=vv.cod_variedad
						WHERE  hv.cod_variedad=11
						GROUP BY hv.cod_variedad HAVING COUNT(*)>1
						) as total limit 1
								);
								
	set @restarPacamara=(
				SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) 
						from (
						select COUNT(hv.cod_variedad) as total from tbl_bene_h_variedades hv
						INNER JOIN tbl_vulnerabilidad_variedades vv on hv.cod_variedad=vv.cod_variedad
						WHERE  hv.cod_variedad=12
						GROUP BY hv.cod_variedad HAVING COUNT(*)>1
						) as total limit 1
								);
									
	set @restarBourbon=(
				SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) 
						from (
						select COUNT(hv.cod_variedad) as total from tbl_bene_h_variedades hv
						INNER JOIN tbl_vulnerabilidad_variedades vv on hv.cod_variedad=vv.cod_variedad
						WHERE  hv.cod_variedad=13
						GROUP BY hv.cod_variedad HAVING COUNT(*)>1
						) as total limit 1
								);									
								
set @restarAnacafe=(
			SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) 
						from (
						select COUNT(hv.cod_variedad) as total from tbl_bene_h_variedades hv
						INNER JOIN tbl_vulnerabilidad_variedades vv on hv.cod_variedad=vv.cod_variedad
						WHERE  hv.cod_variedad=14
						GROUP BY hv.cod_variedad HAVING COUNT(*)>1
						) as total limit 1
								);			
								
set @restarMaragogipe=(
			SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) 
						from (
						select COUNT(hv.cod_variedad) as total from tbl_bene_h_variedades hv
						INNER JOIN tbl_vulnerabilidad_variedades vv on hv.cod_variedad=vv.cod_variedad
						WHERE  hv.cod_variedad=15
						GROUP BY hv.cod_variedad HAVING COUNT(*)>1
						) as total limit 1
								);			
								
								
	set @restarGeisha=(
				SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) 
						from (
						select COUNT(hv.cod_variedad) as total from tbl_bene_h_variedades hv
						INNER JOIN tbl_vulnerabilidad_variedades vv on hv.cod_variedad=vv.cod_variedad
						WHERE  hv.cod_variedad=16
						GROUP BY hv.cod_variedad HAVING COUNT(*)>1
						) as total limit 1
								);									
								
set @restarh27=(
			SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) 
						from (
						select COUNT(hv.cod_variedad) as total from tbl_bene_h_variedades hv
						INNER JOIN tbl_vulnerabilidad_variedades vv on hv.cod_variedad=vv.cod_variedad
						WHERE  hv.cod_variedad=17
						GROUP BY hv.cod_variedad HAVING COUNT(*)>1
						) as total limit 1
								);			
								
set @restarOtra=(
			SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) 
						from (
						select COUNT(hv.cod_variedad) as total from tbl_bene_h_variedades hv
						INNER JOIN tbl_vulnerabilidad_variedades vv on hv.cod_variedad=vv.cod_variedad
						WHERE  hv.cod_variedad=18
						GROUP BY hv.cod_variedad HAVING COUNT(*)>1
						) as total limit 1
								);																													
																					
	SELECT etiqueta,totales from
(
SELECT vv.variedad as etiqueta,
if(vv.cod_variedad=1,FORMAT((ROUND(COUNT(vv.cod_variedad)-@restarCatimor)),0,'en_US'),
if(vv.cod_variedad=2,FORMAT((ROUND(COUNT(vv.cod_variedad)-@restarCatuai)),0,'en_US'),
if(vv.cod_variedad=3,FORMAT((ROUND(COUNT(vv.cod_variedad)-@restarCaturra)),0,'en_US'),
if(vv.cod_variedad=4,FORMAT((ROUND(COUNT(vv.cod_variedad)-@restarIhcafe)),0,'en_US'),
if(vv.cod_variedad=5,FORMAT((ROUND(COUNT(vv.cod_variedad)-@restarLempira)),0,'en_US'),
if(vv.cod_variedad=6,FORMAT((ROUND(COUNT(vv.cod_variedad)-@restarPacas)),0,'en_US'),
if(vv.cod_variedad=7,FORMAT((ROUND(COUNT(vv.cod_variedad)-@restarParaneima)),0,'en_US'),
if(vv.cod_variedad=8,FORMAT((ROUND(COUNT(vv.cod_variedad)-@restarTipica)),0,'en_US'),
if(vv.cod_variedad=9,FORMAT((ROUND(COUNT(vv.cod_variedad)-@restarIcatu)),0,'en_US'),
if(vv.cod_variedad=10,FORMAT((ROUND(COUNT(vv.cod_variedad)-@restarObata)),0,'en_US'),



if(vv.cod_variedad=11,FORMAT((ROUND(COUNT(vv.cod_variedad)-@restarPendiente)),0,'en_US'),
if(vv.cod_variedad=12,FORMAT((ROUND(COUNT(vv.cod_variedad)-@restarPacamara)),0,'en_US'),
if(vv.cod_variedad=13,FORMAT((ROUND(COUNT(vv.cod_variedad)-@restarBourbon)),0,'en_US'),
if(vv.cod_variedad=14,FORMAT((ROUND(COUNT(vv.cod_variedad)-@restarAnacafe)),0,'en_US'),
if(vv.cod_variedad=15,FORMAT((ROUND(COUNT(vv.cod_variedad)-@restarMaragogipe)),0,'en_US'),
if(vv.cod_variedad=16,FORMAT((ROUND(COUNT(vv.cod_variedad)-@restarGeisha)),0,'en_US'),
if(vv.cod_variedad=17,FORMAT((ROUND(COUNT(vv.cod_variedad)-@restarh27)),0,'en_US'),
if (vv.cod_variedad=18,FORMAT((ROUND(COUNT(vv.cod_variedad)-@restarOtra)),0,'en_US'),'no_gusta_el_else')) ))))))))))))))))
as totales from tbl_bene_h_variedades hv
	INNER JOIN tbl_vulnerabilidad_variedades vv on hv.cod_variedad=vv.cod_variedad
						GROUP BY vv.variedad
UNION all 

SELECT vv.variedad as etiqueta,0 as 'totales' from tbl_vulnerabilidad_variedades vv ) as T
	GROUP BY etiqueta;

END$$

CREATE DEFINER=`root`@`localhost` PROCEDURE `estadisticaBeneficiaroPiso` (IN `pFechaInicio` VARCHAR(25), IN `pFechaFinal` VARCHAR(25))  BEGIN

 SELECT etiqueta, totales FROM
	(
	
	SELECT tp.tipo_piso as etiqueta,
		COUNT(tp.cod_tipo_piso) as 'totales'
		
	 from tbl_bene_vivienda bv
	INNER JOIN tbl_bene_tipo_piso tp on bv.cod_tipo_piso=tp.cod_tipo_piso
	INNER JOIN tbl_beneficiario_ficha bf on bv.cod_beneficiario=bf.cod_beneficiario
	
	INNER JOIN tbl_general_municipio gm on bf.cod_municipio=gm.cod_municipio
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE fecha_visita BETWEEN pFechaInicio and pFechaFinal and
	gd.cod_depart IN(3,4)
	GROUP BY tp.tipo_piso
	
	
	UNION ALL

	SELECT tp.tipo_piso as etiqueta,0 as 'totales' from tbl_bene_tipo_piso tp ) as T
	GROUP BY etiqueta;
 COMMIT;
 
END$$

CREATE DEFINER=`root`@`localhost` PROCEDURE `estadisticaBeneficiaroTecho` (IN `pFechaInicio` VARCHAR(25), IN `pFechaFinal` VARCHAR(25))  BEGIN


SELECT etiqueta,totales from 
	(
	
	SELECT tt.tipo_techo as etiqueta,
		COUNT(tt.cod_tipo_techo) as 'totales'
		
	 from tbl_bene_vivienda bv
	INNER JOIN tbl_bene_tipo_techo tt on bv.cod_tipo_techo=tt.cod_tipo_techo
	INNER JOIN tbl_beneficiario_ficha bf on bv.cod_beneficiario=bf.cod_beneficiario
	
	INNER JOIN tbl_general_municipio gm on bf.cod_municipio=gm.cod_municipio
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE fecha_visita BETWEEN pFechaInicio and pFechaFinal and
	gd.cod_depart IN(3,4)
	GROUP BY tt.tipo_techo
	
	UNION ALL

	SELECT tt.tipo_techo as etiqueta,0 as 'totales' from tbl_bene_tipo_techo tt ) as T
	GROUP BY etiqueta;
 COMMIT;
	

	
END$$

CREATE DEFINER=`root`@`localhost` PROCEDURE `estadisticaBeneficiaroTipoPared` (IN `pFechaInicio` VARCHAR(25), IN `pFechaFinal` VARCHAR(25))  BEGIN
	(
	
	SELECT tp.tipo_pared as etiqueta,
		COUNT(tp.cod_tipo_pared) as 'totales'
		
	 from tbl_bene_vivienda bv
	INNER JOIN tbl_bene_tipo_pared tp on bv.cod_tipo_pared=tp.cod_tipo_pared
	INNER JOIN tbl_beneficiario_ficha bf on bv.cod_beneficiario=bf.cod_beneficiario
	
	INNER JOIN tbl_general_municipio gm on bf.cod_municipio=gm.cod_municipio
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE fecha_visita BETWEEN pFechaInicio and pFechaFinal and
	gd.cod_depart IN(3,4)
	GROUP BY tp.tipo_pared 
	)
	
			UNION
	
	SELECT 'Ladrillo ',0 from dual 
	WHERE NOT EXISTS
	(SELECT
		tp.cod_tipo_pared			
	from tbl_bene_vivienda bv
	INNER JOIN tbl_bene_tipo_pared tp on bv.cod_tipo_pared=tp.cod_tipo_pared
	INNER JOIN tbl_beneficiario_ficha bf on bv.cod_beneficiario=bf.cod_beneficiario
	
	INNER JOIN tbl_general_municipio gm on bf.cod_municipio=gm.cod_municipio
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE fecha_visita BETWEEN pFechaInicio and pFechaFinal and
	gd.cod_depart IN(3,4) and tp.cod_tipo_pared=1
	GROUP BY tp.tipo_pared 
	
	)
	
		UNION
	
	SELECT 'Bloque ',0 from dual 
	WHERE NOT EXISTS
	(SELECT
		tp.cod_tipo_pared			
	from tbl_bene_vivienda bv
	INNER JOIN tbl_bene_tipo_pared tp on bv.cod_tipo_pared=tp.cod_tipo_pared
	INNER JOIN tbl_beneficiario_ficha bf on bv.cod_beneficiario=bf.cod_beneficiario
	
	INNER JOIN tbl_general_municipio gm on bf.cod_municipio=gm.cod_municipio
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE fecha_visita BETWEEN pFechaInicio and pFechaFinal and
	gd.cod_depart IN(3,4) and tp.cod_tipo_pared=2
	GROUP BY tp.tipo_pared 
	
	)
	
	
	
		UNION
	
	SELECT 'Adobe ',0 from dual 
	WHERE NOT EXISTS
	(SELECT
		tp.cod_tipo_pared			
	from tbl_bene_vivienda bv
	INNER JOIN tbl_bene_tipo_pared tp on bv.cod_tipo_pared=tp.cod_tipo_pared
	INNER JOIN tbl_beneficiario_ficha bf on bv.cod_beneficiario=bf.cod_beneficiario
	
	INNER JOIN tbl_general_municipio gm on bf.cod_municipio=gm.cod_municipio
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE fecha_visita BETWEEN pFechaInicio and pFechaFinal and
	gd.cod_depart IN(3,4) and tp.cod_tipo_pared=3
	GROUP BY tp.tipo_pared 
	
	)
	UNION
	
	SELECT 'Madera ',0 from dual 
	WHERE NOT EXISTS
	(SELECT
		tp.cod_tipo_pared			
	from tbl_bene_vivienda bv
	INNER JOIN tbl_bene_tipo_pared tp on bv.cod_tipo_pared=tp.cod_tipo_pared
	INNER JOIN tbl_beneficiario_ficha bf on bv.cod_beneficiario=bf.cod_beneficiario
	
	INNER JOIN tbl_general_municipio gm on bf.cod_municipio=gm.cod_municipio
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE fecha_visita BETWEEN pFechaInicio and pFechaFinal and
	gd.cod_depart IN(3,4) and tp.cod_tipo_pared=4
	GROUP BY tp.tipo_pared 
	
	);
	
END$$

CREATE DEFINER=`root`@`localhost` PROCEDURE `estadisticaBeneficiaroTipoVivienda` (IN `pFechaInicio` VARCHAR(25), IN `pFechaFinal` VARCHAR(25))  BEGIN
	(
	
	SELECT tv.tipo_vivienda as etiqueta,
		COUNT(tv.cod_tipo_vivienda) as 'totales'
		
	 from tbl_bene_vivienda bv
	INNER JOIN tbl_bene_tipo_vivienda tv on bv.cod_tipo_vivienda=tv.cod_tipo_vivienda
	INNER JOIN tbl_beneficiario_ficha bf on bv.cod_beneficiario=bf.cod_beneficiario
	
	
	INNER JOIN tbl_general_municipio gm on bf.cod_municipio=gm.cod_municipio
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE fecha_visita BETWEEN pFechaInicio and pFechaFinal and
	gd.cod_depart IN(3,4)
	GROUP BY tv.tipo_vivienda
	)
	
	
UNION
	
	
	SELECT 'Propia',0 from dual 
	WHERE NOT EXISTS
	(SELECT
		tv.tipo_vivienda
		
		
	 from tbl_bene_vivienda bv
	INNER JOIN tbl_bene_tipo_vivienda tv on bv.cod_tipo_vivienda=tv.cod_tipo_vivienda
	INNER JOIN tbl_beneficiario_ficha bf on bv.cod_beneficiario=bf.cod_beneficiario
	
	
	INNER JOIN tbl_general_municipio gm on bf.cod_municipio=gm.cod_municipio
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE fecha_visita BETWEEN pFechaInicio and pFechaFinal and
	gd.cod_depart IN(3,4) and tv.cod_tipo_vivienda=1
	GROUP BY tv.tipo_vivienda)
	
UNION
	
	SELECT 'Alquilada',0 from dual 
	WHERE NOT EXISTS
	(SELECT
		tv.tipo_vivienda
		
		
	 from tbl_bene_vivienda bv
	INNER JOIN tbl_bene_tipo_vivienda tv on bv.cod_tipo_vivienda=tv.cod_tipo_vivienda
	INNER JOIN tbl_beneficiario_ficha bf on bv.cod_beneficiario=bf.cod_beneficiario
	
	
	INNER JOIN tbl_general_municipio gm on bf.cod_municipio=gm.cod_municipio
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE fecha_visita BETWEEN pFechaInicio and pFechaFinal and
	gd.cod_depart IN(3,4) and tv.cod_tipo_vivienda=2
	GROUP BY tv.tipo_vivienda)
	
	
	UNION
	
	SELECT 'Hipotecada',0 from dual 
	WHERE NOT EXISTS
	(SELECT
		tv.tipo_vivienda
			
	from tbl_bene_vivienda bv
	INNER JOIN tbl_bene_tipo_vivienda tv on bv.cod_tipo_vivienda=tv.cod_tipo_vivienda
	INNER JOIN tbl_beneficiario_ficha bf on bv.cod_beneficiario=bf.cod_beneficiario
	
	INNER JOIN tbl_general_municipio gm on bf.cod_municipio=gm.cod_municipio
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE fecha_visita BETWEEN pFechaInicio and pFechaFinal and
	gd.cod_depart IN(3,4) and tv.cod_tipo_vivienda=3
	GROUP BY tv.tipo_vivienda
	
	);
	
END$$

CREATE DEFINER=`root`@`localhost` PROCEDURE `estadisticanivelnacional` (IN `evento` VARCHAR(50))  BEGIN
	#Routine body goes here...SELECT CONVERT('25 euros', SIGNED)

	set @restarSi=(
	SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) 
						from (
						select COUNT(d.desisicon) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						WHERE  vp.cod_pregunta=25 and d.cod_desicion=1 
						GROUP BY hr.cod_finca HAVING COUNT(*)>1
						) as total limit 1
								);
	
	if evento='factores de exposicion' then
SELECT CONCAT(vp.pregunta,d.desisicon),
if(d.cod_desicion=1,FORMAT((ROUND(COUNT(d.desisicon)-@restarSi)),0,'en_US'),##ojo solo applique un round
if(d.cod_desicion=2,FORMAT(COUNT(d.desisicon),0,'en_US'),
if (d.cod_desicion=3,COUNT(d.desisicon),'no_gusta_el_else')) )
as totales from tbl_h_respuestas hr
INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
WHERE  vp.cod_pregunta=25
GROUP BY d.desisicon

;

end if;
END$$

CREATE DEFINER=`root`@`localhost` PROCEDURE `estadisticanivelnacionalParametros` (IN `Pevento` VARCHAR(50), IN `PanioInicio` VARCHAR(25), IN `PanioFinal` VARCHAR(25))  BEGIN
	#Routine body goes here...SELECT CONVERT('25 euros', SIGNED)

	set @restarSi=(
	SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) 
						from (
						select COUNT(d.desisicon) as total from tbl_h_respuestas hr
						left JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						LEFT OUTER JOIN tbl_vulnerabilidad_desicion d on d.cod_desicion=vr.cod_desicion
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						
						WHERE  vp.cod_pregunta=4 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal 
						GROUP BY hr.cod_finca HAVING COUNT(*)>1
						) as total limit 1
								);
	
	if Pevento='factores de exposicion' then
SELECT 
d.desisicon,COUNT(d.desisicon)
as totales from tbl_h_respuestas hr
RIGHT JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
RIGHT JOIN  tbl_vulnerabilidad_desicion d on d.cod_desicion=vr.cod_desicion
INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta

INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	
WHERE  vp.cod_pregunta=4 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
GROUP BY d.cod_desicion

;



end if;
END$$

CREATE DEFINER=`root`@`localhost` PROCEDURE `estadisticanivelnacionalParametrosAgencias` (IN `Pevento` VARCHAR(50), IN `PanioInicio` VARCHAR(25), IN `PanioFinal` VARCHAR(25), IN `PcodAgencia` VARCHAR(25))  BEGIN
	 
	 
if PcodAgencia!='' THEN
	set @restarSi=(
	SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) 
						from (
						select COUNT(d.desisicon) as total from tbl_h_respuestas hr
						RIGHT JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						 RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						RIGHT JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						RIGHT JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
						
						
						WHERE  vp.cod_pregunta=1 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal and gp.cod_agencia=PcodAgencia
						GROUP BY hr.cod_finca HAVING COUNT(*)>1
						) as total limit 1
								);
	
if Pevento='factores de exposicion' then

	(SELECT CONCAT('Cambio Temperatura ',d.desisicon,' ,QUIZAS,NO')as etiqueta,
	
		if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi),##ojo solo applique un round
		if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
		as totales
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_agencia=PcodAgencia
	GROUP BY d.desisicon
	
	)
	
	UNION
    SELECT 'Cambio Temperatura SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=1 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_agencia=PcodAgencia
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Cambio Temperatura NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=1 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_agencia=PcodAgencia
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Cambio Temperatura QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=1 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_agencia=PcodAgencia
	GROUP BY d.desisicon 
	)ORDER BY etiqueta ASC
	;
end if;

end if;

END$$

CREATE DEFINER=`root`@`localhost` PROCEDURE `estadisticanivelnacionalParametrosEuroclima` (IN `Pevento` VARCHAR(50), IN `PanioInicio` VARCHAR(25), IN `PanioFinal` VARCHAR(25))  BEGIN
	 
	 #14 4,13,12

	set @restarSi=(
	SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) 
						from (
						select COUNT(d.desisicon) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						 INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
						INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
						
						WHERE  vp.cod_pregunta=1 AND gd.cod_depart IN (4,12,13,14)
	and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
						 
						 
						GROUP BY hr.cod_finca HAVING COUNT(*)>1
						) as total limit 1
								);
	set @pregutasi='';
	set @valorsi='';
if Pevento='factores de exposicion' then
	(SELECT CONCAT('Cambio Temperatura ',d.desisicon,' ,QUIZAS,NO')as etiqueta,
		if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi),##ojo solo applique un round
		if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
		as totales
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=1 AND gd.cod_depart IN (4,12,13,14)
	and vf.fecha_visita BETWEEN PanioInicio and PanioFinal 
	GROUP BY d.desisicon
	
	)
	
	UNION
    SELECT 'Cambio Temperatura SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=1 and d.cod_desicion=1 AND gd.cod_depart IN (4,12,13,14)
	and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Cambio Temperatura NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=1 and d.cod_desicion=2 AND gd.cod_depart IN (4,12,13,14)
	and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Cambio Temperatura QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=1 and d.cod_desicion=3 AND gd.cod_depart IN (4,12,13,14)
	and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	GROUP BY d.desisicon 
	)ORDER BY etiqueta ASC
	;


end if;

END$$

CREATE DEFINER=`root`@`localhost` PROCEDURE `estadisticanivelnacionalParametrosEuroclimaGenero` (IN `Pevento` VARCHAR(50), IN `PanioInicio` VARCHAR(25), IN `PanioFinal` VARCHAR(25), IN `psexo` VARCHAR(15))  BEGIN
	 
SELECT COUNT(vf.cod_vulnerabilidad) as total
 from tbl_vulnerabilidades_ficha vf 
INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad

INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio#
INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart

INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero

WHERE  vf.fecha_visita BETWEEN PanioInicio and PanioFinal and
gd.cod_depart in(4,12,13,14) and gg.cod_genero=psexo
;



END$$

CREATE DEFINER=`root`@`localhost` PROCEDURE `estadisticanivelnacionalParametrosEuroclimaS` (IN `Pevento` VARCHAR(50), IN `PanioInicio` VARCHAR(25), IN `PanioFinal` VARCHAR(25), IN `psexo` VARCHAR(15))  BEGIN
	 
	 #14 AND gg.cod_genero=psexo 4,13,12

	set @restarSi=(
	SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) 
						from (
						select COUNT(d.desisicon) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca 
						INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
						INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
						
						INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio#
INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
						
						WHERE  vp.cod_pregunta=1 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal and gd.cod_depart in(4,12,13,14) 
						and gg.cod_genero=psexo 
						GROUP BY hr.cod_finca HAVING COUNT(*)>1
						) as total limit 1
								);
	set @pregutasi='';
	set @valorsi='';
if Pevento='factores de exposicion' then
	SELECT CONCAT('Cambio Temperatura ',d.desisicon,' ,QUIZAS,NO')as etiqueta,
		if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi),##ojo solo applique un round
		if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
		as totales
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio#
INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart in(4,12,13,14) AND gg.cod_genero=psexo
	GROUP BY d.desisicon;
	
	
end if;

END$$

CREATE DEFINER=`root`@`localhost` PROCEDURE `estadisticanivelnacionalParametrosFecha` (IN `Pevento` VARCHAR(50), IN `PanioInicio` VARCHAR(25), IN `PanioFinal` VARCHAR(25))  BEGIN
	 
	 
if PanioFinal !='' THEN
	set @restarSi=(
	SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) 
						from (
						select COUNT(d.desisicon) as total from tbl_h_respuestas hr
						RIGHT JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						 RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						RIGHT JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						RIGHT JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						
						
						
						WHERE  vp.cod_pregunta=1 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal 
						GROUP BY hr.cod_finca HAVING COUNT(*)>1
						) as total limit 1
								);
	
if Pevento='factores de exposicion' then
	(SELECT CONCAT('Cambio Temperatura ',d.desisicon,' ,QUIZAS,NO')as etiqueta,
		if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi),##ojo solo applique un round
		if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
		as totales
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	
	
	WHERE  vp.cod_pregunta=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	
	GROUP BY d.desisicon
	
	)
	
	UNION
    SELECT 'Cambio Temperatura SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca

	
	WHERE  vp.cod_pregunta=1 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Cambio Temperatura NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca

	
	WHERE  vp.cod_pregunta=1 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Cambio Temperatura QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca

	
	WHERE  vp.cod_pregunta=1 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	
	GROUP BY d.desisicon 
	)ORDER BY etiqueta ASC
	;
end if;

end if;

END$$

CREATE DEFINER=`root`@`localhost` PROCEDURE `estadisticanivelnacionalParametrosGenero` (IN `Pevento` VARCHAR(50), IN `PanioInicio` VARCHAR(25), IN `PanioFinal` VARCHAR(25), IN `PcodGenero` VARCHAR(25))  BEGIN
	 
	 
if PcodGenero!='' THEN
	set @restarSi=(
	SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) 
						from (
						select COUNT(d.desisicon) as total from tbl_h_respuestas hr
						RIGHT JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						 RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						RIGHT JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
						
						
						WHERE  vp.cod_pregunta=1 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal and gp.cod_genero=PcodGenero
						GROUP BY hr.cod_finca HAVING COUNT(*)>1
						) as total limit 1
								);
	
if Pevento='factores de exposicion' then
	(SELECT CONCAT('Cambio Temperatura ',d.desisicon,' ,QUIZAS,NO')as etiqueta,
		if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi),##ojo solo applique un round
		if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
		as totales
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_genero=PcodGenero
	GROUP BY d.desisicon
	
	)
	
	UNION
    SELECT 'Cambio Temperatura SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=1 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_genero=PcodGenero
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Cambio Temperatura NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=1 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_genero=PcodGenero
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Cambio Temperatura QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=1 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_genero=PcodGenero
	GROUP BY d.desisicon 
	)ORDER BY etiqueta ASC
	;
end if;

end if;

END$$

CREATE DEFINER=`root`@`localhost` PROCEDURE `estadisticanivelnacionalParametrosOtros` (IN `Pevento` VARCHAR(50), IN `PanioInicio` VARCHAR(25), IN `PanioFinal` VARCHAR(25), IN `PcodDepartamento` VARCHAR(5))  BEGIN
	 
	 #14 4,13,12
if PcodDepartamento!='' THEN
	set @restarSi=(
	SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) 
						from (
						select COUNT(d.desisicon) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						 INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
						INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
						
						WHERE  vp.cod_pregunta=1 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal and gd.cod_depart=PcodDepartamento
						GROUP BY hr.cod_finca HAVING COUNT(*)>1
						) as total limit 1
								);
	set @pregutasi='';
	set @valorsi='';
if Pevento='factores de exposicion' then
	(SELECT CONCAT('Cambio Temperatura ',d.desisicon,' ,QUIZAS,NO')as etiqueta,
		if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi),##ojo solo applique un round
		if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
		as totales
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=PcodDepartamento
	GROUP BY d.desisicon
	
	)
	
	UNION
    SELECT 'Cambio Temperatura SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=1 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=PcodDepartamento
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Cambio Temperatura NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=1 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=PcodDepartamento
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Cambio Temperatura QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=1 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=PcodDepartamento
	GROUP BY d.desisicon 
	)ORDER BY etiqueta ASC
	;
end if;

end if;

END$$

CREATE DEFINER=`root`@`localhost` PROCEDURE `estadisticanivelnacionalParametrosRegional` (IN `Pevento` VARCHAR(50), IN `PanioInicio` VARCHAR(25), IN `PanioFinal` VARCHAR(25), IN `PcodRegional` VARCHAR(25))  BEGIN
	 
	 
if PcodRegional !='' THEN
	set @restarSi=(
	SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) 
						from (
						select COUNT(d.desisicon) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						 INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
						INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
						INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
						
						
						WHERE  vp.cod_pregunta=1 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal and gr.cod_regional=PcodRegional
						GROUP BY hr.cod_finca HAVING COUNT(*)>1
						) as total limit 1
								);
	
if Pevento='factores de exposicion' then
	(SELECT CONCAT('Cambio Temperatura ',d.desisicon,' ,QUIZAS,NO')as etiqueta,
		if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi),##ojo solo applique un round
		if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
		as totales
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
	INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
	
	WHERE  vp.cod_pregunta=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gr.cod_regional=PcodRegional
	GROUP BY d.desisicon
	
	)
	
	UNION
    SELECT 'Cambio Temperatura SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
	INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
	
	WHERE  vp.cod_pregunta=1 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gr.cod_regional=PcodRegional
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Cambio Temperatura NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
	INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
	
	WHERE  vp.cod_pregunta=1 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gr.cod_regional=PcodRegional
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Cambio Temperatura QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
	INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
	
	WHERE  vp.cod_pregunta=1 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gr.cod_regional=PcodRegional
	GROUP BY d.desisicon 
	)ORDER BY etiqueta ASC
	;
end if;

end if;

END$$

CREATE DEFINER=`root`@`localhost` PROCEDURE `estadisticanivelnacionalParametrosTecnico` (IN `Pevento` VARCHAR(50), IN `PanioInicio` VARCHAR(25), IN `PanioFinal` VARCHAR(25), IN `PcodTecnico` VARCHAR(25))  BEGIN
	 
	 
if PcodTecnico!='' THEN
	set @restarSi=(
	SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) 
						from (
						select COUNT(d.desisicon) as total from tbl_h_respuestas hr
						RIGHT JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						 RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						RIGHT JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						RIGHT JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
						
						

						WHERE  vp.cod_pregunta=1 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal and gt.cod_tecnico=PcodTecnico
						GROUP BY hr.cod_finca HAVING COUNT(*)>1
						) as total limit 1
								);
	
if Pevento='factores de exposicion' then
	(SELECT CONCAT('Cambio Temperatura ',d.desisicon,' ,QUIZAS,NO')as etiqueta,
		if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi),##ojo solo applique un round
		if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
		as totales
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
	
	WHERE  vp.cod_pregunta=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gt.cod_tecnico=PcodTecnico
	GROUP BY d.desisicon
	
	)
	
	UNION
    SELECT 'Cambio Temperatura SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
	
	WHERE  vp.cod_pregunta=1 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gt.cod_tecnico=PcodTecnico
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Cambio Temperatura NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
	
	WHERE  vp.cod_pregunta=1 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gt.cod_tecnico=PcodTecnico
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Cambio Temperatura QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
	
	WHERE  vp.cod_pregunta=1 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gt.cod_tecnico=PcodTecnico
	GROUP BY d.desisicon 
	)ORDER BY etiqueta ASC
	;
end if;

end if;

END$$

CREATE DEFINER=`root`@`localhost` PROCEDURE `generalpreguntas` (IN `p_año_inicio` INT, IN `p_año_final` INT, IN `p_fecha_inicio` INT, IN `p_fecha_final` INT, IN `p_departamento` INT, IN `p_nombre_evento` VARCHAR(50))  BEGIN
declare evento varchar(50);


set evento=UPPER(p_nombre_evento);


			case	
			WHEN evento='EVENTO1' THEN

			SELECT 	d.desisicon,COUNT(vr.respuesta) as cantidad from tbl_h_respuestas hr 
			INNER JOIN   tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN   tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN   tbl_vulnerabilidad_desicion d ON vr.cod_desicion = d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
			INNER JOIN tbl_vulnerabilidades_ficha vf on gf.cod_finca=vf.cod_finca
			
			INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
			INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
			WHERE d.cod_desicion BETWEEN 1 and 3 and vp.cod_pregunta BETWEEN 1 and 3 
			and SUBSTRING(vf.fecha_visita,1,4) BETWEEN p_año_inicio and p_año_final
			and SUBSTRING(vf.fecha_visita,6,2) BETWEEN p_fecha_inicio and p_fecha_final
			and gm.cod_depart=p_departamento
			GROUP BY d.cod_desicion;
			
			WHEN evento='EVENTO2' THEN

			SELECT 	d.desisicon,COUNT(vr.respuesta) as cantidad from tbl_h_respuestas hr 
			INNER JOIN   tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN   tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN   tbl_vulnerabilidad_desicion d ON vr.cod_desicion = d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
			INNER JOIN tbl_vulnerabilidades_ficha vf on gf.cod_finca=vf.cod_finca
			
			INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
			INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
			WHERE d.cod_desicion BETWEEN 1 and 3 and vp.cod_pregunta BETWEEN 4 and 7 
			and SUBSTRING(vf.fecha_visita,1,4) BETWEEN p_año_inicio and p_año_final
			and SUBSTRING(vf.fecha_visita,6,2) BETWEEN p_fecha_inicio and p_fecha_final
			and gm.cod_depart=p_departamento
			GROUP BY d.cod_desicion;
			End case;

COMMIT;
	
END$$

CREATE DEFINER=`root`@`localhost` PROCEDURE `lider_contador_todos` (IN `fechaInicio` VARCHAR(15), IN `fechaFinal` VARCHAR(15), IN `filtro` VARCHAR(1))  BEGIN
set @totalFicha=(SELECT COUNT(lf.cod_ficha) from tbl_lideres_ficha lf);


 if filtro='1' then 
		SELECT CONCAT_WS('/',COUNT(gg.cod_genero),@totalFicha) as totales FROM tbl_lider_productor lp 
		LEFT JOIN  tbl_general_genero gg ON gg.cod_genero = lp.cod_genero
		LEFT JOIN  tbl_lideres_ficha lf ON lp.cod_identidad = lf.cod_identidad
		LEFT JOIN tbl_bene_proyecto_beneficia bpb ON bpb.cod_pro_beneficia = lf.cod_pro_beneficia
		WHERE lf.fecha_visita BETWEEN fechaInicio and fechaFinal and bpb.cod_pro_beneficia=2
		GROUP BY gg.cod_genero;

elseif filtro='2' then 
		SELECT CONCAT(COUNT(vv.cod_variedad),'/',@totalFicha)  as totales FROM tbl_lider_productor lp 

		LEFT JOIN tbl_lideres_ficha lf ON lp.cod_identidad = lf.cod_identidad
		LEFT JOIN tbl_lider_fincas lfi ON lfi.cod_identidad = lp.cod_identidad
		LEFT JOIN tbl_lider_parcela lpar ON lpar.cod_finca = lfi.cod_finca
		LEFT JOIN tbl_vulnerabilidad_variedades vv ON vv.cod_variedad = lpar.cod_variedad
		LEFT JOIN tbl_bene_proyecto_beneficia bpb ON bpb.cod_pro_beneficia = lf.cod_pro_beneficia

		WHERE lf.fecha_visita BETWEEN fechaInicio and fechaFinal and bpb.cod_pro_beneficia=2;

elseif filtro='3' then 
	
		SELECT CONCAT( COUNT(lg.cod_grupo),'/',@totalFicha) as totales FROM tbl_lider_productor lp 

		LEFT JOIN tbl_lideres_ficha lf ON lp.cod_identidad = lf.cod_identidad
		LEFT JOIN tbl_lider_grupo lg ON lg.cod_grupo = lf.cod_grupo
		 
		LEFT JOIN tbl_bene_proyecto_beneficia bpb ON bpb.cod_pro_beneficia = lf.cod_pro_beneficia
		WHERE lf.fecha_visita BETWEEN fechaInicio and fechaFinal and bpb.cod_pro_beneficia=2


		;

			
elseif filtro='4' then
			SELECT CONCAT( COUNT(lpr.cod_problema),'/',@totalFicha) as totales FROM tbl_lider_productor lp 
		LEFT JOIN tbl_lideres_ficha lf ON lp.cod_identidad = lf.cod_identidad
		LEFT JOIN tbl_lider_problema lpr ON lpr.cod_problema = lf.cod_problema 
		LEFT JOIN tbl_bene_proyecto_beneficia bpb ON bpb.cod_pro_beneficia = lf.cod_pro_beneficia

		WHERE lf.fecha_visita BETWEEN fechaInicio and fechaFinal and bpb.cod_pro_beneficia=2


		;
elseif filtro='5' then

		SELECT CONCAT(COUNT(lgc.cod_comunal),'/',@totalFicha) as totales FROM tbl_lider_productor lp 

		LEFT JOIN tbl_lideres_ficha lf ON lp.cod_identidad = lf.cod_identidad
		LEFT JOIN tbl_lider_h_comunal lhco ON lhco.cod_ficha = lf.cod_ficha
		LEFT JOIN tbl_lider_grupo_comunal lgc ON lgc.cod_comunal = lhco.cod_comunal 
		LEFT JOIN tbl_bene_proyecto_beneficia bpb ON bpb.cod_pro_beneficia = lf.cod_pro_beneficia
		WHERE lf.fecha_visita BETWEEN fechaInicio and fechaFinal and bpb.cod_pro_beneficia=2

		;
  
end if;



END$$

CREATE DEFINER=`root`@`localhost` PROCEDURE `lider_delete_toda_data` ()  BEGIN


DELETE from tbl_div_h_meses;
alter TABLE tbl_div_h_meses AUTO_INCREMENT=1;
DELETE from tbl_div_h_familia_mes;
alter TABLE tbl_div_h_familia_mes AUTO_INCREMENT=1;

DELETE from tbl_div_familia;
alter TABLE tbl_div_h_familia_mes AUTO_INCREMENT=1;

DELETE from tbl_div_h_fruta;
alter TABLE tbl_div_h_frutas AUTO_INCREMENT=1;

DELETE from tbl_div_finca;
alter TABLE tbl_div_finca AUTO_INCREMENT=1;

DELETE from tbl_di_ficha;
alter TABLE tbl_div_ficha AUTO_INCREMENT=1
;
#DELETE from tbl_div_productor;

END$$

CREATE DEFINER=`root`@`localhost` PROCEDURE `lider_gen_gru_pro_var` (IN `fechaInicio` VARCHAR(15), IN `fechaFinal` VARCHAR(15), IN `evento` VARCHAR(1))  BEGIN

if evento=1 then 
		SELECT etiqueta,totales from 
		(SELECT  gg.genero as etiqueta,(COUNT(gg.cod_genero)) as totales FROM tbl_lider_productor lp 

		LEFT JOIN  tbl_general_genero gg ON gg.cod_genero = lp.cod_genero
		LEFT JOIN  tbl_lideres_ficha lf ON lp.cod_identidad = lf.cod_identidad
		LEFT JOIN tbl_bene_proyecto_beneficia bpb ON bpb.cod_pro_beneficia = lf.cod_pro_beneficia
		WHERE lf.fecha_visita BETWEEN fechaInicio and fechaFinal and bpb.cod_pro_beneficia=2
		GROUP BY gg.cod_genero
		union all
		SELECT gg.genero as etiqueta,0 as 'totales' from tbl_general_genero gg) as t
		GROUP BY etiqueta
		;
elseif evento=2 then

		SELECT etiqueta,totales from 
			(SELECT  vv.variedad "etiqueta", COUNT(vv.cod_variedad) as totales FROM tbl_lider_productor lp 

		LEFT JOIN tbl_lideres_ficha lf ON lp.cod_identidad = lf.cod_identidad
		LEFT JOIN tbl_lider_fincas lfi ON lfi.cod_identidad = lp.cod_identidad
		LEFT JOIN tbl_lider_parcela lpar ON lpar.cod_finca = lfi.cod_finca
		LEFT JOIN tbl_vulnerabilidad_variedades vv ON vv.cod_variedad = lpar.cod_variedad
		LEFT JOIN tbl_bene_proyecto_beneficia bpb ON bpb.cod_pro_beneficia = lf.cod_pro_beneficia

		WHERE lf.fecha_visita BETWEEN fechaInicio and fechaFinal and bpb.cod_pro_beneficia=2
		GROUP BY vv.cod_variedad

		union 
		SELECT vv.variedad as etiqueta,0 as totales from tbl_vulnerabilidad_variedades  vv) as t
		GROUP BY etiqueta
		;
		
elseif evento=3 then	
		SELECT etiqueta,totales from 
		(	SELECT  lg.grupo "etiqueta",COUNT(lg.cod_grupo) as totales FROM tbl_lider_productor lp 

		LEFT JOIN tbl_lideres_ficha lf ON lp.cod_identidad = lf.cod_identidad
		LEFT JOIN tbl_lider_grupo lg ON lg.cod_grupo = lf.cod_grupo
		 
		LEFT JOIN tbl_bene_proyecto_beneficia bpb ON bpb.cod_pro_beneficia = lf.cod_pro_beneficia
		WHERE lf.fecha_visita BETWEEN fechaInicio and fechaFinal and bpb.cod_pro_beneficia=2

		GROUP BY lg.cod_grupo
		UNION all

		SELECT lg.grupo as etiqueta,0  as totales from tbl_lider_grupo lg) as t
		GROUP BY etiqueta

		;
elseif evento=4 then	

		SELECT etiqueta,totales from 
			(SELECT  lpr.problema as etiqueta,COUNT(lpr.cod_problema) as totales FROM tbl_lider_productor lp 
		LEFT JOIN tbl_lideres_ficha lf ON lp.cod_identidad = lf.cod_identidad
		LEFT JOIN tbl_lider_problema lpr ON lpr.cod_problema = lf.cod_problema 
		LEFT JOIN tbl_bene_proyecto_beneficia bpb ON bpb.cod_pro_beneficia = lf.cod_pro_beneficia

		WHERE lf.fecha_visita BETWEEN fechaInicio and fechaFinal and bpb.cod_pro_beneficia=2

		GROUP BY lpr.cod_problema

		union all
		SELECT lpr.problema as etiqueta,0 as totales from tbl_lider_problema lpr) as t
		GROUP BY etiqueta
		;


elseif evento=5 then	

		SELECT etiqueta,totales from 
		(
		SELECT lgc.comunal "etiqueta",COUNT(lgc.cod_comunal) as totales FROM tbl_lider_productor lp 

		LEFT JOIN tbl_lideres_ficha lf ON lp.cod_identidad = lf.cod_identidad
		LEFT JOIN tbl_lider_h_comunal lhco ON lhco.cod_ficha = lf.cod_ficha
		LEFT JOIN tbl_lider_grupo_comunal lgc ON lgc.cod_comunal = lhco.cod_comunal 
		LEFT JOIN tbl_bene_proyecto_beneficia bpb ON bpb.cod_pro_beneficia = lf.cod_pro_beneficia
		WHERE lf.fecha_visita BETWEEN fechaInicio and fechaFinal and bpb.cod_pro_beneficia=2
		GROUP BY lgc.cod_comunal
		union all
		 SELECT lgc.comunal as etiqueta,0 as totales from tbl_lider_grupo_comunal lgc) as t
		 GROUP BY etiqueta
		;

end if;
END$$

CREATE DEFINER=`root`@`localhost` PROCEDURE `lid_delete_toda_data` ()  BEGIN

DELETE from tbl_lider_h_coasociados;
alter TABLE tbl_lider_h_coasociados AUTO_INCREMENT=1;

DELETE from tbl_lider_parcela;
alter TABLE tbl_lider_parcela AUTO_INCREMENT=1;

DELETE from tbl_lider_fincas;
alter TABLE tbl_lider_fincas AUTO_INCREMENT=1;

DELETE from tbl_lider_h_comunal;
alter TABLE tbl_lider_h_comunal AUTO_INCREMENT=1;

DELETE from tbl_lideres_ficha;
alter TABLE tbl_lideres_ficha AUTO_INCREMENT=1;

DELETE from tbl_lider_coasociados;
alter TABLE tbl_lider_coasociados AUTO_INCREMENT=1;
##DELETE from tbl_lider_productor;
END$$

CREATE DEFINER=`root`@`localhost` PROCEDURE `llenadoTecnicos` ()  BEGIN
	#Routine body goes here...
SELECT t.cod_tecnico,t.nombre from tbl_general_tecnico t;
END$$

CREATE DEFINER=`root`@`localhost` PROCEDURE `localizarCadena` ()  BEGIN
#select LOCATE('AM','AM_vari_tolerantes_1 AM_sist_produccion_1 AM_sist_agroforestales_1');
#SELECT REPLACE('hhhh iiii jjj',' ', '-');

#set @contri= 'casa grande verde';
#set @espacios=replace(@contri,' ','');
#select LENGTH(@espacios); AM_vari_tolerantes_1 AM_sist_produccion_1 AM_sist_agroforestales_1
CREATE TEMPORARY TABLE IF NOT EXISTS tmp_cadena as (SELECT 'AM_vari_tolerantes_1 M_sist_produccion_1 AM_sist_agroforestales_1' as nombre) ;
set @tolerante=(SELECT 1 from tmp_cadena WHERE nombre like '%AM_vari_tolerantes_1%'
			UNION
			SELECT 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT *from tmp_cadena WHERE nombre like '%AM_vari_tolerantes_1%')
			); 
 
 set @siste_produccion=(SELECT 1 from tmp_cadena WHERE nombre like '%M_sist_produccion_1%' 
		UNION
		SELECT 0 FROM DUAL
		WHERE NOT EXISTS
		(SELECT *from tmp_cadena WHERE nombre like '%M_sist_produccion_1%')
		);
 
 set @sis_agroforesteria=(SELECT 1 from tmp_cadena WHERE nombre like '%AM_sist_agroforestales_1%'
 UNION
SELECT 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT *from tmp_cadena WHERE nombre like '%AM_sist_agroforestales_1%')
 );
 
 set @cadena=(SELECT CONCAT(@tolerante,@siste_produccion,@sis_agroforesteria));
IF @cadena=000 then
set @tolerante='';
set @siste_produccion='';
set @sis_agroforesteria='';
end if;
 SELECT @tolerante,@siste_produccion,@sis_agroforesteria;
 
DROP TABLE tmp_cadena;

END$$

CREATE DEFINER=`root`@`localhost` PROCEDURE `porpregunta` (`p_respuesta` VARCHAR(10), `p_inicio` INT, `p_final` INT)  BEGIN

DECLARE desicion VARCHAR(50);
START TRANSACTION;

SET desicion = UPPER(p_respuesta) ;

CASE
  WHEN desicion = "SI" THEN

	SELECT 	vp.pregunta,count(vr.respuesta) as SI from tbl_h_respuestas hr 
	INNER JOIN   tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN   tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN   tbl_vulnerabilidad_desicion d on d.cod_desicion = vr.cod_desicion
	WHERE d.desisicon = p_respuesta and vp.cod_pregunta BETWEEN p_inicio and p_final
	GROUP BY vp.cod_pregunta;
	
	  WHEN desicion = "NO" THEN

	SELECT 	vp.pregunta,count(vr.respuesta) as "NO" from tbl_h_respuestas hr 
	INNER JOIN   tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN   tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN   tbl_vulnerabilidad_desicion d on d.cod_desicion = vr.cod_desicion
	WHERE d.desisicon = p_respuesta and vp.cod_pregunta BETWEEN p_inicio and p_final
	GROUP BY vp.cod_pregunta;
	
	  WHEN desicion = "QUIZAS" THEN

	SELECT 	vp.pregunta,count(vr.respuesta) as QUIZAS from tbl_h_respuestas hr 
	INNER JOIN   tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN   tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN   tbl_vulnerabilidad_desicion d on d.cod_desicion = vr.cod_desicion
	WHERE d.desisicon = p_respuesta and vp.cod_pregunta BETWEEN p_inicio and p_final
	GROUP BY vp.cod_pregunta;
END CASE;

COMMIT;
END$$

CREATE DEFINER=`root`@`localhost` PROCEDURE `restar` ()  BEGIN
	


SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca

INNER JOIN tbl_vulnerabilidades_ficha vf on gf.cod_finca=vf.cod_finca
INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio 
INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
WHERE  vp.cod_pregunta=4 and d.cod_desicion=1  and gd.cod_depart=1
GROUP BY gf.cod_identidad HAVING COUNT(*)>1) as total limit 1;

END$$

CREATE DEFINER=`root`@`localhost` PROCEDURE `SL_aldeas` ()  NO SQL
SELECT concat(d.cod_depart,"-",
              m.cod_municipio,"-",
           a.num_municipio_depart_aldea),d.departamento,m.municipio,a.aldea from tbl_aldea a 
INNER join tbl_municipio1 m on a.cod_municipio=m.cod_municipio
INNER JOIN tbl_departamento d ON d.cod_depart = m.cod_depart$$

CREATE DEFINER=`root`@`localhost` PROCEDURE `sl_productores` ()  NO SQL
SELECT p.cod_identidad,
p.clave,
p.nombre,
g.genero,
pa.pais,
concat(d.cod_depart,'-',m.cod_municipio,'-',
       a.num_municipio_depart_aldea) as 'codigo aldea',
a.aldea,
m.municipio,d.departamento

FROm tbl_general_productor p 
INNER JOIN tbl_general_pais pa on p.cod_pais=pa.cod_pais
INNER JOIN tbl_general_genero g on p.cod_genero=g.cod_genero
INNER JOIN tbl_general_aldea a on p.cod_aldea=a.cod_aldea
INNER JOIN tbl_general_municipio m on a.cod_municipio=m.cod_municipio
INNER JOIN tbl_general_departamento d on m.cod_depart=d.cod_depart$$

CREATE DEFINER=`root`@`localhost` PROCEDURE `variedades` ()  BEGIN
	#Routine body goes here...
	DROP table  temporalVariedades;
	SELECT variedades into @v 
	FROM ihcafefichas.`tbl_estructura_variedades_vulnerabilidades` WHERE sumision='6' and
	sumision2='19640' LIMIT 2;
	
	
	 CREATE temporary TABLE IF NOT EXISTS temporalVariedades AS 
  SELECT @rownum:=@rownum+1 ‘tn’,variedades FROM  ihcafefichas.`tbl_estructura_variedades_vulnerabilidades`,(SELECT @rownum:=0) r
	 
   WHERE  sumision='6';
SELECT @rownum ‘tn’ from temporalVariedades;

END$$

CREATE DEFINER=`root`@`localhost` PROCEDURE `vulnerabilidadNivelNacional` (IN `evento` VARCHAR(50))  BEGIN
	#Routine body goes here...
set @restarSi1=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						WHERE  vp.cod_pregunta=1 and d.cod_desicion=1 
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
						);
set @restarSi2=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						WHERE  vp.cod_pregunta=2 and d.cod_desicion=1 
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
						);		
										
set @restarSi3=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						WHERE  vp.cod_pregunta=3 and d.cod_desicion=1 
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
						);			
set @restarSi4=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						WHERE  vp.cod_pregunta=4 and d.cod_desicion=1 
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
						);		
											
set @restarSi5=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						WHERE  vp.cod_pregunta=5 and d.cod_desicion=1 
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
						);	
set @restarSi6=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						WHERE  vp.cod_pregunta=6 and d.cod_desicion=1 
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
						);
						
set @restarSi7=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						WHERE  vp.cod_pregunta=7 and d.cod_desicion=1 
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
						);	
						
set @restarSi8=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						WHERE  vp.cod_pregunta=8 and d.cod_desicion=1 
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
						);											
						
set @restarSi11=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						WHERE  vp.cod_pregunta=11 and d.cod_desicion=1 
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
						);		
						
set @restarSi12=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						WHERE  vp.cod_pregunta=12 and d.cod_desicion=1 
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
						);			
						
set @restarSi13=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						WHERE  vp.cod_pregunta=13 and d.cod_desicion=1 
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
						);		
						
set @restarSi20=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						WHERE  vp.cod_pregunta=20 and d.cod_desicion=1 
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
						);
						#__________________________________
						
set @restarSi9=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						WHERE  vp.cod_pregunta=9 and d.cod_desicion=1 
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
						);							
set @restarSi10=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						WHERE  vp.cod_pregunta=10 and d.cod_desicion=1 
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
						);		
						
set @restarSi14=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						WHERE  vp.cod_pregunta=14 and d.cod_desicion=1 
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
						);		
						
set @restarSi15=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						WHERE  vp.cod_pregunta=15 and d.cod_desicion=1 
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
						);
set @restarSi16=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						WHERE  vp.cod_pregunta=16 and d.cod_desicion=1 
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
						);
set @restarSi17=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						WHERE  vp.cod_pregunta=17 and d.cod_desicion=1 
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
						);
						
set @restarSi18=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						WHERE  vp.cod_pregunta=18 and d.cod_desicion=1 
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
						);
						
set @restarSi19=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						WHERE  vp.cod_pregunta=19 and d.cod_desicion=1 
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
						);
set @restarSi21=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						WHERE  vp.cod_pregunta=21 and d.cod_desicion=1 
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
						);																																																																																
set @restarSi22=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						WHERE  vp.cod_pregunta=22 and d.cod_desicion=1 
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
						);		
						
set @restarSi23=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						WHERE  vp.cod_pregunta=23 and d.cod_desicion=1 
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
						);	
						
set @restarSi24=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						WHERE  vp.cod_pregunta=24 and d.cod_desicion=1 
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
						);	
						
set @restarSi25=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						WHERE  vp.cod_pregunta=25 and d.cod_desicion=1 
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
						);																				
if evento='factores de exposicion' then
	SELECT CONCAT('Cambio Temperatura ',d.desisicon,' ,QUIZAS,NO'),
	if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi1),##ojo solo applique un round
	if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
	as totales from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	WHERE  vp.cod_pregunta=1 
	GROUP BY d.cod_desicion
	
	union
	SELECT CONCAT('Lluvias Irregulares ',d.desisicon,' ,QUIZAS,NO'),
	if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi2),##ojo solo applique un round
	if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
	as totales from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	WHERE  vp.cod_pregunta=2 
	GROUP BY d.cod_desicion
	
	union
		SELECT CONCAT('Aumento de Lluvias ',d.desisicon,' ,QUIZAS,NO'),
		if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi3),##ojo solo applique un round
		if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
		as totales from tbl_h_respuestas hr
		INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
		INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
		INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
		WHERE  vp.cod_pregunta=3 
		GROUP BY d.cod_desicion
			union
		SELECT CONCAT('Riesgo de Huracanes ',d.desisicon,' ,QUIZAS,NO'),
		if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi4),##ojo solo applique un round
		if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
		as totales from tbl_h_respuestas hr
		INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
		INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
		INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
		WHERE  vp.cod_pregunta=4 
		GROUP BY d.cod_desicion
		
			union
		SELECT CONCAT('Sequias ',d.desisicon,' ,QUIZAS,NO'),
		if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi5),##ojo solo applique un round
		if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
		as totales from tbl_h_respuestas hr
		INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
		INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
		INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
		WHERE  vp.cod_pregunta=5 
		GROUP BY d.cod_desicion
			union
		SELECT CONCAT('Vientos Fuertes ',d.desisicon,' ,QUIZAS,NO'),
		if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi6),##ojo solo applique un round
		if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
		as totales from tbl_h_respuestas hr
		INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
		INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
		INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
		WHERE  vp.cod_pregunta=6 
		GROUP BY d.cod_desicion;
		
		elseif evento='factores de impacto' then
		
			
		SELECT CONCAT('Suelos Erosionados ',d.desisicon,' ,QUIZAS,NO'),
		if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi7),##ojo solo applique un round
		if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
		as totales from tbl_h_respuestas hr
		INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
		INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
		INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
		WHERE  vp.cod_pregunta=7 
		GROUP BY d.cod_desicion
		
		UNION
		
		SELECT CONCAT('Baja Fertilidad de Suelos ',d.desisicon,' ,QUIZAS,NO'),
		if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi8),##ojo solo applique un round
		if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
		as totales from tbl_h_respuestas hr
		INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
		INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
		INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
		WHERE  vp.cod_pregunta=8 
		GROUP BY d.cod_desicion
		
				
		UNION
		
		SELECT CONCAT('Floracion Irregular ',d.desisicon,' ,QUIZAS,NO'),
		if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi11),##ojo solo applique un round
		if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
		as totales from tbl_h_respuestas hr
		INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
		INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
		INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
		WHERE  vp.cod_pregunta=11 
		GROUP BY d.cod_desicion
		
				
		UNION
		
		SELECT CONCAT('Incremento en Caida de flores ',d.desisicon,' ,QUIZAS,NO'),
		if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi12),##ojo solo applique un round
		if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
		as totales from tbl_h_respuestas hr
		INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
		INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
		INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
		WHERE  vp.cod_pregunta=12 
		GROUP BY d.cod_desicion
		
				
		UNION
		
		SELECT CONCAT('Incremento de Plagas y enfermedades ',d.desisicon,' ,QUIZAS,NO'),
		if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi13),##ojo solo applique un round
		if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
		as totales from tbl_h_respuestas hr
		INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
		INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
		INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
		WHERE  vp.cod_pregunta=13 
		GROUP BY d.cod_desicion
		
				
		UNION
		
		SELECT CONCAT('Bajas en Productividad  ',d.desisicon,' ,QUIZAS,NO'),
		if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi20),##ojo solo applique un round
		if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
		as totales from tbl_h_respuestas hr
		INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
		INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
		INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
		WHERE  vp.cod_pregunta=20 
		GROUP BY d.cod_desicion;
		
		elseif evento='factores de adaptabilidad' then
		
		SELECT CONCAT('Practica de Conservacion  ',d.desisicon,' ,QUIZAS,NO'),
		if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi9),##ojo solo applique un round
		if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
		as totales from tbl_h_respuestas hr
		INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
		INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
		INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
		WHERE  vp.cod_pregunta=9
		GROUP BY d.cod_desicion
		
			UNION
		
		SELECT CONCAT('Cobertura de Hiervas  ',d.desisicon,' ,QUIZAS,NO'),
		if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi10),##ojo solo applique un round
		if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
		as totales from tbl_h_respuestas hr
		INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
		INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
		INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
		WHERE  vp.cod_pregunta=10 
		GROUP BY d.cod_desicion
		
			UNION
		
		SELECT CONCAT('Diversificación de Cafetal  ',d.desisicon,' ,QUIZAS,NO'),
		if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi14),##ojo solo applique un round
		if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
		as totales from tbl_h_respuestas hr
		INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
		INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
		INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
		WHERE  vp.cod_pregunta=14 
		GROUP BY d.cod_desicion
		UNION
		
		SELECT CONCAT('Cafetales Pleno Sol ',d.desisicon,' ,QUIZAS,NO'),
		if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi15),##ojo solo applique un round
		if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
		as totales from tbl_h_respuestas hr
		INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
		INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
		INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
		WHERE  vp.cod_pregunta=15 
		GROUP BY d.cod_desicion
		
		UNION
		
		SELECT CONCAT('Cafetales Viejos  ',d.desisicon,' ,QUIZAS,NO'),
		if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi16),##ojo solo applique un round
		if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
		as totales from tbl_h_respuestas hr
		INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
		INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
		INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
		WHERE  vp.cod_pregunta=16
		GROUP BY d.cod_desicion
		UNION
		
		SELECT CONCAT('Variedades de Café  ',d.desisicon,' ,QUIZAS,NO'),
		if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi17),##ojo solo applique un round
		if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
		as totales from tbl_h_respuestas hr
		INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
		INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
		INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
		WHERE  vp.cod_pregunta=17
		GROUP BY d.cod_desicion
		
		UNION
		
		SELECT CONCAT('Manejo de Tejidos  ',d.desisicon,' ,QUIZAS,NO'),
		if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi18),##ojo solo applique un round
		if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
		as totales from tbl_h_respuestas hr
		INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
		INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
		INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
		WHERE  vp.cod_pregunta=18
		GROUP BY d.cod_desicion
		
		UNION
		
		SELECT CONCAT('Resiembra de Café  ',d.desisicon,' ,QUIZAS,NO'),
		if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi19),##ojo solo applique un round
		if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
		as totales from tbl_h_respuestas hr
		INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
		INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
		INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
		WHERE  vp.cod_pregunta=19
		GROUP BY d.cod_desicion
		UNION
		
		SELECT CONCAT('Aplicacion N/ha/   ',d.desisicon,' ,QUIZAS,NO'),
		if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi21),##ojo solo applique un round
		if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
		as totales from tbl_h_respuestas hr
		INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
		INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
		INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
		WHERE  vp.cod_pregunta=21
		GROUP BY d.cod_desicion
		
		UNION
		
		SELECT CONCAT('Aplicacion de Abanos  ',d.desisicon,' ,QUIZAS,NO'),
		if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi22),##ojo solo applique un round
		if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
		as totales from tbl_h_respuestas hr
		INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
		INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
		INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
		WHERE  vp.cod_pregunta=22
		GROUP BY d.cod_desicion
		
		UNION
		
		SELECT CONCAT('Protección de Fuentes  ',d.desisicon,' ,QUIZAS,NO'),
		if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi23),##ojo solo applique un round
		if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
		as totales from tbl_h_respuestas hr
		INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
		INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
		INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
		WHERE  vp.cod_pregunta=23
		GROUP BY d.cod_desicion
		
		UNION
		
		SELECT CONCAT('Otros usos de la finca están sin asocio con árboles  ',d.desisicon,' ,QUIZAS,NO'),
		if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi24),##ojo solo applique un round
		if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
		as totales from tbl_h_respuestas hr
		INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
		INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
		INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
		WHERE  vp.cod_pregunta=24
		GROUP BY d.cod_desicion
		
		UNION
		
		SELECT CONCAT('Procesos organizativos sobre mitigación y adaptación  ',d.desisicon,' ,QUIZAS,NO'),
		if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi25),##ojo solo applique un round
		if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
		as totales from tbl_h_respuestas hr
		INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
		INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
		INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
		WHERE  vp.cod_pregunta=25
		GROUP BY d.cod_desicion
;

end if;
END$$

CREATE DEFINER=`root`@`localhost` PROCEDURE `vulnerabilidadParametros` (IN `Pevento` VARCHAR(50), IN `PanioInicio` VARCHAR(25), IN `PanioFinal` VARCHAR(25), IN `PcodDepartamento` VARCHAR(25))  BEGIN
if PcodDepartamento!='' then																																																			
	if Pevento='factores de exposicion' then
		set @restarSi1=(
							SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) 
							from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
							INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
							INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
							INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
							INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
							INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
							INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
							INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
						
							WHERE  vp.cod_pregunta=1 and d.cod_desicion=1 and vf.fecha_visita 
							BETWEEN PanioInicio and PanioFinal AND gd.cod_depart=PcodDepartamento
							GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
								);
		set @restarSi2=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
						INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
						
						WHERE  vp.cod_pregunta=2 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gd.cod_depart=PcodDepartamento
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
						);		
										
		set @restarSi3=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
						INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
						
						WHERE  vp.cod_pregunta=3 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gd.cod_depart=PcodDepartamento
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
						);			
		set @restarSi4=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
						INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
						
						WHERE  vp.cod_pregunta=4 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gd.cod_depart=PcodDepartamento
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
						);		
											
		set @restarSi5=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
						INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
						
						WHERE  vp.cod_pregunta=5 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gd.cod_depart=PcodDepartamento
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
						);	
		set @restarSi6=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
						INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
						
						WHERE  vp.cod_pregunta=6 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gd.cod_depart=PcodDepartamento
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
						);
#----------------------pregunta 1-------------------------------------------------------------------------------------------------------						
	(SELECT CONCAT('Cambio Temperatura ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
		if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi1),##ojo solo applique un round
		if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
		as totales from tbl_h_respuestas hr
		INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
		INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
		INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
		INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
 
		INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
		INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
		INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
		WHERE  vp.cod_pregunta=1 and 
		vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gd.cod_depart=PcodDepartamento
		GROUP BY d.cod_desicion
		
	
    UNION
    SELECT 'Cambio Temperatura SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=1 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=PcodDepartamento
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Cambio Temperatura NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=1 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=PcodDepartamento
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Cambio Temperatura QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion

	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=1 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=PcodDepartamento
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
#--------------------------pregunta2------------------------------------------------------------------------------------------------------------------------
		union
		(SELECT CONCAT('Lluvias Irregulares ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
		if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi2),##ojo solo applique un round
		if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
		as totales from tbl_h_respuestas hr
		INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
		INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
		INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
		INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca

		INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
		INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
		INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
		WHERE  vp.cod_pregunta=2 and 
		vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gd.cod_depart=PcodDepartamento
		GROUP BY d.cod_desicion
		
    UNION
    SELECT 'Lluvias Irregulares SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=2 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=PcodDepartamento
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Lluvias Irregulares NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=2 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=PcodDepartamento
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Lluvias Irregulares QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=2 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=PcodDepartamento
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
		
		
#-------------------------pregunta 3----------------------------------------------------------------------------------------------------------------------		
	
		union
		(SELECT CONCAT('Aumento de Lluvias ',d.desisicon,' ,QUIZAS,NO')as Pregunta,
		if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi3),##ojo solo applique un round
		if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
		as totales from tbl_h_respuestas hr
		INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
		INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
		INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
		INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca

		INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
		INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
		INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
		WHERE  vp.cod_pregunta=3 and 
		vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gd.cod_depart=PcodDepartamento
		GROUP BY d.cod_desicion
		
		UNION
    SELECT 'Aumento de Lluvias SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=3 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=PcodDepartamento
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Aumento de Lluvias NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=3 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=PcodDepartamento
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Aumento de Lluvias QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=3 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=PcodDepartamento
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
#--------------------pregunta 4------------------------------------------------------------------------------------------------------------------------		
			union
		(SELECT CONCAT('Riesgo de Huracanes ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
		if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi4),##ojo solo applique un round
		if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
		as totales from tbl_h_respuestas hr
		INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
		INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
		INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
		INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca

		INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
		INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
		INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
		WHERE  vp.cod_pregunta=4 and 
		vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gd.cod_depart=PcodDepartamento
		GROUP BY d.cod_desicion
		UNION
    SELECT 'Riesgo de Huracanes SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=4 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=PcodDepartamento
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Riesgo de Huracanes NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=4 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=PcodDepartamento
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Riesgo de Huracanes QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=4 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=PcodDepartamento
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
#-----------------pregunta 5---------------------------------------------------------------------------------------------------------------------		
		
			union
		(SELECT CONCAT('Sequias ',d.desisicon,' ,QUIZAS,NO') as pregunta,
		if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi5),##ojo solo applique un round
		if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
		as totales from tbl_h_respuestas hr
		INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
		INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
		INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
		INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca

		INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
		INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
		INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
		WHERE  vp.cod_pregunta=5 and 
		vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gd.cod_depart=PcodDepartamento
		GROUP BY d.cod_desicion
		UNION
    SELECT 'Sequias SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=5 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=PcodDepartamento
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Sequias NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=5 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=PcodDepartamento
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Sequias QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=5 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=PcodDepartamento
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
		
#------------------------pregunta 6--------------------------------------------------------------------------------------------------------------		
			union
		(SELECT CONCAT('Vientos Fuertes ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
		if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi6),##ojo solo applique un round
		if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
		as totales from tbl_h_respuestas hr
		INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
		INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
		INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
		INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca

		INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
		INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
		INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
		WHERE  vp.cod_pregunta=6 and 
		vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gd.cod_depart=PcodDepartamento
		GROUP BY d.cod_desicion
		
		UNION
    SELECT 'Vientos Fuertes SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=6 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=PcodDepartamento
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Vientos Fuertes NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=6 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=PcodDepartamento
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Vientos Fuertes QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=6 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=PcodDepartamento
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
		;
		
#-------------------------------------------------------------------------------------------------------------------------------------------------
#-------------------------------------------------------------------------------------------------------------------------------------------------		
	elseif Pevento='factores de impacto' then

			set @restarSi7=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
						INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
						
						WHERE  vp.cod_pregunta=7 and d.cod_desicion=1 and vf.fecha_visita 
						BETWEEN PanioInicio and PanioFinal AND gd.cod_depart=PcodDepartamento
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
										);
								
				set @restarSi8=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
						INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
						
						WHERE  vp.cod_pregunta=8 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gd.cod_depart=PcodDepartamento
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
											);		
						
				set @restarSi11=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
						INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
						
						WHERE  vp.cod_pregunta=11 and d.cod_desicion=1 and vf.fecha_visita 
						BETWEEN PanioInicio and PanioFinal AND gd.cod_depart=PcodDepartamento
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
											);		
						
					set @restarSi12=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
						INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
						
						WHERE  vp.cod_pregunta=12 and d.cod_desicion=1 and vf.fecha_visita 
						BETWEEN PanioInicio and PanioFinal AND gd.cod_depart=PcodDepartamento
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
											);																					
																							
				set @restarSi13=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
						INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
						
						WHERE  vp.cod_pregunta=13 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gd.cod_depart=PcodDepartamento
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
										);	
						
				set @restarSi20=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
						INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
						
						WHERE  vp.cod_pregunta=20 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gd.cod_depart=PcodDepartamento
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
											);

#--------------------pregunta 7-----------------------------------------------------------------------------------------------------------------------------
				(SELECT CONCAT('Suelos Erosionados ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
				if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi7),##ojo solo applique un round
				if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
				as totales from tbl_h_respuestas hr
				INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
				INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
				INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
				INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
				INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
				INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
				INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart	
		
				WHERE  vp.cod_pregunta=7 and 
				vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gd.cod_depart=PcodDepartamento
				GROUP BY d.cod_desicion
						UNION
    SELECT 'Suelos Erosionados SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=7 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=PcodDepartamento
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Suelos Erosionados NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=7 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=PcodDepartamento
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Suelos Erosionados QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=7 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=PcodDepartamento
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
	
				
				
				
#--------------------pregunta8-----------------------------------------------------------------------------------------------------------------------------
		
				union
		
			(SELECT CONCAT('Baja Fertilidad de los Suelos ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
				if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi8),##ojo solo applique un round
				if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
				as totales from tbl_h_respuestas hr
				INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
				INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
				INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
				INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
				INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
				INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
				INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
				WHERE  vp.cod_pregunta=8 and 
				vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gd.cod_depart=PcodDepartamento
				GROUP BY d.cod_desicion
				
								UNION
    SELECT 'Baja Fertilidad de los Suelos SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=8 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=PcodDepartamento
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Baja Fertilidad de los Suelos NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=8 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=PcodDepartamento
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Baja Fertilidad de los Suelos QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=8 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=PcodDepartamento
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
	
		
		
#----------------------pregunta 11-----------------------------------------------------------------------------------		
				union
		
				(SELECT CONCAT('Floracion Irregular ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
				if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi11),##ojo solo applique un round
				if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
				as totales from tbl_h_respuestas hr
				INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
				INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
				INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
				INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
				INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
				INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
				INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
				WHERE  vp.cod_pregunta=11 and 
				vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gd.cod_depart=PcodDepartamento
				GROUP BY d.cod_desicion
											UNION
    SELECT 'Floracion Irregular SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=11 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=PcodDepartamento
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Floracion Irregular NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=11 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=PcodDepartamento
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Floracion Irregular QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=11 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=PcodDepartamento
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
	
		
#-------------------pregunta 12-----------------------------------------------------------------------------------------------------------------------------		
				union
		
				(SELECT CONCAT('Incremento en Caida de flores ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
				if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi12),##ojo solo applique un round
				if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
				as totales from tbl_h_respuestas hr
				INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
				INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
				INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
				INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
				INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
				INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
				INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
				WHERE  vp.cod_pregunta=12 and 
				vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gd.cod_depart=PcodDepartamento
				GROUP BY d.cod_desicion
				
					UNION
    SELECT 'Incremento en Caida de flores SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=12 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=PcodDepartamento
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Incremento en Caida de flores NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=12 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=PcodDepartamento
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Incremento en Caida de flores QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=12 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=PcodDepartamento
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
	
		
#-----------------pregunta 13--------------------------------------------------------------------------------------------------------------------------		
				union
		
				(SELECT CONCAT('Incremento de Plagas y enfermedades ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
				if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi13),##ojo solo applique un round
				if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
				as totales from tbl_h_respuestas hr
				INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
				INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
				INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
				INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
				INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
				INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
				INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
				WHERE  vp.cod_pregunta=13 and 
				vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gd.cod_depart=PcodDepartamento
				GROUP BY d.cod_desicion
				
														UNION
    SELECT 'Incremento de Plagas y enfermedades SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=13 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=PcodDepartamento
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Incremento de Plagas y enfermedades NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=13 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=PcodDepartamento
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Incremento de Plagas y enfermedades QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=13 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=PcodDepartamento
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
	
#-----------------pregunta 20--------------------------------------------------------------------------------------------------------------------------		
				union
		
				(SELECT CONCAT('Bajas en Productividad ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
				if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi20),##ojo solo applique un round
				if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
				as totales from tbl_h_respuestas hr
				INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
				INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
				INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
				INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
				INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
				INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
				INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
				WHERE  vp.cod_pregunta=20 and 
				vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gd.cod_depart=PcodDepartamento
				GROUP BY d.cod_desicion
				
				
													UNION
    SELECT 'Bajas en Productividad SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=20 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=PcodDepartamento
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Bajas en Productividad NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=20 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=PcodDepartamento
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Bajas en Productividad QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=20 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=PcodDepartamento
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
							;
							
#------------------------------------------------------------------------------------------------------------------------------------							
#------------------------------------------------------------------------------------------------------------------------------------							
	elseif Pevento='factores de adaptabilidad' then


			set @restarSi9=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
						INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
						
						WHERE  vp.cod_pregunta=9 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gd.cod_depart=PcodDepartamento
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
									);	
			set @restarSi10=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
						INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
						
						WHERE  vp.cod_pregunta=10 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gd.cod_depart=PcodDepartamento
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
									);
						
			set @restarSi14=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
						INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
						
						WHERE  vp.cod_pregunta=14 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gd.cod_depart=PcodDepartamento
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
						);	
						
		set @restarSi15=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
						INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
						
						WHERE  vp.cod_pregunta=15 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gd.cod_depart=PcodDepartamento
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
								);	
						
		set @restarSi16=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
						INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
						
						WHERE  vp.cod_pregunta=16 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gd.cod_depart=PcodDepartamento
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
						);	
		set @restarSi17=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
						INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
						
						WHERE  vp.cod_pregunta=17 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gd.cod_depart=PcodDepartamento
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
								);	
		set @restarSi18=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
						INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
						
						WHERE  vp.cod_pregunta=18 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gd.cod_depart=PcodDepartamento
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
									);	
						
			set @restarSi19=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
						INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
						
						WHERE  vp.cod_pregunta=19 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gd.cod_depart=PcodDepartamento
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
									);	
						
			set @restarSi21=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
						INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
						
						WHERE  vp.cod_pregunta=21 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gd.cod_depart=PcodDepartamento
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
									);		
			set @restarSi22=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
						INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
						
						WHERE  vp.cod_pregunta=22 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gd.cod_depart=PcodDepartamento
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
						);
			set @restarSi23=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
						INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
						
						WHERE  vp.cod_pregunta=23 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gd.cod_depart=PcodDepartamento
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
										);			
						
			set @restarSi24=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
						INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
						
						WHERE  vp.cod_pregunta=24 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gd.cod_depart=PcodDepartamento
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
									);	
			set @restarSi25=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
						INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
						
						WHERE  vp.cod_pregunta=25 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gd.cod_depart=PcodDepartamento
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
										);																																	
#-----------------------------pregunta 9-------------------------------------------------------------------------------------------------------------
			(SELECT CONCAT('Practica de Conservacion ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi9),##ojo solo applique un round
			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
			INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
			INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
			INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
			WHERE  vp.cod_pregunta=9 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gd.cod_depart=PcodDepartamento
			GROUP BY d.cod_desicion
				UNION
    SELECT 'Practica de Conservacion SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=9 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=PcodDepartamento
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Practica de Conservacion  NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=9 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=PcodDepartamento
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Practica de Conservacion  QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=9 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=PcodDepartamento
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
				union
#------------------------pregunta 10---------------------------------------------------------------------------------------------------				
		
			(SELECT CONCAT('Cobertura de Hiervas ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi10),##ojo solo applique un round
			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
			INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
			INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
			INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
			WHERE  vp.cod_pregunta=10 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gd.cod_depart=PcodDepartamento
			GROUP BY d.cod_desicion
			
				UNION
    SELECT 'Cobertura de Hiervas SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=10 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=PcodDepartamento
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Cobertura de Hiervas  NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=10 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=PcodDepartamento
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Cobertura de Hiervas  QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=10 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=PcodDepartamento
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
			
			
#------------------------pregunta 14---------------------------------------------------------------------------------------------------		
			union
		
			(SELECT CONCAT('Diversificación de Cafetal ',d.desisicon,' ,QUIZAS,NO')as Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi14),##ojo solo applique un round
			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
			INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
			INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
			INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
			WHERE  vp.cod_pregunta=14 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gd.cod_depart=PcodDepartamento
			GROUP BY d.cod_desicion
			
				UNION
    SELECT 'Diversificación de Cafetal SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=14 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=PcodDepartamento
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Diversificación de Cafetal NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=14 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=PcodDepartamento
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Diversificación de Cafetal QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=14 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=PcodDepartamento
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
			
		
#------------------------pregunta 15---------------------------------------------------------------------------------------------------		
			union
		
			(SELECT CONCAT('Cafetales Pleno Sol ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi15),##ojo solo applique un round
			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
			INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
			INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
			INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
			WHERE  vp.cod_pregunta=15 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gd.cod_depart=PcodDepartamento
			GROUP BY d.cod_desicion
			
			UNION
    SELECT 'Cafetales Pleno Sol SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=15 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=PcodDepartamento
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Cafetales Pleno Sol NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=15 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=PcodDepartamento
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Cafetales Pleno Sol QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=15 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=PcodDepartamento
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
			
#------------------------pregunta 16---------------------------------------------------------------------------------------------------		
			union
		
			(SELECT CONCAT('Cafetales Viejos ',d.desisicon,' ,QUIZAS,NO')as Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi16),##ojo solo applique un round
			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
			INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
			INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
			INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
			WHERE  vp.cod_pregunta=16 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gd.cod_depart=PcodDepartamento
			GROUP BY d.cod_desicion
			
				
			UNION
    SELECT 'Cafetales Viejos SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=16 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=PcodDepartamento
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Cafetales Viejos NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=16 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=PcodDepartamento
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Cafetales Viejos QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=16 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=PcodDepartamento
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
			
#------------------------pregunta 17---------------------------------------------------------------------------------------------------		
		
			union
		
			(SELECT CONCAT('Variedades de Café ',d.desisicon,' ,QUIZAS,NO')as Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi17),##ojo solo applique un round
			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
			INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
			INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
			INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
			WHERE  vp.cod_pregunta=17 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gd.cod_depart=PcodDepartamento
			GROUP BY d.cod_desicion
			
					
			UNION
    SELECT 'Variedades de Café  SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=17 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=PcodDepartamento
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Variedades de Café  NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=17 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=PcodDepartamento
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Variedades de Café  QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=17 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=PcodDepartamento
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
			
#------------------------pregunta 18---------------------------------------------------------------------------------------------------		
				union
		
			(SELECT CONCAT('Manejo de Tejidos ',d.desisicon,' ,QUIZAS,NO')as Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi18),##ojo solo applique un round
			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
			INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
			INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
			INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
			WHERE  vp.cod_pregunta=18 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gd.cod_depart=PcodDepartamento
			GROUP BY d.cod_desicion
			
				
			UNION
    SELECT 'Manejo de Tejidos  SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=18 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=PcodDepartamento
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Manejo de Tejidos  NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=18 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=PcodDepartamento
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Manejo de Tejidos  QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=18 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=PcodDepartamento
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
			
			
#------------------------pregunta 19---------------------------------------------------------------------------------------------------
			union
		
			(SELECT CONCAT('Resiembra de Café ',d.desisicon,' ,QUIZAS,NO') AS Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi19),##ojo solo applique un round
			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
			INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
			INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
			INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
			WHERE  vp.cod_pregunta=19 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gd.cod_depart=PcodDepartamento
			GROUP BY d.cod_desicion
			
				
			UNION
    SELECT 'Resiembra de Café  SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=19 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=PcodDepartamento
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Resiembra de Café  NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=19 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=PcodDepartamento
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Resiembra de Café  QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=19 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=PcodDepartamento
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
			
			
#------------------------pregunta 21---------------------------------------------------------------------------------------------------		
			union
		
			(SELECT CONCAT('Aplicacion N/ha/ ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi21),##ojo solo applique un round
			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
			INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
			INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
			INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
			WHERE  vp.cod_pregunta=21 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gd.cod_depart=PcodDepartamento
			GROUP BY d.cod_desicion
				
			UNION
    SELECT 'Aplicacion N/ha/ SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=21 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=PcodDepartamento
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Aplicacion N/ha/  NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=21 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=PcodDepartamento
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Aplicacion N/ha/  QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=21 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=PcodDepartamento
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
			
			
#------------------------pregunta 22---------------------------------------------------------------------------------------------------
			union
		
			(SELECT CONCAT('Aplicacion de Abanos ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi22),##ojo solo applique un round
			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
			INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
			INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
			INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
			WHERE  vp.cod_pregunta=22 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gd.cod_depart=PcodDepartamento
			GROUP BY d.cod_desicion
			UNION
    SELECT 'Aplicacion de Abanos SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=22 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=PcodDepartamento
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Aplicacion de Abanos NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=22 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=PcodDepartamento
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Aplicacion de Abanos QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=22 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=PcodDepartamento
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
			
			
#------------------------pregunta 23---------------------------------------------------------------------------------------------------		
			UNION
		
			(SELECT CONCAT('Protección de Fuentes ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi23),##ojo solo applique un round
			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
			INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
			INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
			INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
			WHERE  vp.cod_pregunta=23 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gd.cod_depart=PcodDepartamento
			GROUP BY d.cod_desicion
			UNION
    SELECT 'Protección de Fuentes SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=23 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=PcodDepartamento
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Protección de Fuentes NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=23 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=PcodDepartamento
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Protección de Fuentes QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=23 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=PcodDepartamento
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
#------------------------pregunta 24---------------------------------------------------------------------------------------------------			
			UNION
		
			(SELECT CONCAT('Otros usos de la finca están sin asocio con árboles ',d.desisicon,' ,QUIZAS,NO')as Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi24),##ojo solo applique un round
			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
			INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
			INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
			INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
			WHERE  vp.cod_pregunta=24 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gd.cod_depart=PcodDepartamento
			GROUP BY d.cod_desicion
			
			UNION
    SELECT 'Otros usos de la finca están sin asocio con árboles SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=24 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=PcodDepartamento
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Otros usos de la finca están sin asocio con árboles NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=24 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=PcodDepartamento
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Otros usos de la finca están sin asocio con árboles QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=24 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=PcodDepartamento
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
			
#------------------------pregunta 25---------------------------------------------------------------------------------------------------			
			UNION
		
			(SELECT CONCAT('Procesos organizativos sobre mitigación y adaptación ',d.desisicon,' ,QUIZAS,NO')As Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi25),##ojo solo applique un round
			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
			INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
			INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
			INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
			WHERE  vp.cod_pregunta=25 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gd.cod_depart=PcodDepartamento
			GROUP BY d.cod_desicion
			UNION
    SELECT 'Procesos organizativos sobre mitigación y adaptación SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=25 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=PcodDepartamento
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Procesos organizativos sobre mitigación y adaptación NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=25 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=PcodDepartamento
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Procesos organizativos sobre mitigación y adaptación QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=25 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=PcodDepartamento
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
			
			;


		end if;


#elseif PcodAgencia!='' then
	#	SELECT 'estas en agencia ' as mensaje;
end if;
END$$

CREATE DEFINER=`root`@`localhost` PROCEDURE `vulnerabilidadParametrosAgencia` (IN `Pevento` VARCHAR(50), IN `PanioInicio` VARCHAR(25), IN `PanioFinal` VARCHAR(25), IN `PcodAgencia` VARCHAR(25))  BEGIN
if PcodAgencia!='' then																																																			
	if Pevento='factores de exposicion' then
		set @restarSi1=(
							SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) 
							from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
							INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
							INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
							INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
							INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
							INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
							INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
						
							WHERE  vp.cod_pregunta=1 and d.cod_desicion=1 and vf.fecha_visita 
							BETWEEN PanioInicio and PanioFinal AND gp.cod_agencia=PcodAgencia
							GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
								);
		set @restarSi2=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
						
						WHERE  vp.cod_pregunta=2 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gp.cod_agencia=PcodAgencia
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
						);		
										
		set @restarSi3=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
						
						WHERE  vp.cod_pregunta=3 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gp.cod_agencia=PcodAgencia
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
						);			
		set @restarSi4=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
						
						WHERE  vp.cod_pregunta=4 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gp.cod_agencia=PcodAgencia
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
						);		
											
		set @restarSi5=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
						
						WHERE  vp.cod_pregunta=5 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gp.cod_agencia=PcodAgencia
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
						);	
		set @restarSi6=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
						
						WHERE  vp.cod_pregunta=6 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gp.cod_agencia=PcodAgencia
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
						);
#----------------------pregunta 1-------------------------------------------------------------------------------------------------------						
	(SELECT CONCAT('Cambio Temperatura ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
		if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi1),##ojo solo applique un round
		if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
		as totales from tbl_h_respuestas hr
		INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
		INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
		INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
		INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
 
		INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
		INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
		WHERE  vp.cod_pregunta=1 and 
		vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gp.cod_agencia=PcodAgencia
		GROUP BY d.cod_desicion
		
	
    UNION
    SELECT 'Cambio Temperatura SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=1 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_agencia=PcodAgencia
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Cambio Temperatura NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=1 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_agencia=PcodAgencia
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Cambio Temperatura QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=1 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_agencia=PcodAgencia
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
#--------------------------pregunta2------------------------------------------------------------------------------------------------------------------------
		union
		(SELECT CONCAT('Lluvias Irregulares ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
		if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi2),##ojo solo applique un round
		if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
		as totales from tbl_h_respuestas hr
		INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
		INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
		INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
		INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca

		INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
		INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
		WHERE  vp.cod_pregunta=2 and 
		vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gp.cod_agencia=PcodAgencia
		GROUP BY d.cod_desicion
		
    UNION
    SELECT 'Lluvias Irregulares SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad

	WHERE  vp.cod_pregunta=2 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_agencia=PcodAgencia
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Lluvias Irregulares NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=2 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_agencia=PcodAgencia
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Lluvias Irregulares QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=2 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_agencia=PcodAgencia
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
		
		
#-------------------------pregunta 3----------------------------------------------------------------------------------------------------------------------		
	
		union
		(SELECT CONCAT('Aumento de Lluvias ',d.desisicon,' ,QUIZAS,NO')as Pregunta,
		if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi3),##ojo solo applique un round
		if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
		as totales from tbl_h_respuestas hr
		INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
		INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
		INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
		INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca

		INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
		INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
		WHERE  vp.cod_pregunta=3 and 
		vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gp.cod_agencia=PcodAgencia
		GROUP BY d.cod_desicion
		
		UNION
    SELECT 'Aumento de Lluvias SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=3 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_agencia=PcodAgencia
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Aumento de Lluvias NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=3 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_agencia=PcodAgencia
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Aumento de Lluvias QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=3 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_agencia=PcodAgencia
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
#--------------------pregunta 4------------------------------------------------------------------------------------------------------------------------		
			union
		(SELECT CONCAT('Riesgo de Huracanes ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
		if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi4),##ojo solo applique un round
		if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
		as totales from tbl_h_respuestas hr
		INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
		INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
		INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
		INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca

		INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
		INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
		WHERE  vp.cod_pregunta=4 and 
		vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gp.cod_agencia=PcodAgencia
		GROUP BY d.cod_desicion
		UNION
    SELECT 'Riesgo de Huracanes SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=4 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_agencia=PcodAgencia
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Riesgo de Huracanes NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=4 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_agencia=PcodAgencia
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Riesgo de Huracanes QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=4 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_agencia=PcodAgencia
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
#-----------------pregunta 5---------------------------------------------------------------------------------------------------------------------		
		
			union
		(SELECT CONCAT('Sequias ',d.desisicon,' ,QUIZAS,NO') as pregunta,
		if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi5),##ojo solo applique un round
		if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
		as totales from tbl_h_respuestas hr
		INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
		INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
		INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
		INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca

		INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
		INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
		WHERE  vp.cod_pregunta=5 and 
		vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gp.cod_agencia=PcodAgencia
		GROUP BY d.cod_desicion
		UNION
    SELECT 'Sequias SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=5 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_agencia=PcodAgencia
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Sequias NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=5 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_agencia=PcodAgencia
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Sequias QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=5 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_agencia=PcodAgencia
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
		
#------------------------pregunta 6--------------------------------------------------------------------------------------------------------------		
			union
		(SELECT CONCAT('Vientos Fuertes ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
		if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi6),##ojo solo applique un round
		if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
		as totales from tbl_h_respuestas hr
		INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
		INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
		INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
		INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca

		INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
		INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
		WHERE  vp.cod_pregunta=6 and 
		vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gp.cod_agencia=PcodAgencia
		GROUP BY d.cod_desicion
		
		UNION
    SELECT 'Vientos Fuertes SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=6 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_agencia=PcodAgencia
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Vientos Fuertes NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=6 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_agencia=PcodAgencia
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Vientos Fuertes QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=6 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_agencia=PcodAgencia
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
		;
		
#-------------------------------------------------------------------------------------------------------------------------------------------------
#-------------------------------------------------------------------------------------------------------------------------------------------------		
	elseif Pevento='factores de impacto' then

			set @restarSi7=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
						
						WHERE  vp.cod_pregunta=7 and d.cod_desicion=1 and vf.fecha_visita 
						BETWEEN PanioInicio and PanioFinal AND gp.cod_agencia=PcodAgencia
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
										);
								
				set @restarSi8=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
						
						WHERE  vp.cod_pregunta=8 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gp.cod_agencia=PcodAgencia
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
											);		
						
				set @restarSi11=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
						
						WHERE  vp.cod_pregunta=11 and d.cod_desicion=1 and vf.fecha_visita 
						BETWEEN PanioInicio and PanioFinal AND gp.cod_agencia=PcodAgencia
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
											);		
						
					set @restarSi12=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
						
						WHERE  vp.cod_pregunta=12 and d.cod_desicion=1 and vf.fecha_visita 
						BETWEEN PanioInicio and PanioFinal AND gp.cod_agencia=PcodAgencia
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
											);																					
																							
				set @restarSi13=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
						
						WHERE  vp.cod_pregunta=13 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gp.cod_agencia=PcodAgencia
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
										);	
						
				set @restarSi20=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
						
						WHERE  vp.cod_pregunta=20 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gp.cod_agencia=PcodAgencia
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
											);

#--------------------pregunta 7-----------------------------------------------------------------------------------------------------------------------------
				(SELECT CONCAT('Suelos Erosionados ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
				if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi7),##ojo solo applique un round
				if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
				as totales from tbl_h_respuestas hr
				INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
				INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
				INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
				INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
				INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
				INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
		
				WHERE  vp.cod_pregunta=7 and 
				vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gp.cod_agencia=PcodAgencia
				GROUP BY d.cod_desicion
						UNION
    SELECT 'Suelos Erosionados SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=7 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_agencia=PcodAgencia
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Suelos Erosionados NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=7 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_agencia=PcodAgencia
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Suelos Erosionados QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=7 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_agencia=PcodAgencia
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
	
				
				
				
#--------------------pregunta8-----------------------------------------------------------------------------------------------------------------------------
		
				union
		
			(SELECT CONCAT('Baja Fertilidad de los Suelos ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
				if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi8),##ojo solo applique un round
				if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
				as totales from tbl_h_respuestas hr
				INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
				INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
				INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
				INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
				INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
				INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
				WHERE  vp.cod_pregunta=8 and 
				vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gp.cod_agencia=PcodAgencia
				GROUP BY d.cod_desicion
				
								UNION
    SELECT 'Baja Fertilidad de los Suelos SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=8 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_agencia=PcodAgencia
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Baja Fertilidad de los Suelos NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=8 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_agencia=PcodAgencia
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Baja Fertilidad de los Suelos QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=8 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_agencia=PcodAgencia
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
	
		
		
#----------------------pregunta 11-----------------------------------------------------------------------------------		
				union
		
				(SELECT CONCAT('Floracion Irregular ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
				if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi11),##ojo solo applique un round
				if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
				as totales from tbl_h_respuestas hr
				INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
				INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
				INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
				INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
				INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
				INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
				WHERE  vp.cod_pregunta=11 and 
				vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gp.cod_agencia=PcodAgencia
				GROUP BY d.cod_desicion
											UNION
    SELECT 'Floracion Irregular SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=11 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_agencia=PcodAgencia
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Floracion Irregular NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=11 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_agencia=PcodAgencia
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Floracion Irregular QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=11 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_agencia=PcodAgencia
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
	
		
#-------------------pregunta 12-----------------------------------------------------------------------------------------------------------------------------		
				union
		
				(SELECT CONCAT('Incremento en Caida de flores ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
				if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi12),##ojo solo applique un round
				if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
				as totales from tbl_h_respuestas hr
				INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
				INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
				INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
				INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
				INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
				INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
				WHERE  vp.cod_pregunta=12 and 
				vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gp.cod_agencia=PcodAgencia
				GROUP BY d.cod_desicion
				
					UNION
    SELECT 'Incremento en Caida de flores SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=12 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_agencia=PcodAgencia
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Incremento en Caida de flores NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=12 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_agencia=PcodAgencia
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Incremento en Caida de flores QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=12 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_agencia=PcodAgencia
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
	
		
#-----------------pregunta 13--------------------------------------------------------------------------------------------------------------------------		
				union
		
				(SELECT CONCAT('Incremento de Plagas y enfermedades ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
				if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi13),##ojo solo applique un round
				if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
				as totales from tbl_h_respuestas hr
				INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
				INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
				INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
				INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
				INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
				INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
				WHERE  vp.cod_pregunta=13 and 
				vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gp.cod_agencia=PcodAgencia
				GROUP BY d.cod_desicion
				
														UNION
    SELECT 'Incremento de Plagas y enfermedades SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=13 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_agencia=PcodAgencia
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Incremento de Plagas y enfermedades NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=13 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_agencia=PcodAgencia
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Incremento de Plagas y enfermedades QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=13 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_agencia=PcodAgencia
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
	
#-----------------pregunta 20--------------------------------------------------------------------------------------------------------------------------		
				union
		
				(SELECT CONCAT('Bajas en Productividad ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
				if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi20),##ojo solo applique un round
				if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
				as totales from tbl_h_respuestas hr
				INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
				INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
				INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
				INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
				INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
				INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
				WHERE  vp.cod_pregunta=20 and 
				vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gp.cod_agencia=PcodAgencia
				GROUP BY d.cod_desicion
				
				
													UNION
    SELECT 'Bajas en Productividad SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=20 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_agencia=PcodAgencia
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Bajas en Productividad NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=20 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_agencia=PcodAgencia
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Bajas en Productividad QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=20 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_agencia=PcodAgencia
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
							;
							
#------------------------------------------------------------------------------------------------------------------------------------							
#------------------------------------------------------------------------------------------------------------------------------------							
	elseif Pevento='factores de adaptabilidad' then


			set @restarSi9=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
						
						WHERE  vp.cod_pregunta=9 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gp.cod_agencia=PcodAgencia
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
									);	
			set @restarSi10=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
						
						WHERE  vp.cod_pregunta=10 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gp.cod_agencia=PcodAgencia
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
									);
						
			set @restarSi14=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
						
						WHERE  vp.cod_pregunta=14 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gp.cod_agencia=PcodAgencia
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
						);	
						
		set @restarSi15=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
						
						WHERE  vp.cod_pregunta=15 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gp.cod_agencia=PcodAgencia
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
								);	
						
		set @restarSi16=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
						
						WHERE  vp.cod_pregunta=16 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gp.cod_agencia=PcodAgencia
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
						);	
		set @restarSi17=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
						
						WHERE  vp.cod_pregunta=17 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gp.cod_agencia=PcodAgencia
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
								);	
		set @restarSi18=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
						
						WHERE  vp.cod_pregunta=18 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gp.cod_agencia=PcodAgencia
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
									);	
						
			set @restarSi19=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
						
						WHERE  vp.cod_pregunta=19 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gp.cod_agencia=PcodAgencia
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
									);	
						
			set @restarSi21=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
						
						WHERE  vp.cod_pregunta=21 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gp.cod_agencia=PcodAgencia
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
									);		
			set @restarSi22=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
						
						WHERE  vp.cod_pregunta=22 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gp.cod_agencia=PcodAgencia
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
						);
			set @restarSi23=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
						
						WHERE  vp.cod_pregunta=23 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gp.cod_agencia=PcodAgencia
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
										);			
						
			set @restarSi24=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
						
						WHERE  vp.cod_pregunta=24 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gp.cod_agencia=PcodAgencia
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
									);	
			set @restarSi25=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
						
						WHERE  vp.cod_pregunta=25 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gp.cod_agencia=PcodAgencia
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
										);																																	
#-----------------------------pregunta 9-------------------------------------------------------------------------------------------------------------
			(SELECT CONCAT('Practica de Conservacion ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi9),##ojo solo applique un round
			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
			INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
			INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
			WHERE  vp.cod_pregunta=9 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gp.cod_agencia=PcodAgencia
			GROUP BY d.cod_desicion
				UNION
    SELECT 'Practica de Conservacion SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=9 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_agencia=PcodAgencia
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Practica de Conservacion  NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=9 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_agencia=PcodAgencia
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Practica de Conservacion  QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=9 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_agencia=PcodAgencia
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
				union
#------------------------pregunta 10---------------------------------------------------------------------------------------------------				
		
			(SELECT CONCAT('Cobertura de Hiervas ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi10),##ojo solo applique un round
			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
			INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
			INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
			WHERE  vp.cod_pregunta=10 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gp.cod_agencia=PcodAgencia
			GROUP BY d.cod_desicion
			
				UNION
    SELECT 'Cobertura de Hiervas SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=10 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_agencia=PcodAgencia
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Cobertura de Hiervas  NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=10 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_agencia=PcodAgencia
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Cobertura de Hiervas  QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=10 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_agencia=PcodAgencia
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
			
			
#------------------------pregunta 14---------------------------------------------------------------------------------------------------		
			union
		
			(SELECT CONCAT('Diversificación de Cafetal ',d.desisicon,' ,QUIZAS,NO')as Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi14),##ojo solo applique un round
			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
			INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
			INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
			WHERE  vp.cod_pregunta=14 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gp.cod_agencia=PcodAgencia
			GROUP BY d.cod_desicion
			
				UNION
    SELECT 'Diversificación de Cafetal SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=14 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_agencia=PcodAgencia
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Diversificación de Cafetal NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=14 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_agencia=PcodAgencia
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Diversificación de Cafetal QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=14 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_agencia=PcodAgencia
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
			
		
#------------------------pregunta 15---------------------------------------------------------------------------------------------------		
			union
		
			(SELECT CONCAT('Cafetales Pleno Sol ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi15),##ojo solo applique un round
			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
			INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
			INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
			WHERE  vp.cod_pregunta=15 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gp.cod_agencia=PcodAgencia
			GROUP BY d.cod_desicion
			
			UNION
    SELECT 'Cafetales Pleno Sol SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=15 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_agencia=PcodAgencia
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Cafetales Pleno Sol NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=15 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_agencia=PcodAgencia
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Cafetales Pleno Sol QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=15 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_agencia=PcodAgencia
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
			
#------------------------pregunta 16---------------------------------------------------------------------------------------------------		
			union
		
			(SELECT CONCAT('Cafetales Viejos ',d.desisicon,' ,QUIZAS,NO')as Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi16),##ojo solo applique un round
			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
			INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
			INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
			WHERE  vp.cod_pregunta=16 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gp.cod_agencia=PcodAgencia
			GROUP BY d.cod_desicion
			
				
			UNION
    SELECT 'Cafetales Viejos SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=16 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_agencia=PcodAgencia
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Cafetales Viejos NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=16 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_agencia=PcodAgencia
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Cafetales Viejos QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=16 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_agencia=PcodAgencia
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
			
#------------------------pregunta 17---------------------------------------------------------------------------------------------------		
		
			union
		
			(SELECT CONCAT('Variedades de Café ',d.desisicon,' ,QUIZAS,NO')as Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi17),##ojo solo applique un round
			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
			INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
			INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
			WHERE  vp.cod_pregunta=17 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gp.cod_agencia=PcodAgencia
			GROUP BY d.cod_desicion
			
					
			UNION
    SELECT 'Variedades de Café  SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=17 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_agencia=PcodAgencia
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Variedades de Café  NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=17 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_agencia=PcodAgencia
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Variedades de Café  QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=17 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_agencia=PcodAgencia
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
			
#------------------------pregunta 18---------------------------------------------------------------------------------------------------		
				union
		
			(SELECT CONCAT('Manejo de Tejidos ',d.desisicon,' ,QUIZAS,NO')as Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi18),##ojo solo applique un round
			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
			INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
			INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
			WHERE  vp.cod_pregunta=18 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gp.cod_agencia=PcodAgencia
			GROUP BY d.cod_desicion
			
				
			UNION
    SELECT 'Manejo de Tejidos  SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=18 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_agencia=PcodAgencia
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Manejo de Tejidos  NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=18 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_agencia=PcodAgencia
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Manejo de Tejidos  QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=18 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_agencia=PcodAgencia
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
			
			
#------------------------pregunta 19---------------------------------------------------------------------------------------------------
			union
		
			(SELECT CONCAT('Resiembra de Café ',d.desisicon,' ,QUIZAS,NO') AS Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi19),##ojo solo applique un round
			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
			INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
			INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
			WHERE  vp.cod_pregunta=19 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gp.cod_agencia=PcodAgencia
			GROUP BY d.cod_desicion
			
				
			UNION
    SELECT 'Resiembra de Café  SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=19 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_agencia=PcodAgencia
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Resiembra de Café  NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=19 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_agencia=PcodAgencia
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Resiembra de Café  QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=19 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_agencia=PcodAgencia
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
			
			
#------------------------pregunta 21---------------------------------------------------------------------------------------------------		
			union
		
			(SELECT CONCAT('Aplicacion N/ha/ ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi21),##ojo solo applique un round
			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
			INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
			INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
			WHERE  vp.cod_pregunta=21 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gp.cod_agencia=PcodAgencia
			GROUP BY d.cod_desicion
				
			UNION
    SELECT 'Aplicacion N/ha/ SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=21 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_agencia=PcodAgencia
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Aplicacion N/ha/  NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=21 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_agencia=PcodAgencia
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Aplicacion N/ha/  QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=21 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_agencia=PcodAgencia
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
			
			
#------------------------pregunta 22---------------------------------------------------------------------------------------------------
			union
		
			(SELECT CONCAT('Aplicacion de Abanos ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi22),##ojo solo applique un round
			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
			INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
			INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
			WHERE  vp.cod_pregunta=22 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gp.cod_agencia=PcodAgencia
			GROUP BY d.cod_desicion
			UNION
    SELECT 'Aplicacion de Abanos SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=22 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_agencia=PcodAgencia
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Aplicacion de Abanos NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=22 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_agencia=PcodAgencia
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Aplicacion de Abanos QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=22 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_agencia=PcodAgencia
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
			
			
#------------------------pregunta 23---------------------------------------------------------------------------------------------------		
			UNION
		
			(SELECT CONCAT('Protección de Fuentes ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi23),##ojo solo applique un round
			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
			INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
			INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
			WHERE  vp.cod_pregunta=23 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gp.cod_agencia=PcodAgencia
			GROUP BY d.cod_desicion
			UNION
    SELECT 'Protección de Fuentes SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=23 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_agencia=PcodAgencia
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Protección de Fuentes NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=23 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_agencia=PcodAgencia
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Protección de Fuentes QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=23 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_agencia=PcodAgencia
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
#------------------------pregunta 24---------------------------------------------------------------------------------------------------			
			UNION
		
			(SELECT CONCAT('Otros usos de la finca están sin asocio con árboles ',d.desisicon,' ,QUIZAS,NO')as Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi24),##ojo solo applique un round
			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
			INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
			INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
			WHERE  vp.cod_pregunta=24 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gp.cod_agencia=PcodAgencia
			GROUP BY d.cod_desicion
			
			UNION
    SELECT 'Otros usos de la finca están sin asocio con árboles SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=24 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_agencia=PcodAgencia
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Otros usos de la finca están sin asocio con árboles NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=24 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_agencia=PcodAgencia
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Otros usos de la finca están sin asocio con árboles QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=24 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_agencia=PcodAgencia
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
			
#------------------------pregunta 25---------------------------------------------------------------------------------------------------			
			UNION
		
			(SELECT CONCAT('Procesos organizativos sobre mitigación y adaptación ',d.desisicon,' ,QUIZAS,NO')As Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi25),##ojo solo applique un round
			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
			INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
			INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
			WHERE  vp.cod_pregunta=25 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gp.cod_agencia=PcodAgencia
			GROUP BY d.cod_desicion
			UNION
    SELECT 'Procesos organizativos sobre mitigación y adaptación SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=25 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_agencia=PcodAgencia
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Procesos organizativos sobre mitigación y adaptación NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=25 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_agencia=PcodAgencia
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Procesos organizativos sobre mitigación y adaptación QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=25 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_agencia=PcodAgencia
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
			
			;


		end if;


#elseif PcodAgencia!='' then
	#	SELECT 'estas en agencia ' as mensaje;
end if;
END$$

CREATE DEFINER=`root`@`localhost` PROCEDURE `vulnerabilidadParametrosEuro` (IN `Pevento` VARCHAR(50), IN `PanioInicio` VARCHAR(25), IN `PanioFinal` VARCHAR(25))  BEGIN
																																																			
	if Pevento='factores de exposicion' then
		set @restarSi1=(
							SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) 
							from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
							INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
							INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
							INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
							INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
							INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
							INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
							INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
						
							WHERE  vp.cod_pregunta=1 and d.cod_desicion=1 and vf.fecha_visita 
							BETWEEN PanioInicio and PanioFinal AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
							GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
								);
		set @restarSi2=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
						INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
						
						WHERE  vp.cod_pregunta=2 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
						);		
										
		set @restarSi3=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
						INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
						
						WHERE  vp.cod_pregunta=3 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
						);			
		set @restarSi4=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
						INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
						
						WHERE  vp.cod_pregunta=4 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
						);		
											
		set @restarSi5=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
						INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
						
						WHERE  vp.cod_pregunta=5 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
						);	
		set @restarSi6=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
						INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
						
						WHERE  vp.cod_pregunta=6 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
						);
#----------------------pregunta 1-------------------------------------------------------------------------------------------------------						
	(SELECT CONCAT('Cambio Temperatura ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
		if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi1),##ojo solo applique un round
		if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
		as totales from tbl_h_respuestas hr
		INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
		INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
		INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
		INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
 
		INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
		INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
		INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
		WHERE  vp.cod_pregunta=1 and 
		vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
		GROUP BY d.cod_desicion
		
	
    UNION
    SELECT 'Cambio Temperatura SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=1 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Cambio Temperatura NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=1 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Cambio Temperatura QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=1 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
#--------------------------pregunta2------------------------------------------------------------------------------------------------------------------------
		union
		(SELECT CONCAT('Lluvias Irregulares ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
		if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi2),##ojo solo applique un round
		if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
		as totales from tbl_h_respuestas hr
		INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
		INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
		INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
		INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca

		INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
		INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
		INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
		WHERE  vp.cod_pregunta=2 and 
		vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
		GROUP BY d.cod_desicion
		
    UNION
    SELECT 'Lluvias Irregulares SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=2 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Lluvias Irregulares NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=2 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Lluvias Irregulares QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=2 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
		
		
#-------------------------pregunta 3----------------------------------------------------------------------------------------------------------------------		
	
		union
		(SELECT CONCAT('Aumento de Lluvias ',d.desisicon,' ,QUIZAS,NO')as Pregunta,
		if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi3),##ojo solo applique un round
		if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
		as totales from tbl_h_respuestas hr
		INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
		INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
		INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
		INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca

		INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
		INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
		INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
		WHERE  vp.cod_pregunta=3 and 
		vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
		GROUP BY d.cod_desicion
		
		UNION
    SELECT 'Aumento de Lluvias SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=3 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Aumento de Lluvias NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=3 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Aumento de Lluvias QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=3 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
#--------------------pregunta 4------------------------------------------------------------------------------------------------------------------------		
			union
		(SELECT CONCAT('Riesgo de Huracanes ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
		if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi4),##ojo solo applique un round
		if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
		as totales from tbl_h_respuestas hr
		INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
		INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
		INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
		INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca

		INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
		INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
		INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
		WHERE  vp.cod_pregunta=4 and 
		vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
		GROUP BY d.cod_desicion
		UNION
    SELECT 'Riesgo de Huracanes SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=4 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Riesgo de Huracanes NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=4 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Riesgo de Huracanes QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=4 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
#-----------------pregunta 5---------------------------------------------------------------------------------------------------------------------		
		
			union
		(SELECT CONCAT('Sequias ',d.desisicon,' ,QUIZAS,NO') as pregunta,
		if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi5),##ojo solo applique un round
		if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
		as totales from tbl_h_respuestas hr
		INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
		INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
		INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
		INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca

		INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
		INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
		INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
		WHERE  vp.cod_pregunta=5 and 
		vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
		GROUP BY d.cod_desicion
		UNION
    SELECT 'Sequias SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=5 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Sequias NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=5 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Sequias QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=5 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
		
#------------------------pregunta 6--------------------------------------------------------------------------------------------------------------		
			union
		(SELECT CONCAT('Vientos Fuertes ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
		if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi6),##ojo solo applique un round
		if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
		as totales from tbl_h_respuestas hr
		INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
		INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
		INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
		INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca

		INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
		INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
		INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
		WHERE  vp.cod_pregunta=6 and 
		vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
		GROUP BY d.cod_desicion
		
		UNION
    SELECT 'Vientos Fuertes SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=6 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Vientos Fuertes NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=6 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Vientos Fuertes QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=6 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
		;
		
#-------------------------------------------------------------------------------------------------------------------------------------------------
#-------------------------------------------------------------------------------------------------------------------------------------------------		
	elseif Pevento='factores de impacto' then

			set @restarSi7=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
						INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
						
						WHERE  vp.cod_pregunta=7 and d.cod_desicion=1 and vf.fecha_visita 
						BETWEEN PanioInicio and PanioFinal AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
										);
								
				set @restarSi8=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
						INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
						
						WHERE  vp.cod_pregunta=8 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
											);		
						
				set @restarSi11=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
						INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
						
						WHERE  vp.cod_pregunta=11 and d.cod_desicion=1 and vf.fecha_visita 
						BETWEEN PanioInicio and PanioFinal AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
											);		
						
					set @restarSi12=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
						INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
						
						WHERE  vp.cod_pregunta=12 and d.cod_desicion=1 and vf.fecha_visita 
						BETWEEN PanioInicio and PanioFinal AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
											);																					
																							
				set @restarSi13=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
						INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
						
						WHERE  vp.cod_pregunta=13 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
										);	
						
				set @restarSi20=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
						INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
						
						WHERE  vp.cod_pregunta=20 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
											);

#--------------------pregunta 7-----------------------------------------------------------------------------------------------------------------------------
				(SELECT CONCAT('Suelos Erosionados ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
				if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi7),##ojo solo applique un round
				if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
				as totales from tbl_h_respuestas hr
				INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
				INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
				INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
				INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
				INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
				INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
				INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart	
		
				WHERE  vp.cod_pregunta=7 and 
				vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
				GROUP BY d.cod_desicion
						UNION
    SELECT 'Suelos Erosionados SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=7 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Suelos Erosionados NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=7 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Suelos Erosionados QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=7 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
	
				
				
				
#--------------------pregunta8-----------------------------------------------------------------------------------------------------------------------------
		
				union
		
			(SELECT CONCAT('Baja Fertilidad de los Suelos ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
				if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi8),##ojo solo applique un round
				if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
				as totales from tbl_h_respuestas hr
				INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
				INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
				INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
				INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
				INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
				INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
				INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
				WHERE  vp.cod_pregunta=8 and 
				vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
				GROUP BY d.cod_desicion
				
								UNION
    SELECT 'Baja Fertilidad de los Suelos SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=8 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Baja Fertilidad de los Suelos NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=8 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Baja Fertilidad de los Suelos QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=8 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
	
		
		
#----------------------pregunta 11-----------------------------------------------------------------------------------		
				union
		
				(SELECT CONCAT('Floracion Irregular ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
				if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi11),##ojo solo applique un round
				if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
				as totales from tbl_h_respuestas hr
				INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
				INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
				INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
				INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
				INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
				INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
				INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
				WHERE  vp.cod_pregunta=11 and 
				vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
				GROUP BY d.cod_desicion
											UNION
    SELECT 'Floracion Irregular SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=11 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Floracion Irregular NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=11 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Floracion Irregular QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=11 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
	
		
#-------------------pregunta 12-----------------------------------------------------------------------------------------------------------------------------		
				union
		
				(SELECT CONCAT('Incremento en Caida de flores ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
				if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi12),##ojo solo applique un round
				if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
				as totales from tbl_h_respuestas hr
				INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
				INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
				INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
				INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
				INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
				INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
				INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
				WHERE  vp.cod_pregunta=12 and 
				vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
				GROUP BY d.cod_desicion
				
					UNION
    SELECT 'Incremento en Caida de flores SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=12 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Incremento en Caida de flores NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=12 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Incremento en Caida de flores QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=12 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
	
		
#-----------------pregunta 13--------------------------------------------------------------------------------------------------------------------------		
				union
		
				(SELECT CONCAT('Incremento de Plagas y enfermedades ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
				if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi13),##ojo solo applique un round
				if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
				as totales from tbl_h_respuestas hr
				INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
				INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
				INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
				INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
				INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
				INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
				INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
				WHERE  vp.cod_pregunta=13 and 
				vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
				GROUP BY d.cod_desicion
				
														UNION
    SELECT 'Incremento de Plagas y enfermedades SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=13 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Incremento de Plagas y enfermedades NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=13 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Incremento de Plagas y enfermedades QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=13 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
	
#-----------------pregunta 20--------------------------------------------------------------------------------------------------------------------------		
				union
		
				(SELECT CONCAT('Bajas en Productividad ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
				if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi20),##ojo solo applique un round
				if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
				as totales from tbl_h_respuestas hr
				INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
				INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
				INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
				INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
				INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
				INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
				INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
				WHERE  vp.cod_pregunta=20 and 
				vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
				GROUP BY d.cod_desicion
				
				
													UNION
    SELECT 'Bajas en Productividad SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=20 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Bajas en Productividad NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=20 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Bajas en Productividad QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=20 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
							;
							
#------------------------------------------------------------------------------------------------------------------------------------							
#------------------------------------------------------------------------------------------------------------------------------------							
	elseif Pevento='factores de adaptabilidad' then


			set @restarSi9=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
						INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
						
						WHERE  vp.cod_pregunta=9 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
									);	
			set @restarSi10=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
						INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
						
						WHERE  vp.cod_pregunta=10 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
									);
						
			set @restarSi14=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
						INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
						
						WHERE  vp.cod_pregunta=14 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
						);	
						
		set @restarSi15=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
						INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
						
						WHERE  vp.cod_pregunta=15 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
								);	
						
		set @restarSi16=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
						INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
						
						WHERE  vp.cod_pregunta=16 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
						);	
		set @restarSi17=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
						INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
						
						WHERE  vp.cod_pregunta=17 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
								);	
		set @restarSi18=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
						INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
						
						WHERE  vp.cod_pregunta=18 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
									);	
						
			set @restarSi19=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
						INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
						
						WHERE  vp.cod_pregunta=19 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
									);	
						
			set @restarSi21=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
						INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
						
						WHERE  vp.cod_pregunta=21 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
									);		
			set @restarSi22=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
						INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
						
						WHERE  vp.cod_pregunta=22 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
						);
			set @restarSi23=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
						INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
						
						WHERE  vp.cod_pregunta=23 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
										);			
						
			set @restarSi24=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
						INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
						
						WHERE  vp.cod_pregunta=24 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
									);	
			set @restarSi25=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
						INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
						
						WHERE  vp.cod_pregunta=25 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
										);																																	
#-----------------------------pregunta 9-------------------------------------------------------------------------------------------------------------
			(SELECT CONCAT('Practica de Conservacion ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi9),##ojo solo applique un round
			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
			INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
			INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
			INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
			WHERE  vp.cod_pregunta=9 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
			GROUP BY d.cod_desicion
				UNION
    SELECT 'Practica de Conservacion SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=9 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Practica de Conservacion  NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=9 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Practica de Conservacion  QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=9 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
				union
#------------------------pregunta 10---------------------------------------------------------------------------------------------------				
		
			(SELECT CONCAT('Cobertura de Hiervas ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi10),##ojo solo applique un round
			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
			INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
			INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
			INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
			WHERE  vp.cod_pregunta=10 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
			GROUP BY d.cod_desicion
			
				UNION
    SELECT 'Cobertura de Hiervas SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=10 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Cobertura de Hiervas  NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=10 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Cobertura de Hiervas  QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=10 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
			
			
#------------------------pregunta 14---------------------------------------------------------------------------------------------------		
			union
		
			(SELECT CONCAT('Diversificación de Cafetal ',d.desisicon,' ,QUIZAS,NO')as Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi14),##ojo solo applique un round
			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
			INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
			INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
			INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
			WHERE  vp.cod_pregunta=14 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
			GROUP BY d.cod_desicion
			
				UNION
    SELECT 'Diversificación de Cafetal SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=14 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Diversificación de Cafetal NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=14 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Diversificación de Cafetal QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=14 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
			
		
#------------------------pregunta 15---------------------------------------------------------------------------------------------------		
			union
		
			(SELECT CONCAT('Cafetales Pleno Sol ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi15),##ojo solo applique un round
			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
			INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
			INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
			INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
			WHERE  vp.cod_pregunta=15 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
			GROUP BY d.cod_desicion
			
			UNION
    SELECT 'Cafetales Pleno Sol SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=15 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Cafetales Pleno Sol NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=15 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Cafetales Pleno Sol QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=15 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
			
#------------------------pregunta 16---------------------------------------------------------------------------------------------------		
			union
		
			(SELECT CONCAT('Cafetales Viejos ',d.desisicon,' ,QUIZAS,NO')as Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi16),##ojo solo applique un round
			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
			INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
			INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
			INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
			WHERE  vp.cod_pregunta=16 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
			GROUP BY d.cod_desicion
			
				
			UNION
    SELECT 'Cafetales Viejos SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=16 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Cafetales Viejos NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=16 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Cafetales Viejos QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=16 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
			
#------------------------pregunta 17---------------------------------------------------------------------------------------------------		
		
			union
		
			(SELECT CONCAT('Variedades de Café ',d.desisicon,' ,QUIZAS,NO')as Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi17),##ojo solo applique un round

			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
			INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
			INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
			INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
			WHERE  vp.cod_pregunta=17 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
			GROUP BY d.cod_desicion
			
					
			UNION
    SELECT 'Variedades de Café  SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=17 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Variedades de Café  NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=17 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Variedades de Café  QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=17 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
			
#------------------------pregunta 18---------------------------------------------------------------------------------------------------		
				union
		
			(SELECT CONCAT('Manejo de Tejidos ',d.desisicon,' ,QUIZAS,NO')as Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi18),##ojo solo applique un round
			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
			INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
			INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
			INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
			WHERE  vp.cod_pregunta=18 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
			GROUP BY d.cod_desicion
			
				
			UNION
    SELECT 'Manejo de Tejidos  SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=18 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Manejo de Tejidos  NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=18 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Manejo de Tejidos  QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=18 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
			
			
#------------------------pregunta 19---------------------------------------------------------------------------------------------------
			union
		
			(SELECT CONCAT('Resiembra de Café ',d.desisicon,' ,QUIZAS,NO') AS Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi19),##ojo solo applique un round
			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
			INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
			INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
			INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
			WHERE  vp.cod_pregunta=19 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
			GROUP BY d.cod_desicion
			
				
			UNION
    SELECT 'Resiembra de Café  SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=19 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Resiembra de Café  NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=19 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Resiembra de Café  QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=19 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
			
			
#------------------------pregunta 21---------------------------------------------------------------------------------------------------		
			union
		
			(SELECT CONCAT('Aplicacion N/ha/ ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi21),##ojo solo applique un round
			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
			INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
			INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
			INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
			WHERE  vp.cod_pregunta=21 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
			GROUP BY d.cod_desicion

				
			UNION
    SELECT 'Aplicacion N/ha/ SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=21 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Aplicacion N/ha/  NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=21 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Aplicacion N/ha/  QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion

	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=21 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
			
			
#------------------------pregunta 22---------------------------------------------------------------------------------------------------
			union
		
			(SELECT CONCAT('Aplicacion de Abanos ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi22),##ojo solo applique un round
			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
			INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
			INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
			INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
			WHERE  vp.cod_pregunta=22 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
			GROUP BY d.cod_desicion
			UNION
    SELECT 'Aplicacion de Abanos SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=22 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Aplicacion de Abanos NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=22 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Aplicacion de Abanos QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=22 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
			
			
#------------------------pregunta 23---------------------------------------------------------------------------------------------------		
			UNION
		
			(SELECT CONCAT('Protección de Fuentes ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi23),##ojo solo applique un round
			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
			INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
			INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
			INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
			WHERE  vp.cod_pregunta=23 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
			GROUP BY d.cod_desicion
			UNION
    SELECT 'Protección de Fuentes SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=23 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Protección de Fuentes NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=23 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Protección de Fuentes QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=23 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
#------------------------pregunta 24---------------------------------------------------------------------------------------------------			
			UNION
		
			(SELECT CONCAT('Otros usos de la finca están sin asocio con árboles ',d.desisicon,' ,QUIZAS,NO')as Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi24),##ojo solo applique un round
			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
			INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
			INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
			INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
			WHERE  vp.cod_pregunta=24 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
			GROUP BY d.cod_desicion
			
			UNION
    SELECT 'Otros usos de la finca están sin asocio con árboles SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=24 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Otros usos de la finca están sin asocio con árboles NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=24 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Otros usos de la finca están sin asocio con árboles QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=24 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
			
#------------------------pregunta 25---------------------------------------------------------------------------------------------------			
			UNION
		
			(SELECT CONCAT('Procesos organizativos sobre mitigación y adaptación ',d.desisicon,' ,QUIZAS,NO')As Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi25),##ojo solo applique un round
			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
			INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
			INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
			INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
			WHERE  vp.cod_pregunta=25 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
			GROUP BY d.cod_desicion
			UNION
    SELECT 'Procesos organizativos sobre mitigación y adaptación SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=25 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Procesos organizativos sobre mitigación y adaptación NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=25 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Procesos organizativos sobre mitigación y adaptación QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=25 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=4 and gd.cod_depart=13  and gd.cod_depart=12 and gd.cod_depart=14
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
			
			;


		


#elseif PcodAgencia!='' then
	#	SELECT 'estas en agencia ' as mensaje;
end if;
END$$

CREATE DEFINER=`root`@`localhost` PROCEDURE `vulnerabilidadParametrosEuroclima` (IN `Pevento` VARCHAR(50), IN `PanioInicio` VARCHAR(25), IN `PanioFinal` VARCHAR(25))  BEGIN
																																																			
	if Pevento='factores de exposicion' then
		set @restarSi1=(
							SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) 
							from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
							INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
							INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
							INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
							INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
							INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
							INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
							INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
						
							WHERE  vp.cod_pregunta=1 and d.cod_desicion=1 and vf.fecha_visita 
							BETWEEN PanioInicio and PanioFinal AND gd.cod_depart IN (4,12,13,14)
							GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
								);
		set @restarSi2=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
						INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
						
						WHERE  vp.cod_pregunta=2 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gd.cod_depart IN (4,12,13,14)
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
						);		
										
		set @restarSi3=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
						INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
						
						WHERE  vp.cod_pregunta=3 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gd.cod_depart IN (4,12,13,14)
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
						);			
		set @restarSi4=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
						INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
						
						WHERE  vp.cod_pregunta=4 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gd.cod_depart IN (4,12,13,14)
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
						);		
											
		set @restarSi5=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
						INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
						
						WHERE  vp.cod_pregunta=5 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gd.cod_depart IN (4,12,13,14)
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
						);	
		set @restarSi6=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
						INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
						
						WHERE  vp.cod_pregunta=6 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gd.cod_depart IN (4,12,13,14)
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
						);
#----------------------pregunta 1-------------------------------------------------------------------------------------------------------						
	(SELECT CONCAT('Cambio Temperatura ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
		if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi1),##ojo solo applique un round
		if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
		as totales from tbl_h_respuestas hr
		INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
		INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
		INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
		INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
 
		INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
		INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
		INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
		WHERE  vp.cod_pregunta=1 and 
		vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gd.cod_depart IN (4,12,13,14)
		GROUP BY d.cod_desicion
		
	
    UNION
    SELECT 'Cambio Temperatura SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=1 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14)
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Cambio Temperatura NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=1 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14)
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Cambio Temperatura QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=1 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14)
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
#--------------------------pregunta2------------------------------------------------------------------------------------------------------------------------
		union
		(SELECT CONCAT('Lluvias Irregulares ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
		if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi2),##ojo solo applique un round
		if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
		as totales from tbl_h_respuestas hr
		INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
		INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
		INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
		INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca

		INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
		INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
		INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
		WHERE  vp.cod_pregunta=2 and 
		vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gd.cod_depart IN (4,12,13,14)
		GROUP BY d.cod_desicion
		
    UNION
    SELECT 'Lluvias Irregulares SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=2 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14)
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Lluvias Irregulares NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=2 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14)
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Lluvias Irregulares QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=2 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14)
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
		
		
#-------------------------pregunta 3----------------------------------------------------------------------------------------------------------------------		
	
		union
		(SELECT CONCAT('Aumento de Lluvias ',d.desisicon,' ,QUIZAS,NO')as Pregunta,
		if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi3),##ojo solo applique un round
		if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
		as totales from tbl_h_respuestas hr
		INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
		INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
		INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
		INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca

		INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
		INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
		INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
		WHERE  vp.cod_pregunta=3 and 
		vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gd.cod_depart IN (4,12,13,14)
		GROUP BY d.cod_desicion
		
		UNION
    SELECT 'Aumento de Lluvias SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=3 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14)
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Aumento de Lluvias NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=3 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14)
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Aumento de Lluvias QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=3 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14)
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
#--------------------pregunta 4------------------------------------------------------------------------------------------------------------------------		
			union
		(SELECT CONCAT('Riesgo de Huracanes ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
		if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi4),##ojo solo applique un round
		if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
		as totales from tbl_h_respuestas hr
		INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
		INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
		INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
		INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca

		INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
		INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
		INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
		WHERE  vp.cod_pregunta=4 and 
		vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gd.cod_depart IN (4,12,13,14)
		GROUP BY d.cod_desicion
		UNION
    SELECT 'Riesgo de Huracanes SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=4 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14)
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Riesgo de Huracanes NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=4 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14)
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Riesgo de Huracanes QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=4 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14)
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
#-----------------pregunta 5---------------------------------------------------------------------------------------------------------------------		
		
			union
		(SELECT CONCAT('Sequias ',d.desisicon,' ,QUIZAS,NO') as pregunta,
		if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi5),##ojo solo applique un round
		if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
		as totales from tbl_h_respuestas hr
		INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
		INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
		INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
		INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca

		INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
		INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
		INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
		WHERE  vp.cod_pregunta=5 and 
		vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gd.cod_depart IN (4,12,13,14)
		GROUP BY d.cod_desicion
		UNION
    SELECT 'Sequias SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=5 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14)
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Sequias NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=5 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14)
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Sequias QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=5 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14)
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
		
#------------------------pregunta 6--------------------------------------------------------------------------------------------------------------		
			union
		(SELECT CONCAT('Vientos Fuertes ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
		if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi6),##ojo solo applique un round
		if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
		as totales from tbl_h_respuestas hr
		INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
		INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
		INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
		INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca

		INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
		INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
		INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
		WHERE  vp.cod_pregunta=6 and 
		vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gd.cod_depart IN (4,12,13,14)
		GROUP BY d.cod_desicion
		
		UNION
    SELECT 'Vientos Fuertes SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=6 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14)
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Vientos Fuertes NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=6 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14)
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Vientos Fuertes QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=6 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14)
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
		;
		
#-------------------------------------------------------------------------------------------------------------------------------------------------
#-------------------------------------------------------------------------------------------------------------------------------------------------		
	elseif Pevento='factores de impacto' then

			set @restarSi7=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
						INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
						
						WHERE  vp.cod_pregunta=7 and d.cod_desicion=1 and vf.fecha_visita 
						BETWEEN PanioInicio and PanioFinal AND gd.cod_depart IN (4,12,13,14)
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
										);
								
				set @restarSi8=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
						INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
						
						WHERE  vp.cod_pregunta=8 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gd.cod_depart IN (4,12,13,14)
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
											);		
						
				set @restarSi11=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
						INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
						
						WHERE  vp.cod_pregunta=11 and d.cod_desicion=1 and vf.fecha_visita 
						BETWEEN PanioInicio and PanioFinal AND gd.cod_depart IN (4,12,13,14)
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
											);		
						
					set @restarSi12=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
						INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
						
						WHERE  vp.cod_pregunta=12 and d.cod_desicion=1 and vf.fecha_visita 
						BETWEEN PanioInicio and PanioFinal AND gd.cod_depart IN (4,12,13,14)
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
											);																					
																							
				set @restarSi13=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
						INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
						
						WHERE  vp.cod_pregunta=13 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gd.cod_depart IN (4,12,13,14)
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
										);	
						
				set @restarSi20=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
						INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
						
						WHERE  vp.cod_pregunta=20 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gd.cod_depart IN (4,12,13,14)
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
											);

#--------------------pregunta 7-----------------------------------------------------------------------------------------------------------------------------
				(SELECT CONCAT('Suelos Erosionados ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
				if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi7),##ojo solo applique un round
				if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
				as totales from tbl_h_respuestas hr
				INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
				INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
				INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
				INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
				INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
				INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
				INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart	
		
				WHERE  vp.cod_pregunta=7 and 
				vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gd.cod_depart IN (4,12,13,14)
				GROUP BY d.cod_desicion
						UNION
    SELECT 'Suelos Erosionados SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=7 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14)
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Suelos Erosionados NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=7 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14)
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Suelos Erosionados QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=7 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14)
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
	
				
				
				
#--------------------pregunta8-----------------------------------------------------------------------------------------------------------------------------
		
				union
		
			(SELECT CONCAT('Baja Fertilidad de los Suelos ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
				if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi8),##ojo solo applique un round
				if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
				as totales from tbl_h_respuestas hr
				INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
				INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
				INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
				INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
				INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
				INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
				INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
				WHERE  vp.cod_pregunta=8 and 
				vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gd.cod_depart IN (4,12,13,14)
				GROUP BY d.cod_desicion
				
								UNION
    SELECT 'Baja Fertilidad de los Suelos SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=8 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14)
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Baja Fertilidad de los Suelos NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=8 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14)
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Baja Fertilidad de los Suelos QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=8 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14)
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
	
		
		
#----------------------pregunta 11-----------------------------------------------------------------------------------		
				union
		
				(SELECT CONCAT('Floracion Irregular ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
				if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi11),##ojo solo applique un round
				if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
				as totales from tbl_h_respuestas hr
				INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
				INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
				INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
				INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
				INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
				INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
				INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
				WHERE  vp.cod_pregunta=11 and 
				vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gd.cod_depart IN (4,12,13,14)
				GROUP BY d.cod_desicion
											UNION
    SELECT 'Floracion Irregular SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=11 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14)
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Floracion Irregular NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=11 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14)
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Floracion Irregular QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=11 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14)
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
	
		
#-------------------pregunta 12-----------------------------------------------------------------------------------------------------------------------------		
				union
		
				(SELECT CONCAT('Incremento en Caida de flores ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
				if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi12),##ojo solo applique un round
				if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
				as totales from tbl_h_respuestas hr
				INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
				INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
				INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
				INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
				INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
				INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
				INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
				WHERE  vp.cod_pregunta=12 and 
				vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gd.cod_depart IN (4,12,13,14)
				GROUP BY d.cod_desicion
				
					UNION
    SELECT 'Incremento en Caida de flores SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=12 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14)
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Incremento en Caida de flores NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=12 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14)
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Incremento en Caida de flores QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=12 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14)
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
	
		
#-----------------pregunta 13--------------------------------------------------------------------------------------------------------------------------		
				union
		
				(SELECT CONCAT('Incremento de Plagas y enfermedades ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
				if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi13),##ojo solo applique un round
				if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
				as totales from tbl_h_respuestas hr
				INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
				INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
				INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
				INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
				INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
				INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
				INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
				WHERE  vp.cod_pregunta=13 and 
				vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gd.cod_depart IN (4,12,13,14)
				GROUP BY d.cod_desicion
				
														UNION
    SELECT 'Incremento de Plagas y enfermedades SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=13 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14)
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Incremento de Plagas y enfermedades NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=13 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14)
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Incremento de Plagas y enfermedades QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=13 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14)
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
	
#-----------------pregunta 20--------------------------------------------------------------------------------------------------------------------------		
				union
		
				(SELECT CONCAT('Bajas en Productividad ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
				if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi20),##ojo solo applique un round
				if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
				as totales from tbl_h_respuestas hr
				INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
				INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
				INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
				INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
				INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
				INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
				INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
				WHERE  vp.cod_pregunta=20 and 
				vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gd.cod_depart IN (4,12,13,14)
				GROUP BY d.cod_desicion
				
				
													UNION
    SELECT 'Bajas en Productividad SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=20 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14)
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Bajas en Productividad NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=20 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14)
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Bajas en Productividad QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=20 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14)
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
							;
							
#------------------------------------------------------------------------------------------------------------------------------------							
#------------------------------------------------------------------------------------------------------------------------------------							
	elseif Pevento='factores de adaptabilidad' then


			set @restarSi9=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
						INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
						
						WHERE  vp.cod_pregunta=9 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gd.cod_depart IN (4,12,13,14)
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
									);	
			set @restarSi10=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
						INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
						
						WHERE  vp.cod_pregunta=10 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gd.cod_depart IN (4,12,13,14)
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
									);
						
			set @restarSi14=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
						INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
						
						WHERE  vp.cod_pregunta=14 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gd.cod_depart IN (4,12,13,14)
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
						);	
						
		set @restarSi15=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
						INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
						
						WHERE  vp.cod_pregunta=15 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gd.cod_depart IN (4,12,13,14)
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
								);	
						
		set @restarSi16=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
						INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
						
						WHERE  vp.cod_pregunta=16 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gd.cod_depart IN (4,12,13,14)
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
						);	
		set @restarSi17=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
						INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
						
						WHERE  vp.cod_pregunta=17 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gd.cod_depart IN (4,12,13,14)
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
								);	
		set @restarSi18=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
						INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
						
						WHERE  vp.cod_pregunta=18 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gd.cod_depart IN (4,12,13,14)
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
									);	
						
			set @restarSi19=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
						INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
						
						WHERE  vp.cod_pregunta=19 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gd.cod_depart IN (4,12,13,14)
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
									);	
						
			set @restarSi21=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
						INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
						
						WHERE  vp.cod_pregunta=21 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gd.cod_depart IN (4,12,13,14)
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
									);		
			set @restarSi22=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
						INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
						
						WHERE  vp.cod_pregunta=22 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gd.cod_depart IN (4,12,13,14)
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
						);
			set @restarSi23=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
						INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
						
						WHERE  vp.cod_pregunta=23 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gd.cod_depart IN (4,12,13,14)
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
										);			
						
			set @restarSi24=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
						INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
						
						WHERE  vp.cod_pregunta=24 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gd.cod_depart IN (4,12,13,14)
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
									);	
			set @restarSi25=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
						INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
						
						WHERE  vp.cod_pregunta=25 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gd.cod_depart IN (4,12,13,14)
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
										);																																	
#-----------------------------pregunta 9-------------------------------------------------------------------------------------------------------------
			(SELECT CONCAT('Practica de Conservacion ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi9),##ojo solo applique un round
			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
			INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
			INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
			INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
			WHERE  vp.cod_pregunta=9 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gd.cod_depart IN (4,12,13,14)
			GROUP BY d.cod_desicion
				UNION
    SELECT 'Practica de Conservacion SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=9 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14)
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Practica de Conservacion  NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=9 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14)
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Practica de Conservacion  QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=9 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14)
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
				union
#------------------------pregunta 10---------------------------------------------------------------------------------------------------				
		
			(SELECT CONCAT('Cobertura de Hiervas ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi10),##ojo solo applique un round
			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
			INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
			INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
			INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
			WHERE  vp.cod_pregunta=10 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gd.cod_depart IN (4,12,13,14)
			GROUP BY d.cod_desicion
			
				UNION
    SELECT 'Cobertura de Hiervas SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=10 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14)
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Cobertura de Hiervas  NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=10 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14)
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Cobertura de Hiervas  QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=10 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14)
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
			
			
#------------------------pregunta 14---------------------------------------------------------------------------------------------------		
			union
		
			(SELECT CONCAT('Diversificación de Cafetal ',d.desisicon,' ,QUIZAS,NO')as Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi14),##ojo solo applique un round
			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
			INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
			INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
			INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
			WHERE  vp.cod_pregunta=14 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gd.cod_depart IN (4,12,13,14)
			GROUP BY d.cod_desicion
			
				UNION
    SELECT 'Diversificación de Cafetal SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=14 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14)
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Diversificación de Cafetal NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=14 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14)
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Diversificación de Cafetal QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=14 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14)
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
			
		
#------------------------pregunta 15---------------------------------------------------------------------------------------------------		
			union
		
			(SELECT CONCAT('Cafetales Pleno Sol ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi15),##ojo solo applique un round
			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
			INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
			INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
			INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
			WHERE  vp.cod_pregunta=15 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gd.cod_depart IN (4,12,13,14)
			GROUP BY d.cod_desicion
			
			UNION
    SELECT 'Cafetales Pleno Sol SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=15 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14)
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Cafetales Pleno Sol NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=15 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14)
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Cafetales Pleno Sol QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=15 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14)
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
			
#------------------------pregunta 16---------------------------------------------------------------------------------------------------		
			union
		
			(SELECT CONCAT('Cafetales Viejos ',d.desisicon,' ,QUIZAS,NO')as Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi16),##ojo solo applique un round
			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
			INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
			INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
			INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
			WHERE  vp.cod_pregunta=16 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gd.cod_depart IN (4,12,13,14)
			GROUP BY d.cod_desicion
			
				
			UNION
    SELECT 'Cafetales Viejos SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=16 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14)
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Cafetales Viejos NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=16 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14)
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Cafetales Viejos QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=16 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14)
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
			
#------------------------pregunta 17---------------------------------------------------------------------------------------------------		
		
			union
		
			(SELECT CONCAT('Variedades de Café ',d.desisicon,' ,QUIZAS,NO')as Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi17),##ojo solo applique un round
			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
			INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
			INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
			INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
			WHERE  vp.cod_pregunta=17 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gd.cod_depart IN (4,12,13,14)
			GROUP BY d.cod_desicion
			
					
			UNION
    SELECT 'Variedades de Café  SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=17 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14)
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Variedades de Café  NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=17 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14)
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Variedades de Café  QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=17 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14)
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
			
#------------------------pregunta 18---------------------------------------------------------------------------------------------------		
				union
		
			(SELECT CONCAT('Manejo de Tejidos ',d.desisicon,' ,QUIZAS,NO')as Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi18),##ojo solo applique un round
			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
			INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
			INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
			INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
			WHERE  vp.cod_pregunta=18 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gd.cod_depart IN (4,12,13,14)
			GROUP BY d.cod_desicion
			
				
			UNION
    SELECT 'Manejo de Tejidos  SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=18 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14)
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Manejo de Tejidos  NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=18 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14)
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Manejo de Tejidos  QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=18 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14)
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
			
			
#------------------------pregunta 19---------------------------------------------------------------------------------------------------
			union
		
			(SELECT CONCAT('Resiembra de Café ',d.desisicon,' ,QUIZAS,NO') AS Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi19),##ojo solo applique un round
			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
			INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
			INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
			INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
			WHERE  vp.cod_pregunta=19 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gd.cod_depart IN (4,12,13,14)
			GROUP BY d.cod_desicion
			
				
			UNION
    SELECT 'Resiembra de Café  SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=19 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14)
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Resiembra de Café  NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=19 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14)
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Resiembra de Café  QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=19 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14)
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
			
			
#------------------------pregunta 21---------------------------------------------------------------------------------------------------		
			union
		
			(SELECT CONCAT('Aplicacion N/ha/ ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi21),##ojo solo applique un round
			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
			INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
			INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
			INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
			WHERE  vp.cod_pregunta=21 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gd.cod_depart IN (4,12,13,14)
			GROUP BY d.cod_desicion
				
			UNION
    SELECT 'Aplicacion N/ha/ SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=21 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14)
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Aplicacion N/ha/  NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=21 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14)
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Aplicacion N/ha/  QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=21 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14)
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
			
			
#------------------------pregunta 22---------------------------------------------------------------------------------------------------
			union
		
			(SELECT CONCAT('Aplicacion de Abanos ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi22),##ojo solo applique un round
			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
			INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
			INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
			INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
			WHERE  vp.cod_pregunta=22 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gd.cod_depart IN (4,12,13,14)
			GROUP BY d.cod_desicion
			UNION
    SELECT 'Aplicacion de Abanos SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=22 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14)
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Aplicacion de Abanos NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=22 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14)
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Aplicacion de Abanos QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=22 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14)
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
			
			
#------------------------pregunta 23---------------------------------------------------------------------------------------------------		
			UNION
		
			(SELECT CONCAT('Protección de Fuentes ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi23),##ojo solo applique un round
			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
			INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
			INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
			INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
			WHERE  vp.cod_pregunta=23 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gd.cod_depart IN (4,12,13,14)
			GROUP BY d.cod_desicion
			UNION
    SELECT 'Protección de Fuentes SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=23 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14)
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Protección de Fuentes NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=23 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14)
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Protección de Fuentes QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=23 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14)
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
#------------------------pregunta 24---------------------------------------------------------------------------------------------------			
			UNION
		
			(SELECT CONCAT('Otros usos de la finca están sin asocio con árboles ',d.desisicon,' ,QUIZAS,NO')as Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi24),##ojo solo applique un round
			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
			INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
			INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
			INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
			WHERE  vp.cod_pregunta=24 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gd.cod_depart IN (4,12,13,14)
			GROUP BY d.cod_desicion
			
			UNION
    SELECT 'Otros usos de la finca están sin asocio con árboles SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=24 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14)
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Otros usos de la finca están sin asocio con árboles NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=24 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14)
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Otros usos de la finca están sin asocio con árboles QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=24 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14)
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
			
#------------------------pregunta 25---------------------------------------------------------------------------------------------------			
			UNION
		
			(SELECT CONCAT('Procesos organizativos sobre mitigación y adaptación ',d.desisicon,' ,QUIZAS,NO')As Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi25),##ojo solo applique un round
			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
			INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
			INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
			INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
			WHERE  vp.cod_pregunta=25 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gd.cod_depart IN (4,12,13,14)
			GROUP BY d.cod_desicion
			UNION
    SELECT 'Procesos organizativos sobre mitigación y adaptación SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=25 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14)
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Procesos organizativos sobre mitigación y adaptación NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=25 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14)
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Procesos organizativos sobre mitigación y adaptación QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=25 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14)
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
			
			;


	


#elseif PcodAgencia!='' then
	#	SELECT 'estas en agencia ' as mensaje;
end if;
END$$

CREATE DEFINER=`root`@`localhost` PROCEDURE `vulnerabilidadParametrosEuroclimaS` (IN `Pevento` VARCHAR(50), IN `PanioInicio` VARCHAR(25), IN `PanioFinal` VARCHAR(25), IN `psexo` VARCHAR(15))  BEGIN
																																																			
	if Pevento='factores de exposicion' then
		set @restarSi1=(
							SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) 
							from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
							INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
							INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
							INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
							INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
							INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca 
							INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad 
							INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
							INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
							INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
						
							WHERE  vp.cod_pregunta=1 and d.cod_desicion=1 and vf.fecha_visita 
							BETWEEN PanioInicio and PanioFinal AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
							GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
								);
		set @restarSi2=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
						INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
						INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
						
						WHERE  vp.cod_pregunta=2 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
						);		
										
		set @restarSi3=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
						INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
						INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
						
						WHERE  vp.cod_pregunta=3 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
						);			
		set @restarSi4=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
						INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
						INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
						
						WHERE  vp.cod_pregunta=4 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
						);		
											
		set @restarSi5=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
						INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
						INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
						
						WHERE  vp.cod_pregunta=5 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
						);	
		set @restarSi6=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
						INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
						INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
						
						WHERE  vp.cod_pregunta=6 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
						);
#----------------------pregunta 1-------------------------------------------------------------------------------------------------------						
	(SELECT CONCAT('Cambio Temperatura ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
		if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi1),##ojo solo applique un round
		if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
		as totales from tbl_h_respuestas hr
		INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
		INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
		INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
		INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
 
		INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
		INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
		INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
		WHERE  vp.cod_pregunta=1 and 
		vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
		GROUP BY d.cod_desicion
		
	
    UNION
    SELECT 'Cambio Temperatura SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=1 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Cambio Temperatura NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=1 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Cambio Temperatura QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=1 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
#--------------------------pregunta2------------------------------------------------------------------------------------------------------------------------
		union
		(SELECT CONCAT('Lluvias Irregulares ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
		if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi2),##ojo solo applique un round
		if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
		as totales from tbl_h_respuestas hr
		INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
		INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
		INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
		INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca

		INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
		INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
		INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
		WHERE  vp.cod_pregunta=2 and 
		vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
		GROUP BY d.cod_desicion
		
    UNION
    SELECT 'Lluvias Irregulares SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=2 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Lluvias Irregulares NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=2 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Lluvias Irregulares QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=2 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
		
		
#-------------------------pregunta 3----------------------------------------------------------------------------------------------------------------------		
	
		union
		(SELECT CONCAT('Aumento de Lluvias ',d.desisicon,' ,QUIZAS,NO')as Pregunta,
		if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi3),##ojo solo applique un round
		if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
		as totales from tbl_h_respuestas hr
		INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
		INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
		INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
		INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca

		INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
		INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
		INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
		WHERE  vp.cod_pregunta=3 and 
		vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
		GROUP BY d.cod_desicion
		
		UNION
    SELECT 'Aumento de Lluvias SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=3 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Aumento de Lluvias NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=3 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Aumento de Lluvias QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=3 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
#--------------------pregunta 4------------------------------------------------------------------------------------------------------------------------		
			union
		(SELECT CONCAT('Riesgo de Huracanes ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
		if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi4),##ojo solo applique un round
		if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
		as totales from tbl_h_respuestas hr
		INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
		INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
		INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
		INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca

		INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
		INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
		INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
		WHERE  vp.cod_pregunta=4 and 
		vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
		GROUP BY d.cod_desicion
		UNION
    SELECT 'Riesgo de Huracanes SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=4 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Riesgo de Huracanes NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=4 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Riesgo de Huracanes QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=4 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
#-----------------pregunta 5---------------------------------------------------------------------------------------------------------------------		
		
			union
		(SELECT CONCAT('Sequias ',d.desisicon,' ,QUIZAS,NO') as pregunta,
		if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi5),##ojo solo applique un round
		if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
		as totales from tbl_h_respuestas hr
		INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
		INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
		INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
		INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca

		INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
		INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
		INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
		WHERE  vp.cod_pregunta=5 and 
		vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
		GROUP BY d.cod_desicion
		UNION
    SELECT 'Sequias SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=5 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Sequias NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=5 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Sequias QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=5 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
		
#------------------------pregunta 6--------------------------------------------------------------------------------------------------------------		
			union
		(SELECT CONCAT('Vientos Fuertes ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
		if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi6),##ojo solo applique un round
		if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
		as totales from tbl_h_respuestas hr
		INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
		INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
		INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
		INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca

		INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
		INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
		INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
		WHERE  vp.cod_pregunta=6 and 
		vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
		GROUP BY d.cod_desicion
		
		UNION
    SELECT 'Vientos Fuertes SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=6 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Vientos Fuertes NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=6 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Vientos Fuertes QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=6 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
		;
		
#-------------------------------------------------------------------------------------------------------------------------------------------------
#-------------------------------------------------------------------------------------------------------------------------------------------------		
	elseif Pevento='factores de impacto' then

			set @restarSi7=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
						INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
						INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
						
						WHERE  vp.cod_pregunta=7 and d.cod_desicion=1 and vf.fecha_visita 
						BETWEEN PanioInicio and PanioFinal AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
										);
								
				set @restarSi8=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
						INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
						INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
						
						WHERE  vp.cod_pregunta=8 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
											);		
						
				set @restarSi11=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
						INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
						INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
						
						WHERE  vp.cod_pregunta=11 and d.cod_desicion=1 and vf.fecha_visita 
						BETWEEN PanioInicio and PanioFinal AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
											);		
						
					set @restarSi12=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
						INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
						INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
						
						WHERE  vp.cod_pregunta=12 and d.cod_desicion=1 and vf.fecha_visita 
						BETWEEN PanioInicio and PanioFinal AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
											);																					
																							
				set @restarSi13=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
						INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
						INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
						
						WHERE  vp.cod_pregunta=13 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
										);	
						
				set @restarSi20=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
						INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
						INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
						
						WHERE  vp.cod_pregunta=20 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
											);

#--------------------pregunta 7-----------------------------------------------------------------------------------------------------------------------------
				(SELECT CONCAT('Suelos Erosionados ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
				if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi7),##ojo solo applique un round
				if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
				as totales from tbl_h_respuestas hr
				INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
				INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
				INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
				INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
				INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
				INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
				INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart	
		
				WHERE  vp.cod_pregunta=7 and 
				vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
				GROUP BY d.cod_desicion
						UNION
    SELECT 'Suelos Erosionados SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=7 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Suelos Erosionados NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=7 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Suelos Erosionados QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=7 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
	
				
				
				
#--------------------pregunta8-----------------------------------------------------------------------------------------------------------------------------
		
				union
		
			(SELECT CONCAT('Baja Fertilidad de los Suelos ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
				if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi8),##ojo solo applique un round
				if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
				as totales from tbl_h_respuestas hr
				INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
				INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
				INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
				INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
				INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
				INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
				INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
				WHERE  vp.cod_pregunta=8 and 
				vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
				GROUP BY d.cod_desicion
				
								UNION
    SELECT 'Baja Fertilidad de los Suelos SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=8 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Baja Fertilidad de los Suelos NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=8 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Baja Fertilidad de los Suelos QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=8 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
	
		
		
#----------------------pregunta 11-----------------------------------------------------------------------------------		
				union
		
				(SELECT CONCAT('Floracion Irregular ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
				if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi11),##ojo solo applique un round
				if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
				as totales from tbl_h_respuestas hr
				INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
				INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
				INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
				INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
				INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
				INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
				INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
				WHERE  vp.cod_pregunta=11 and 
				vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
				GROUP BY d.cod_desicion
											UNION
    SELECT 'Floracion Irregular SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=11 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Floracion Irregular NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=11 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Floracion Irregular QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=11 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
	
		
#-------------------pregunta 12-----------------------------------------------------------------------------------------------------------------------------		
				union
		
				(SELECT CONCAT('Incremento en Caida de flores ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
				if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi12),##ojo solo applique un round
				if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
				as totales from tbl_h_respuestas hr
				INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
				INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
				INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
				INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
				INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
				INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
				INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
				WHERE  vp.cod_pregunta=12 and 
				vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
				GROUP BY d.cod_desicion
				
					UNION
    SELECT 'Incremento en Caida de flores SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=12 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Incremento en Caida de flores NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=12 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Incremento en Caida de flores QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=12 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
	
		
#-----------------pregunta 13--------------------------------------------------------------------------------------------------------------------------		
				union
		
				(SELECT CONCAT('Incremento de Plagas y enfermedades ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
				if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi13),##ojo solo applique un round
				if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
				as totales from tbl_h_respuestas hr
				INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
				INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
				INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
				INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
				INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
				INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
				INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
				WHERE  vp.cod_pregunta=13 and 
				vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
				GROUP BY d.cod_desicion
				
														UNION
    SELECT 'Incremento de Plagas y enfermedades SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=13 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Incremento de Plagas y enfermedades NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=13 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Incremento de Plagas y enfermedades QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=13 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
	
#-----------------pregunta 20--------------------------------------------------------------------------------------------------------------------------		
				union
		
				(SELECT CONCAT('Bajas en Productividad ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
				if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi20),##ojo solo applique un round
				if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
				as totales from tbl_h_respuestas hr
				INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
				INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
				INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
				INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
				INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
				INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
				INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
				WHERE  vp.cod_pregunta=20 and 
				vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
				GROUP BY d.cod_desicion
				
				
													UNION
    SELECT 'Bajas en Productividad SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=20 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Bajas en Productividad NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=20 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Bajas en Productividad QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=20 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
							;
							
#------------------------------------------------------------------------------------------------------------------------------------							
#------------------------------------------------------------------------------------------------------------------------------------							
	elseif Pevento='factores de adaptabilidad' then


			set @restarSi9=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
						INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
						INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
						
						WHERE  vp.cod_pregunta=9 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
									);	
			set @restarSi10=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
						INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
						INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
						
						WHERE  vp.cod_pregunta=10 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
									);
						
			set @restarSi14=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
						INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
						INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
						
						WHERE  vp.cod_pregunta=14 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
						);	
						
		set @restarSi15=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
						INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
						INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
						
						WHERE  vp.cod_pregunta=15 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
								);	
						
		set @restarSi16=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
						INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
						INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
						
						WHERE  vp.cod_pregunta=16 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
						);	
		set @restarSi17=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
						INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
						INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
						
						WHERE  vp.cod_pregunta=17 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
								);	
		set @restarSi18=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
						INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
						INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
						
						WHERE  vp.cod_pregunta=18 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
									);	
						
			set @restarSi19=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
						INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
						INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
						
						WHERE  vp.cod_pregunta=19 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
									);	
						
			set @restarSi21=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
						INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
						INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
						
						WHERE  vp.cod_pregunta=21 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
									);		
			set @restarSi22=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
						INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
						INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
						
						WHERE  vp.cod_pregunta=22 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
						);
			set @restarSi23=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
						INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
						INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
						
						WHERE  vp.cod_pregunta=23 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
										);			
						
			set @restarSi24=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
						INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
						INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
						
						WHERE  vp.cod_pregunta=24 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
									);	
			set @restarSi25=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
						INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
						INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
						
						WHERE  vp.cod_pregunta=25 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
										);																																	
#-----------------------------pregunta 9-------------------------------------------------------------------------------------------------------------
			(SELECT CONCAT('Practica de Conservacion ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi9),##ojo solo applique un round
			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
			INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
			INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
			INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
			WHERE  vp.cod_pregunta=9 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
			GROUP BY d.cod_desicion
				UNION
    SELECT 'Practica de Conservacion SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=9 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Practica de Conservacion  NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=9 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Practica de Conservacion  QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=9 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
				union
#------------------------pregunta 10---------------------------------------------------------------------------------------------------				
		
			(SELECT CONCAT('Cobertura de Hiervas ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi10),##ojo solo applique un round
			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
			INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
			INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
			INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
			WHERE  vp.cod_pregunta=10 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
			GROUP BY d.cod_desicion
			
				UNION
    SELECT 'Cobertura de Hiervas SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=10 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Cobertura de Hiervas  NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=10 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Cobertura de Hiervas  QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=10 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
			
			
#------------------------pregunta 14---------------------------------------------------------------------------------------------------		
			union
		
			(SELECT CONCAT('Diversificación de Cafetal ',d.desisicon,' ,QUIZAS,NO')as Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi14),##ojo solo applique un round
			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
			INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
			INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
			INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
			WHERE  vp.cod_pregunta=14 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
			GROUP BY d.cod_desicion
			
				UNION
    SELECT 'Diversificación de Cafetal SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=14 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Diversificación de Cafetal NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=14 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Diversificación de Cafetal QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=14 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
			
		
#------------------------pregunta 15---------------------------------------------------------------------------------------------------		
			union
		
			(SELECT CONCAT('Cafetales Pleno Sol ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi15),##ojo solo applique un round
			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
			INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
			INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
			INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
			WHERE  vp.cod_pregunta=15 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
			GROUP BY d.cod_desicion
			
			UNION
    SELECT 'Cafetales Pleno Sol SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=15 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Cafetales Pleno Sol NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=15 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Cafetales Pleno Sol QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=15 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
			
#------------------------pregunta 16---------------------------------------------------------------------------------------------------		
			union
		
			(SELECT CONCAT('Cafetales Viejos ',d.desisicon,' ,QUIZAS,NO')as Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi16),##ojo solo applique un round
			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
			INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
			INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
			INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
			WHERE  vp.cod_pregunta=16 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
			GROUP BY d.cod_desicion
			
				
			UNION
    SELECT 'Cafetales Viejos SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=16 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Cafetales Viejos NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=16 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Cafetales Viejos QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=16 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
			
#------------------------pregunta 17---------------------------------------------------------------------------------------------------		
		
			union
		
			(SELECT CONCAT('Variedades de Café ',d.desisicon,' ,QUIZAS,NO')as Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi17),##ojo solo applique un round
			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
			INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
			INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
			INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
			WHERE  vp.cod_pregunta=17 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
			GROUP BY d.cod_desicion
			
					
			UNION
    SELECT 'Variedades de Café  SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=17 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Variedades de Café  NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=17 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Variedades de Café  QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=17 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
			
#------------------------pregunta 18---------------------------------------------------------------------------------------------------		
				union
		
			(SELECT CONCAT('Manejo de Tejidos ',d.desisicon,' ,QUIZAS,NO')as Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi18),##ojo solo applique un round
			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
			INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
			INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
			INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
			WHERE  vp.cod_pregunta=18 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
			GROUP BY d.cod_desicion
			
				
			UNION
    SELECT 'Manejo de Tejidos  SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=18 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Manejo de Tejidos  NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=18 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Manejo de Tejidos  QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=18 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
			
			
#------------------------pregunta 19---------------------------------------------------------------------------------------------------
			union
		
			(SELECT CONCAT('Resiembra de Café ',d.desisicon,' ,QUIZAS,NO') AS Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi19),##ojo solo applique un round
			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
			INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
			INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
			INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
			WHERE  vp.cod_pregunta=19 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
			GROUP BY d.cod_desicion
			
				
			UNION
    SELECT 'Resiembra de Café  SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=19 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Resiembra de Café  NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=19 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Resiembra de Café  QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=19 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
			
			
#------------------------pregunta 21---------------------------------------------------------------------------------------------------		
			union
		
			(SELECT CONCAT('Aplicacion N/ha/ ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi21),##ojo solo applique un round
			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
			INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
			INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
			INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
			WHERE  vp.cod_pregunta=21 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
			GROUP BY d.cod_desicion
				
			UNION
    SELECT 'Aplicacion N/ha/ SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=21 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Aplicacion N/ha/  NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=21 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Aplicacion N/ha/  QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=21 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
			
			
#------------------------pregunta 22---------------------------------------------------------------------------------------------------
			union
		
			(SELECT CONCAT('Aplicacion de Abanos ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi22),##ojo solo applique un round
			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
			INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
			INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
			INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
			WHERE  vp.cod_pregunta=22 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
			GROUP BY d.cod_desicion
			UNION
    SELECT 'Aplicacion de Abanos SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=22 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Aplicacion de Abanos NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=22 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Aplicacion de Abanos QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=22 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
			
			
#------------------------pregunta 23---------------------------------------------------------------------------------------------------		
			UNION
		
			(SELECT CONCAT('Protección de Fuentes ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi23),##ojo solo applique un round
			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
			INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
			INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
			INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
			WHERE  vp.cod_pregunta=23 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
			GROUP BY d.cod_desicion
			UNION
    SELECT 'Protección de Fuentes SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=23 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Protección de Fuentes NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=23 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Protección de Fuentes QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=23 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
#------------------------pregunta 24---------------------------------------------------------------------------------------------------			
			UNION
		
			(SELECT CONCAT('Otros usos de la finca están sin asocio con árboles ',d.desisicon,' ,QUIZAS,NO')as Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi24),##ojo solo applique un round
			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
			INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
			INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
			INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
			WHERE  vp.cod_pregunta=24 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
			GROUP BY d.cod_desicion
			
			UNION
    SELECT 'Otros usos de la finca están sin asocio con árboles SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=24 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Otros usos de la finca están sin asocio con árboles NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=24 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Otros usos de la finca están sin asocio con árboles QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=24 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
			
#------------------------pregunta 25---------------------------------------------------------------------------------------------------			
			UNION
		
			(SELECT CONCAT('Procesos organizativos sobre mitigación y adaptación ',d.desisicon,' ,QUIZAS,NO')As Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi25),##ojo solo applique un round
			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
			INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
			INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
			INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
			WHERE  vp.cod_pregunta=25 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
			GROUP BY d.cod_desicion
			UNION
    SELECT 'Procesos organizativos sobre mitigación y adaptación SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=25 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Procesos organizativos sobre mitigación y adaptación NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=25 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Procesos organizativos sobre mitigación y adaptación QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=25 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14) AND gg.cod_genero=psexo
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
			
			;


	


#elseif PcodAgencia!='' then
	#	SELECT 'estas en agencia ' as mensaje;
end if;
END$$

CREATE DEFINER=`root`@`localhost` PROCEDURE `vulnerabilidadParametrosFecha` (IN `Pevento` VARCHAR(50), IN `PanioInicio` VARCHAR(25), IN `PanioFinal` VARCHAR(25))  BEGIN
if PanioFinal!='' then																																																			
	if Pevento='factores de exposicion' then
		set @restarSi1=(
							SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) 
							from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
							INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
							INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
							INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
							INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
							INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						
						
							WHERE  vp.cod_pregunta=1 and d.cod_desicion=1 and vf.fecha_visita 
							BETWEEN PanioInicio and PanioFinal 
							GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
								);
		set @restarSi2=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
					
						
						WHERE  vp.cod_pregunta=2 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal 
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
						);		
										
		set @restarSi3=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
					
						
						WHERE  vp.cod_pregunta=3 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal 
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
						);			
		set @restarSi4=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
					
						
						WHERE  vp.cod_pregunta=4 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal 
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
						);		
											
		set @restarSi5=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
					
						
						WHERE  vp.cod_pregunta=5 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal 
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
						);	
		set @restarSi6=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
					
						
						WHERE  vp.cod_pregunta=6 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal 
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
						);
#----------------------pregunta 1-------------------------------------------------------------------------------------------------------						
	(SELECT CONCAT('Cambio Temperatura ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
		if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi1),##ojo solo applique un round
		if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
		as totales from tbl_h_respuestas hr
		INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
		INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
		INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
		INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
 
		INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	
	
		WHERE  vp.cod_pregunta=1 and 
		vf.fecha_visita BETWEEN PanioInicio and PanioFinal 
		GROUP BY d.cod_desicion
		
	
    UNION
    SELECT 'Cambio Temperatura SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca

	
	WHERE  vp.cod_pregunta=1 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Cambio Temperatura NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca

	
	WHERE  vp.cod_pregunta=1 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Cambio Temperatura QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca

	
	WHERE  vp.cod_pregunta=1 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
#--------------------------pregunta2------------------------------------------------------------------------------------------------------------------------
		union
		(SELECT CONCAT('Lluvias Irregulares ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
		if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi2),##ojo solo applique un round
		if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
		as totales from tbl_h_respuestas hr
		INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
		INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
		INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
		INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca

		INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	
	
		WHERE  vp.cod_pregunta=2 and 
		vf.fecha_visita BETWEEN PanioInicio and PanioFinal 
		GROUP BY d.cod_desicion
		
    UNION
    SELECT 'Lluvias Irregulares SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico

	WHERE  vp.cod_pregunta=2 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Lluvias Irregulares NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca

	
	WHERE  vp.cod_pregunta=2 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Lluvias Irregulares QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca

	
	WHERE  vp.cod_pregunta=2 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
		
		
#-------------------------pregunta 3----------------------------------------------------------------------------------------------------------------------		
	
		union
		(SELECT CONCAT('Aumento de Lluvias ',d.desisicon,' ,QUIZAS,NO')as Pregunta,
		if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi3),##ojo solo applique un round
		if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
		as totales from tbl_h_respuestas hr
		INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
		INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
		INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
		INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca

		INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	
	
		WHERE  vp.cod_pregunta=3 and 
		vf.fecha_visita BETWEEN PanioInicio and PanioFinal 
		GROUP BY d.cod_desicion
		
		UNION
    SELECT 'Aumento de Lluvias SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca

	
	WHERE  vp.cod_pregunta=3 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Aumento de Lluvias NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca

	
	WHERE  vp.cod_pregunta=3 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Aumento de Lluvias QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca

	
	WHERE  vp.cod_pregunta=3 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
#--------------------pregunta 4------------------------------------------------------------------------------------------------------------------------		
			union
		(SELECT CONCAT('Riesgo de Huracanes ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
		if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi4),##ojo solo applique un round
		if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
		as totales from tbl_h_respuestas hr
		INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
		INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
		INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
		INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca

		INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	
	
		WHERE  vp.cod_pregunta=4 and 
		vf.fecha_visita BETWEEN PanioInicio and PanioFinal 
		GROUP BY d.cod_desicion
		UNION
    SELECT 'Riesgo de Huracanes SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca

	
	WHERE  vp.cod_pregunta=4 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Riesgo de Huracanes NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca

	
	WHERE  vp.cod_pregunta=4 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Riesgo de Huracanes QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca

	
	WHERE  vp.cod_pregunta=4 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
#-----------------pregunta 5---------------------------------------------------------------------------------------------------------------------		
		
			union
		(SELECT CONCAT('Sequias ',d.desisicon,' ,QUIZAS,NO') as pregunta,
		if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi5),##ojo solo applique un round
		if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
		as totales from tbl_h_respuestas hr
		INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
		INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
		INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
		INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca

		INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	
	
		WHERE  vp.cod_pregunta=5 and 
		vf.fecha_visita BETWEEN PanioInicio and PanioFinal 
		GROUP BY d.cod_desicion
		UNION
    SELECT 'Sequias SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca

	
	WHERE  vp.cod_pregunta=5 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Sequias NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca

	
	WHERE  vp.cod_pregunta=5 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Sequias QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca

	
	WHERE  vp.cod_pregunta=5 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
		
#------------------------pregunta 6--------------------------------------------------------------------------------------------------------------		
			union
		(SELECT CONCAT('Vientos Fuertes ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
		if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi6),##ojo solo applique un round
		if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
		as totales from tbl_h_respuestas hr
		INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
		INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
		INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
		INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca

		INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	
	
		WHERE  vp.cod_pregunta=6 and 
		vf.fecha_visita BETWEEN PanioInicio and PanioFinal 
		GROUP BY d.cod_desicion
		
		UNION
    SELECT 'Vientos Fuertes SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca

	
	WHERE  vp.cod_pregunta=6 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Vientos Fuertes NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca

	
	WHERE  vp.cod_pregunta=6 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Vientos Fuertes QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca

	
	WHERE  vp.cod_pregunta=6 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
		;
		
#-------------------------------------------------------------------------------------------------------------------------------------------------
#-------------------------------------------------------------------------------------------------------------------------------------------------		
	elseif Pevento='factores de impacto' then

			set @restarSi7=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
					
						
						WHERE  vp.cod_pregunta=7 and d.cod_desicion=1 and vf.fecha_visita 
						BETWEEN PanioInicio and PanioFinal 
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
										);
								
				set @restarSi8=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
					
						
						WHERE  vp.cod_pregunta=8 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal 
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
											);		
						
				set @restarSi11=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
					
						
						WHERE  vp.cod_pregunta=11 and d.cod_desicion=1 and vf.fecha_visita 
						BETWEEN PanioInicio and PanioFinal 
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
											);		
						
					set @restarSi12=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
					
						
						WHERE  vp.cod_pregunta=12 and d.cod_desicion=1 and vf.fecha_visita 
						BETWEEN PanioInicio and PanioFinal 
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
											);																					
																							
				set @restarSi13=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
					
						
						WHERE  vp.cod_pregunta=13 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal 
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
										);	
						
				set @restarSi20=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
					
						
						WHERE  vp.cod_pregunta=20 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal 
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
											);

#--------------------pregunta 7-----------------------------------------------------------------------------------------------------------------------------
				(SELECT CONCAT('Suelos Erosionados ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
				if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi7),##ojo solo applique un round
				if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
				as totales from tbl_h_respuestas hr
				INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
				INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
				INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
				INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
				INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
			
		
				WHERE  vp.cod_pregunta=7 and 
				vf.fecha_visita BETWEEN PanioInicio and PanioFinal 
				GROUP BY d.cod_desicion
						UNION
    SELECT 'Suelos Erosionados SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca

	
	WHERE  vp.cod_pregunta=7 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Suelos Erosionados NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca

	
	WHERE  vp.cod_pregunta=7 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Suelos Erosionados QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca

	
	WHERE  vp.cod_pregunta=7 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
	
				
				
				
#--------------------pregunta8-----------------------------------------------------------------------------------------------------------------------------
		
				union
		
			(SELECT CONCAT('Baja Fertilidad de los Suelos ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
				if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi8),##ojo solo applique un round
				if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
				as totales from tbl_h_respuestas hr
				INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
				INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
				INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
				INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
				INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
			
	
				WHERE  vp.cod_pregunta=8 and 
				vf.fecha_visita BETWEEN PanioInicio and PanioFinal 
				GROUP BY d.cod_desicion
				
								UNION
    SELECT 'Baja Fertilidad de los Suelos SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca

	
	WHERE  vp.cod_pregunta=8 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Baja Fertilidad de los Suelos NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca

	
	WHERE  vp.cod_pregunta=8 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Baja Fertilidad de los Suelos QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca

	
	WHERE  vp.cod_pregunta=8 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
	
		
		
#----------------------pregunta 11-----------------------------------------------------------------------------------		
				union
		
				(SELECT CONCAT('Floracion Irregular ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
				if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi11),##ojo solo applique un round
				if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
				as totales from tbl_h_respuestas hr
				INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
				INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
				INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
				INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
				INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
			
	
				WHERE  vp.cod_pregunta=11 and 
				vf.fecha_visita BETWEEN PanioInicio and PanioFinal 
				GROUP BY d.cod_desicion
											UNION
    SELECT 'Floracion Irregular SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca

	
	WHERE  vp.cod_pregunta=11 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Floracion Irregular NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca

	
	WHERE  vp.cod_pregunta=11 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Floracion Irregular QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca

	
	WHERE  vp.cod_pregunta=11 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
	
		
#-------------------pregunta 12-----------------------------------------------------------------------------------------------------------------------------		
				union
		
				(SELECT CONCAT('Incremento en Caida de flores ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
				if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi12),##ojo solo applique un round
				if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
				as totales from tbl_h_respuestas hr
				INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
				INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
				INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
				INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
				INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
			
	
				WHERE  vp.cod_pregunta=12 and 
				vf.fecha_visita BETWEEN PanioInicio and PanioFinal 
				GROUP BY d.cod_desicion
				
					UNION
    SELECT 'Incremento en Caida de flores SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca

	
	WHERE  vp.cod_pregunta=12 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Incremento en Caida de flores NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca

	
	WHERE  vp.cod_pregunta=12 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Incremento en Caida de flores QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca

	
	WHERE  vp.cod_pregunta=12 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
	
		
#-----------------pregunta 13--------------------------------------------------------------------------------------------------------------------------		
				union
		
				(SELECT CONCAT('Incremento de Plagas y enfermedades ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
				if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi13),##ojo solo applique un round
				if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
				as totales from tbl_h_respuestas hr
				INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
				INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
				INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
				INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
				INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
			
	
				WHERE  vp.cod_pregunta=13 and 
				vf.fecha_visita BETWEEN PanioInicio and PanioFinal 
				GROUP BY d.cod_desicion
				
														UNION
    SELECT 'Incremento de Plagas y enfermedades SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca

	
	WHERE  vp.cod_pregunta=13 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Incremento de Plagas y enfermedades NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca

	
	WHERE  vp.cod_pregunta=13 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Incremento de Plagas y enfermedades QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca

	
	WHERE  vp.cod_pregunta=13 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
	
#-----------------pregunta 20--------------------------------------------------------------------------------------------------------------------------		
				union
		
				(SELECT CONCAT('Bajas en Productividad ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
				if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi20),##ojo solo applique un round
				if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
				as totales from tbl_h_respuestas hr
				INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
				INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
				INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
				INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
				INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
			
	
				WHERE  vp.cod_pregunta=20 and 
				vf.fecha_visita BETWEEN PanioInicio and PanioFinal 
				GROUP BY d.cod_desicion
				
				
													UNION
    SELECT 'Bajas en Productividad SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca

	
	WHERE  vp.cod_pregunta=20 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Bajas en Productividad NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca

	
	WHERE  vp.cod_pregunta=20 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Bajas en Productividad QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca

	
	WHERE  vp.cod_pregunta=20 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
							;
							
#------------------------------------------------------------------------------------------------------------------------------------							
#------------------------------------------------------------------------------------------------------------------------------------							
	elseif Pevento='factores de adaptabilidad' then


			set @restarSi9=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
					
						
						WHERE  vp.cod_pregunta=9 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal 
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
									);	
			set @restarSi10=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
					
						
						WHERE  vp.cod_pregunta=10 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal 
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
									);
						
			set @restarSi14=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
					
						
						WHERE  vp.cod_pregunta=14 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal 
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
						);	
						
		set @restarSi15=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
					
						
						WHERE  vp.cod_pregunta=15 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal 
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
								);	
						
		set @restarSi16=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
					
						
						WHERE  vp.cod_pregunta=16 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal 
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
						);	
		set @restarSi17=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
					
						
						WHERE  vp.cod_pregunta=17 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal 
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
								);	
		set @restarSi18=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
					
						
						WHERE  vp.cod_pregunta=18 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal 
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
									);	
						
			set @restarSi19=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
					
						
						WHERE  vp.cod_pregunta=19 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal 
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
									);	
						
			set @restarSi21=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
					
						
						WHERE  vp.cod_pregunta=21 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal 
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
									);		
			set @restarSi22=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
					
						
						WHERE  vp.cod_pregunta=22 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal 
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
						);
			set @restarSi23=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
					
						
						WHERE  vp.cod_pregunta=23 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal 
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
										);			
						
			set @restarSi24=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
					
						
						WHERE  vp.cod_pregunta=24 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal 
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
									);	
			set @restarSi25=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
					
						
						WHERE  vp.cod_pregunta=25 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal 
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
										);																																	
#-----------------------------pregunta 9-------------------------------------------------------------------------------------------------------------
			(SELECT CONCAT('Practica de Conservacion ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi9),##ojo solo applique un round
			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
			INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
		
	
			WHERE  vp.cod_pregunta=9 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal 
			GROUP BY d.cod_desicion
				UNION
    SELECT 'Practica de Conservacion SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca

	
	WHERE  vp.cod_pregunta=9 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Practica de Conservacion  NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca

	
	WHERE  vp.cod_pregunta=9 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Practica de Conservacion  QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca

	
	WHERE  vp.cod_pregunta=9 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
				union
#------------------------pregunta 10---------------------------------------------------------------------------------------------------				
		
			(SELECT CONCAT('Cobertura de Hiervas ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi10),##ojo solo applique un round
			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
			INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
		
	
			WHERE  vp.cod_pregunta=10 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal 
			GROUP BY d.cod_desicion
			
				UNION
    SELECT 'Cobertura de Hiervas SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca

	
	WHERE  vp.cod_pregunta=10 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Cobertura de Hiervas  NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca

	
	WHERE  vp.cod_pregunta=10 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Cobertura de Hiervas  QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca

	
	WHERE  vp.cod_pregunta=10 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
			
			
#------------------------pregunta 14---------------------------------------------------------------------------------------------------		
			union
		
			(SELECT CONCAT('Diversificación de Cafetal ',d.desisicon,' ,QUIZAS,NO')as Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi14),##ojo solo applique un round
			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
			INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
		
	
			WHERE  vp.cod_pregunta=14 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal 
			GROUP BY d.cod_desicion
			
				UNION
    SELECT 'Diversificación de Cafetal SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca

	
	WHERE  vp.cod_pregunta=14 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Diversificación de Cafetal NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca

	
	WHERE  vp.cod_pregunta=14 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Diversificación de Cafetal QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca

	
	WHERE  vp.cod_pregunta=14 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
			
		
#------------------------pregunta 15---------------------------------------------------------------------------------------------------		
			union
		
			(SELECT CONCAT('Cafetales Pleno Sol ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi15),##ojo solo applique un round
			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
			INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
		
	
			WHERE  vp.cod_pregunta=15 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal 
			GROUP BY d.cod_desicion
			
			UNION
    SELECT 'Cafetales Pleno Sol SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca

	
	WHERE  vp.cod_pregunta=15 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Cafetales Pleno Sol NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca

	
	WHERE  vp.cod_pregunta=15 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Cafetales Pleno Sol QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca

	
	WHERE  vp.cod_pregunta=15 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
			
#------------------------pregunta 16---------------------------------------------------------------------------------------------------		
			union
		
			(SELECT CONCAT('Cafetales Viejos ',d.desisicon,' ,QUIZAS,NO')as Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi16),##ojo solo applique un round
			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
			INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
		
	
			WHERE  vp.cod_pregunta=16 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal 
			GROUP BY d.cod_desicion
			
				
			UNION
    SELECT 'Cafetales Viejos SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca

	
	WHERE  vp.cod_pregunta=16 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Cafetales Viejos NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca

	
	WHERE  vp.cod_pregunta=16 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Cafetales Viejos QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca

	
	WHERE  vp.cod_pregunta=16 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
			
#------------------------pregunta 17---------------------------------------------------------------------------------------------------		
		
			union
		
			(SELECT CONCAT('Variedades de Café ',d.desisicon,' ,QUIZAS,NO')as Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi17),##ojo solo applique un round
			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
			INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
		
	
			WHERE  vp.cod_pregunta=17 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal 
			GROUP BY d.cod_desicion
			
					
			UNION
    SELECT 'Variedades de Café  SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca

	
	WHERE  vp.cod_pregunta=17 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Variedades de Café  NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca

	
	WHERE  vp.cod_pregunta=17 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Variedades de Café  QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca

	
	WHERE  vp.cod_pregunta=17 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
			
#------------------------pregunta 18---------------------------------------------------------------------------------------------------		
				union
		
			(SELECT CONCAT('Manejo de Tejidos ',d.desisicon,' ,QUIZAS,NO')as Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi18),##ojo solo applique un round
			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
			INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
		
	
			WHERE  vp.cod_pregunta=18 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal 
			GROUP BY d.cod_desicion
			
				
			UNION
    SELECT 'Manejo de Tejidos  SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca

	
	WHERE  vp.cod_pregunta=18 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Manejo de Tejidos  NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca

	
	WHERE  vp.cod_pregunta=18 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Manejo de Tejidos  QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca

	
	WHERE  vp.cod_pregunta=18 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
			
			
#------------------------pregunta 19---------------------------------------------------------------------------------------------------
			union
		
			(SELECT CONCAT('Resiembra de Café ',d.desisicon,' ,QUIZAS,NO') AS Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi19),##ojo solo applique un round
			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
			INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
		
	
			WHERE  vp.cod_pregunta=19 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal 
			GROUP BY d.cod_desicion
			
				
			UNION
    SELECT 'Resiembra de Café  SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca

	
	WHERE  vp.cod_pregunta=19 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Resiembra de Café  NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca

	
	WHERE  vp.cod_pregunta=19 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Resiembra de Café  QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca

	
	WHERE  vp.cod_pregunta=19 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
			
			
#------------------------pregunta 21---------------------------------------------------------------------------------------------------		
			union
		
			(SELECT CONCAT('Aplicacion N/ha/ ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi21),##ojo solo applique un round
			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
			INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
		
	
			WHERE  vp.cod_pregunta=21 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal 
			GROUP BY d.cod_desicion
				
			UNION
    SELECT 'Aplicacion N/ha/ SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca

	
	WHERE  vp.cod_pregunta=21 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Aplicacion N/ha/  NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca

	
	WHERE  vp.cod_pregunta=21 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Aplicacion N/ha/  QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca

	
	WHERE  vp.cod_pregunta=21 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
			
			
#------------------------pregunta 22---------------------------------------------------------------------------------------------------
			union
		
			(SELECT CONCAT('Aplicacion de Abanos ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi22),##ojo solo applique un round
			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
			INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
		
	
			WHERE  vp.cod_pregunta=22 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal 
			GROUP BY d.cod_desicion
			UNION
    SELECT 'Aplicacion de Abanos SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca

	
	WHERE  vp.cod_pregunta=22 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Aplicacion de Abanos NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca

	
	WHERE  vp.cod_pregunta=22 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Aplicacion de Abanos QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca

	
	WHERE  vp.cod_pregunta=22 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
			
			
#------------------------pregunta 23---------------------------------------------------------------------------------------------------		
			UNION
		
			(SELECT CONCAT('Protección de Fuentes ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi23),##ojo solo applique un round
			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
			INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
		
	
			WHERE  vp.cod_pregunta=23 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal 
			GROUP BY d.cod_desicion
			UNION
    SELECT 'Protección de Fuentes SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca

	
	WHERE  vp.cod_pregunta=23 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Protección de Fuentes NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca

	
	WHERE  vp.cod_pregunta=23 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Protección de Fuentes QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca

	
	WHERE  vp.cod_pregunta=23 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
#------------------------pregunta 24---------------------------------------------------------------------------------------------------			
			UNION
		
			(SELECT CONCAT('Otros usos de la finca están sin asocio con árboles ',d.desisicon,' ,QUIZAS,NO')as Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi24),##ojo solo applique un round
			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
			INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
		
	
			WHERE  vp.cod_pregunta=24 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal 
			GROUP BY d.cod_desicion
			
			UNION
    SELECT 'Otros usos de la finca están sin asocio con árboles SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca

	
	WHERE  vp.cod_pregunta=24 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Otros usos de la finca están sin asocio con árboles NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca

	
	WHERE  vp.cod_pregunta=24 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Otros usos de la finca están sin asocio con árboles QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca

	
	WHERE  vp.cod_pregunta=24 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
			
#------------------------pregunta 25---------------------------------------------------------------------------------------------------			
			UNION
		
			(SELECT CONCAT('Procesos organizativos sobre mitigación y adaptación ',d.desisicon,' ,QUIZAS,NO')As Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi25),##ojo solo applique un round
			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
			INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
		
	
			WHERE  vp.cod_pregunta=25 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal 
			GROUP BY d.cod_desicion
			UNION
    SELECT 'Procesos organizativos sobre mitigación y adaptación SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca

	
	WHERE  vp.cod_pregunta=25 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Procesos organizativos sobre mitigación y adaptación NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca

	
	WHERE  vp.cod_pregunta=25 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Procesos organizativos sobre mitigación y adaptación QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca

	
	WHERE  vp.cod_pregunta=25 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
			
			;


		end if;


#elseif PcodAgencia!='' then
	#	SELECT 'estas en agencia ' as mensaje;
end if;
END$$

CREATE DEFINER=`root`@`localhost` PROCEDURE `vulnerabilidadParametrosGenero` (IN `Pevento` VARCHAR(50), IN `PanioInicio` VARCHAR(25), IN `PanioFinal` VARCHAR(25), IN `PcodGenero` VARCHAR(25))  BEGIN
if PcodGenero!='' then																																																			
	if Pevento='factores de exposicion' then
		set @restarSi1=(
							SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) 
							from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
							INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
							INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
							INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
							INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
							INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
							INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
						
							WHERE  vp.cod_pregunta=1 and d.cod_desicion=1 and vf.fecha_visita 
							BETWEEN PanioInicio and PanioFinal AND gp.cod_genero=PcodGenero
							GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
								);
		set @restarSi2=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
						
						WHERE  vp.cod_pregunta=2 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gp.cod_genero=PcodGenero
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
						);		
										
		set @restarSi3=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
						
						WHERE  vp.cod_pregunta=3 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gp.cod_genero=PcodGenero
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
						);			
		set @restarSi4=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
						
						WHERE  vp.cod_pregunta=4 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gp.cod_genero=PcodGenero
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
						);		
											
		set @restarSi5=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
						
						WHERE  vp.cod_pregunta=5 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gp.cod_genero=PcodGenero
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
						);	
		set @restarSi6=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
						
						WHERE  vp.cod_pregunta=6 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gp.cod_genero=PcodGenero
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
						);
#----------------------pregunta 1-------------------------------------------------------------------------------------------------------						
	(SELECT CONCAT('Cambio Temperatura ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
		if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi1),##ojo solo applique un round
		if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
		as totales from tbl_h_respuestas hr
		INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
		INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
		INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
		INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
 
		INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
		INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
		WHERE  vp.cod_pregunta=1 and 
		vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gp.cod_genero=PcodGenero
		GROUP BY d.cod_desicion
		
	
    UNION
    SELECT 'Cambio Temperatura SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=1 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_genero=PcodGenero
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Cambio Temperatura NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=1 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_genero=PcodGenero
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Cambio Temperatura QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=1 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_genero=PcodGenero
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
#--------------------------pregunta2------------------------------------------------------------------------------------------------------------------------
		union
		(SELECT CONCAT('Lluvias Irregulares ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
		if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi2),##ojo solo applique un round
		if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
		as totales from tbl_h_respuestas hr
		INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
		INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
		INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
		INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca

		INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
		INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
		WHERE  vp.cod_pregunta=2 and 
		vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gp.cod_genero=PcodGenero
		GROUP BY d.cod_desicion
		
    UNION
    SELECT 'Lluvias Irregulares SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad

	WHERE  vp.cod_pregunta=2 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_genero=PcodGenero
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Lluvias Irregulares NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=2 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_genero=PcodGenero
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Lluvias Irregulares QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=2 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_genero=PcodGenero
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
		
		
#-------------------------pregunta 3----------------------------------------------------------------------------------------------------------------------		
	
		union
		(SELECT CONCAT('Aumento de Lluvias ',d.desisicon,' ,QUIZAS,NO')as Pregunta,
		if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi3),##ojo solo applique un round
		if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
		as totales from tbl_h_respuestas hr
		INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
		INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
		INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
		INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca

		INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
		INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
		WHERE  vp.cod_pregunta=3 and 
		vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gp.cod_genero=PcodGenero
		GROUP BY d.cod_desicion
		
		UNION
    SELECT 'Aumento de Lluvias SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=3 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_genero=PcodGenero
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Aumento de Lluvias NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=3 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_genero=PcodGenero
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Aumento de Lluvias QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=3 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_genero=PcodGenero
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
#--------------------pregunta 4------------------------------------------------------------------------------------------------------------------------		
			union
		(SELECT CONCAT('Riesgo de Huracanes ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
		if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi4),##ojo solo applique un round
		if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
		as totales from tbl_h_respuestas hr
		INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
		INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
		INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
		INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca

		INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
		INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
		WHERE  vp.cod_pregunta=4 and 
		vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gp.cod_genero=PcodGenero
		GROUP BY d.cod_desicion
		UNION
    SELECT 'Riesgo de Huracanes SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=4 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_genero=PcodGenero
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Riesgo de Huracanes NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=4 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_genero=PcodGenero
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Riesgo de Huracanes QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=4 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_genero=PcodGenero
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
#-----------------pregunta 5---------------------------------------------------------------------------------------------------------------------		
		
			union
		(SELECT CONCAT('Sequias ',d.desisicon,' ,QUIZAS,NO') as pregunta,
		if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi5),##ojo solo applique un round
		if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
		as totales from tbl_h_respuestas hr
		INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
		INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
		INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
		INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca

		INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
		INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
		WHERE  vp.cod_pregunta=5 and 
		vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gp.cod_genero=PcodGenero
		GROUP BY d.cod_desicion
		UNION
    SELECT 'Sequias SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=5 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_genero=PcodGenero
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Sequias NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=5 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_genero=PcodGenero
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Sequias QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=5 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_genero=PcodGenero
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
		
#------------------------pregunta 6--------------------------------------------------------------------------------------------------------------		
			union
		(SELECT CONCAT('Vientos Fuertes ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
		if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi6),##ojo solo applique un round
		if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
		as totales from tbl_h_respuestas hr
		INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
		INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
		INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
		INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca

		INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
		INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
		WHERE  vp.cod_pregunta=6 and 
		vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gp.cod_genero=PcodGenero
		GROUP BY d.cod_desicion
		
		UNION
    SELECT 'Vientos Fuertes SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=6 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_genero=PcodGenero
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Vientos Fuertes NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=6 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_genero=PcodGenero
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Vientos Fuertes QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=6 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_genero=PcodGenero
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
		;
		
#-------------------------------------------------------------------------------------------------------------------------------------------------
#-------------------------------------------------------------------------------------------------------------------------------------------------		
	elseif Pevento='factores de impacto' then

			set @restarSi7=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
						
						WHERE  vp.cod_pregunta=7 and d.cod_desicion=1 and vf.fecha_visita 
						BETWEEN PanioInicio and PanioFinal AND gp.cod_genero=PcodGenero
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
										);
								
				set @restarSi8=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
						
						WHERE  vp.cod_pregunta=8 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gp.cod_genero=PcodGenero
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
											);		
						
				set @restarSi11=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
						
						WHERE  vp.cod_pregunta=11 and d.cod_desicion=1 and vf.fecha_visita 
						BETWEEN PanioInicio and PanioFinal AND gp.cod_genero=PcodGenero
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
											);		
						
					set @restarSi12=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
						
						WHERE  vp.cod_pregunta=12 and d.cod_desicion=1 and vf.fecha_visita 
						BETWEEN PanioInicio and PanioFinal AND gp.cod_genero=PcodGenero
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
											);																					
																							
				set @restarSi13=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
						
						WHERE  vp.cod_pregunta=13 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gp.cod_genero=PcodGenero
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
										);	
						
				set @restarSi20=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
						
						WHERE  vp.cod_pregunta=20 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gp.cod_genero=PcodGenero
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
											);

#--------------------pregunta 7-----------------------------------------------------------------------------------------------------------------------------
				(SELECT CONCAT('Suelos Erosionados ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
				if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi7),##ojo solo applique un round
				if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
				as totales from tbl_h_respuestas hr
				INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
				INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
				INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
				INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
				INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
				INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
		
				WHERE  vp.cod_pregunta=7 and 
				vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gp.cod_genero=PcodGenero
				GROUP BY d.cod_desicion
						UNION
    SELECT 'Suelos Erosionados SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=7 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_genero=PcodGenero
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Suelos Erosionados NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=7 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_genero=PcodGenero
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Suelos Erosionados QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=7 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_genero=PcodGenero
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
	
				
				
				
#--------------------pregunta8-----------------------------------------------------------------------------------------------------------------------------
		
				union
		
			(SELECT CONCAT('Baja Fertilidad de los Suelos ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
				if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi8),##ojo solo applique un round
				if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
				as totales from tbl_h_respuestas hr
				INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
				INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
				INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
				INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
				INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
				INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
				WHERE  vp.cod_pregunta=8 and 
				vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gp.cod_genero=PcodGenero
				GROUP BY d.cod_desicion
				
								UNION
    SELECT 'Baja Fertilidad de los Suelos SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=8 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_genero=PcodGenero
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Baja Fertilidad de los Suelos NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=8 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_genero=PcodGenero
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Baja Fertilidad de los Suelos QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=8 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_genero=PcodGenero
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
	
		
		
#----------------------pregunta 11-----------------------------------------------------------------------------------		
				union
		
				(SELECT CONCAT('Floracion Irregular ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
				if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi11),##ojo solo applique un round
				if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
				as totales from tbl_h_respuestas hr
				INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
				INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
				INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
				INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
				INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
				INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
				WHERE  vp.cod_pregunta=11 and 
				vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gp.cod_genero=PcodGenero
				GROUP BY d.cod_desicion
											UNION
    SELECT 'Floracion Irregular SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=11 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_genero=PcodGenero
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Floracion Irregular NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=11 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_genero=PcodGenero
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Floracion Irregular QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=11 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_genero=PcodGenero
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
	
		
#-------------------pregunta 12-----------------------------------------------------------------------------------------------------------------------------		
				union
		
				(SELECT CONCAT('Incremento en Caida de flores ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
				if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi12),##ojo solo applique un round
				if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
				as totales from tbl_h_respuestas hr
				INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
				INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
				INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
				INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
				INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
				INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
				WHERE  vp.cod_pregunta=12 and 
				vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gp.cod_genero=PcodGenero
				GROUP BY d.cod_desicion
				
					UNION
    SELECT 'Incremento en Caida de flores SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=12 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_genero=PcodGenero
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Incremento en Caida de flores NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=12 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_genero=PcodGenero
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Incremento en Caida de flores QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=12 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_genero=PcodGenero
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
	
		
#-----------------pregunta 13--------------------------------------------------------------------------------------------------------------------------		
				union
		
				(SELECT CONCAT('Incremento de Plagas y enfermedades ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
				if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi13),##ojo solo applique un round
				if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
				as totales from tbl_h_respuestas hr
				INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
				INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
				INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
				INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
				INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
				INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
				WHERE  vp.cod_pregunta=13 and 
				vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gp.cod_genero=PcodGenero
				GROUP BY d.cod_desicion
				
														UNION
    SELECT 'Incremento de Plagas y enfermedades SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=13 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_genero=PcodGenero
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Incremento de Plagas y enfermedades NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=13 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_genero=PcodGenero
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Incremento de Plagas y enfermedades QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=13 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_genero=PcodGenero
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
	
#-----------------pregunta 20--------------------------------------------------------------------------------------------------------------------------		
				union
		
				(SELECT CONCAT('Bajas en Productividad ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
				if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi20),##ojo solo applique un round
				if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
				as totales from tbl_h_respuestas hr
				INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
				INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
				INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
				INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
				INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
				INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
				WHERE  vp.cod_pregunta=20 and 
				vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gp.cod_genero=PcodGenero
				GROUP BY d.cod_desicion
				
				
													UNION
    SELECT 'Bajas en Productividad SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=20 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_genero=PcodGenero
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Bajas en Productividad NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=20 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_genero=PcodGenero
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Bajas en Productividad QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=20 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_genero=PcodGenero
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
							;
							
#------------------------------------------------------------------------------------------------------------------------------------							
#------------------------------------------------------------------------------------------------------------------------------------							
	elseif Pevento='factores de adaptabilidad' then


			set @restarSi9=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
						
						WHERE  vp.cod_pregunta=9 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gp.cod_genero=PcodGenero
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
									);	
			set @restarSi10=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
						
						WHERE  vp.cod_pregunta=10 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gp.cod_genero=PcodGenero
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
									);
						
			set @restarSi14=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
						
						WHERE  vp.cod_pregunta=14 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gp.cod_genero=PcodGenero
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
						);	
						
		set @restarSi15=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
						
						WHERE  vp.cod_pregunta=15 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gp.cod_genero=PcodGenero
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
								);	
						
		set @restarSi16=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
						
						WHERE  vp.cod_pregunta=16 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gp.cod_genero=PcodGenero
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
						);	
		set @restarSi17=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
						
						WHERE  vp.cod_pregunta=17 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gp.cod_genero=PcodGenero
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
								);	
		set @restarSi18=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
						
						WHERE  vp.cod_pregunta=18 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gp.cod_genero=PcodGenero
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
									);	
						
			set @restarSi19=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
						
						WHERE  vp.cod_pregunta=19 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gp.cod_genero=PcodGenero
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
									);	
						
			set @restarSi21=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
						
						WHERE  vp.cod_pregunta=21 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gp.cod_genero=PcodGenero
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
									);		
			set @restarSi22=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
						
						WHERE  vp.cod_pregunta=22 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gp.cod_genero=PcodGenero
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
						);
			set @restarSi23=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
						
						WHERE  vp.cod_pregunta=23 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gp.cod_genero=PcodGenero
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
										);			
						
			set @restarSi24=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
						
						WHERE  vp.cod_pregunta=24 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gp.cod_genero=PcodGenero
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
									);	
			set @restarSi25=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
						
						WHERE  vp.cod_pregunta=25 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gp.cod_genero=PcodGenero
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
										);																																	
#-----------------------------pregunta 9-------------------------------------------------------------------------------------------------------------
			(SELECT CONCAT('Practica de Conservacion ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi9),##ojo solo applique un round
			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
			INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
			INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
			WHERE  vp.cod_pregunta=9 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gp.cod_genero=PcodGenero
			GROUP BY d.cod_desicion
				UNION
    SELECT 'Practica de Conservacion SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=9 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_genero=PcodGenero
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Practica de Conservacion  NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=9 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_genero=PcodGenero
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Practica de Conservacion  QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=9 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_genero=PcodGenero
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
				union
#------------------------pregunta 10---------------------------------------------------------------------------------------------------				
		
			(SELECT CONCAT('Cobertura de Hiervas ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi10),##ojo solo applique un round
			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
			INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
			INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
			WHERE  vp.cod_pregunta=10 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gp.cod_genero=PcodGenero
			GROUP BY d.cod_desicion
			
				UNION
    SELECT 'Cobertura de Hiervas SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=10 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_genero=PcodGenero
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Cobertura de Hiervas  NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=10 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_genero=PcodGenero
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Cobertura de Hiervas  QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=10 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_genero=PcodGenero
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
			
			
#------------------------pregunta 14---------------------------------------------------------------------------------------------------		
			union
		
			(SELECT CONCAT('Diversificación de Cafetal ',d.desisicon,' ,QUIZAS,NO')as Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi14),##ojo solo applique un round
			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
			INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
			INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
			WHERE  vp.cod_pregunta=14 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gp.cod_genero=PcodGenero
			GROUP BY d.cod_desicion
			
				UNION
    SELECT 'Diversificación de Cafetal SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=14 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_genero=PcodGenero
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Diversificación de Cafetal NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=14 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_genero=PcodGenero
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Diversificación de Cafetal QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=14 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_genero=PcodGenero
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
			
		
#------------------------pregunta 15---------------------------------------------------------------------------------------------------		
			union
		
			(SELECT CONCAT('Cafetales Pleno Sol ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi15),##ojo solo applique un round
			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
			INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
			INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
			WHERE  vp.cod_pregunta=15 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gp.cod_genero=PcodGenero
			GROUP BY d.cod_desicion
			
			UNION
    SELECT 'Cafetales Pleno Sol SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=15 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_genero=PcodGenero
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Cafetales Pleno Sol NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=15 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_genero=PcodGenero
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Cafetales Pleno Sol QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=15 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_genero=PcodGenero
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
			
#------------------------pregunta 16---------------------------------------------------------------------------------------------------		
			union
		
			(SELECT CONCAT('Cafetales Viejos ',d.desisicon,' ,QUIZAS,NO')as Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi16),##ojo solo applique un round
			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
			INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
			INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
			WHERE  vp.cod_pregunta=16 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gp.cod_genero=PcodGenero
			GROUP BY d.cod_desicion
			
				
			UNION
    SELECT 'Cafetales Viejos SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=16 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_genero=PcodGenero
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Cafetales Viejos NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=16 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_genero=PcodGenero
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Cafetales Viejos QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=16 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_genero=PcodGenero
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
			
#------------------------pregunta 17---------------------------------------------------------------------------------------------------		
		
			union
		
			(SELECT CONCAT('Variedades de Café ',d.desisicon,' ,QUIZAS,NO')as Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi17),##ojo solo applique un round
			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
			INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
			INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
			WHERE  vp.cod_pregunta=17 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gp.cod_genero=PcodGenero
			GROUP BY d.cod_desicion
			
					
			UNION
    SELECT 'Variedades de Café  SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=17 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_genero=PcodGenero
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Variedades de Café  NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=17 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_genero=PcodGenero
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Variedades de Café  QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=17 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_genero=PcodGenero
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
			
#------------------------pregunta 18---------------------------------------------------------------------------------------------------		
				union
		
			(SELECT CONCAT('Manejo de Tejidos ',d.desisicon,' ,QUIZAS,NO')as Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi18),##ojo solo applique un round
			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
			INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
			INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
			WHERE  vp.cod_pregunta=18 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gp.cod_genero=PcodGenero
			GROUP BY d.cod_desicion
			
				
			UNION
    SELECT 'Manejo de Tejidos  SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=18 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_genero=PcodGenero
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Manejo de Tejidos  NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=18 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_genero=PcodGenero
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Manejo de Tejidos  QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=18 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_genero=PcodGenero
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
			
			
#------------------------pregunta 19---------------------------------------------------------------------------------------------------
			union
		
			(SELECT CONCAT('Resiembra de Café ',d.desisicon,' ,QUIZAS,NO') AS Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi19),##ojo solo applique un round
			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
			INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
			INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
			WHERE  vp.cod_pregunta=19 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gp.cod_genero=PcodGenero
			GROUP BY d.cod_desicion
			
				
			UNION
    SELECT 'Resiembra de Café  SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=19 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_genero=PcodGenero
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Resiembra de Café  NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=19 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_genero=PcodGenero
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Resiembra de Café  QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=19 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_genero=PcodGenero
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
			
			
#------------------------pregunta 21---------------------------------------------------------------------------------------------------		
			union
		
			(SELECT CONCAT('Aplicacion N/ha/ ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi21),##ojo solo applique un round
			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
			INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
			INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
			WHERE  vp.cod_pregunta=21 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gp.cod_genero=PcodGenero
			GROUP BY d.cod_desicion
				
			UNION
    SELECT 'Aplicacion N/ha/ SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=21 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_genero=PcodGenero
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Aplicacion N/ha/  NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=21 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_genero=PcodGenero
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Aplicacion N/ha/  QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=21 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_genero=PcodGenero
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
			
			
#------------------------pregunta 22---------------------------------------------------------------------------------------------------
			union
		
			(SELECT CONCAT('Aplicacion de Abanos ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi22),##ojo solo applique un round
			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
			INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
			INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
			WHERE  vp.cod_pregunta=22 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gp.cod_genero=PcodGenero
			GROUP BY d.cod_desicion
			UNION
    SELECT 'Aplicacion de Abanos SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=22 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_genero=PcodGenero
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Aplicacion de Abanos NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=22 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_genero=PcodGenero
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Aplicacion de Abanos QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=22 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_genero=PcodGenero
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
			
			
#------------------------pregunta 23---------------------------------------------------------------------------------------------------		
			UNION
		
			(SELECT CONCAT('Protección de Fuentes ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi23),##ojo solo applique un round
			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
			INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
			INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
			WHERE  vp.cod_pregunta=23 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gp.cod_genero=PcodGenero
			GROUP BY d.cod_desicion
			UNION
    SELECT 'Protección de Fuentes SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=23 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_genero=PcodGenero
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Protección de Fuentes NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=23 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_genero=PcodGenero
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Protección de Fuentes QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=23 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_genero=PcodGenero
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
#------------------------pregunta 24---------------------------------------------------------------------------------------------------			
			UNION
		
			(SELECT CONCAT('Otros usos de la finca están sin asocio con árboles ',d.desisicon,' ,QUIZAS,NO')as Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi24),##ojo solo applique un round
			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
			INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
			INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
			WHERE  vp.cod_pregunta=24 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gp.cod_genero=PcodGenero
			GROUP BY d.cod_desicion
			
			UNION
    SELECT 'Otros usos de la finca están sin asocio con árboles SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=24 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_genero=PcodGenero
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Otros usos de la finca están sin asocio con árboles NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=24 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_genero=PcodGenero
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Otros usos de la finca están sin asocio con árboles QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=24 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_genero=PcodGenero
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
			
#------------------------pregunta 25---------------------------------------------------------------------------------------------------			
			UNION
		
			(SELECT CONCAT('Procesos organizativos sobre mitigación y adaptación ',d.desisicon,' ,QUIZAS,NO')As Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi25),##ojo solo applique un round
			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
			INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
			INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
			WHERE  vp.cod_pregunta=25 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gp.cod_genero=PcodGenero
			GROUP BY d.cod_desicion
			UNION
    SELECT 'Procesos organizativos sobre mitigación y adaptación SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=25 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_genero=PcodGenero
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Procesos organizativos sobre mitigación y adaptación NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=25 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_genero=PcodGenero
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Procesos organizativos sobre mitigación y adaptación QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=25 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_genero=PcodGenero
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
			
			;


		end if;


#elseif PcodAgencia!='' then
	#	SELECT 'estas en agencia ' as mensaje;
end if;
END$$

CREATE DEFINER=`root`@`localhost` PROCEDURE `vulnerabilidadParametrosRegional` (IN `Pevento` VARCHAR(50), IN `PanioInicio` VARCHAR(25), IN `PanioFinal` VARCHAR(25), IN `PcodRegional` VARCHAR(25))  BEGIN
if PcodRegional!='' then																																																			
	if Pevento='factores de exposicion' then
		set @restarSi1=(
							SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) 
							from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
							INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
							INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
							INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
							INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
							INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
						INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
						INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
						
							WHERE  vp.cod_pregunta=1 and d.cod_desicion=1 and vf.fecha_visita 
							BETWEEN PanioInicio and PanioFinal AND gr.cod_regional=PcodRegional
							GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
								);
		set @restarSi2=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
						INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
						INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
						
						WHERE  vp.cod_pregunta=2 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gr.cod_regional=PcodRegional
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
						);		
										
		set @restarSi3=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
					INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
						INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
						INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
						
						WHERE  vp.cod_pregunta=3 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gr.cod_regional=PcodRegional
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
						);			
		set @restarSi4=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
						INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
						INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
						
						WHERE  vp.cod_pregunta=4 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gr.cod_regional=PcodRegional
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
						);		
											
		set @restarSi5=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
					INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
						INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
						INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
						
						WHERE  vp.cod_pregunta=5 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gr.cod_regional=PcodRegional
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
						);	
		set @restarSi6=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
						INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
						INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
						
						WHERE  vp.cod_pregunta=6 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gr.cod_regional=PcodRegional
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
						);
#----------------------pregunta 1-------------------------------------------------------------------------------------------------------						
	(SELECT CONCAT('Cambio Temperatura ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
		if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi1),##ojo solo applique un round
		if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
		as totales from tbl_h_respuestas hr
		INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
		INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
		INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
		INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
 
		INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
						INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
						INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
	
		WHERE  vp.cod_pregunta=1 and 
		vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gr.cod_regional=PcodRegional
		GROUP BY d.cod_desicion
		
	
    UNION
    SELECT 'Cambio Temperatura SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
						INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
						INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
	
	WHERE  vp.cod_pregunta=1 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gr.cod_regional=PcodRegional
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Cambio Temperatura NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
						INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
						INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
	
	WHERE  vp.cod_pregunta=1 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gr.cod_regional=PcodRegional
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Cambio Temperatura QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
						INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
						INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
	
	WHERE  vp.cod_pregunta=1 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gr.cod_regional=PcodRegional
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
#--------------------------pregunta2------------------------------------------------------------------------------------------------------------------------
		union
		(SELECT CONCAT('Lluvias Irregulares ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
		if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi2),##ojo solo applique un round
		if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
		as totales from tbl_h_respuestas hr
		INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
		INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
		INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
		INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca

		INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
						INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
						INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
	
		WHERE  vp.cod_pregunta=2 and 
		vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gr.cod_regional=PcodRegional
		GROUP BY d.cod_desicion
		
    UNION
    SELECT 'Lluvias Irregulares SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
						INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
						INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional

	WHERE  vp.cod_pregunta=2 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gr.cod_regional=PcodRegional
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Lluvias Irregulares NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
						INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
						INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
	
	WHERE  vp.cod_pregunta=2 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gr.cod_regional=PcodRegional
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Lluvias Irregulares QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
						INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
						INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
	
	WHERE  vp.cod_pregunta=2 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gr.cod_regional=PcodRegional
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
		
		
#-------------------------pregunta 3----------------------------------------------------------------------------------------------------------------------		
	
		union
		(SELECT CONCAT('Aumento de Lluvias ',d.desisicon,' ,QUIZAS,NO')as Pregunta,
		if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi3),##ojo solo applique un round
		if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
		as totales from tbl_h_respuestas hr
		INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
		INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
		INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
		INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca

		INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
						INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
						INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
	
		WHERE  vp.cod_pregunta=3 and 
		vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gr.cod_regional=PcodRegional
		GROUP BY d.cod_desicion
		
		UNION
    SELECT 'Aumento de Lluvias SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
						INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
						INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
	
	WHERE  vp.cod_pregunta=3 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gr.cod_regional=PcodRegional
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Aumento de Lluvias NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
						INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
						INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
	
	WHERE  vp.cod_pregunta=3 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gr.cod_regional=PcodRegional
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Aumento de Lluvias QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
						INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
						INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
	
	WHERE  vp.cod_pregunta=3 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gr.cod_regional=PcodRegional
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
#--------------------pregunta 4------------------------------------------------------------------------------------------------------------------------		
			union
		(SELECT CONCAT('Riesgo de Huracanes ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
		if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi4),##ojo solo applique un round
		if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
		as totales from tbl_h_respuestas hr
		INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
		INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
		INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
		INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca

		INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
						INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
						INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
						
		WHERE  vp.cod_pregunta=4 and 
		vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gr.cod_regional=PcodRegional
		GROUP BY d.cod_desicion
		UNION
    SELECT 'Riesgo de Huracanes SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
						INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
						INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
	
	WHERE  vp.cod_pregunta=4 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gr.cod_regional=PcodRegional
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Riesgo de Huracanes NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
						INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
						INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
	
	WHERE  vp.cod_pregunta=4 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gr.cod_regional=PcodRegional
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Riesgo de Huracanes QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
						INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
						INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
	
	WHERE  vp.cod_pregunta=4 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gr.cod_regional=PcodRegional
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
#-----------------pregunta 5---------------------------------------------------------------------------------------------------------------------		
		
			union
		(SELECT CONCAT('Sequias ',d.desisicon,' ,QUIZAS,NO') as pregunta,
		if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi5),##ojo solo applique un round
		if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
		as totales from tbl_h_respuestas hr
		INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
		INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
		INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
		INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca

		INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
						INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
						INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
	
		WHERE  vp.cod_pregunta=5 and 
		vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gr.cod_regional=PcodRegional
		GROUP BY d.cod_desicion
		UNION
    SELECT 'Sequias SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
						INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
						INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
	
	WHERE  vp.cod_pregunta=5 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gr.cod_regional=PcodRegional
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Sequias NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
						INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
						INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
	
	WHERE  vp.cod_pregunta=5 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gr.cod_regional=PcodRegional
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Sequias QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
						INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
						INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
	
	WHERE  vp.cod_pregunta=5 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gr.cod_regional=PcodRegional
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
		
#------------------------pregunta 6--------------------------------------------------------------------------------------------------------------		
			union
		(SELECT CONCAT('Vientos Fuertes ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
		if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi6),##ojo solo applique un round
		if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
		as totales from tbl_h_respuestas hr
		INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
		INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
		INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
		INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca

		INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
						INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
						INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
	
		WHERE  vp.cod_pregunta=6 and 
		vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gr.cod_regional=PcodRegional
		GROUP BY d.cod_desicion
		
		UNION
    SELECT 'Vientos Fuertes SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
						INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
						INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
						
	WHERE  vp.cod_pregunta=6 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gr.cod_regional=PcodRegional
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Vientos Fuertes NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
						INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
						INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
	
	WHERE  vp.cod_pregunta=6 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gr.cod_regional=PcodRegional
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Vientos Fuertes QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
						INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
						INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
	
	WHERE  vp.cod_pregunta=6 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gr.cod_regional=PcodRegional
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
		;
		
#-------------------------------------------------------------------------------------------------------------------------------------------------
#-------------------------------------------------------------------------------------------------------------------------------------------------		
	elseif Pevento='factores de impacto' then

			set @restarSi7=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
						INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
						INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
						
						WHERE  vp.cod_pregunta=7 and d.cod_desicion=1 and vf.fecha_visita 
						BETWEEN PanioInicio and PanioFinal AND gr.cod_regional=PcodRegional
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
										);
								
				set @restarSi8=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
						INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
						INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
						
						WHERE  vp.cod_pregunta=8 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gr.cod_regional=PcodRegional
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
											);		
						
				set @restarSi11=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
						INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
						INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
						
						WHERE  vp.cod_pregunta=11 and d.cod_desicion=1 and vf.fecha_visita 
						BETWEEN PanioInicio and PanioFinal AND gr.cod_regional=PcodRegional
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
											);		
						
					set @restarSi12=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
		
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
	INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
	
						
						WHERE  vp.cod_pregunta=12 and d.cod_desicion=1 and vf.fecha_visita 
						BETWEEN PanioInicio and PanioFinal AND gr.cod_regional=PcodRegional
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
											);																					
																							
				set @restarSi13=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
						INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
						INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
						
						WHERE  vp.cod_pregunta=13 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gr.cod_regional=PcodRegional
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
										);	
						
				set @restarSi20=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
						INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
						INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
						
						WHERE  vp.cod_pregunta=20 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gr.cod_regional=PcodRegional
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
											);

#--------------------pregunta 7-----------------------------------------------------------------------------------------------------------------------------
				(SELECT CONCAT('Suelos Erosionados ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
				if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi7),##ojo solo applique un round
				if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
				as totales from tbl_h_respuestas hr
				INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
				INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
				INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
				INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
				INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
						INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
						INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
		
				WHERE  vp.cod_pregunta=7 and 
				vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gr.cod_regional=PcodRegional
				GROUP BY d.cod_desicion
						UNION
    SELECT 'Suelos Erosionados SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
						INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
						INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
	
	WHERE  vp.cod_pregunta=7 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gr.cod_regional=PcodRegional
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Suelos Erosionados NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
	INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
	
	WHERE  vp.cod_pregunta=7 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gr.cod_regional=PcodRegional
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Suelos Erosionados QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
		INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
	INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
	
	WHERE  vp.cod_pregunta=7 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gr.cod_regional=PcodRegional
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
	
				
				
				
#--------------------pregunta8-----------------------------------------------------------------------------------------------------------------------------
		
				union
		
			(SELECT CONCAT('Baja Fertilidad de los Suelos ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
				if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi8),##ojo solo applique un round
				if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
				as totales from tbl_h_respuestas hr
				INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
				INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
				INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
				INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
					INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
	INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
	
				WHERE  vp.cod_pregunta=8 and 
				vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gr.cod_regional=PcodRegional
				GROUP BY d.cod_desicion
				
								UNION
    SELECT 'Baja Fertilidad de los Suelos SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
		INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
	INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
	
	WHERE  vp.cod_pregunta=8 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gr.cod_regional=PcodRegional
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Baja Fertilidad de los Suelos NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
	INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
	
	WHERE  vp.cod_pregunta=8 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gr.cod_regional=PcodRegional
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Baja Fertilidad de los Suelos QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
	INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
	
	WHERE  vp.cod_pregunta=8 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gr.cod_regional=PcodRegional
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
	
		
		
#----------------------pregunta 11-----------------------------------------------------------------------------------		
				union
		
				(SELECT CONCAT('Floracion Irregular ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
				if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi11),##ojo solo applique un round
				if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
				as totales from tbl_h_respuestas hr
				INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
				INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
				INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
				INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
	INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
	
				WHERE  vp.cod_pregunta=11 and 
				vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gr.cod_regional=PcodRegional
				GROUP BY d.cod_desicion
											UNION
    SELECT 'Floracion Irregular SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
	INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
	
	WHERE  vp.cod_pregunta=11 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gr.cod_regional=PcodRegional
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Floracion Irregular NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
	INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
	
	WHERE  vp.cod_pregunta=11 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gr.cod_regional=PcodRegional
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Floracion Irregular QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
	INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
	
	WHERE  vp.cod_pregunta=11 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gr.cod_regional=PcodRegional
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
	
		
#-------------------pregunta 12-----------------------------------------------------------------------------------------------------------------------------		
				union
		
				(SELECT CONCAT('Incremento en Caida de flores ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
				if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi12),##ojo solo applique un round
				if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
				as totales from tbl_h_respuestas hr
				INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
				INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
				INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
				INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
	INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
	
				WHERE  vp.cod_pregunta=12 and 
				vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gr.cod_regional=PcodRegional
				GROUP BY d.cod_desicion
				
					UNION
    SELECT 'Incremento en Caida de flores SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
	INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
	
	WHERE  vp.cod_pregunta=12 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gr.cod_regional=PcodRegional
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Incremento en Caida de flores NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
	INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
	
	WHERE  vp.cod_pregunta=12 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gr.cod_regional=PcodRegional
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Incremento en Caida de flores QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
	INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
	
	WHERE  vp.cod_pregunta=12 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gr.cod_regional=PcodRegional
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
	
		
#-----------------pregunta 13--------------------------------------------------------------------------------------------------------------------------		
				union
		
				(SELECT CONCAT('Incremento de Plagas y enfermedades ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
				if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi13),##ojo solo applique un round
				if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
				as totales from tbl_h_respuestas hr
				INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
				INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
				INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
				INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
	INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
	
				WHERE  vp.cod_pregunta=13 and 
				vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gr.cod_regional=PcodRegional
				GROUP BY d.cod_desicion
				
														UNION
    SELECT 'Incremento de Plagas y enfermedades SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
	INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
	
	WHERE  vp.cod_pregunta=13 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gr.cod_regional=PcodRegional
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Incremento de Plagas y enfermedades NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
	INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
	
	WHERE  vp.cod_pregunta=13 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gr.cod_regional=PcodRegional
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Incremento de Plagas y enfermedades QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
	INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
	
	WHERE  vp.cod_pregunta=13 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gr.cod_regional=PcodRegional
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
	
#-----------------pregunta 20--------------------------------------------------------------------------------------------------------------------------		
				union
		
				(SELECT CONCAT('Bajas en Productividad ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
				if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi20),##ojo solo applique un round
				if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
				as totales from tbl_h_respuestas hr
				INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
				INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
				INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
				INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
	INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
	
				WHERE  vp.cod_pregunta=20 and 
				vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gr.cod_regional=PcodRegional
				GROUP BY d.cod_desicion
				
				
													UNION
    SELECT 'Bajas en Productividad SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
		
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
	INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
	
	
	WHERE  vp.cod_pregunta=20 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gr.cod_regional=PcodRegional
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Bajas en Productividad NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
	INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
	
	WHERE  vp.cod_pregunta=20 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gr.cod_regional=PcodRegional
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Bajas en Productividad QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
	INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
	
	WHERE  vp.cod_pregunta=20 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gr.cod_regional=PcodRegional
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
							;
							
#------------------------------------------------------------------------------------------------------------------------------------							
#------------------------------------------------------------------------------------------------------------------------------------							
	elseif Pevento='factores de adaptabilidad' then


			set @restarSi9=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
	INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
						
						WHERE  vp.cod_pregunta=9 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gr.cod_regional=PcodRegional
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
									);	
			set @restarSi10=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
								
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
	INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
	
						
						WHERE  vp.cod_pregunta=10 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gr.cod_regional=PcodRegional
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
									);
						
			set @restarSi14=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
	INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
						
						WHERE  vp.cod_pregunta=14 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gr.cod_regional=PcodRegional
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
						);	
						
		set @restarSi15=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
							INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
	INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
						
						WHERE  vp.cod_pregunta=15 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gr.cod_regional=PcodRegional
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
								);	
						
		set @restarSi16=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
	INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
						
						WHERE  vp.cod_pregunta=16 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gr.cod_regional=PcodRegional
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
						);	
		set @restarSi17=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
	INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
						
						WHERE  vp.cod_pregunta=17 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gr.cod_regional=PcodRegional
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
								);	
		set @restarSi18=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
	INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
						
						WHERE  vp.cod_pregunta=18 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gr.cod_regional=PcodRegional
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
									);	
						
			set @restarSi19=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
							INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
	INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
			
						
						WHERE  vp.cod_pregunta=19 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gr.cod_regional=PcodRegional
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
									);	
						
			set @restarSi21=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
	INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
						
						WHERE  vp.cod_pregunta=21 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gr.cod_regional=PcodRegional
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
									);		
			set @restarSi22=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
	INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
						
						WHERE  vp.cod_pregunta=22 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gr.cod_regional=PcodRegional
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
						);
			set @restarSi23=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
	INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
						
						WHERE  vp.cod_pregunta=23 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gr.cod_regional=PcodRegional
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
										);			
						
			set @restarSi24=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
	INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
						
						WHERE  vp.cod_pregunta=24 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gr.cod_regional=PcodRegional
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
									);	
			set @restarSi25=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
	INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
						
						WHERE  vp.cod_pregunta=25 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gr.cod_regional=PcodRegional
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
										);																																	
#-----------------------------pregunta 9-------------------------------------------------------------------------------------------------------------
			(SELECT CONCAT('Practica de Conservacion ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi9),##ojo solo applique un round
			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
		
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
	INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
	
	
			WHERE  vp.cod_pregunta=9 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gr.cod_regional=PcodRegional
			GROUP BY d.cod_desicion
				UNION
    SELECT 'Practica de Conservacion SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
		
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
	INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
	
	
	WHERE  vp.cod_pregunta=9 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gr.cod_regional=PcodRegional
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Practica de Conservacion  NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
		
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
	INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
	
	
	WHERE  vp.cod_pregunta=9 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gr.cod_regional=PcodRegional
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Practica de Conservacion  QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
		
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
	INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
	
	
	WHERE  vp.cod_pregunta=9 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gr.cod_regional=PcodRegional
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
				union
#------------------------pregunta 10---------------------------------------------------------------------------------------------------				
		
			(SELECT CONCAT('Cobertura de Hiervas ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi10),##ojo solo applique un round
			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
	INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
	
			WHERE  vp.cod_pregunta=10 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gr.cod_regional=PcodRegional
			GROUP BY d.cod_desicion
			
				UNION
    SELECT 'Cobertura de Hiervas SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
	INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
	
	WHERE  vp.cod_pregunta=10 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gr.cod_regional=PcodRegional
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Cobertura de Hiervas  NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
	INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
	
	WHERE  vp.cod_pregunta=10 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gr.cod_regional=PcodRegional
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Cobertura de Hiervas  QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
	INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
	
	WHERE  vp.cod_pregunta=10 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gr.cod_regional=PcodRegional
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
			
			
#------------------------pregunta 14---------------------------------------------------------------------------------------------------		
			union
		
			(SELECT CONCAT('Diversificación de Cafetal ',d.desisicon,' ,QUIZAS,NO')as Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi14),##ojo solo applique un round
			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
	INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
	
			WHERE  vp.cod_pregunta=14 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gr.cod_regional=PcodRegional
			GROUP BY d.cod_desicion
			
				UNION
    SELECT 'Diversificación de Cafetal SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
	INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
	
	WHERE  vp.cod_pregunta=14 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gr.cod_regional=PcodRegional
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Diversificación de Cafetal NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
	INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
	
	WHERE  vp.cod_pregunta=14 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gr.cod_regional=PcodRegional
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Diversificación de Cafetal QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
	INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
	
	WHERE  vp.cod_pregunta=14 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gr.cod_regional=PcodRegional
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
			
		
#------------------------pregunta 15---------------------------------------------------------------------------------------------------		
			union
		
			(SELECT CONCAT('Cafetales Pleno Sol ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi15),##ojo solo applique un round
			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
	INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
	
			WHERE  vp.cod_pregunta=15 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gr.cod_regional=PcodRegional
			GROUP BY d.cod_desicion
			
			UNION
    SELECT 'Cafetales Pleno Sol SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
	INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
	
	WHERE  vp.cod_pregunta=15 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gr.cod_regional=PcodRegional
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Cafetales Pleno Sol NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
	INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
	
	WHERE  vp.cod_pregunta=15 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gr.cod_regional=PcodRegional
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Cafetales Pleno Sol QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
	INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
	
	WHERE  vp.cod_pregunta=15 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gr.cod_regional=PcodRegional
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
			
#------------------------pregunta 16---------------------------------------------------------------------------------------------------		
			union
		
			(SELECT CONCAT('Cafetales Viejos ',d.desisicon,' ,QUIZAS,NO')as Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi16),##ojo solo applique un round
			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
	INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
	
			WHERE  vp.cod_pregunta=16 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gr.cod_regional=PcodRegional
			GROUP BY d.cod_desicion
			
				
			UNION
    SELECT 'Cafetales Viejos SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
	INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
	
	WHERE  vp.cod_pregunta=16 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gr.cod_regional=PcodRegional
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Cafetales Viejos NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
	INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
	
	WHERE  vp.cod_pregunta=16 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gr.cod_regional=PcodRegional
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Cafetales Viejos QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
	INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
	
	WHERE  vp.cod_pregunta=16 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gr.cod_regional=PcodRegional
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
			
#------------------------pregunta 17---------------------------------------------------------------------------------------------------		
		
			union
		
			(SELECT CONCAT('Variedades de Café ',d.desisicon,' ,QUIZAS,NO')as Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi17),##ojo solo applique un round
			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
	INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
	
			WHERE  vp.cod_pregunta=17 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gr.cod_regional=PcodRegional
			GROUP BY d.cod_desicion
			
					
			UNION
    SELECT 'Variedades de Café  SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
	INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
	
	WHERE  vp.cod_pregunta=17 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gr.cod_regional=PcodRegional
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Variedades de Café  NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
	INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
	
	WHERE  vp.cod_pregunta=17 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gr.cod_regional=PcodRegional
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Variedades de Café  QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
	INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
	
	WHERE  vp.cod_pregunta=17 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gr.cod_regional=PcodRegional
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
			
#------------------------pregunta 18---------------------------------------------------------------------------------------------------		
				union
		
			(SELECT CONCAT('Manejo de Tejidos ',d.desisicon,' ,QUIZAS,NO')as Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi18),##ojo solo applique un round
			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
	INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
	
			WHERE  vp.cod_pregunta=18 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gr.cod_regional=PcodRegional
			GROUP BY d.cod_desicion
			
				
			UNION
    SELECT 'Manejo de Tejidos  SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
	INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
	
	WHERE  vp.cod_pregunta=18 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gr.cod_regional=PcodRegional
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Manejo de Tejidos  NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
	INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
	
	WHERE  vp.cod_pregunta=18 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gr.cod_regional=PcodRegional
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Manejo de Tejidos  QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
	INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
	
	WHERE  vp.cod_pregunta=18 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gr.cod_regional=PcodRegional
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
			
			
#------------------------pregunta 19---------------------------------------------------------------------------------------------------
			union
		
			(SELECT CONCAT('Resiembra de Café ',d.desisicon,' ,QUIZAS,NO') AS Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi19),##ojo solo applique un round
			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
	INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
	
			WHERE  vp.cod_pregunta=19 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gr.cod_regional=PcodRegional
			GROUP BY d.cod_desicion
			
				
			UNION
    SELECT 'Resiembra de Café  SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
	INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
	
	WHERE  vp.cod_pregunta=19 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gr.cod_regional=PcodRegional
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Resiembra de Café  NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
	INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
	
	WHERE  vp.cod_pregunta=19 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gr.cod_regional=PcodRegional
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Resiembra de Café  QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
	INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
	
	WHERE  vp.cod_pregunta=19 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gr.cod_regional=PcodRegional
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
			
			
#------------------------pregunta 21---------------------------------------------------------------------------------------------------		
			union
		
			(SELECT CONCAT('Aplicacion N/ha/ ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi21),##ojo solo applique un round
			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
	INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
	
			WHERE  vp.cod_pregunta=21 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gr.cod_regional=PcodRegional
			GROUP BY d.cod_desicion
				
			UNION
    SELECT 'Aplicacion N/ha/ SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
	INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
	
	WHERE  vp.cod_pregunta=21 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gr.cod_regional=PcodRegional
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Aplicacion N/ha/  NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
	INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
	
	WHERE  vp.cod_pregunta=21 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gr.cod_regional=PcodRegional
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Aplicacion N/ha/  QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
	INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
	
	WHERE  vp.cod_pregunta=21 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gr.cod_regional=PcodRegional
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
			
			
#------------------------pregunta 22---------------------------------------------------------------------------------------------------
			union
		
			(SELECT CONCAT('Aplicacion de Abanos ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi22),##ojo solo applique un round
			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
	INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
	
			WHERE  vp.cod_pregunta=22 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gr.cod_regional=PcodRegional
			GROUP BY d.cod_desicion
			UNION
    SELECT 'Aplicacion de Abanos SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
	INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
	
	WHERE  vp.cod_pregunta=22 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gr.cod_regional=PcodRegional
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Aplicacion de Abanos NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
	INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
	
	WHERE  vp.cod_pregunta=22 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gr.cod_regional=PcodRegional
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Aplicacion de Abanos QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
	INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
	
	WHERE  vp.cod_pregunta=22 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gr.cod_regional=PcodRegional
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
			
			
#------------------------pregunta 23---------------------------------------------------------------------------------------------------		
			UNION
		
			(SELECT CONCAT('Protección de Fuentes ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi23),##ojo solo applique un round
			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
	INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
	
			WHERE  vp.cod_pregunta=23 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gr.cod_regional=PcodRegional
			GROUP BY d.cod_desicion
			UNION
    SELECT 'Protección de Fuentes SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
	INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
	
	WHERE  vp.cod_pregunta=23 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gr.cod_regional=PcodRegional
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Protección de Fuentes NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
	INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
	
	WHERE  vp.cod_pregunta=23 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gr.cod_regional=PcodRegional
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Protección de Fuentes QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
	INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
	
	WHERE  vp.cod_pregunta=23 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gr.cod_regional=PcodRegional
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
#------------------------pregunta 24---------------------------------------------------------------------------------------------------			
			UNION
		
			(SELECT CONCAT('Otros usos de la finca están sin asocio con árboles ',d.desisicon,' ,QUIZAS,NO')as Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi24),##ojo solo applique un round
			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
	INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
	
			WHERE  vp.cod_pregunta=24 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gr.cod_regional=PcodRegional
			GROUP BY d.cod_desicion
			
			UNION
    SELECT 'Otros usos de la finca están sin asocio con árboles SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
	INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
	
	WHERE  vp.cod_pregunta=24 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gr.cod_regional=PcodRegional
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Otros usos de la finca están sin asocio con árboles NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
	INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
	
	WHERE  vp.cod_pregunta=24 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gr.cod_regional=PcodRegional
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Otros usos de la finca están sin asocio con árboles QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
	INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
	
	WHERE  vp.cod_pregunta=24 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gr.cod_regional=PcodRegional
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
			
#------------------------pregunta 25---------------------------------------------------------------------------------------------------			
			UNION
		
			(SELECT CONCAT('Procesos organizativos sobre mitigación y adaptación ',d.desisicon,' ,QUIZAS,NO')As Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi25),##ojo solo applique un round
			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
	INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
	
			WHERE  vp.cod_pregunta=25 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gr.cod_regional=PcodRegional
			GROUP BY d.cod_desicion
			UNION
    SELECT 'Procesos organizativos sobre mitigación y adaptación SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
	INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
	
	WHERE  vp.cod_pregunta=25 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gr.cod_regional=PcodRegional
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Procesos organizativos sobre mitigación y adaptación NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
	INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
	
	WHERE  vp.cod_pregunta=25 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gr.cod_regional=PcodRegional
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Procesos organizativos sobre mitigación y adaptación QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
	INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
	
	WHERE  vp.cod_pregunta=25 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gr.cod_regional=PcodRegional
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
			
			;


		end if;


#elseif PcodAgencia!='' then
	#	SELECT 'estas en agencia ' as mensaje;
end if;
END$$

CREATE DEFINER=`root`@`localhost` PROCEDURE `vulnerabilidadParametrosTecnico` (IN `Pevento` VARCHAR(50), IN `PanioInicio` VARCHAR(25), IN `PanioFinal` VARCHAR(25), IN `PcodTecnico` VARCHAR(25))  BEGIN
if PcodTecnico!='' then																																																			
	if Pevento='factores de exposicion' then
		set @restarSi1=(
							SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) 
							from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
							INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
							INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
							INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
							INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
							INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
							INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
						
							WHERE  vp.cod_pregunta=1 and d.cod_desicion=1 and vf.fecha_visita 
							BETWEEN PanioInicio and PanioFinal AND gt.cod_tecnico=PcodTecnico
							GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
								);
		set @restarSi2=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
						
						WHERE  vp.cod_pregunta=2 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gt.cod_tecnico=PcodTecnico
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
						);		
										
		set @restarSi3=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
						
						WHERE  vp.cod_pregunta=3 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gt.cod_tecnico=PcodTecnico
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
						);			
		set @restarSi4=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
						
						WHERE  vp.cod_pregunta=4 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gt.cod_tecnico=PcodTecnico
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
						);		
											
		set @restarSi5=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
						
						WHERE  vp.cod_pregunta=5 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gt.cod_tecnico=PcodTecnico
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
						);	
		set @restarSi6=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
						
						WHERE  vp.cod_pregunta=6 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gt.cod_tecnico=PcodTecnico
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
						);
#----------------------pregunta 1-------------------------------------------------------------------------------------------------------						
	(SELECT CONCAT('Cambio Temperatura ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
		if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi1),##ojo solo applique un round
		if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
		as totales from tbl_h_respuestas hr
		INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
		INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
		INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
		INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
 
		INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
		INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
	
		WHERE  vp.cod_pregunta=1 and 
		vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gt.cod_tecnico=PcodTecnico
		GROUP BY d.cod_desicion
		
	
    UNION
    SELECT 'Cambio Temperatura SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
	
	WHERE  vp.cod_pregunta=1 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gt.cod_tecnico=PcodTecnico
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Cambio Temperatura NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
	
	WHERE  vp.cod_pregunta=1 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gt.cod_tecnico=PcodTecnico
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Cambio Temperatura QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
	
	WHERE  vp.cod_pregunta=1 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gt.cod_tecnico=PcodTecnico
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
#--------------------------pregunta2------------------------------------------------------------------------------------------------------------------------
		union
		(SELECT CONCAT('Lluvias Irregulares ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
		if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi2),##ojo solo applique un round
		if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
		as totales from tbl_h_respuestas hr
		INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
		INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
		INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
		INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca

		INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
		INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
	
		WHERE  vp.cod_pregunta=2 and 
		vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gt.cod_tecnico=PcodTecnico
		GROUP BY d.cod_desicion
		
    UNION
    SELECT 'Lluvias Irregulares SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico

	WHERE  vp.cod_pregunta=2 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gt.cod_tecnico=PcodTecnico
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Lluvias Irregulares NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
	
	WHERE  vp.cod_pregunta=2 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gt.cod_tecnico=PcodTecnico
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Lluvias Irregulares QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
	
	WHERE  vp.cod_pregunta=2 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gt.cod_tecnico=PcodTecnico
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
		
		
#-------------------------pregunta 3----------------------------------------------------------------------------------------------------------------------		
	
		union
		(SELECT CONCAT('Aumento de Lluvias ',d.desisicon,' ,QUIZAS,NO')as Pregunta,
		if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi3),##ojo solo applique un round
		if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
		as totales from tbl_h_respuestas hr
		INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
		INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
		INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
		INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca

		INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
		INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
	
		WHERE  vp.cod_pregunta=3 and 
		vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gt.cod_tecnico=PcodTecnico
		GROUP BY d.cod_desicion
		
		UNION
    SELECT 'Aumento de Lluvias SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
	
	WHERE  vp.cod_pregunta=3 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gt.cod_tecnico=PcodTecnico
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Aumento de Lluvias NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
	
	WHERE  vp.cod_pregunta=3 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gt.cod_tecnico=PcodTecnico
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Aumento de Lluvias QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
	
	WHERE  vp.cod_pregunta=3 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gt.cod_tecnico=PcodTecnico
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
#--------------------pregunta 4------------------------------------------------------------------------------------------------------------------------		
			union
		(SELECT CONCAT('Riesgo de Huracanes ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
		if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi4),##ojo solo applique un round
		if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
		as totales from tbl_h_respuestas hr
		INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
		INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
		INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
		INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca

		INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
		INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
	
		WHERE  vp.cod_pregunta=4 and 
		vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gt.cod_tecnico=PcodTecnico
		GROUP BY d.cod_desicion
		UNION
    SELECT 'Riesgo de Huracanes SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
	
	WHERE  vp.cod_pregunta=4 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gt.cod_tecnico=PcodTecnico
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Riesgo de Huracanes NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
	
	WHERE  vp.cod_pregunta=4 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gt.cod_tecnico=PcodTecnico
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Riesgo de Huracanes QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
	
	WHERE  vp.cod_pregunta=4 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gt.cod_tecnico=PcodTecnico
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
#-----------------pregunta 5---------------------------------------------------------------------------------------------------------------------		
		
			union
		(SELECT CONCAT('Sequias ',d.desisicon,' ,QUIZAS,NO') as pregunta,
		if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi5),##ojo solo applique un round
		if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
		as totales from tbl_h_respuestas hr
		INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
		INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
		INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
		INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca

		INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
		INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
	
		WHERE  vp.cod_pregunta=5 and 
		vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gt.cod_tecnico=PcodTecnico
		GROUP BY d.cod_desicion
		UNION
    SELECT 'Sequias SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
	
	WHERE  vp.cod_pregunta=5 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gt.cod_tecnico=PcodTecnico
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Sequias NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
	
	WHERE  vp.cod_pregunta=5 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gt.cod_tecnico=PcodTecnico
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Sequias QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
	
	WHERE  vp.cod_pregunta=5 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gt.cod_tecnico=PcodTecnico
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
		
#------------------------pregunta 6--------------------------------------------------------------------------------------------------------------		
			union
		(SELECT CONCAT('Vientos Fuertes ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
		if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi6),##ojo solo applique un round
		if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
		as totales from tbl_h_respuestas hr
		INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
		INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
		INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
		INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca

		INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
		INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
	
		WHERE  vp.cod_pregunta=6 and 
		vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gt.cod_tecnico=PcodTecnico
		GROUP BY d.cod_desicion
		
		UNION
    SELECT 'Vientos Fuertes SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
	
	WHERE  vp.cod_pregunta=6 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gt.cod_tecnico=PcodTecnico
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Vientos Fuertes NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
	
	WHERE  vp.cod_pregunta=6 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gt.cod_tecnico=PcodTecnico
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Vientos Fuertes QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
	
	WHERE  vp.cod_pregunta=6 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gt.cod_tecnico=PcodTecnico
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
		;
		
#-------------------------------------------------------------------------------------------------------------------------------------------------
#-------------------------------------------------------------------------------------------------------------------------------------------------		
	elseif Pevento='factores de impacto' then

			set @restarSi7=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
						
						WHERE  vp.cod_pregunta=7 and d.cod_desicion=1 and vf.fecha_visita 
						BETWEEN PanioInicio and PanioFinal AND gt.cod_tecnico=PcodTecnico
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
										);
								
				set @restarSi8=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
						
						WHERE  vp.cod_pregunta=8 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gt.cod_tecnico=PcodTecnico
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
											);		
						
				set @restarSi11=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
						
						WHERE  vp.cod_pregunta=11 and d.cod_desicion=1 and vf.fecha_visita 
						BETWEEN PanioInicio and PanioFinal AND gt.cod_tecnico=PcodTecnico
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
											);		
						
					set @restarSi12=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
						
						WHERE  vp.cod_pregunta=12 and d.cod_desicion=1 and vf.fecha_visita 
						BETWEEN PanioInicio and PanioFinal AND gt.cod_tecnico=PcodTecnico
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
											);																					
																							
				set @restarSi13=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
						
						WHERE  vp.cod_pregunta=13 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gt.cod_tecnico=PcodTecnico
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
										);	
						
				set @restarSi20=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
						
						WHERE  vp.cod_pregunta=20 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gt.cod_tecnico=PcodTecnico
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
											);

#--------------------pregunta 7-----------------------------------------------------------------------------------------------------------------------------
				(SELECT CONCAT('Suelos Erosionados ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
				if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi7),##ojo solo applique un round
				if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
				as totales from tbl_h_respuestas hr
				INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
				INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
				INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
				INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
				INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
				INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
		
				WHERE  vp.cod_pregunta=7 and 
				vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gt.cod_tecnico=PcodTecnico
				GROUP BY d.cod_desicion
						UNION
    SELECT 'Suelos Erosionados SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
	
	WHERE  vp.cod_pregunta=7 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gt.cod_tecnico=PcodTecnico
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Suelos Erosionados NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
	
	WHERE  vp.cod_pregunta=7 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gt.cod_tecnico=PcodTecnico
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Suelos Erosionados QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
	
	WHERE  vp.cod_pregunta=7 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gt.cod_tecnico=PcodTecnico
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
	
				
				
				
#--------------------pregunta8-----------------------------------------------------------------------------------------------------------------------------
		
				union
		
			(SELECT CONCAT('Baja Fertilidad de los Suelos ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
				if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi8),##ojo solo applique un round
				if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
				as totales from tbl_h_respuestas hr
				INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
				INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
				INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
				INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
				INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
				INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
	
				WHERE  vp.cod_pregunta=8 and 
				vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gt.cod_tecnico=PcodTecnico
				GROUP BY d.cod_desicion
				
								UNION
    SELECT 'Baja Fertilidad de los Suelos SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
	
	WHERE  vp.cod_pregunta=8 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gt.cod_tecnico=PcodTecnico
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Baja Fertilidad de los Suelos NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
	
	WHERE  vp.cod_pregunta=8 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gt.cod_tecnico=PcodTecnico
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Baja Fertilidad de los Suelos QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
	
	WHERE  vp.cod_pregunta=8 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gt.cod_tecnico=PcodTecnico
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
	
		
		
#----------------------pregunta 11-----------------------------------------------------------------------------------		
				union
		
				(SELECT CONCAT('Floracion Irregular ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
				if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi11),##ojo solo applique un round
				if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
				as totales from tbl_h_respuestas hr
				INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
				INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
				INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
				INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
				INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
				INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
	
				WHERE  vp.cod_pregunta=11 and 
				vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gt.cod_tecnico=PcodTecnico
				GROUP BY d.cod_desicion
											UNION
    SELECT 'Floracion Irregular SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
	
	WHERE  vp.cod_pregunta=11 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gt.cod_tecnico=PcodTecnico
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Floracion Irregular NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
	
	WHERE  vp.cod_pregunta=11 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gt.cod_tecnico=PcodTecnico
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Floracion Irregular QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
	
	WHERE  vp.cod_pregunta=11 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gt.cod_tecnico=PcodTecnico
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
	
		
#-------------------pregunta 12-----------------------------------------------------------------------------------------------------------------------------		
				union
		
				(SELECT CONCAT('Incremento en Caida de flores ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
				if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi12),##ojo solo applique un round
				if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
				as totales from tbl_h_respuestas hr
				INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
				INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
				INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
				INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
				INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
				INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
	
				WHERE  vp.cod_pregunta=12 and 
				vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gt.cod_tecnico=PcodTecnico
				GROUP BY d.cod_desicion
				
					UNION
    SELECT 'Incremento en Caida de flores SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
	
	WHERE  vp.cod_pregunta=12 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gt.cod_tecnico=PcodTecnico
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Incremento en Caida de flores NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
	
	WHERE  vp.cod_pregunta=12 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gt.cod_tecnico=PcodTecnico
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Incremento en Caida de flores QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
	
	WHERE  vp.cod_pregunta=12 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gt.cod_tecnico=PcodTecnico
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
	
		
#-----------------pregunta 13--------------------------------------------------------------------------------------------------------------------------		
				union
		
				(SELECT CONCAT('Incremento de Plagas y enfermedades ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
				if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi13),##ojo solo applique un round
				if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
				as totales from tbl_h_respuestas hr
				INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
				INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
				INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
				INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
				INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
				INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
	
				WHERE  vp.cod_pregunta=13 and 
				vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gt.cod_tecnico=PcodTecnico
				GROUP BY d.cod_desicion
				
														UNION
    SELECT 'Incremento de Plagas y enfermedades SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
	
	WHERE  vp.cod_pregunta=13 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gt.cod_tecnico=PcodTecnico
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Incremento de Plagas y enfermedades NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
	
	WHERE  vp.cod_pregunta=13 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gt.cod_tecnico=PcodTecnico
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Incremento de Plagas y enfermedades QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
	
	WHERE  vp.cod_pregunta=13 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gt.cod_tecnico=PcodTecnico
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
	
#-----------------pregunta 20--------------------------------------------------------------------------------------------------------------------------		
				union
		
				(SELECT CONCAT('Bajas en Productividad ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
				if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi20),##ojo solo applique un round
				if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
				as totales from tbl_h_respuestas hr
				INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
				INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
				INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
				INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
				INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
				INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
	
				WHERE  vp.cod_pregunta=20 and 
				vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gt.cod_tecnico=PcodTecnico
				GROUP BY d.cod_desicion
				
				
													UNION
    SELECT 'Bajas en Productividad SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
	
	WHERE  vp.cod_pregunta=20 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gt.cod_tecnico=PcodTecnico
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Bajas en Productividad NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
	
	WHERE  vp.cod_pregunta=20 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gt.cod_tecnico=PcodTecnico
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Bajas en Productividad QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
	
	WHERE  vp.cod_pregunta=20 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gt.cod_tecnico=PcodTecnico
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
							;
							
#------------------------------------------------------------------------------------------------------------------------------------							
#------------------------------------------------------------------------------------------------------------------------------------							
	elseif Pevento='factores de adaptabilidad' then


			set @restarSi9=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
						
						WHERE  vp.cod_pregunta=9 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gt.cod_tecnico=PcodTecnico
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
									);	
			set @restarSi10=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
						
						WHERE  vp.cod_pregunta=10 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gt.cod_tecnico=PcodTecnico
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
									);
						
			set @restarSi14=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
						
						WHERE  vp.cod_pregunta=14 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gt.cod_tecnico=PcodTecnico
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
						);	
						
		set @restarSi15=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
						
						WHERE  vp.cod_pregunta=15 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gt.cod_tecnico=PcodTecnico
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
								);	
						
		set @restarSi16=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
						
						WHERE  vp.cod_pregunta=16 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gt.cod_tecnico=PcodTecnico
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
						);	
		set @restarSi17=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
						
						WHERE  vp.cod_pregunta=17 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gt.cod_tecnico=PcodTecnico
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
								);	
		set @restarSi18=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
						
						WHERE  vp.cod_pregunta=18 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gt.cod_tecnico=PcodTecnico
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
									);	
						
			set @restarSi19=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
						
						WHERE  vp.cod_pregunta=19 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gt.cod_tecnico=PcodTecnico
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
									);	
						
			set @restarSi21=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
						
						WHERE  vp.cod_pregunta=21 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gt.cod_tecnico=PcodTecnico
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
									);		
			set @restarSi22=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
						
						WHERE  vp.cod_pregunta=22 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gt.cod_tecnico=PcodTecnico
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
						);
			set @restarSi23=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
						
						WHERE  vp.cod_pregunta=23 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gt.cod_tecnico=PcodTecnico
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
										);			
						
			set @restarSi24=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
						
						WHERE  vp.cod_pregunta=24 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gt.cod_tecnico=PcodTecnico
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
									);	
			set @restarSi25=(
						SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) as total_restar 
						from (select COUNT(d.cod_desicion) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
						
						WHERE  vp.cod_pregunta=25 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal AND gt.cod_tecnico=PcodTecnico
						GROUP BY hr.cod_finca HAVING COUNT(*)>1) as total limit 1
										);																																	
#-----------------------------pregunta 9-------------------------------------------------------------------------------------------------------------
			(SELECT CONCAT('Practica de Conservacion ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi9),##ojo solo applique un round
			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
			INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
			INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
	
			WHERE  vp.cod_pregunta=9 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gt.cod_tecnico=PcodTecnico
			GROUP BY d.cod_desicion
				UNION
    SELECT 'Practica de Conservacion SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
	
	WHERE  vp.cod_pregunta=9 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gt.cod_tecnico=PcodTecnico
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Practica de Conservacion  NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
	
	WHERE  vp.cod_pregunta=9 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gt.cod_tecnico=PcodTecnico
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Practica de Conservacion  QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
	
	WHERE  vp.cod_pregunta=9 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gt.cod_tecnico=PcodTecnico
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
				union
#------------------------pregunta 10---------------------------------------------------------------------------------------------------				
		
			(SELECT CONCAT('Cobertura de Hiervas ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi10),##ojo solo applique un round
			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
			INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
			INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
	
			WHERE  vp.cod_pregunta=10 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gt.cod_tecnico=PcodTecnico
			GROUP BY d.cod_desicion
			
				UNION
    SELECT 'Cobertura de Hiervas SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
	
	WHERE  vp.cod_pregunta=10 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gt.cod_tecnico=PcodTecnico
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Cobertura de Hiervas  NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
	
	WHERE  vp.cod_pregunta=10 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gt.cod_tecnico=PcodTecnico
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Cobertura de Hiervas  QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
	
	WHERE  vp.cod_pregunta=10 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gt.cod_tecnico=PcodTecnico
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
			
			
#------------------------pregunta 14---------------------------------------------------------------------------------------------------		
			union
		
			(SELECT CONCAT('Diversificación de Cafetal ',d.desisicon,' ,QUIZAS,NO')as Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi14),##ojo solo applique un round
			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
			INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
			INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
	
			WHERE  vp.cod_pregunta=14 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gt.cod_tecnico=PcodTecnico
			GROUP BY d.cod_desicion
			
				UNION
    SELECT 'Diversificación de Cafetal SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
	
	WHERE  vp.cod_pregunta=14 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gt.cod_tecnico=PcodTecnico
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Diversificación de Cafetal NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
	
	WHERE  vp.cod_pregunta=14 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gt.cod_tecnico=PcodTecnico
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Diversificación de Cafetal QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
	
	WHERE  vp.cod_pregunta=14 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gt.cod_tecnico=PcodTecnico
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
			
		
#------------------------pregunta 15---------------------------------------------------------------------------------------------------		
			union
		
			(SELECT CONCAT('Cafetales Pleno Sol ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi15),##ojo solo applique un round
			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
			INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
			INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
	
			WHERE  vp.cod_pregunta=15 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gt.cod_tecnico=PcodTecnico
			GROUP BY d.cod_desicion
			
			UNION
    SELECT 'Cafetales Pleno Sol SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
	
	WHERE  vp.cod_pregunta=15 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gt.cod_tecnico=PcodTecnico
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Cafetales Pleno Sol NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
	
	WHERE  vp.cod_pregunta=15 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gt.cod_tecnico=PcodTecnico
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Cafetales Pleno Sol QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
	
	WHERE  vp.cod_pregunta=15 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gt.cod_tecnico=PcodTecnico
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
			
#------------------------pregunta 16---------------------------------------------------------------------------------------------------		
			union
		
			(SELECT CONCAT('Cafetales Viejos ',d.desisicon,' ,QUIZAS,NO')as Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi16),##ojo solo applique un round
			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
			INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
			INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
	
			WHERE  vp.cod_pregunta=16 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gt.cod_tecnico=PcodTecnico
			GROUP BY d.cod_desicion
			
				
			UNION
    SELECT 'Cafetales Viejos SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
	
	WHERE  vp.cod_pregunta=16 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gt.cod_tecnico=PcodTecnico
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Cafetales Viejos NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
	
	WHERE  vp.cod_pregunta=16 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gt.cod_tecnico=PcodTecnico
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Cafetales Viejos QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
	
	WHERE  vp.cod_pregunta=16 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gt.cod_tecnico=PcodTecnico
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
			
#------------------------pregunta 17---------------------------------------------------------------------------------------------------		
		
			union
		
			(SELECT CONCAT('Variedades de Café ',d.desisicon,' ,QUIZAS,NO')as Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi17),##ojo solo applique un round
			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
			INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
			INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
	
			WHERE  vp.cod_pregunta=17 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gt.cod_tecnico=PcodTecnico
			GROUP BY d.cod_desicion
			
					
			UNION
    SELECT 'Variedades de Café  SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
	
	WHERE  vp.cod_pregunta=17 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gt.cod_tecnico=PcodTecnico
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Variedades de Café  NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
	
	WHERE  vp.cod_pregunta=17 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gt.cod_tecnico=PcodTecnico
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Variedades de Café  QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
	
	WHERE  vp.cod_pregunta=17 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gt.cod_tecnico=PcodTecnico
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
			
#------------------------pregunta 18---------------------------------------------------------------------------------------------------		
				union
		
			(SELECT CONCAT('Manejo de Tejidos ',d.desisicon,' ,QUIZAS,NO')as Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi18),##ojo solo applique un round
			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
			INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
			INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
	
			WHERE  vp.cod_pregunta=18 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gt.cod_tecnico=PcodTecnico
			GROUP BY d.cod_desicion
			
				
			UNION
    SELECT 'Manejo de Tejidos  SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
	
	WHERE  vp.cod_pregunta=18 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gt.cod_tecnico=PcodTecnico
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Manejo de Tejidos  NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
	
	WHERE  vp.cod_pregunta=18 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gt.cod_tecnico=PcodTecnico
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Manejo de Tejidos  QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
	
	WHERE  vp.cod_pregunta=18 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gt.cod_tecnico=PcodTecnico
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
		
			
			
#------------------------pregunta 19---------------------------------------------------------------------------------------------------
			union
		
			(SELECT CONCAT('Resiembra de Café ',d.desisicon,' ,QUIZAS,NO') AS Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi19),##ojo solo applique un round
			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
			INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
			INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
	
			WHERE  vp.cod_pregunta=19 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gt.cod_tecnico=PcodTecnico
			GROUP BY d.cod_desicion
			
				
			UNION
    SELECT 'Resiembra de Café  SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
	
	WHERE  vp.cod_pregunta=19 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gt.cod_tecnico=PcodTecnico
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Resiembra de Café  NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
	
	WHERE  vp.cod_pregunta=19 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gt.cod_tecnico=PcodTecnico
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Resiembra de Café  QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
	
	WHERE  vp.cod_pregunta=19 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gt.cod_tecnico=PcodTecnico
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
			
			
#------------------------pregunta 21---------------------------------------------------------------------------------------------------		
			union
		
			(SELECT CONCAT('Aplicacion N/ha/ ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi21),##ojo solo applique un round
			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
			INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
			INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
	
			WHERE  vp.cod_pregunta=21 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gt.cod_tecnico=PcodTecnico
			GROUP BY d.cod_desicion
				
			UNION
    SELECT 'Aplicacion N/ha/ SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
	
	WHERE  vp.cod_pregunta=21 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gt.cod_tecnico=PcodTecnico
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Aplicacion N/ha/  NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
	
	WHERE  vp.cod_pregunta=21 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gt.cod_tecnico=PcodTecnico
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Aplicacion N/ha/  QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
	
	WHERE  vp.cod_pregunta=21 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gt.cod_tecnico=PcodTecnico
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
			
			
#------------------------pregunta 22---------------------------------------------------------------------------------------------------
			union
		
			(SELECT CONCAT('Aplicacion de Abanos ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi22),##ojo solo applique un round
			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
			INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
			INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
	
			WHERE  vp.cod_pregunta=22 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gt.cod_tecnico=PcodTecnico
			GROUP BY d.cod_desicion
			UNION
    SELECT 'Aplicacion de Abanos SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
	
	WHERE  vp.cod_pregunta=22 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gt.cod_tecnico=PcodTecnico
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Aplicacion de Abanos NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
	
	WHERE  vp.cod_pregunta=22 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gt.cod_tecnico=PcodTecnico
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Aplicacion de Abanos QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
	
	WHERE  vp.cod_pregunta=22 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gt.cod_tecnico=PcodTecnico
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
			
			
#------------------------pregunta 23---------------------------------------------------------------------------------------------------		
			UNION
		
			(SELECT CONCAT('Protección de Fuentes ',d.desisicon,' ,QUIZAS,NO') as Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi23),##ojo solo applique un round
			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
			INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
			INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
	
			WHERE  vp.cod_pregunta=23 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gt.cod_tecnico=PcodTecnico
			GROUP BY d.cod_desicion
			UNION
    SELECT 'Protección de Fuentes SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
	
	WHERE  vp.cod_pregunta=23 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gt.cod_tecnico=PcodTecnico
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Protección de Fuentes NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
	
	WHERE  vp.cod_pregunta=23 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gt.cod_tecnico=PcodTecnico
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Protección de Fuentes QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
	
	WHERE  vp.cod_pregunta=23 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gt.cod_tecnico=PcodTecnico
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
#------------------------pregunta 24---------------------------------------------------------------------------------------------------			
			UNION
		
			(SELECT CONCAT('Otros usos de la finca están sin asocio con árboles ',d.desisicon,' ,QUIZAS,NO')as Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi24),##ojo solo applique un round
			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
			INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
			INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
	
			WHERE  vp.cod_pregunta=24 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gt.cod_tecnico=PcodTecnico
			GROUP BY d.cod_desicion
			
			UNION
    SELECT 'Otros usos de la finca están sin asocio con árboles SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
	
	WHERE  vp.cod_pregunta=24 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gt.cod_tecnico=PcodTecnico
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Otros usos de la finca están sin asocio con árboles NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
	
	WHERE  vp.cod_pregunta=24 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gt.cod_tecnico=PcodTecnico
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Otros usos de la finca están sin asocio con árboles QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
	
	WHERE  vp.cod_pregunta=24 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gt.cod_tecnico=PcodTecnico
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
			
#------------------------pregunta 25---------------------------------------------------------------------------------------------------			
			UNION
		
			(SELECT CONCAT('Procesos organizativos sobre mitigación y adaptación ',d.desisicon,' ,QUIZAS,NO')As Pregunta,
			if(d.cod_desicion=1,ROUND(COUNT(d.cod_desicion)-@restarSi25),##ojo solo applique un round
			if(d.cod_desicion=2,COUNT(d.cod_desicion),COUNT(d.cod_desicion))) 
			as totales from tbl_h_respuestas hr
			INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
		
			INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
			INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
	
			WHERE  vp.cod_pregunta=25 and 
			vf.fecha_visita BETWEEN PanioInicio and PanioFinal AND gt.cod_tecnico=PcodTecnico
			GROUP BY d.cod_desicion
			UNION
    SELECT 'Procesos organizativos sobre mitigación y adaptación SI ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 1,ROUND(COUNT(d.cod_desicion) - @restarSi),'no se encuentra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	RIGHT JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	RIGHT JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
	
	WHERE  vp.cod_pregunta=25 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gt.cod_tecnico=PcodTecnico
	GROUP BY d.desisicon 
	)
	
	UNION
    SELECT 'Procesos organizativos sobre mitigación y adaptación NO ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(IF(d.cod_desicion = 2, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
	
	WHERE  vp.cod_pregunta=25 and d.cod_desicion=2 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gt.cod_tecnico=PcodTecnico
	GROUP BY d.desisicon 
	
	 )
	UNION
    SELECT 'Procesos organizativos sobre mitigación y adaptación QUIZAS ,QUIZAS,NO', 0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
(IF(d.cod_desicion = 3, COUNT(d.cod_desicion),'no se encuntra'))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca	
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
	
	WHERE  vp.cod_pregunta=25 and d.cod_desicion=3 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gt.cod_tecnico=PcodTecnico
	GROUP BY d.desisicon 
	)ORDER BY Pregunta ASC)
			
			;


		end if;


#elseif PcodAgencia!='' then
	#	SELECT 'estas en agencia ' as mensaje;
end if;
END$$

CREATE DEFINER=`root`@`localhost` PROCEDURE `VulnerabilidadRankinRecomendaciones` ()  BEGIN
	SELECT CONCAT(vp.cod_pregunta,'-',vr.cod_respuesta,'-(',TRIM(SUBSTR(vr.respuesta,1,50))) AS Recomendaciones,count(hr.cod_respuesta) as total from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	WHERE vr.respuesta<>''
	GROUP BY vr.respuesta ORDER BY count(hr.cod_respuesta) DESC LIMIT 10;

END$$

CREATE DEFINER=`root`@`localhost` PROCEDURE `vulnerabilidadRankinRecomendacionesAgencia` (IN `PanioInicio` VARCHAR(25), IN `PanioFinal` VARCHAR(25), IN `PcodAgencia` VARCHAR(25))  BEGIN




	SELECT CONCAT(vp.cod_pregunta,'-',vr.cod_respuesta,'-(',TRIM(SUBSTR(vr.respuesta,1,50))) AS Recomendaciones,count(hr.cod_respuesta) as total 
	from 		tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on gf.cod_finca=vf.cod_finca	
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
	
	
	WHERE vr.respuesta<>'' and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	and ga.cod_agencia=PcodAgencia
	
	
	GROUP BY vr.respuesta
	ORDER BY count(hr.cod_respuesta) DESC LIMIT 10;

	




END$$

CREATE DEFINER=`root`@`localhost` PROCEDURE `vulnerabilidadRankinRecomendacionesFecha` (IN `PanioInicio` VARCHAR(25), IN `PanioFinal` VARCHAR(25))  BEGIN




	SELECT CONCAT(vp.cod_pregunta,'-',vr.cod_respuesta,'-(',TRIM(SUBSTR(vr.respuesta,1,50))) AS Recomendaciones,count(hr.cod_respuesta) as total 
	from 		tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	INNER JOIN tbl_vulnerabilidades_ficha vf on gf.cod_finca=vf.cod_finca	
	WHERE vr.respuesta<>'' and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	
	GROUP BY vr.respuesta
	ORDER BY count(hr.cod_respuesta) DESC LIMIT 10;
	




END$$

CREATE DEFINER=`root`@`localhost` PROCEDURE `vulnerabilidadRankinRecomendacionesRegional` (IN `PanioInicio` VARCHAR(25), IN `PanioFinal` VARCHAR(25), IN `Pregional` VARCHAR(25))  BEGIN


	SELECT CONCAT(vp.cod_pregunta,'-',vr.cod_respuesta,'-(',TRIM(SUBSTR(vr.respuesta,1,50))) AS Recomendaciones,count(hr.cod_respuesta) as total 
	from 		tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on gf.cod_finca=vf.cod_finca	
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
	INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
	
	
	
	WHERE vr.respuesta<>'' and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	and gr.cod_regional=Pregional
	
	
	GROUP BY vr.respuesta
	ORDER BY count(hr.cod_respuesta) DESC LIMIT 10;

	


END$$

CREATE DEFINER=`root`@`localhost` PROCEDURE `vulnerabilidadRankinRecomendaciones_contador_Agencia` (IN `PanioInicio` VARCHAR(25), IN `PanioFinal` VARCHAR(25), IN `PcodAgencia` VARCHAR(25))  BEGIN

	SELECT SUM(total) from (
	
		SELECT CONCAT(vp.cod_pregunta,'-',vr.cod_respuesta,'-(',TRIM(SUBSTR(vr.respuesta,1,50))) AS Recomendaciones,count(hr.cod_respuesta) as total 
	from 		tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on gf.cod_finca=vf.cod_finca	
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia

	
	
	
	WHERE vr.respuesta<>'' and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	and ga.cod_agencia=PcodAgencia
	
	
	GROUP BY vr.respuesta
	ORDER BY count(hr.cod_respuesta) DESC LIMIT 10
	
	) as total
	;





END$$

CREATE DEFINER=`root`@`localhost` PROCEDURE `vulnerabilidadRankinRecomendaciones_contador_fecha` (IN `PanioInicio` VARCHAR(25), IN `PanioFinal` VARCHAR(25))  BEGIN

	SELECT SUM(total) from (
	
		SELECT CONCAT(vp.cod_pregunta,'-',vr.cod_respuesta,'-(',TRIM(SUBSTR(vr.respuesta,1,50))) AS Recomendaciones,count(hr.cod_respuesta) as total 
	from 		tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on gf.cod_finca=vf.cod_finca	

	
	
	
	WHERE vr.respuesta<>'' and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	
	
	
	GROUP BY vr.respuesta
	ORDER BY count(hr.cod_respuesta) DESC LIMIT 10
	
	) as total
	;





END$$

CREATE DEFINER=`root`@`localhost` PROCEDURE `vulnerabilidadRankinRecomendaciones_contador_regional` (IN `PanioInicio` VARCHAR(25), IN `PanioFinal` VARCHAR(25), IN `PcodRegional` VARCHAR(25))  BEGIN

	SELECT SUM(total) from (
	
		SELECT CONCAT(vp.cod_pregunta,'-',vr.cod_respuesta,'-(',TRIM(SUBSTR(vr.respuesta,1,50))) AS Recomendaciones,count(hr.cod_respuesta) as total 
	from 		tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on gf.cod_finca=vf.cod_finca	
	INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
	INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
	
	
	
	WHERE vr.respuesta<>'' and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	and gr.cod_regional=PcodRegional
	
	
	GROUP BY vr.respuesta
	ORDER BY count(hr.cod_respuesta) DESC LIMIT 10
	
	) as total
	;





END$$

CREATE DEFINER=`root`@`localhost` PROCEDURE `vulnerabilidad_contador` (IN `p_año_inicio` INT, IN `p_año_final` INT, IN `p_fecha_inicio` INT, IN `p_fecha_final` INT, IN `p_departamento` INT, IN `p_nombre_evento` VARCHAR(50))  BEGIN

set @totalficha=((SELECT count(cod_vulnerabilidad) from tbl_vulnerabilidades_ficha));
case	
			WHEN UPPER(p_nombre_evento)='Factores de exposicion' THEN

set @totalpregunta=(



			SELECT 	COUNT(vr.respuesta) as cantidad from tbl_h_respuestas hr 
			INNER JOIN   tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN   tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN   tbl_vulnerabilidad_desicion d ON vr.cod_desicion = d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
			INNER JOIN tbl_vulnerabilidades_ficha vf on gf.cod_finca=vf.cod_finca
			
			INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
			INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
			WHERE d.cod_desicion BETWEEN 1 and 3 and vp.cod_pregunta BETWEEN 1 and 3 
			and SUBSTRING(vf.fecha_visita,1,4) BETWEEN p_año_inicio and p_año_final
			and SUBSTRING(vf.fecha_visita,6,2) BETWEEN p_fecha_inicio and p_fecha_final
			and gd.cod_depart=p_departamento LIMIT 1
			 );


	SELECT "FICHAS: ",concat(@totalficha,'/',@totalficha,'pregunta 1 al 4') from ihcafemonitoreo.tbl_vulnerabilidades_ficha LIMIT 1;
			
	
END CASE;
END$$

CREATE DEFINER=`root`@`localhost` PROCEDURE `vulnerabilidad_contador_agencia` (IN `Pevento` VARCHAR(50), IN `PanioInicio` VARCHAR(25), IN `PanioFinal` VARCHAR(25), IN `PcodAgencia` VARCHAR(25))  BEGIN
	 
	 
if PcodAgencia!='' THEN
	set @restarSi=(
	SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) 
						from (
						select COUNT(d.desisicon) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						 INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
								INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
							INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
						
						WHERE  vp.cod_pregunta=1 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal and gp.cod_agencia=PcodAgencia
						GROUP BY hr.cod_finca HAVING COUNT(*)>1
						) as total limit 1
								);
								##TRAER DESDE TBL DE FICHAS 
	set @totalFichas=	(SELECT COUNT(vf.cod_vulnerabilidad) FROM tbl_vulnerabilidades_ficha vf);
	
if Pevento='factores de exposicion' or Pevento='factores de impacto'	then
	
	SELECT CONCAT((ROUND(COUNT(d.cod_desicion)-@restarSi)),'/',@totalFichas)
		
		as totales
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
							INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=1 and vf.fecha_visita  BETWEEN PanioInicio and PanioFinal
	AND gp.cod_agencia=PcodAgencia
	UNION
    SELECT  0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(ROUND(COUNT(d.cod_desicion)-@restarSi))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
							INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=1 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_agencia=PcodAgencia
	GROUP BY d.desisicon 
	)
	
	
	#ORDER BY etiqueta ASC
	;
end if;

end if;

END$$

CREATE DEFINER=`root`@`localhost` PROCEDURE `vulnerabilidad_contador_departamento` (IN `Pevento` VARCHAR(50), IN `PanioInicio` VARCHAR(25), IN `PanioFinal` VARCHAR(25), IN `PcodDepartamento` VARCHAR(25))  BEGIN
	 
	 
if PcodDepartamento!='' THEN
	set @restarSi=(
	SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) 
						from (
						select COUNT(d.desisicon) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						 INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
						INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
						
						WHERE  vp.cod_pregunta=1 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal and gd.cod_depart=PcodDepartamento
						GROUP BY hr.cod_finca HAVING COUNT(*)>1
						) as total limit 1
								);
								##TRAER DESDE TBL DE FICHAS 
	set @totalFichas=	(SELECT COUNT(vf.cod_vulnerabilidad) FROM tbl_vulnerabilidades_ficha vf);
	
if Pevento='factores de exposicion' or Pevento='factores de impacto'	then
	
	SELECT CONCAT((ROUND(COUNT(d.cod_desicion)-@restarSi)),'/',@totalFichas)
		
		as totales
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=1 and vf.fecha_visita  BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart=PcodDepartamento
	
	
	
	#ORDER BY etiqueta ASC
	;
end if;

end if;

END$$

CREATE DEFINER=`root`@`localhost` PROCEDURE `vulnerabilidad_contador_euroclima` (IN `Pevento` VARCHAR(50), IN `PanioInicio` VARCHAR(25), IN `PanioFinal` VARCHAR(25))  BEGIN
	 
	 
if Pevento!='' THEN
	set @restarSi=(
	SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) 
						from (
						select COUNT(d.desisicon) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						 INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
						INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
						
						WHERE  vp.cod_pregunta=1 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal and gd.cod_depart IN (4,12,13,14)
						GROUP BY hr.cod_finca HAVING COUNT(*)>1
						) as total limit 1
								);
								##TRAER DESDE TBL DE FICHAS 
	set @totalFichas=	(SELECT COUNT(vf.cod_vulnerabilidad) FROM tbl_vulnerabilidades_ficha vf);
	
if Pevento='factores de exposicion' or Pevento='factores de impacto'	or Pevento='factores de adaptabilidad' then
	
	SELECT CONCAT((ROUND(COUNT(d.cod_desicion)-@restarSi)),'/',@totalFichas)
		
		as totales
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
	INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio	
	INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
	
	WHERE  vp.cod_pregunta=1 and vf.fecha_visita  BETWEEN PanioInicio and PanioFinal
	AND gd.cod_depart IN (4,12,13,14)
	
	
	
	#ORDER BY etiqueta ASC
	;
end if;

end if;

END$$

CREATE DEFINER=`root`@`localhost` PROCEDURE `vulnerabilidad_contador_Euroclima_fecha` (IN `Pevento` VARCHAR(50), IN `PanioInicio` VARCHAR(25), IN `PanioFinal` VARCHAR(25))  BEGIN
	 
	 

	set @restarSi=(
	SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) 
						from (
						select COUNT(d.desisicon) as total from tbl_h_respuestas hr
					INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
							INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
							INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
							INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
							INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
							INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
							INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
						
						
						WHERE  vp.cod_pregunta=1 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal and gd.cod_depart in(4,12,13,14)
						GROUP BY hr.cod_finca HAVING COUNT(*)>1
						) as total limit 1
								);
								##TRAER DESDE TBL DE FICHAS 
	set @totalFichas=	(SELECT COUNT(vf.cod_vulnerabilidad) FROM tbl_vulnerabilidades_ficha vf);
	
if Pevento<>''	then
	
	SELECT CONCAT((ROUND(COUNT(d.cod_desicion)-@restarSi)),'/',@totalFichas)
		
		as totales
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
							INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
							INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
							INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
							INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
							INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
							INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
						
	WHERE  vp.cod_pregunta=1 and vf.fecha_visita  BETWEEN PanioInicio and PanioFinal and gd.cod_depart in(4,12,13,14)
	
	

	
	
	#ORDER BY etiqueta ASC
	;
end if;


END$$

CREATE DEFINER=`root`@`localhost` PROCEDURE `vulnerabilidad_contador_Euroclima_fecha_genero` (IN `Pevento` VARCHAR(50), IN `PanioInicio` VARCHAR(25), IN `PanioFinal` VARCHAR(25))  BEGIN
	 
	 

	set @restarSi=(
	SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) 
						from (
						select COUNT(d.desisicon) as total from tbl_h_respuestas hr
					INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
							INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
							INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
							INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
							INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
							INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
							INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
						
						
						WHERE  vp.cod_pregunta=1 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal and gd.cod_depart in(4,12,13,14)
						GROUP BY hr.cod_finca HAVING COUNT(*)>1
						) as total limit 1
								);
								##TRAER DESDE TBL DE FICHAS 
	set @totalFichas=	(SELECT COUNT(vf.cod_vulnerabilidad) FROM tbl_vulnerabilidades_ficha vf);
	
if Pevento<>''	then
	
	SELECT CONCAT((ROUND(COUNT(d.cod_desicion)-@restarSi)),'/',@totalFichas)
		
		as totales
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
							INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
							INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
							INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
							INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
							INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
							INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
						
	WHERE  vp.cod_pregunta=1 and vf.fecha_visita  BETWEEN PanioInicio and PanioFinal and gd.cod_depart in(4,12,13,14)
	
	

	
	
	#ORDER BY etiqueta ASC
	;
end if;


END$$

CREATE DEFINER=`root`@`localhost` PROCEDURE `vulnerabilidad_contador_fecha` (IN `Pevento` VARCHAR(50), IN `PanioInicio` VARCHAR(25), IN `PanioFinal` VARCHAR(25))  BEGIN
	 
	 

	set @restarSi=(
	SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) 
						from (
						select COUNT(d.desisicon) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						 INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						
						
						WHERE  vp.cod_pregunta=1 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal 
						GROUP BY hr.cod_finca HAVING COUNT(*)>1
						) as total limit 1
								);
								##TRAER DESDE TBL DE FICHAS 
	set @totalFichas=	(SELECT COUNT(vf.cod_vulnerabilidad) FROM tbl_vulnerabilidades_ficha vf);
	
if Pevento='factores de exposicion' or Pevento='factores de impacto'	then
	
	SELECT CONCAT((ROUND(COUNT(d.cod_desicion)-@restarSi)),'/',@totalFichas)
		
		as totales
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						
	WHERE  vp.cod_pregunta=1 and vf.fecha_visita  BETWEEN PanioInicio and PanioFinal
	
	

	
	
	#ORDER BY etiqueta ASC
	;
end if;


END$$

CREATE DEFINER=`root`@`localhost` PROCEDURE `vulnerabilidad_contador_genero` (IN `Pevento` VARCHAR(50), IN `PanioInicio` VARCHAR(25), IN `PanioFinal` VARCHAR(25), IN `PcodGenero` VARCHAR(25))  BEGIN
	 
	 
if PcodGenero!='' THEN
	set @restarSi=(
	SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) 
						from (
						select COUNT(d.desisicon) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						 INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
								INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
							INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
						
						WHERE  vp.cod_pregunta=1 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal and gp.cod_genero=PcodGenero
						GROUP BY hr.cod_finca HAVING COUNT(*)>1
						) as total limit 1
								);
								##TRAER DESDE TBL DE FICHAS 
	set @totalFichas=	(SELECT COUNT(vf.cod_vulnerabilidad) FROM tbl_vulnerabilidades_ficha vf);
	
if Pevento='factores de exposicion' or Pevento='factores de impacto'	then
	
	SELECT CONCAT((ROUND(COUNT(d.cod_desicion)-@restarSi)),'/',@totalFichas)
		
		as totales
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
	INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
							INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=1 and vf.fecha_visita  BETWEEN PanioInicio and PanioFinal
	AND gp.cod_genero=PcodGenero
	UNION
    SELECT  0 FROM DUAL
     WHERE NOT EXISTS
     (SELECT
	(ROUND(COUNT(d.cod_desicion)-@restarSi))
	AS total
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
							INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
	
	WHERE  vp.cod_pregunta=1 and d.cod_desicion=1 and vf.fecha_visita BETWEEN PanioInicio and PanioFinal
	AND gp.cod_genero=PcodGenero
	GROUP BY d.desisicon 
	)
	
	
	#ORDER BY etiqueta ASC
	;
end if;

end if;

END$$

CREATE DEFINER=`root`@`localhost` PROCEDURE `vulnerabilidad_contador_regional` (IN `Pevento` VARCHAR(50), IN `PanioInicio` VARCHAR(25), IN `PanioFinal` VARCHAR(25), IN `PcodRegional` VARCHAR(25))  BEGIN
	 
	 
if PcodRegional!='' THEN
	set @restarSi=(
	SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) 
						from (
						select COUNT(d.desisicon) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						 INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
						INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
						INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
						
						WHERE  vp.cod_pregunta=1 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal and gr.cod_regional=PcodRegional
						GROUP BY hr.cod_finca HAVING COUNT(*)>1
						) as total limit 1
								);
								##TRAER DESDE TBL DE FICHAS 
	set @totalFichas=	(SELECT COUNT(vf.cod_vulnerabilidad) FROM tbl_vulnerabilidades_ficha vf);
	
if Pevento='factores de exposicion' or Pevento='factores de impacto'	then
	
	SELECT CONCAT((ROUND(COUNT(d.cod_desicion)-@restarSi)),'/',@totalFichas)
		
		as totales
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
						INNER JOIN tbl_general_agencia ga on gp.cod_agencia=ga.cod_agencia
						INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
	WHERE  vp.cod_pregunta=1 and vf.fecha_visita  BETWEEN PanioInicio and PanioFinal
	AND gr.cod_regional=PcodRegional
	

	
	
	#ORDER BY etiqueta ASC
	;
end if;

end if;

END$$

CREATE DEFINER=`root`@`localhost` PROCEDURE `vulnerabilidad_contador_tecnico` (IN `Pevento` VARCHAR(50), IN `PanioInicio` VARCHAR(25), IN `PanioFinal` VARCHAR(25), IN `PcodTecnico` VARCHAR(25))  BEGIN
	 
	 
if PcodTecnico!='' THEN
	set @restarSi=(
	SELECT   if(SUM(total)-COUNT(total)>0,SUM(total)-COUNT(total),0) 
						from (
						select COUNT(d.desisicon) as total from tbl_h_respuestas hr
						INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
						INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
						 INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
						INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
						
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
						
						WHERE  vp.cod_pregunta=1 and d.cod_desicion=1 and vf.fecha_visita
						BETWEEN PanioInicio and PanioFinal and gt.cod_tecnico=PcodTecnico
						GROUP BY hr.cod_finca HAVING COUNT(*)>1
						) as total limit 1
								);
								##TRAER DESDE TBL DE FICHAS 
	set @totalFichas=	(SELECT COUNT(vf.cod_vulnerabilidad) FROM tbl_vulnerabilidades_ficha vf);
	
if Pevento='factores de exposicion' or Pevento='factores de impacto'	then
	
	SELECT CONCAT((ROUND(COUNT(d.cod_desicion)-@restarSi)),'/',@totalFichas)
		
		as totales
		 from tbl_h_respuestas hr
	INNER JOIN tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
	INNER JOIN tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
	INNER JOIN tbl_vulnerabilidad_desicion d on vr.cod_desicion=d.cod_desicion
	INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
	
						INNER JOIN tbl_vulnerabilidades_ficha vf on vf.cod_finca=gf.cod_finca
						INNER JOIN tbl_general_tecnico gt on vf.cod_tecnico=gt.cod_tecnico
	
	WHERE  vp.cod_pregunta=1 and vf.fecha_visita  BETWEEN PanioInicio and PanioFinal
	AND gt.cod_tecnico=PcodTecnico
	

	
	
	#ORDER BY etiqueta ASC
	;
end if;

end if;

END$$

CREATE DEFINER=`root`@`localhost` PROCEDURE `vulnerabilidad_contar_fichas` ()  BEGIN
SET @etiqueta=(SELECT gm.etiqueta_grafica from ihcafefichas.tbl_general_metas gm);
set @valor=(SELECT cantidad from ihcafefichas.tbl_general_metas  m WHERE m.`año`='2021');
	SELECT
	 (@etiqueta) as etiquetas,
	(@valor)-count(vf.cod_vulnerabilidad) as valores 
	from tbl_vulnerabilidades_ficha vf 
	
	UNION
	SELECT 
	(SELECT nf.ficha from ihcafefichas.tbl_general_nombre_ficha nf),
	count(vff.cod_vulnerabilidad) as contar from tbl_vulnerabilidades_ficha vff
	
	UNION
	SELECT
	CONCAT( (@etiqueta),' en Porcentaje') as etiquetas,
	(1-((count(vf.cod_vulnerabilidad)/
	(@valor)) ))*100 as valores 
	from tbl_vulnerabilidades_ficha vf 
	
	UNION
	SELECT 
	CONCAT((SELECT nf.ficha from ihcafefichas.tbl_general_nombre_ficha nf),' en Porcentaje'),
	
	(count(vff.cod_vulnerabilidad)/
	(@valor))*100 as contar2 from tbl_vulnerabilidades_ficha vff
	
	
	
	
	;
END$$

CREATE DEFINER=`root`@`localhost` PROCEDURE `vulnerabilidad_general_contador` ()  BEGIN
	#Routine body goes here...
	SELECT 'CANTIDAD DE FICHAS: ',CONCAT(count(vf.cod_vulnerabilidad),'/',count(vf.cod_vulnerabilidad))
	 from  tbl_vulnerabilidades_ficha vf;

END$$

CREATE DEFINER=`root`@`localhost` PROCEDURE `vulnerabilidad_genera_lpreguntas` (IN `p_año_inicio` INT, IN `p_año_final` INT, IN `p_fecha_inicio` INT, IN `p_fecha_final` INT, IN `p_departamento` INT, IN `p_nombre_evento` VARCHAR(50))  BEGIN
declare evento varchar(50);

set evento=UPPER(p_nombre_evento);
set @total_pregunta=(SELECT COUNT(v.cod_vulnerabilidad) from ihcafemonitoreo.tbl_vulnerabilidades_ficha v);
			case	
			WHEN evento='Factores de exposicion' THEN
			SELECT 	d.desisicon,COUNT(d.desisicon) as cantidad from tbl_h_respuestas hr 
			
			INNER JOIN   tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN   tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN   tbl_vulnerabilidad_desicion d ON vr.cod_desicion = d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
			INNER JOIN tbl_vulnerabilidades_ficha vf on gf.cod_finca=vf.cod_finca
			
			INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
			INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
			WHERE d.cod_desicion BETWEEN 1 and 3 and vp.cod_pregunta=1 
			and SUBSTRING(vf.fecha_visita,1,4) BETWEEN p_año_inicio and p_año_final
			and SUBSTRING(vf.fecha_visita,6,2) BETWEEN p_fecha_inicio and p_fecha_final
			and gd.cod_depart=p_departamento
			GROUP BY d.cod_desicion;
			
			
			
			
			
			WHEN evento='EVENTO2' THEN

			SELECT 	d.desisicon,COUNT(vr.respuesta) as cantidad from tbl_h_respuestas hr 
			INNER JOIN   tbl_vulnerabilidad_respuesta vr on hr.cod_respuesta=vr.cod_respuesta
			INNER JOIN   tbl_vulnerabilidad_pregunta vp on vr.cod_pregunta=vp.cod_pregunta
			INNER JOIN   tbl_vulnerabilidad_desicion d ON vr.cod_desicion = d.cod_desicion
			INNER JOIN tbl_general_finca gf on hr.cod_finca=gf.cod_finca
			INNER JOIN tbl_vulnerabilidades_ficha vf on gf.cod_finca=vf.cod_finca
			
			INNER JOIN tbl_general_municipio gm on vf.cod_municipio=gm.cod_municipio
			INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
			WHERE d.cod_desicion BETWEEN 1 and 3 and vp.cod_pregunta BETWEEN 4 and 7 
			and SUBSTRING(vf.fecha_visita,1,4) BETWEEN p_año_inicio and p_año_final
			and SUBSTRING(vf.fecha_visita,6,2) BETWEEN p_fecha_inicio and p_fecha_final
			and gd.cod_depart=p_departamento
			GROUP BY d.cod_desicion;
			End case;
COMMIT;
END$$

CREATE DEFINER=`root`@`localhost` PROCEDURE `vulnerabilidad_sl_ficha_vulnerabilidad` ()  NO SQL
SELECT pro.cod_identidad as Identidad,
pro.nombre as Nombre,
pro.clave as Clave,
pro.cod_genero as Genero,
pro.nacimiento as Nacimiento,
pro.celular as Celular,
pro.cod_agencia as Cod_agencia,
ga.agencia as Agencia,
gr.regional AS Regional,

f.finca as Finca,
a.municipio as Municipio,
gd.departamento as Departamento,

#vr.variedad as Variedad,
pro.cod_pais,
vv.pendiente as Pendiente,
vv.area_total_cafe as Area_cafe,
vv.p_promedio as Promedio,
vv.edad_cafetal as Edad_Cafetal,
vv.num_meses_seco as Numero_secos,
f.latitud as Latitud,
f.longitud as Longitud,
p.pregunta as Pregunta,
r.respuesta as Respuesta,
d.desisicon as Decision,

gtt.nombre as Tecnico
from tbl_h_respuestas hr
INNER JOIN tbl_vulnerabilidad_respuesta r on hr.cod_respuesta=r.cod_respuesta
INNER JOIN tbl_vulnerabilidad_pregunta p on r.cod_pregunta=p.cod_pregunta
INNER join tbl_general_finca f on hr.cod_finca=f.cod_finca
INNER JOIN tbl_vulnerabilidades_ficha vv on f.cod_finca=vv.cod_finca
#INNER JOIN tbl_vulnerabilidad_h_variedad hv on hv.cod_vulnerabilidad=vv.cod_vulnerabilidad
#INNER JOIN tbl_vulnerabilidad_variedades vr on hv.cod_variedad=vr.cod_variedad

INNER JOIN tbl_general_productor pro on f.cod_identidad=pro.cod_identidad
INNER JOIN tbl_general_tecnico gtt on vv.cod_tecnico=gtt.cod_tecnico
INNER join tbl_general_municipio a on vv.cod_municipio=a.cod_municipio
INNER JOIN tbl_general_municipio gm on  a.cod_municipio=gm.cod_municipio
INNER JOIN tbl_general_departamento gd on gm.cod_depart=gd.cod_depart
INNER JOIN tbl_general_agencia ga on pro.cod_agencia=ga.cod_agencia
INNER JOIN tbl_general_regional gr on ga.cod_regional=gr.cod_regional
INNER JOIN tbl_vulnerabilidad_desicion d on r.cod_desicion=d.cod_desicion$$

CREATE DEFINER=`root`@`localhost` PROCEDURE `vulnerabilida_parametros` (`p_año` INT, `p_fecha_inicio` INT, `p_fecha_final` INT)  BEGIN
		SELECT gg.genero,COUNT(cod_vulnerabilidad)
		 FROM `tbl_vulnerabilidades_ficha`  vf 
		INNER JOIN tbl_general_productor gp on vf.cod_identidad=gp.cod_identidad
		INNER JOIN tbl_general_genero gg on gp.cod_genero=gg.cod_genero
		
		
	
	 	WHERE SUBSTRING(fecha_visita,1,4)=p_año  and SUBSTRING(fecha_visita,6,2)
		 BETWEEN p_fecha_inicio and p_fecha_final 
		GROUP BY gg.genero;

END$$

DELIMITER ;

-- --------------------------------------------------------

--
-- Estructura de tabla para la tabla `tbl_beneficiario_ficha`
--

CREATE TABLE `tbl_beneficiario_ficha` (
  `cod_beneficiario` bigint(20) NOT NULL,
  `cod_grupo` bigint(20) NOT NULL,
  `grupo` varchar(50) NOT NULL,
  `cod_identidad` varchar(20) NOT NULL,
  `fecha_visita` date NOT NULL,
  `fecha_envio` date NOT NULL,
  `cod_org_cafetalera` bigint(20) NOT NULL,
  `cod_pro_beneficia` bigint(20) NOT NULL,
  `cod_tecnico` bigint(20) NOT NULL,
  `cod_finca` varchar(20) NOT NULL,
  `fecha_ingreso` date NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- --------------------------------------------------------

--
-- Estructura de tabla para la tabla `tbl_bene_finca`
--

CREATE TABLE `tbl_bene_finca` (
  `cod_finca` varchar(20) NOT NULL,
  `ubicacion` varchar(50) NOT NULL,
  `latitud` double NOT NULL,
  `longitud` double NOT NULL,
  `altitud` double NOT NULL,
  `presion` double NOT NULL,
  `nombre_fuente_agua` varchar(50) NOT NULL,
  `sombra` int(5) NOT NULL,
  `area_total_mz` decimal(5,2) NOT NULL,
  `area_cafe` decimal(5,2) NOT NULL,
  `num_plantas_cafe` int(8) NOT NULL,
  `qq_uva_anterior` int(9) NOT NULL,
  `qq_oro_anterior` int(9) NOT NULL,
  `edad_finca` int(3) NOT NULL,
  `cod_tenencia` bigint(20) NOT NULL,
  `cod_identidad` varchar(20) NOT NULL,
  `url_finca` varchar(50) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- --------------------------------------------------------

--
-- Estructura de tabla para la tabla `tbl_bene_grupo_comunitario`
--

CREATE TABLE `tbl_bene_grupo_comunitario` (
  `cod_grupo` bigint(20) NOT NULL,
  `grupo_comunitario` varchar(50) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

--
-- Volcado de datos para la tabla `tbl_bene_grupo_comunitario`
--

INSERT INTO `tbl_bene_grupo_comunitario` (`cod_grupo`, `grupo_comunitario`) VALUES
(1, 'Caja Rural'),
(2, 'Cooperativa Cafetalera'),
(3, 'Asociacion de productores'),
(4, 'Empresa de Servicios'),
(5, 'Junta de Agua'),
(6, 'Ninguna');

-- --------------------------------------------------------

--
-- Estructura de tabla para la tabla `tbl_bene_h_rubros`
--

CREATE TABLE `tbl_bene_h_rubros` (
  `cod_h_rubros` bigint(20) NOT NULL,
  `cod_rubro` bigint(20) NOT NULL,
  `cod_finca` varchar(20) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- --------------------------------------------------------

--
-- Estructura de tabla para la tabla `tbl_bene_h_tipo_apoyo`
--

CREATE TABLE `tbl_bene_h_tipo_apoyo` (
  `cod_h_tipo_apoyo` bigint(20) NOT NULL,
  `cod_vivienda` bigint(20) NOT NULL,
  `cod_tipo_apoyo` bigint(20) NOT NULL,
  `apoyo_otro` varchar(100) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- --------------------------------------------------------

--
-- Estructura de tabla para la tabla `tbl_bene_h_tipo_estufa`
--

CREATE TABLE `tbl_bene_h_tipo_estufa` (
  `cod_h_estufa` bigint(20) NOT NULL,
  `cod_vivienda` bigint(20) NOT NULL,
  `cod_tipo_estufa` bigint(20) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- --------------------------------------------------------

--
-- Estructura de tabla para la tabla `tbl_bene_h_tipo_servicios_p`
--

CREATE TABLE `tbl_bene_h_tipo_servicios_p` (
  `cod_h_tipo_servicio` bigint(20) NOT NULL,
  `cod_vivienda` bigint(20) NOT NULL,
  `cod_tipo_servicio` bigint(20) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- --------------------------------------------------------

--
-- Estructura de tabla para la tabla `tbl_bene_h_variedades`
--

CREATE TABLE `tbl_bene_h_variedades` (
  `cod_h_variedad` bigint(20) NOT NULL,
  `cod_variedad` bigint(20) NOT NULL,
  `cod_finca` varchar(20) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- --------------------------------------------------------

--
-- Estructura de tabla para la tabla `tbl_bene_org_cafetalera`
--

CREATE TABLE `tbl_bene_org_cafetalera` (
  `cod_org_cafetalera` bigint(20) NOT NULL,
  `organizacion_cafetale` varchar(50) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

--
-- Volcado de datos para la tabla `tbl_bene_org_cafetalera`
--

INSERT INTO `tbl_bene_org_cafetalera` (`cod_org_cafetalera`, `organizacion_cafetale`) VALUES
(1, 'ANACAFE'),
(2, 'AHPROCAFE'),
(3, 'UNIOCOOP'),
(4, 'LA CENTRAL DE COOPERATIVAS'),
(5, 'Ninguna');

-- --------------------------------------------------------

--
-- Estructura de tabla para la tabla `tbl_bene_productor`
--

CREATE TABLE `tbl_bene_productor` (
  `cod_identidad` varchar(20) NOT NULL,
  `clave` varchar(15) DEFAULT NULL,
  `nombre` varchar(45) NOT NULL,
  `cod_genero` bigint(1) NOT NULL,
  `celular` varchar(9) DEFAULT NULL,
  `nacimiento` date DEFAULT NULL,
  `cod_pais` bigint(20) NOT NULL,
  `cod_municipio` bigint(20) NOT NULL,
  `cod_agencia` bigint(20) NOT NULL,
  `cod_etnias` bigint(20) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- --------------------------------------------------------

--
-- Estructura de tabla para la tabla `tbl_bene_proyecto_beneficia`
--

CREATE TABLE `tbl_bene_proyecto_beneficia` (
  `cod_pro_beneficia` bigint(20) NOT NULL,
  `proyecto_beneficia` varchar(50) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

--
-- Volcado de datos para la tabla `tbl_bene_proyecto_beneficia`
--

INSERT INTO `tbl_bene_proyecto_beneficia` (`cod_pro_beneficia`, `proyecto_beneficia`) VALUES
(1, 'CONECTA+'),
(2, 'EUROCLIMA'),
(3, 'INNOVA'),
(4, 'GIZ'),
(5, 'IHCAFE'),
(6, 'Fondo de Desarrollo Verde (FDV)');

-- --------------------------------------------------------

--
-- Estructura de tabla para la tabla `tbl_bene_rubro`
--

CREATE TABLE `tbl_bene_rubro` (
  `cod_rubro` bigint(20) NOT NULL,
  `rubro` varchar(50) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

--
-- Volcado de datos para la tabla `tbl_bene_rubro`
--

INSERT INTO `tbl_bene_rubro` (`cod_rubro`, `rubro`) VALUES
(1, 'Maderables'),
(2, 'Frutales'),
(3, 'Musaceas'),
(4, 'Cerdos'),
(5, 'Gallinas'),
(6, 'Peces'),
(7, 'Abejas'),
(8, 'Ganado'),
(9, 'Ninguno'),
(10, 'Granos básicos'),
(11, 'pendiente'),
(12, 'Caña de azucar'),
(13, 'Turismo');

-- --------------------------------------------------------

--
-- Estructura de tabla para la tabla `tbl_bene_tenencia`
--

CREATE TABLE `tbl_bene_tenencia` (
  `cod_tenencia` bigint(20) NOT NULL,
  `tenencia` varchar(50) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

--
-- Volcado de datos para la tabla `tbl_bene_tenencia`
--

INSERT INTO `tbl_bene_tenencia` (`cod_tenencia`, `tenencia`) VALUES
(1, 'Documento Del INA'),
(2, 'Documento Privado'),
(3, 'Titulo del IP (Escritura Publica)'),
(4, 'Sin Documento'),
(5, 'Dominio Pleno');

-- --------------------------------------------------------

--
-- Estructura de tabla para la tabla `tbl_bene_tipo_apoyo`
--

CREATE TABLE `tbl_bene_tipo_apoyo` (
  `cod_tipo_apoyo` bigint(20) NOT NULL,
  `tipo_apoyo` varchar(50) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

--
-- Volcado de datos para la tabla `tbl_bene_tipo_apoyo`
--

INSERT INTO `tbl_bene_tipo_apoyo` (`cod_tipo_apoyo`, `tipo_apoyo`) VALUES
(1, 'Sistema Agroforestal'),
(2, 'Certificación Forestal'),
(3, 'Renovación de Finca'),
(4, 'SAF/Ganadería'),
(5, 'SAF/Granos_básicos'),
(6, 'Otros'),
(7, 'Pendiente');

-- --------------------------------------------------------

--
-- Estructura de tabla para la tabla `tbl_bene_tipo_documentacion`
--

CREATE TABLE `tbl_bene_tipo_documentacion` (
  `cod_tipo_doc` bigint(20) NOT NULL,
  `tipo_documentacion` varchar(50) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

--
-- Volcado de datos para la tabla `tbl_bene_tipo_documentacion`
--

INSERT INTO `tbl_bene_tipo_documentacion` (`cod_tipo_doc`, `tipo_documentacion`) VALUES
(1, 'Escritura publica'),
(2, 'Dominio pleno'),
(3, 'Dominio privado'),
(4, 'No cuenta con documentacion'),
(5, 'Other'),
(6, 'Vacio');

-- --------------------------------------------------------

--
-- Estructura de tabla para la tabla `tbl_bene_tipo_estufa`
--

CREATE TABLE `tbl_bene_tipo_estufa` (
  `cod_tipo_estufa` bigint(20) NOT NULL,
  `tipo_estufa` varchar(30) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

--
-- Volcado de datos para la tabla `tbl_bene_tipo_estufa`
--

INSERT INTO `tbl_bene_tipo_estufa` (`cod_tipo_estufa`, `tipo_estufa`) VALUES
(1, 'Estufa de Gas'),
(2, 'Estufa Electrica'),
(3, 'Hornilla'),
(4, 'Ecofogon'),
(5, 'Pendiente');

-- --------------------------------------------------------

--
-- Estructura de tabla para la tabla `tbl_bene_tipo_pared`
--

CREATE TABLE `tbl_bene_tipo_pared` (
  `cod_tipo_pared` bigint(20) NOT NULL,
  `tipo_pared` varchar(20) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

--
-- Volcado de datos para la tabla `tbl_bene_tipo_pared`
--

INSERT INTO `tbl_bene_tipo_pared` (`cod_tipo_pared`, `tipo_pared`) VALUES
(1, 'Ladrillo'),
(2, 'Bloque'),
(3, 'Adobe'),
(4, 'Madera');

-- --------------------------------------------------------

--
-- Estructura de tabla para la tabla `tbl_bene_tipo_piso`
--

CREATE TABLE `tbl_bene_tipo_piso` (
  `cod_tipo_piso` bigint(20) NOT NULL,
  `tipo_piso` varchar(20) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

--
-- Volcado de datos para la tabla `tbl_bene_tipo_piso`
--

INSERT INTO `tbl_bene_tipo_piso` (`cod_tipo_piso`, `tipo_piso`) VALUES
(1, 'Cemento'),
(2, 'Ceramica'),
(3, 'Tierra'),
(4, 'Piso de ladrillo'),
(5, 'Madera');

-- --------------------------------------------------------

--
-- Estructura de tabla para la tabla `tbl_bene_tipo_servicio`
--

CREATE TABLE `tbl_bene_tipo_servicio` (
  `cod_tipo_servicio` bigint(20) NOT NULL,
  `tipo_servicio` varchar(50) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

--
-- Volcado de datos para la tabla `tbl_bene_tipo_servicio`
--

INSERT INTO `tbl_bene_tipo_servicio` (`cod_tipo_servicio`, `tipo_servicio`) VALUES
(1, 'Agua entubada'),
(2, 'Electricidad'),
(3, 'Alcantarillado'),
(4, 'Letrina'),
(5, 'Pendiente');

-- --------------------------------------------------------

--
-- Estructura de tabla para la tabla `tbl_bene_tipo_techo`
--

CREATE TABLE `tbl_bene_tipo_techo` (
  `cod_tipo_techo` bigint(20) NOT NULL,
  `tipo_techo` varchar(20) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

--
-- Volcado de datos para la tabla `tbl_bene_tipo_techo`
--

INSERT INTO `tbl_bene_tipo_techo` (`cod_tipo_techo`, `tipo_techo`) VALUES
(1, 'Zinc'),
(2, 'Teja'),
(3, 'Asbesto'),
(4, 'Palma'),
(5, 'Other');

-- --------------------------------------------------------

--
-- Estructura de tabla para la tabla `tbl_bene_tipo_vivienda`
--

CREATE TABLE `tbl_bene_tipo_vivienda` (
  `cod_tipo_vivienda` bigint(20) NOT NULL,
  `tipo_vivienda` varchar(45) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

--
-- Volcado de datos para la tabla `tbl_bene_tipo_vivienda`
--

INSERT INTO `tbl_bene_tipo_vivienda` (`cod_tipo_vivienda`, `tipo_vivienda`) VALUES
(1, 'Propia'),
(2, 'Alquilada'),
(3, 'Hipotecada');

-- --------------------------------------------------------

--
-- Estructura de tabla para la tabla `tbl_bene_vivienda`
--

CREATE TABLE `tbl_bene_vivienda` (
  `cod_vivienda` bigint(20) NOT NULL,
  `cod_tipo_vivienda` bigint(20) NOT NULL,
  `cod_tipo_doc` bigint(20) NOT NULL,
  `cod_beneficiario` bigint(20) NOT NULL,
  `cod_tipo_pared` bigint(20) NOT NULL,
  `cod_tipo_techo` bigint(20) NOT NULL,
  `cod_tipo_piso` bigint(20) NOT NULL,
  `url_vivienda` varchar(100) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- --------------------------------------------------------

--
-- Estructura de tabla para la tabla `tbl_div_decision`
--

CREATE TABLE `tbl_div_decision` (
  `cod_dicision` bigint(20) NOT NULL,
  `decision` varchar(2) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

--
-- Volcado de datos para la tabla `tbl_div_decision`
--

INSERT INTO `tbl_div_decision` (`cod_dicision`, `decision`) VALUES
(1, 'Si'),
(2, 'No');

-- --------------------------------------------------------

--
-- Estructura de tabla para la tabla `tbl_div_dicision_pertenece`
--

CREATE TABLE `tbl_div_dicision_pertenece` (
  `cod_decision_per` bigint(20) NOT NULL,
  `decision` varchar(2) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

--
-- Volcado de datos para la tabla `tbl_div_dicision_pertenece`
--

INSERT INTO `tbl_div_dicision_pertenece` (`cod_decision_per`, `decision`) VALUES
(1, 'Si'),
(2, 'No');

-- --------------------------------------------------------

--
-- Estructura de tabla para la tabla `tbl_div_ficha`
--

CREATE TABLE `tbl_div_ficha` (
  `cod_ficha` bigint(20) NOT NULL,
  `cod_rubro` bigint(20) NOT NULL,
  `cod_dicision` bigint(20) NOT NULL,
  `cod_pro_beneficia` bigint(20) NOT NULL,
  `fecha_visita` date NOT NULL,
  `fecha_sistema` date NOT NULL,
  `cod_identidad` varchar(20) NOT NULL,
  `cod_tecnico` bigint(20) NOT NULL,
  `cod_decision_per` bigint(20) NOT NULL,
  `cod_modo` bigint(20) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- --------------------------------------------------------

--
-- Estructura de tabla para la tabla `tbl_div_finca`
--

CREATE TABLE `tbl_div_finca` (
  `cod_finca` varchar(20) NOT NULL,
  `ubicacion` varchar(25) NOT NULL,
  `latitud` double NOT NULL,
  `longitud` double NOT NULL,
  `cod_identidad` varchar(20) NOT NULL,
  `area` float NOT NULL,
  `profundidad` float NOT NULL,
  `cod_porcentaje` bigint(20) NOT NULL,
  `cod_tipo_suelo` bigint(20) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- --------------------------------------------------------

--
-- Estructura de tabla para la tabla `tbl_div_frutas`
--

CREATE TABLE `tbl_div_frutas` (
  `cod_frutas` bigint(20) NOT NULL,
  `frutas` varchar(40) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

--
-- Volcado de datos para la tabla `tbl_div_frutas`
--

INSERT INTO `tbl_div_frutas` (`cod_frutas`, `frutas`) VALUES
(1, 'Melocoton'),
(2, 'Citricos'),
(3, 'Guanabana'),
(4, 'Licha'),
(5, 'Rambutan');

-- --------------------------------------------------------

--
-- Estructura de tabla para la tabla `tbl_div_h_familia_mes`
--

CREATE TABLE `tbl_div_h_familia_mes` (
  `cod_h_familia_mes` bigint(20) NOT NULL,
  `cod_ficha` bigint(20) NOT NULL,
  `cod_mes` int(2) UNSIGNED ZEROFILL NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- --------------------------------------------------------

--
-- Estructura de tabla para la tabla `tbl_div_h_frutas`
--

CREATE TABLE `tbl_div_h_frutas` (
  `cod_h_frutales` bigint(20) NOT NULL,
  `cod_ficha` bigint(20) NOT NULL,
  `cod_fruta` bigint(20) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- --------------------------------------------------------

--
-- Estructura de tabla para la tabla `tbl_div_h_ingresos`
--

CREATE TABLE `tbl_div_h_ingresos` (
  `cod_h_ingreso` bigint(20) NOT NULL,
  `cod_ingreso` bigint(20) NOT NULL,
  `cod_ficha` bigint(20) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- --------------------------------------------------------

--
-- Estructura de tabla para la tabla `tbl_div_h_meses`
--

CREATE TABLE `tbl_div_h_meses` (
  `cod_div_h_meses` bigint(20) NOT NULL,
  `cod_mes` int(2) UNSIGNED ZEROFILL NOT NULL,
  `cod_finca` varchar(20) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- --------------------------------------------------------

--
-- Estructura de tabla para la tabla `tbl_div_modo_imp`
--

CREATE TABLE `tbl_div_modo_imp` (
  `cod_modo` bigint(20) NOT NULL,
  `modo` varchar(40) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

--
-- Volcado de datos para la tabla `tbl_div_modo_imp`
--

INSERT INTO `tbl_div_modo_imp` (`cod_modo`, `modo`) VALUES
(1, 'Grupal'),
(2, 'Individual');

-- --------------------------------------------------------

--
-- Estructura de tabla para la tabla `tbl_div_parentesco`
--

CREATE TABLE `tbl_div_parentesco` (
  `cod_parentesco` bigint(20) NOT NULL,
  `parentesco` varchar(50) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

--
-- Volcado de datos para la tabla `tbl_div_parentesco`
--

INSERT INTO `tbl_div_parentesco` (`cod_parentesco`, `parentesco`) VALUES
(1, 'Esposa'),
(2, 'Madre'),
(3, 'Hija');

-- --------------------------------------------------------

--
-- Estructura de tabla para la tabla `tbl_div_porcentajes`
--

CREATE TABLE `tbl_div_porcentajes` (
  `cod_porcentaje` bigint(20) NOT NULL,
  `porcentaje` varchar(15) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

--
-- Volcado de datos para la tabla `tbl_div_porcentajes`
--

INSERT INTO `tbl_div_porcentajes` (`cod_porcentaje`, `porcentaje`) VALUES
(1, 'Pobre'),
(2, 'Media'),
(3, 'Rica');

-- --------------------------------------------------------

--
-- Estructura de tabla para la tabla `tbl_div_productor`
--

CREATE TABLE `tbl_div_productor` (
  `cod_identidad` varchar(20) NOT NULL,
  `nombre` varchar(45) NOT NULL,
  `clave` varchar(15) DEFAULT NULL,
  `cod_genero` bigint(1) NOT NULL,
  `celular` varchar(9) DEFAULT NULL,
  `nacimiento` date DEFAULT NULL,
  `cod_pais` bigint(20) NOT NULL,
  `cod_municipio` bigint(20) NOT NULL,
  `cod_agencia` bigint(20) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- --------------------------------------------------------

--
-- Estructura de tabla para la tabla `tbl_div_recomendacion`
--

CREATE TABLE `tbl_div_recomendacion` (
  `cod_recomendacion` bigint(20) NOT NULL,
  `cod_parentesco` bigint(20) NOT NULL,
  `cod_ficha` bigint(20) NOT NULL,
  `id_registrada` varchar(20) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- --------------------------------------------------------

--
-- Estructura de tabla para la tabla `tbl_div_rubro`
--

CREATE TABLE `tbl_div_rubro` (
  `cod_rubro` bigint(20) NOT NULL,
  `rubro` varchar(50) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

--
-- Volcado de datos para la tabla `tbl_div_rubro`
--

INSERT INTO `tbl_div_rubro` (`cod_rubro`, `rubro`) VALUES
(1, 'Aguacate con Cafe'),
(2, 'Aguacate Puro'),
(3, 'Huerto Casero'),
(4, 'Limon_5*1'),
(5, 'Aguacate_5*1'),
(6, 'Frutales'),
(7, 'Bisutería'),
(8, 'Granjas Avícol'),
(9, 'Plátano'),
(10, 'Alevines'),
(11, 'Pasto mejorado'),
(12, 'Granos_Básicos');

-- --------------------------------------------------------

--
-- Estructura de tabla para la tabla `tbl_div_tipo_ingreso`
--

CREATE TABLE `tbl_div_tipo_ingreso` (
  `cod_ingreso` bigint(20) NOT NULL,
  `tipo_ingreso` varchar(50) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

--
-- Volcado de datos para la tabla `tbl_div_tipo_ingreso`
--

INSERT INTO `tbl_div_tipo_ingreso` (`cod_ingreso`, `tipo_ingreso`) VALUES
(1, 'Ganadería'),
(2, 'Negocio Pequeño'),
(3, 'Empleo'),
(4, 'Remesas'),
(5, 'Granos Básicos para la venta'),
(6, 'Ninguna');

-- --------------------------------------------------------

--
-- Estructura de tabla para la tabla `tbl_div_tipo_suelo`
--

CREATE TABLE `tbl_div_tipo_suelo` (
  `cod_tipo_suelo` bigint(20) NOT NULL,
  `tipo_suelo` varchar(40) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

--
-- Volcado de datos para la tabla `tbl_div_tipo_suelo`
--

INSERT INTO `tbl_div_tipo_suelo` (`cod_tipo_suelo`, `tipo_suelo`) VALUES
(1, 'Suelos Húmedos'),
(2, 'Suelos pantanosos'),
(3, 'Suelos secos'),
(4, 'Suelos Pedregosos');

-- --------------------------------------------------------

--
-- Estructura de tabla para la tabla `tbl_general_actividad_pro`
--

CREATE TABLE `tbl_general_actividad_pro` (
  `cod_actividad_pro` bigint(20) NOT NULL,
  `actividad_productora` varchar(50) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

--
-- Volcado de datos para la tabla `tbl_general_actividad_pro`
--

INSERT INTO `tbl_general_actividad_pro` (`cod_actividad_pro`, `actividad_productora`) VALUES
(1, 'Productor(a)'),
(2, 'Comerciante'),
(3, 'Exportador'),
(4, 'Intermediario'),
(5, 'Pendiente');

-- --------------------------------------------------------

--
-- Estructura de tabla para la tabla `tbl_general_agencia`
--

CREATE TABLE `tbl_general_agencia` (
  `cod_agencia` bigint(20) NOT NULL,
  `cod_regional` bigint(20) NOT NULL,
  `agencia` varchar(45) NOT NULL,
  `agencia2` varchar(45) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

--
-- Volcado de datos para la tabla `tbl_general_agencia`
--

INSERT INTO `tbl_general_agencia` (`cod_agencia`, `cod_regional`, `agencia`, `agencia2`) VALUES
(1, 1, 'Ag. Santa Barbara \"A\"', 'sb_santa_barbara_A'),
(2, 1, 'Ag. Santa Barbara \"B\"', 'sb_santa_barbara_B'),
(3, 1, 'Ag. Colinas', 'sb_colinas'),
(4, 1, 'Ag. San Luis', 'sb_san_luis'),
(5, 1, 'Ag. San Nicolas', 'sb_san_nicolaas'),
(6, 1, 'Ag. Trinidad', 'sb_trinidad'),
(7, 1, 'Ag. La Union', 'sb_la_union'),
(8, 1, 'Ag. Quimistan', 'sb_quimistan'),
(9, 1, 'Ag. Azacualpa', 'sb_azacualpa'),
(10, 2, 'Ag. Santa Rosa Copan', 'c_santa_rosa_copan'),
(11, 2, 'Ag. La Entrada', 'c_la_entrada'),
(12, 2, 'Ag. Lepaera', 'c_lepaera'),
(13, 2, 'Ag. Corquin', 'c_corquin'),
(14, 2, 'Ag. San Marcos Ocotepeque', 'c_san_marcos_ocotepeque'),
(15, 2, 'Ag. Santa Rita', 'c_santa_rita'),
(16, 2, 'Ag. Gracias Lempira', 'c_gracias_lempira'),
(17, 2, 'Ag. La Encarnacion Ocotepeque', 'c_la_encarnacion_ocotepeque'),
(18, 2, 'Ag. Nueva Ocotepeque', 'c_nueva_ocotepeque'),
(19, 2, 'Ag. San Juan', 'c_san_juan'),
(20, 3, 'Ag. San Pedro Sula', 'cy_san_pedro_sula'),
(21, 3, 'Ag. Morazán', 'cy_morazan'),
(22, 3, 'Ag. Yoro', 'cy_yoro'),
(23, 3, 'Ag. Peña Blanca', 'cy_pena_blanca'),
(24, 3, 'Ag. Sabá', 'cy_saba'),
(25, 4, 'Ag. Danli', 'ep_danli'),
(26, 4, 'Ag. Matasano', 'ep_matasano'),
(27, 4, 'Ag. El Paraíso', 'ep_el_paraiso'),
(28, 4, 'Ag. Teupasenti', 'ep_teupasenti'),
(29, 4, 'Ag. Trojes', 'ep_trojes'),
(30, 4, 'Ag. Moroceli', 'ep_moroceli'),
(31, 5, 'Ag. Comayagua', 'c_comayagua'),
(32, 5, 'Ag. Siguatepeque Taulabé', 'c_siguatepeque_tau'),
(33, 5, 'Ag. San Jeronimo', 'c_san_jeronimo'),
(34, 5, 'Ag. La Libertad', 'c_la_libertad'),
(35, 5, 'Ag. San Luis', 'c_san_luis'),
(36, 5, 'Ag. Lajas', 'c_lajas'),
(37, 5, 'Ag. Marcala', 'c_marcala'),
(38, 5, 'Ag. Planes', 'c_planes'),
(39, 5, 'Ag. Santiago', 'c_santiago'),
(40, 5, 'Ag. Jesús de Otoro', 'c_jesus_de_otoro'),
(41, 5, 'Ag. La Esperanza', 'c_la_esperanza'),
(42, 5, 'Ag. La Paz', 'c_la_paz'),
(43, 6, 'Ag. Juticalpa', 'o_juticalpa'),
(44, 6, 'Ag. Campamento', 'o_campamento'),
(45, 6, 'Ag. Catacamas', 'o_catacamas'),
(46, 6, 'Ag. San Francisco La Paz', 'o_san_francisco_la_paz'),
(47, 6, 'Ag. Salama y La Union', 'o_salama_y_la_union'),
(48, 6, 'Ag. Guaimaca', 'o_guaimaca'),
(49, 7, 'Ag. Tegucigalpa', 'cs_tegucigalpa'),
(50, 7, 'Ag. Choluteca', 'cs_choluteca'),
(51, 7, 'Ag. Vallecillos', 'cs_vallecillos');

-- --------------------------------------------------------

--
-- Estructura de tabla para la tabla `tbl_general_aldea`
--

CREATE TABLE `tbl_general_aldea` (
  `cod_aldea` bigint(20) NOT NULL,
  `cod_municipio` bigint(11) NOT NULL,
  `num_municipio_depart_aldea` int(2) NOT NULL,
  `aldea` varchar(55) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

--
-- Volcado de datos para la tabla `tbl_general_aldea`
--

INSERT INTO `tbl_general_aldea` (`cod_aldea`, `cod_municipio`, `num_municipio_depart_aldea`, `aldea`) VALUES
(1, 1, 1, 'La Ceiba'),
(2, 1, 2, 'Armenia Bonito'),
(3, 1, 3, 'Bonitillo'),
(4, 1, 4, 'Corozal'),
(5, 1, 5, 'Dantillo'),
(6, 1, 6, 'El Búfalo'),
(7, 1, 7, 'El Paraíso o Bataca'),
(8, 1, 8, 'El Perú'),
(9, 1, 9, 'El Pital'),
(10, 1, 10, 'La Ausencia'),
(11, 1, 11, 'La Presa'),
(12, 1, 12, 'Las Mangas'),
(13, 1, 13, 'Los Limpios'),
(14, 1, 14, 'Piedra Pintada o La Colorada'),
(15, 1, 15, 'Río María'),
(16, 1, 16, 'Río Viejo'),
(17, 1, 17, 'Sambo Creek'),
(18, 1, 18, 'Satuye'),
(19, 1, 19, 'Toncontín'),
(20, 1, 20, 'Urraco'),
(21, 1, 21, 'Yaruca'),
(22, 2, 1, 'El Porvenir'),
(23, 2, 2, 'Burgos'),
(24, 2, 3, 'Cáceres'),
(25, 2, 4, 'Campo Salado Barra'),
(26, 2, 5, 'Caracas'),
(27, 2, 6, 'Ceiba Mocha'),
(28, 2, 7, 'El Gancho'),
(29, 2, 8, 'El Pino'),
(30, 2, 9, 'La Ruidosa'),
(31, 2, 10, 'La Unión'),
(32, 2, 11, 'López Bonito'),
(33, 2, 12, 'Orotino'),
(34, 2, 13, 'San José de Montevideo'),
(35, 3, 1, 'Esparta'),
(36, 3, 2, 'Agua Caliente'),
(37, 3, 3, 'Barranquilla Norte'),
(38, 3, 4, 'Buenos Aires'),
(39, 3, 5, 'Campo Nuevo'),
(40, 3, 6, 'Cayo de Venado'),
(41, 3, 7, 'Ceibita Way'),
(42, 3, 8, 'Colonia Brisas de America'),
(43, 3, 9, 'Colorado Barra'),
(44, 3, 10, 'El Jazmín'),
(45, 3, 11, 'El Suspiro'),
(46, 3, 12, 'Flores de Italia'),
(47, 3, 13, 'La Guadalupe'),
(48, 3, 14, 'La Libertad'),
(49, 3, 15, 'La Tarralosa'),
(50, 3, 16, 'Las Americas No.1'),
(51, 3, 17, 'Las Delicias'),
(52, 3, 18, 'Las Delicias del Norte'),
(53, 3, 19, 'Las Flores de Leán'),
(54, 3, 20, 'Lombardia o La Curva'),
(55, 3, 21, 'Los Cerritos'),
(56, 3, 22, 'Mata de Guineo'),
(57, 3, 23, 'Nueva Esperanza'),
(58, 3, 24, 'Nueva Go'),
(59, 3, 25, 'Paris de Leán'),
(60, 3, 26, 'Piedras de Afilar'),
(61, 3, 27, 'Río Chiquito Norte'),
(62, 3, 28, 'Rosita'),
(63, 3, 29, 'San José'),
(64, 3, 30, 'Siempre Viva'),
(65, 3, 31, 'Sombra Verde'),
(66, 4, 1, 'Jutiapa'),
(67, 4, 2, 'Berlín No.1'),
(68, 4, 3, 'Cantor'),
(69, 4, 4, 'Cefalú'),
(70, 4, 5, 'Ceiba Grande'),
(71, 4, 6, 'Corralitos'),
(72, 4, 7, 'Descombros'),
(73, 4, 8, 'El Aguacate en Línea'),
(74, 4, 9, 'El Cacao'),
(75, 4, 10, 'El Diamante'),
(76, 4, 11, 'El Naranjo'),
(77, 4, 12, 'El Urraco'),
(78, 4, 13, 'El Zapotal'),
(79, 4, 14, 'El Zapote'),
(80, 4, 15, 'Entelina'),
(81, 4, 16, 'Ilamapa'),
(82, 4, 17, 'Jalán'),
(83, 4, 18, 'La Bomba'),
(84, 4, 19, 'Las Marías'),
(85, 4, 20, 'Los Olanchitos'),
(86, 4, 21, 'Nueva Armenia'),
(87, 4, 22, 'Papaloteca'),
(88, 4, 23, 'Piedras Amarillas'),
(89, 4, 24, 'Quebrada Grande'),
(90, 4, 25, 'Roma'),
(91, 4, 26, 'Salitrán'),
(92, 4, 27, 'Saltos'),
(93, 4, 28, 'San Ramón'),
(94, 4, 29, 'Sonaguerita'),
(95, 4, 30, 'Subirana'),
(96, 4, 31, 'Tomalá'),
(97, 5, 1, 'La Masica'),
(98, 5, 2, 'Agua Caliente'),
(99, 5, 3, 'Agua Fría'),
(100, 5, 4, 'Boca Cerrada'),
(101, 5, 5, 'Colinas'),
(102, 5, 6, 'El Desvío'),
(103, 5, 7, 'El Naranjal'),
(104, 5, 8, 'El Oro'),
(105, 5, 9, 'El Recreo'),
(106, 5, 10, 'La Cumbre'),
(107, 5, 11, 'Monte Negro'),
(108, 5, 12, 'San Antonio'),
(109, 5, 13, 'San Juan Benque'),
(110, 5, 14, 'San Juan Pueblo'),
(111, 5, 15, 'San Marcos'),
(112, 5, 16, 'Santa Fe'),
(113, 5, 17, 'Soledad'),
(114, 5, 18, 'Tierra Firme'),
(115, 5, 19, 'Trípoli'),
(116, 6, 1, 'San Francisco'),
(117, 6, 2, 'Frisco No.1'),
(118, 6, 3, 'La Frutera'),
(119, 6, 4, 'La Llave'),
(120, 6, 5, 'Las Camelias'),
(121, 6, 6, 'Micelly'),
(122, 6, 7, 'Paguales'),
(123, 6, 8, 'Río Cuero'),
(124, 6, 9, 'Saladito'),
(125, 6, 10, 'Santa Ana'),
(126, 6, 11, 'Santiago'),
(127, 6, 12, 'Santiago Arriba'),
(128, 7, 1, 'Tela'),
(129, 7, 2, 'Agua Blanca'),
(130, 7, 3, 'Agua Chiquita'),
(131, 7, 4, 'Barra Ulúa'),
(132, 7, 5, 'Brisas del Leán'),
(133, 7, 6, 'Buena Vista'),
(134, 7, 7, 'Buenos Aires No.1'),
(135, 7, 8, 'Buenos Aires No.2'),
(136, 7, 9, 'Campo Elvir'),
(137, 7, 10, 'Cangélica o El Corozal'),
(138, 7, 11, 'Cangeliquita Abajo'),
(139, 7, 12, 'Cangeliquita Arriba'),
(140, 7, 13, 'Col. Los Laureles'),
(141, 7, 14, 'Concepción La Florida Vieja'),
(142, 7, 15, 'Creek Martínez'),
(143, 7, 16, 'Champerio o El Triunfo de Esquipulas'),
(144, 7, 17, 'El Barro o Buena Vista'),
(145, 7, 18, 'El Cedro'),
(146, 7, 19, 'El Desvío del Zapote Mojimán'),
(147, 7, 20, 'El Dorado'),
(148, 7, 21, 'El Encanto'),
(149, 7, 22, 'El Guano'),
(150, 7, 23, 'El Guayabal'),
(151, 7, 24, 'El Junco'),
(152, 7, 25, 'El Jute'),
(153, 7, 26, 'El Rodeo'),
(154, 7, 27, 'El Tigre'),
(155, 7, 28, 'El Triunfo de La Cruz'),
(156, 7, 29, 'El Zapote No.1'),
(157, 7, 30, 'El Zapote No.2'),
(158, 7, 31, 'Kilómetro Trece'),
(159, 7, 32, 'Lancetilla'),
(160, 7, 33, 'La Esperanza'),
(161, 7, 34, 'La Esperanza de Santiago'),
(162, 7, 35, 'La Fortuna'),
(163, 7, 36, 'La Ica'),
(164, 7, 37, 'La Paz'),
(165, 7, 38, 'La Union'),
(166, 7, 39, 'La Yusa'),
(167, 7, 40, 'Las Delicias'),
(168, 7, 41, 'Las Mercedes'),
(169, 7, 42, 'Las Metalias'),
(170, 7, 43, 'Las Minas'),
(171, 7, 44, 'Las Palmas'),
(172, 7, 45, 'Las Quebradas'),
(173, 7, 46, 'Los Cerritos'),
(174, 7, 47, 'Melcher Diez y Siete'),
(175, 7, 48, 'Meroa Ocho'),
(176, 7, 49, 'Meroa Río'),
(177, 7, 50, 'Mezapa o Santa Rosa del Norte'),
(178, 7, 51, 'Monte Sion'),
(179, 7, 52, 'Morazán'),
(180, 7, 53, 'Nombre de Dios'),
(181, 7, 54, 'Nueva Esperanza'),
(182, 7, 55, 'Nueva Suyapa'),
(183, 7, 56, 'Nuevo Berlin o Las Jicoteas'),
(184, 7, 57, 'Paujiles'),
(185, 7, 58, 'Peman o Uluita Adentro'),
(186, 7, 59, 'Piedras Gordas'),
(187, 7, 60, 'Planes'),
(188, 7, 61, 'Procón'),
(189, 7, 62, 'Puerto Arturo'),
(190, 7, 63, 'Río Tinto'),
(191, 7, 64, 'San Alejo'),
(192, 7, 65, 'San Antonio'),
(193, 7, 66, 'San Antonio de Villafranca'),
(194, 7, 67, 'San José'),
(195, 7, 68, 'San Juan'),
(196, 7, 69, 'San Juan Lempira'),
(197, 7, 70, 'Santiago'),
(198, 7, 71, 'Tarralosa'),
(199, 7, 72, 'Toloa Adentro'),
(200, 7, 73, 'Toloa Creek'),
(201, 7, 74, 'Tornabé'),
(202, 7, 75, 'Villafranca'),
(203, 7, 76, 'Zoilabé'),
(204, 8, 1, 'Arizona'),
(205, 8, 2, 'Agua Caliente'),
(206, 8, 3, 'Atenas de San Cristóbal o Km. Diez y Siete'),
(207, 8, 4, 'Barranquilla Sur'),
(208, 8, 5, 'Colonia Río Plátano'),
(209, 8, 6, 'Coloradito'),
(210, 8, 7, 'El Coco'),
(211, 8, 8, 'El Empalme'),
(212, 8, 9, 'El Retiro'),
(213, 8, 10, 'Hicaque'),
(214, 8, 11, 'Hisopo'),
(215, 8, 12, 'Jilamito Nuevo'),
(216, 8, 13, 'Jilamito Viejo'),
(217, 8, 14, 'Jilamo Nuevo'),
(218, 8, 15, 'Jilamo Viejo'),
(219, 8, 16, 'La Leona o Km. Doce'),
(220, 8, 17, 'Las Lomas'),
(221, 8, 18, 'Mezapa'),
(222, 8, 19, 'Mezapita'),
(223, 8, 20, 'Planes de Hicaque'),
(224, 8, 21, 'Rio Chiquito Sur'),
(225, 8, 22, 'San Francisco de Saco'),
(226, 8, 23, 'San José de Texiguat'),
(227, 8, 24, 'San José de Tiburón'),
(228, 8, 25, 'Santa María'),
(229, 8, 26, 'Sisama'),
(230, 8, 27, 'Suyapa de Leán o Mataras'),
(231, 9, 1, 'Trujillo'),
(232, 9, 2, 'Col. Aguán'),
(233, 9, 3, 'Chapagua'),
(234, 9, 4, 'El Coco No.1'),
(235, 9, 5, 'Ilanga'),
(236, 9, 6, 'Jericó'),
(237, 9, 7, 'La Brea'),
(238, 9, 8, 'Puerto Castilla'),
(239, 9, 9, 'Tarros'),
(240, 10, 1, 'Balfate'),
(241, 10, 2, 'Arenalosa'),
(242, 10, 3, 'Bambu'),
(243, 10, 4, 'Cuyamel'),
(244, 10, 5, 'El Cenizo'),
(245, 10, 6, 'El Porvenir'),
(246, 10, 7, 'El Satal'),
(247, 10, 8, 'El Satalito'),
(248, 10, 9, 'Las Crucitas'),
(249, 10, 10, 'Las Flores'),
(250, 10, 11, 'Las Mangas'),
(251, 10, 12, 'Limera'),
(252, 10, 13, 'Lis Lis'),
(253, 10, 14, 'Lucinda'),
(254, 10, 15, 'Planes de Bambú'),
(255, 10, 16, 'Río Coco'),
(256, 10, 17, 'Río Esteban'),
(257, 10, 18, 'San Luis'),
(258, 11, 1, 'Iriona'),
(259, 11, 2, 'Ciriboya'),
(260, 11, 3, 'Cusuna'),
(261, 11, 4, 'Iriona Viejo'),
(262, 11, 5, 'Las Champas u Ocotales'),
(263, 11, 6, 'Paya'),
(264, 11, 7, 'Punta de Piedra'),
(265, 11, 8, 'San José de La Punta'),
(266, 11, 9, 'Sangrelaya'),
(267, 11, 10, 'Sico'),
(268, 11, 11, 'Tocamacho'),
(269, 12, 1, 'Limón'),
(270, 12, 2, 'Francia'),
(271, 12, 3, 'Vallecito'),
(272, 13, 1, 'Sabá'),
(273, 13, 2, 'Barranco Chele'),
(274, 13, 3, 'Campo Bohemio o Alianza'),
(275, 13, 4, 'Campo Copete'),
(276, 13, 5, 'Campo Nerones'),
(277, 13, 6, 'Campo Vally'),
(278, 13, 7, 'Ceibita'),
(279, 13, 8, 'Cooperativa El Esfuerzo'),
(280, 13, 9, 'El Achiote'),
(281, 13, 10, 'El Jaguillo Muerto'),
(282, 13, 11, 'Elixir'),
(283, 13, 12, 'Finca El Carmen'),
(284, 13, 13, 'Las Golondrinas'),
(285, 13, 14, 'Orica'),
(286, 13, 15, 'Paguales'),
(287, 13, 16, 'Palos de Agua Abajo'),
(288, 13, 17, 'Sonámbula'),
(289, 13, 18, 'Tiburones'),
(290, 14, 1, 'Santa Fe'),
(291, 14, 2, 'Guadalupe'),
(292, 14, 3, 'Plan Grande'),
(293, 14, 4, 'San Antonio'),
(294, 15, 1, 'Santa Rosa de Aguán'),
(295, 15, 2, 'Vuelta Grande'),
(296, 16, 1, 'Sonaguera'),
(297, 16, 2, 'Agua Caliente'),
(298, 16, 3, 'Alto Seco'),
(299, 16, 4, 'Colonia El Sinaí'),
(300, 16, 5, 'Campo El Olvido'),
(301, 16, 6, 'Campo Guanacaste'),
(302, 16, 7, 'Campo La Paz'),
(303, 16, 8, 'Cooperativa Veinte y Uno de Noviembre o Traviata'),
(304, 16, 9, 'Churrusquera'),
(305, 16, 10, 'El Café'),
(306, 16, 11, 'El Guayabal'),
(307, 16, 12, 'El Limón'),
(308, 16, 13, 'El Porvenir de Aida o El Berrinche'),
(309, 16, 14, 'El Sastre'),
(310, 16, 15, 'Faust'),
(311, 16, 16, 'Flores del Este'),
(312, 16, 17, 'Flores del Terrero'),
(313, 16, 18, 'Gioconda'),
(314, 16, 19, 'Isleta Central'),
(315, 16, 20, 'Juan Lázaro Abajo'),
(316, 16, 21, 'La Cubana'),
(317, 16, 22, 'La Curva de Isletas'),
(318, 16, 23, 'La Hoya Arriba'),
(319, 16, 24, 'La Presa o Juan Lázaro Arriba'),
(320, 16, 25, 'Lanza'),
(321, 16, 26, 'Lezcano'),
(322, 16, 27, 'Lorelay'),
(323, 16, 28, 'Lorencito'),
(324, 16, 29, 'Lucía'),
(325, 16, 30, 'Los Carrioles'),
(326, 16, 31, 'Los Planes'),
(327, 16, 32, 'Miramar'),
(328, 16, 33, 'Monte de Oro'),
(329, 16, 34, 'Parmas'),
(330, 16, 35, 'Puente Alto'),
(331, 16, 36, 'Quebrada de Arena'),
(332, 16, 37, 'Río de Piedra'),
(333, 16, 38, 'Sabana de La Pita'),
(334, 16, 39, 'Sabana de Utila'),
(335, 16, 40, 'Tosca'),
(336, 16, 41, 'Tres Luces'),
(337, 16, 42, 'Trovador'),
(338, 16, 43, 'Utila'),
(339, 17, 1, 'Tocoa'),
(340, 17, 2, 'Cayo Sierra'),
(341, 17, 3, 'Cuaca Nueva o Jaral'),
(342, 17, 4, 'Cuaca Vieja o Cuaca Zona'),
(343, 17, 5, 'Chiripa'),
(344, 17, 6, 'El Guapinol'),
(345, 17, 7, 'Juan Antonio'),
(346, 17, 8, 'La Abisinia'),
(347, 17, 9, 'La Ceibita'),
(348, 17, 10, 'La Concepción'),
(349, 17, 11, 'Las Mangas'),
(350, 17, 12, 'Lerida'),
(351, 17, 13, 'Prieta'),
(352, 17, 14, 'Quebrada de Agua'),
(353, 17, 15, 'Quebrada de Arena'),
(354, 17, 16, 'Salamá'),
(355, 17, 17, 'Taujica'),
(356, 17, 18, 'Zamora'),
(357, 18, 1, 'Bonito Oriental'),
(358, 18, 2, 'Corocito'),
(359, 18, 3, 'El Achiote'),
(360, 18, 4, 'El Antigual'),
(361, 18, 5, 'Feo'),
(362, 18, 6, 'La Esperanza'),
(363, 18, 7, 'Playa de Ganado'),
(364, 18, 8, 'Río Piedra Blanca'),
(365, 18, 9, 'San José del Cinco'),
(366, 18, 10, 'Vista Hermosa'),
(367, 19, 1, 'Comayagua'),
(368, 19, 2, 'Agua Salada'),
(369, 19, 3, 'Cacahuapa'),
(370, 19, 4, 'Cantoral'),
(371, 19, 5, 'El Ciruelo'),
(372, 19, 6, 'El Guachipilín'),
(373, 19, 7, 'El Horno'),
(374, 19, 8, 'El Paraíso'),
(375, 19, 9, 'El Plan de La Rosa'),
(376, 19, 10, 'El Portillo de La Mora'),
(377, 19, 11, 'El Resumidero'),
(378, 19, 12, 'El Sauce'),
(379, 19, 13, 'El Sitio'),
(380, 19, 14, 'El Taladro'),
(381, 19, 15, 'El Volcán'),
(382, 19, 16, 'Guacamaya'),
(383, 19, 17, 'La Cooperativa'),
(384, 19, 18, 'La Escalera'),
(385, 19, 19, 'La Flor'),
(386, 19, 20, 'La Jaguita'),
(387, 19, 21, 'La Laguna'),
(388, 19, 22, 'La Palma'),
(389, 19, 23, 'La Sampedrana'),
(390, 19, 24, 'Las Anonas'),
(391, 19, 25, 'Las Liconas'),
(392, 19, 26, 'Las Mesas'),
(393, 19, 27, 'Lomas del Cordero'),
(394, 19, 28, 'Los Planes'),
(395, 19, 29, 'Motagua del Roblito'),
(396, 19, 30, 'Nueva Valladolid de Capiro'),
(397, 19, 31, 'Palo Pintado'),
(398, 19, 32, 'Piedras Azules'),
(399, 19, 33, 'Planes de Churune'),
(400, 19, 34, 'Río Blanco'),
(401, 19, 35, 'San Antonio de Cañas'),
(402, 19, 36, 'San Antonio de La Libertad'),
(403, 19, 37, 'San José de Pane'),
(404, 19, 38, 'San Miguel de Selguapa'),
(405, 19, 39, 'Valle de Angeles'),
(406, 19, 40, 'Veracruz'),
(407, 20, 1, 'Ajuterique'),
(408, 20, 2, 'El Misterio'),
(409, 20, 3, 'Playitas'),
(410, 20, 4, 'San Antonio del Playón'),
(411, 21, 1, 'El Rosario'),
(412, 21, 2, 'Agua Dulcita'),
(413, 21, 3, 'Cerro Blanco'),
(414, 21, 4, 'Concepción de Guasistagua'),
(415, 21, 5, 'El Buen Pastor'),
(416, 21, 6, 'La Laguna'),
(417, 21, 7, 'Las Huertas'),
(418, 21, 8, 'Lomas Verdes'),
(419, 21, 9, 'Los Llanitos o Leoncito'),
(420, 21, 10, 'San Francisco de La Campa'),
(421, 21, 11, 'San Francisco de Loma Larga'),
(422, 21, 12, 'San Isidro'),
(423, 21, 13, 'San Jacinto o Carboneras'),
(424, 22, 1, 'Esquías'),
(425, 22, 2, 'El Oro Abajo'),
(426, 22, 3, 'El Playón'),
(427, 22, 4, 'Netapa'),
(428, 22, 5, 'Peladeritos'),
(429, 22, 6, 'Rancho Grande'),
(430, 22, 7, 'Río Chiquito'),
(431, 23, 1, 'Humuya'),
(432, 23, 2, 'El Junquillo'),
(433, 23, 3, 'Travesía'),
(434, 24, 1, 'La Libertad'),
(435, 24, 2, 'Cabeceras'),
(436, 24, 3, 'Cantón San Antonio'),
(437, 24, 4, 'Cuesta del Neo'),
(438, 24, 5, 'El Higuerón'),
(439, 24, 6, 'El Olvido'),
(440, 24, 7, 'El Pinabetoso'),
(441, 24, 8, 'Goteras'),
(442, 24, 9, 'La Pita'),
(443, 24, 10, 'Loma Alta'),
(444, 24, 11, 'Los Alfaros'),
(445, 24, 12, 'Montañuelas'),
(446, 24, 13, 'Plan de Alejandro'),
(447, 24, 14, 'San Andrés'),
(448, 24, 15, 'San Antonio de Saque'),
(449, 24, 16, 'San José'),
(450, 24, 17, 'Santa Fe'),
(451, 24, 18, 'Terreritos'),
(452, 24, 19, 'Valle Bonito'),
(453, 24, 20, 'Valle de Angeles'),
(454, 24, 21, 'Vallecitos'),
(455, 24, 22, 'Zacatalitos'),
(456, 25, 1, 'Lamaní'),
(457, 25, 2, 'Guachipilín'),
(458, 25, 3, 'Lagunetas'),
(459, 25, 4, 'Las Mesetas'),
(460, 25, 5, 'Mulacagua'),
(461, 25, 6, 'Ojo de Agua'),
(462, 25, 7, 'Tablazón'),
(463, 25, 8, 'Valladolid'),
(464, 26, 1, 'La Trinidad'),
(465, 26, 2, 'EL Cordoncillo'),
(466, 26, 3, 'El Peñón'),
(467, 26, 4, 'Guacamaya'),
(468, 26, 5, 'Las Tierras'),
(469, 26, 6, 'Los Anises'),
(470, 26, 7, 'Tierra Blanca'),
(471, 27, 1, 'Lejamaní'),
(472, 27, 1, 'Meámbar'),
(473, 27, 3, 'Agua Caliente'),
(474, 27, 4, 'Chichipate'),
(475, 27, 5, 'El Aguaje'),
(476, 27, 6, 'El Buen Pastor'),
(477, 27, 7, 'El Cienegal'),
(478, 27, 8, 'El Palmital'),
(479, 27, 9, 'El Zapote'),
(480, 27, 10, 'Jicarito'),
(481, 27, 11, 'La Concepción'),
(482, 27, 12, 'La Joya'),
(483, 27, 13, 'La Mesa'),
(484, 27, 14, 'La Pimienta'),
(485, 27, 15, 'Las Lajas'),
(486, 27, 16, 'Los Globos'),
(487, 27, 17, 'Los Planes'),
(488, 27, 18, 'Matapalo'),
(489, 27, 19, 'Monte de Dios'),
(490, 27, 20, 'Ojo de Agua'),
(491, 27, 21, 'Potrerillos'),
(492, 27, 22, 'Pueblo Nuevo'),
(493, 27, 23, 'San Antonio de Buenos Aires'),
(494, 27, 24, 'San Isidro'),
(495, 27, 25, 'Santa Ana'),
(496, 27, 26, 'Santa Elena'),
(497, 29, 1, 'Minas de Oro'),
(498, 29, 2, 'Agua Blanca'),
(499, 29, 3, 'El Socorro'),
(500, 29, 4, 'El Zompopero'),
(501, 29, 5, 'La Hoya de La Puerta'),
(502, 29, 6, 'Las Huertas'),
(503, 29, 7, 'Minas de San Antonio'),
(504, 29, 8, 'Montecitos'),
(505, 29, 9, 'Pimientilla'),
(506, 29, 10, 'San Isidro del Mal Paso'),
(507, 29, 11, 'Santa Cruz'),
(508, 30, 1, 'Ojos de Agua'),
(509, 30, 2, 'Agua Blanca'),
(510, 30, 3, 'Buen Pastor'),
(511, 30, 4, 'Campo Dos'),
(512, 30, 5, 'Corralitos'),
(513, 30, 6, 'El Hielo'),
(514, 30, 7, 'El Pacayal'),
(515, 30, 8, 'El Pinabetoso'),
(516, 30, 9, 'El Robledal'),
(517, 30, 10, 'La Balastrera o Buenos Aires'),
(518, 30, 11, 'La Candelaria'),
(519, 30, 12, 'La Cañada'),
(520, 30, 13, 'La Providencia'),
(521, 30, 14, 'Los Anises'),
(522, 30, 15, 'Los Dos Ríos'),
(523, 30, 16, 'Los Guineos'),
(524, 30, 17, 'Portillo Grande'),
(525, 30, 18, 'San Rafael'),
(526, 31, 1, 'San Jerónimo'),
(527, 31, 2, 'Buena Vista'),
(528, 31, 3, 'El Chupadero o Jardines'),
(529, 31, 4, 'Jacintillos'),
(530, 31, 5, 'Jamalteca'),
(531, 31, 6, 'La Ceibita'),
(532, 31, 7, 'La Unión'),
(533, 31, 8, 'Las Arenas'),
(534, 31, 9, 'Las Crucitas'),
(535, 31, 10, 'Los Manzanos'),
(536, 31, 11, 'Los Talnetes'),
(537, 31, 12, 'Ocotes Caídos'),
(538, 31, 13, 'Plan de Leones'),
(539, 31, 14, 'Potrero Sucio'),
(540, 31, 15, 'San Antonio de La Cuesta'),
(541, 31, 16, 'Talanguita'),
(542, 31, 17, 'Terrero del Cedro'),
(543, 31, 18, 'Vallecillos'),
(544, 32, 1, 'San José de Comayagua'),
(545, 32, 2, 'El Calichito'),
(546, 32, 3, 'El Chaparral'),
(547, 32, 4, 'El Porvenir'),
(548, 32, 5, 'El Zarzal'),
(549, 32, 6, 'Higuerones'),
(550, 32, 7, 'La Laguna Seca'),
(551, 32, 8, 'La Pimienta'),
(552, 32, 9, 'La Pita'),
(553, 32, 10, 'Las Delicias'),
(554, 32, 11, 'Los Anises'),
(555, 32, 12, 'Los Llanos de San Jose o Sunzapote'),
(556, 32, 13, 'Puerta del Potrero'),
(557, 33, 1, 'San José del Potrero'),
(558, 33, 2, 'El Chorro'),
(559, 33, 3, 'Minas de Plata'),
(560, 33, 4, 'Ojo de Agua'),
(561, 33, 5, 'Potreritos'),
(562, 33, 6, 'Quezalapa'),
(563, 33, 7, 'Terreritos'),
(564, 33, 8, 'Terreritos de Las Trancas'),
(565, 34, 1, 'San Luis'),
(566, 34, 2, 'El Tablón'),
(567, 34, 3, 'El Tule'),
(568, 34, 4, 'Las Minitas'),
(569, 34, 5, 'Las Quebradas'),
(570, 34, 6, 'Loma Pelada'),
(571, 34, 7, 'Los Anisales'),
(572, 34, 8, 'Los Puentes'),
(573, 34, 9, 'Los Tres Palos'),
(574, 34, 10, 'Los Zacatales'),
(575, 34, 11, 'El Plan Grande'),
(576, 34, 12, 'Quebrada Amarilla'),
(577, 34, 13, 'Trojes'),
(578, 35, 1, 'San Sebastián'),
(579, 35, 2, 'El Ojo de Agua'),
(580, 35, 3, 'La Peñita'),
(581, 36, 1, 'Siguatepeque'),
(582, 36, 2, 'Agua Dulce'),
(583, 36, 3, 'Aguas del Padre'),
(584, 36, 4, 'Buena Vista de Río Bonito'),
(585, 36, 5, 'Chorreritas'),
(586, 36, 6, 'El Achiote'),
(587, 36, 7, 'El Caobanál'),
(588, 36, 8, 'El Pacayal'),
(589, 36, 9, 'El Pito'),
(590, 36, 10, 'El Porvenir'),
(591, 36, 11, 'El Potrerón'),
(592, 36, 12, 'El Rincón'),
(593, 36, 13, 'El Sauce'),
(594, 36, 14, 'El Socorro'),
(595, 36, 15, 'El Zapote'),
(596, 36, 16, 'Guarajao Nuevo'),
(597, 36, 17, 'Guarajao Viejo No.1'),
(598, 36, 18, 'La Crucita'),
(599, 36, 19, 'La Unión del Sute'),
(600, 36, 20, 'Ojo de Agua'),
(601, 36, 21, 'Potrerillos'),
(602, 36, 22, 'Río Bonito'),
(603, 36, 23, 'San Antonio de La Cuchilla'),
(604, 36, 24, 'San Ignacio'),
(605, 36, 25, 'San José de La Cuesta'),
(606, 36, 26, 'San José de Los Chaguites'),
(607, 36, 27, 'Santa Cruz del Dulce'),
(608, 36, 28, 'Santa Rosita'),
(609, 36, 29, 'Taupaz'),
(610, 37, 1, 'Villa de San Antonio'),
(611, 37, 2, 'Flores'),
(612, 37, 3, 'Las Botijas'),
(613, 37, 4, 'Los Cimientos'),
(614, 37, 5, 'Potrero Grande o Quebrada Honda'),
(615, 37, 6, 'Protección'),
(616, 38, 1, 'Las Lajas'),
(617, 38, 2, 'Buen Pastor'),
(618, 38, 3, 'Dulce Nombre'),
(619, 38, 4, 'La Dalia'),
(620, 38, 5, 'Las Piñas'),
(621, 38, 6, 'Los Portones'),
(622, 38, 7, 'Nueva Concepción'),
(623, 38, 8, 'San Manuel de La Parra'),
(624, 38, 9, 'Santa Rosa'),
(625, 38, 10, 'Valle Sucio'),
(626, 39, 1, 'Taulabé'),
(627, 39, 2, 'Buena Vista de Varsovia'),
(628, 39, 3, 'Buenos Aires'),
(629, 39, 4, 'Camalotales'),
(630, 39, 5, 'Cerro Azul'),
(631, 39, 6, 'Choloma'),
(632, 39, 7, 'El Carrizal'),
(633, 39, 8, 'El Cerrón'),
(634, 39, 9, 'El Palmichal o La Fátima'),
(635, 39, 10, 'Jaitique'),
(636, 39, 11, 'Jardines'),
(637, 39, 12, 'La Angostura'),
(638, 39, 13, 'La Misión'),
(639, 39, 14, 'La Unión de San Antonio'),
(640, 39, 15, 'Las Alejandras'),
(641, 39, 16, 'Las Conchas'),
(642, 39, 17, 'Las Lajas'),
(643, 39, 18, 'Montañuelas'),
(644, 39, 19, 'Ocomán'),
(645, 39, 20, 'Quebraditas'),
(646, 39, 21, 'San Antonio de Yure'),
(647, 39, 22, 'Terrero Blanco'),
(648, 39, 23, 'Vacadilla'),
(649, 39, 24, 'Varsovia'),
(650, 40, 1, 'Santa Rosa de Copán'),
(651, 40, 2, 'Calzontes'),
(652, 40, 3, 'Conal Trincheras'),
(653, 40, 4, 'El Callejón'),
(654, 40, 5, 'El Carrizal'),
(655, 40, 6, 'El Conal'),
(656, 40, 7, 'El Corralito'),
(657, 40, 8, 'El Derrumbo'),
(658, 40, 9, 'El Periconal'),
(659, 40, 10, 'El Pinalito'),
(660, 40, 11, 'El Rodeo'),
(661, 40, 12, 'El Rosario'),
(662, 40, 13, 'El Salitrillo'),
(663, 40, 14, 'El Zapote'),
(664, 40, 15, 'Inchuma'),
(665, 40, 16, 'Las Delicias o Las Pilas'),
(666, 40, 17, 'Las Sandías'),
(667, 40, 18, 'Oromilaca'),
(668, 40, 19, 'Potrerillos'),
(669, 40, 20, 'Quezailica'),
(670, 40, 21, 'Yarushin'),
(671, 41, 1, 'Cabañas'),
(672, 41, 2, 'Barbasqueadero'),
(673, 41, 3, 'Descombros'),
(674, 41, 4, 'El Guayabo'),
(675, 41, 5, 'El Llano'),
(676, 41, 6, 'Guarumal'),
(677, 41, 7, 'Ingenios'),
(678, 41, 8, 'La Cumbre de San Juan'),
(679, 41, 9, 'La Unión de San Juan'),
(680, 41, 10, 'Las Juntas No.1'),
(681, 41, 11, 'Las Peñas No.1'),
(682, 41, 12, 'Lomas de La Esperanza'),
(683, 41, 13, 'Miramar'),
(684, 41, 14, 'Mirasolito de La Esperanza'),
(685, 41, 15, 'Mirasolito de Río Negro'),
(686, 41, 16, 'Motagua'),
(687, 41, 17, 'Pinalito'),
(688, 41, 18, 'Platanares'),
(689, 41, 19, 'Pueblo Viejo'),
(690, 41, 20, 'Río Negro'),
(691, 41, 21, 'San Jose de Miramar'),
(692, 42, 1, 'Concepción'),
(693, 42, 2, 'Aldea Nueva'),
(694, 42, 3, 'Bañaderos'),
(695, 42, 4, 'Barbascales'),
(696, 42, 5, 'Candelaria'),
(697, 42, 6, 'Las Delicias'),
(698, 42, 7, 'Las Pavas'),
(699, 42, 8, 'Piedras Coloradas'),
(700, 42, 9, 'Plan Grande'),
(701, 42, 10, 'San José de Las Quebraditas'),
(702, 42, 11, 'San Juan'),
(703, 42, 12, 'Vertientes'),
(704, 43, 1, 'Copán Ruinas'),
(705, 43, 2, 'Agua Buena Arriba'),
(706, 43, 3, 'Agua Caliente'),
(707, 43, 4, 'Barbasqueadero'),
(708, 43, 5, 'Boca del Monte'),
(709, 43, 6, 'Buena Vista'),
(710, 43, 7, 'Buenos Aires'),
(711, 43, 8, 'Carrizalón'),
(712, 43, 9, 'Ceiba Primera'),
(713, 43, 10, 'Ceiba Segunda'),
(714, 43, 11, 'Colón Jubuco'),
(715, 43, 12, 'Corralito'),
(716, 43, 13, 'El Cisne'),
(717, 43, 14, 'El Cordoncillo'),
(718, 43, 15, 'El Chical'),
(719, 43, 16, 'El Chilar o Agua Zarca'),
(720, 43, 17, 'El Chispal'),
(721, 43, 18, 'El Encino'),
(722, 43, 19, 'El Horno'),
(723, 43, 20, 'El Ocote'),
(724, 43, 21, 'El Porvenir Primero'),
(725, 43, 22, 'El Porvenir Segundo'),
(726, 43, 23, 'El Quebracho'),
(727, 43, 24, 'El Salitrón'),
(728, 43, 25, 'El Tesorito'),
(729, 43, 26, 'El Triunfo'),
(730, 43, 27, 'Hacienda Grande'),
(731, 43, 28, 'Jubucón'),
(732, 43, 29, 'La Esperanza'),
(733, 43, 30, 'La Estanzuela'),
(734, 43, 31, 'La Laguna'),
(735, 43, 32, 'Las Delicias'),
(736, 43, 33, 'Las Flores'),
(737, 43, 34, 'Los Arcos'),
(738, 43, 35, 'Llanetillos'),
(739, 43, 36, 'Monte de Los Negros'),
(740, 43, 37, 'Montecristo'),
(741, 43, 38, 'Nueva Armenia'),
(742, 43, 39, 'Ostumán'),
(743, 43, 40, 'San Antonio Tapesco'),
(744, 43, 41, 'San Cristóbal'),
(745, 43, 42, 'San Francisco'),
(746, 43, 43, 'San Isidro'),
(747, 43, 44, 'San Rafael'),
(748, 43, 45, 'Santa Cruz de Virginia'),
(749, 43, 46, 'Santa Rosita'),
(750, 43, 47, 'Sesesmil Primero'),
(751, 43, 48, 'Sesesmil Segundo'),
(752, 43, 49, 'Unión Cedral'),
(753, 43, 50, 'Virginia No.1'),
(754, 44, 1, 'Corquín'),
(755, 44, 2, 'Agua Caliente'),
(756, 44, 3, 'Boca del Monte'),
(757, 44, 4, 'Capucas'),
(758, 44, 5, 'El Carrizal'),
(759, 44, 6, 'Gualme'),
(760, 44, 7, 'Jimilile'),
(761, 44, 8, 'Las Casitas'),
(762, 44, 9, 'Potrerillos'),
(763, 45, 1, 'Cucuyagua'),
(764, 45, 2, 'Cartagua'),
(765, 45, 3, 'El Níspero'),
(766, 45, 4, 'El Portillo'),
(767, 45, 5, 'El Tránsito'),
(768, 45, 6, 'Gualtaya'),
(769, 45, 7, 'Ojos de Agua'),
(770, 45, 8, 'San José de Las Palmas'),
(771, 46, 1, 'Dolores'),
(772, 46, 2, 'Agua Buena'),
(773, 46, 3, 'El Bálsamo o La Canteada'),
(774, 46, 4, 'El Camalote'),
(775, 46, 5, 'Joyas Galanas'),
(776, 46, 6, 'Pasquingual'),
(777, 46, 7, 'Plan del Naranjo'),
(778, 46, 8, 'San Antonio'),
(779, 46, 9, 'Vega Redonda o San Antonio de Flores'),
(780, 46, 10, 'Yaruconte'),
(781, 47, 1, 'Dulce Nombre'),
(782, 47, 2, 'Agua Buena'),
(783, 47, 3, 'El Limón'),
(784, 47, 4, 'El Prado de La Cruz'),
(785, 47, 5, 'El Zapote'),
(786, 47, 6, 'Las Caleras o El Horno'),
(787, 47, 7, 'San Jerónimo'),
(788, 48, 1, 'El Paraíso'),
(789, 48, 2, 'Agua Buena'),
(790, 48, 3, 'Buena Vista'),
(791, 48, 4, 'El Charcón'),
(792, 48, 5, 'El Infiernillo o Nuevo Triunfo'),
(793, 48, 6, 'El Limón'),
(794, 48, 7, 'El Manacal'),
(795, 48, 8, 'El Manguito'),
(796, 48, 9, 'El Tesoro'),
(797, 48, 10, 'La Cumbre'),
(798, 48, 11, 'La Laguna'),
(799, 48, 12, 'La Peña'),
(800, 48, 13, 'La Pimienta'),
(801, 48, 14, 'La Playona'),
(802, 48, 15, 'Las Delicias del Chispal'),
(803, 48, 16, 'Las Flores'),
(804, 48, 17, 'Las Juntas'),
(805, 48, 18, 'Las Orquídeas o El Astillero'),
(806, 48, 19, 'Libertad Nueva'),
(807, 48, 20, 'Libertad Vieja'),
(808, 48, 21, 'Naranjito'),
(809, 48, 22, 'Río Lindo'),
(810, 48, 23, 'San Antonio de Las Crucitas'),
(811, 48, 24, 'San Cristóbal'),
(812, 48, 25, 'San Marcos'),
(813, 48, 26, 'Santa Cruz'),
(814, 48, 27, 'Santa Lucía'),
(815, 49, 1, 'Florida'),
(816, 49, 2, 'Arranca Barba'),
(817, 49, 3, 'Barranca Grita'),
(818, 49, 4, 'Buena Vista'),
(819, 49, 5, 'Buenos Aires'),
(820, 49, 6, 'Concepción de La Barranca'),
(821, 49, 7, 'El Dormitorio No.2'),
(822, 49, 8, 'El Espiritu Santo'),
(823, 49, 9, 'El Jardín'),
(824, 49, 10, 'El Nuevo Porvenir'),
(825, 49, 11, 'El Porvenir o San Marcos'),
(826, 49, 12, 'El Rosario o Zompopero'),
(827, 49, 13, 'Gritaderos'),
(828, 49, 14, 'La Cumbre de Las Flores'),
(829, 49, 15, 'La Elencia'),
(830, 49, 16, 'La Elencita'),
(831, 49, 17, 'La Laguna de San José'),
(832, 49, 18, 'La Ruidosa'),
(833, 49, 19, 'La Sierra'),
(834, 49, 20, 'La Unión'),
(835, 49, 21, 'Las Cañas'),
(836, 49, 22, 'Las Flores de Techín'),
(837, 49, 23, 'Las Palmeras de La Planada'),
(838, 49, 24, 'Los Dubones'),
(839, 49, 25, 'Los Lesquines'),
(840, 49, 26, 'Pastoreadero'),
(841, 49, 27, 'Plancitos o Berlín'),
(842, 49, 28, 'Potrerillos'),
(843, 49, 29, 'Pueblo Nuevo'),
(844, 49, 30, 'Rastrojitos'),
(845, 49, 31, 'San Antonio'),
(846, 49, 32, 'San José de La Frontera'),
(847, 49, 33, 'San Lorenzo de Techín'),
(848, 49, 34, 'San Rafael'),
(849, 49, 35, 'Siete Cuchillas'),
(850, 50, 1, 'La Jigua'),
(851, 50, 2, 'Aldea Nueva'),
(852, 50, 3, 'Chepelares'),
(853, 50, 4, 'El Campanario'),
(854, 50, 5, 'El Puente Goascorán'),
(855, 50, 6, 'El Rincón o San Francisco'),
(856, 50, 7, 'La Colmena'),
(857, 50, 8, 'La Cuchilla de Platanares'),
(858, 50, 9, 'La Nueva Unión'),
(859, 50, 10, 'Piedra Pintada'),
(860, 50, 11, 'Valle de Magdalena o La Laguna'),
(861, 51, 1, 'La Unión'),
(862, 51, 2, 'Azacualpa'),
(863, 51, 3, 'El Corpus'),
(864, 51, 4, 'El Junco'),
(865, 51, 5, 'El Trigo'),
(866, 51, 6, 'La Arena'),
(867, 51, 7, 'Las Minas de San Andrés'),
(868, 51, 8, 'San Miguel'),
(869, 51, 9, 'Santa Cruz'),
(870, 52, 1, 'La Entrada'),
(871, 52, 2, 'Agua Buena'),
(872, 52, 3, 'Buenos Aires'),
(873, 52, 4, 'Chalmeca'),
(874, 52, 5, 'Jimerico o Piedra Parada'),
(875, 52, 6, 'La Cuchilla'),
(876, 52, 7, 'La Unión'),
(877, 52, 8, 'Los Pozos'),
(878, 52, 9, 'Los Tangos'),
(879, 52, 10, 'Nueva Arcadia'),
(880, 52, 11, 'Quebrada Seca'),
(881, 52, 12, 'San Isidro'),
(882, 52, 13, 'San Pablo del Roble'),
(883, 53, 1, 'San Agustín'),
(884, 53, 2, 'Cerro Negro'),
(885, 53, 3, 'El Descombro'),
(886, 53, 4, 'Granadillal'),
(887, 54, 1, 'San Antonio'),
(888, 54, 2, 'Concepción'),
(889, 54, 3, 'El Ocotón o Villa Nueva'),
(890, 54, 4, 'La Reina'),
(891, 54, 5, 'La Zumbadora'),
(892, 54, 6, 'Loma Ancha'),
(893, 54, 7, 'Peña Blanca'),
(894, 54, 8, 'Pueblo Nuevo'),
(895, 54, 9, 'Quebrada Grande'),
(896, 54, 10, 'Quebrada Honda'),
(897, 54, 11, 'San Joaquín'),
(898, 54, 12, 'San Luis'),
(899, 54, 13, 'San Raimundo'),
(900, 54, 14, 'Tierra Colorada'),
(901, 55, 1, 'San Jerónimo'),
(902, 55, 2, 'Agua Zarca'),
(903, 55, 3, 'El Rosario'),
(904, 55, 4, 'El Tránsito'),
(905, 55, 5, 'El Volcán'),
(906, 55, 6, 'La Esperanza'),
(907, 55, 7, 'Santa Elena'),
(908, 55, 8, 'Tierra Blanca'),
(909, 56, 1, 'San José'),
(910, 56, 2, 'Buena Vista'),
(911, 56, 3, 'El Porvenir'),
(912, 56, 4, 'Las Delicias'),
(913, 56, 5, 'Plan de San Jerónimo'),
(914, 56, 6, 'Vivistorio'),
(915, 57, 1, 'San Juan de Opoa'),
(916, 57, 2, 'La Colatina'),
(917, 57, 3, 'El Contamal'),
(918, 57, 4, 'El Coyolar'),
(919, 57, 5, 'El Limón'),
(920, 57, 6, 'El Pinal'),
(921, 57, 7, 'El Portillo'),
(922, 57, 8, 'La Cebratana'),
(923, 57, 9, 'La Laguna Negra'),
(924, 57, 11, 'La Majada'),
(925, 57, 12, 'Las Sandías'),
(926, 57, 13, 'Los Linderos'),
(927, 57, 14, 'Los Pozos'),
(928, 57, 15, 'Santa Elena'),
(929, 57, 16, 'Torihuaque'),
(930, 58, 1, 'San Nicolás'),
(931, 58, 2, 'Buena Vista o El Tablón'),
(932, 58, 3, 'El Achiotal'),
(933, 58, 4, 'El Modelo'),
(934, 58, 5, 'El Porvenir'),
(935, 58, 6, 'La Puerta'),
(936, 58, 7, 'Nueva Concepción del Carmen'),
(937, 59, 1, 'San Pedro'),
(938, 59, 2, 'Cartagua'),
(939, 59, 3, 'El Zapote'),
(940, 59, 4, 'Las Capucas'),
(941, 59, 5, 'San Fco. o El Ejido'),
(942, 59, 6, 'Yaunera'),
(943, 60, 1, 'Santa Rita'),
(944, 60, 2, 'Agua Caliente'),
(945, 60, 3, 'Buena Vista'),
(946, 60, 4, 'Campamento'),
(947, 60, 5, 'El Gobiado'),
(948, 60, 6, 'El Jaral'),
(949, 60, 7, 'El Mirador'),
(950, 60, 8, 'El Planón'),
(951, 60, 9, 'El Raizal'),
(952, 60, 10, 'El Rosario'),
(953, 60, 11, 'El Tamarindo'),
(954, 60, 12, 'Gotas de Sangre'),
(955, 60, 13, 'La Canteada'),
(956, 60, 14, 'La Casita'),
(957, 60, 15, 'La Libertad'),
(958, 60, 16, 'La Reforma'),
(959, 60, 17, 'La Unión Otuta'),
(960, 60, 18, 'Las Medias'),
(961, 60, 19, 'Las Mesas'),
(962, 60, 20, 'Los Achiotes'),
(963, 60, 21, 'Los Planes de La Brea'),
(964, 60, 22, 'Los Ranchos'),
(965, 60, 23, 'Minas de Piedras'),
(966, 60, 24, 'Mirasol'),
(967, 60, 25, 'Plan Grande'),
(968, 60, 26, 'Rastrojitos'),
(969, 60, 27, 'Río Amarillo'),
(970, 60, 28, 'Río Blanco'),
(971, 60, 29, 'San Jerónimo'),
(972, 60, 30, 'Tierra Fría No.1'),
(973, 60, 31, 'Tierra Fría No.2'),
(974, 60, 32, 'Vara de Cohete'),
(975, 61, 1, 'Trinidad de Copán'),
(976, 61, 2, 'Cerro Azul'),
(977, 61, 3, 'La Cumbre'),
(978, 61, 4, 'Lepaerita'),
(979, 61, 5, 'Quebraditas'),
(980, 61, 6, 'San Juan de Planes'),
(981, 62, 1, 'Veracruz'),
(982, 62, 2, 'Agua Caliente'),
(983, 62, 3, 'El Triunfo'),
(984, 62, 4, 'San Antonio'),
(985, 63, 1, 'San Pedro Sula'),
(986, 63, 2, 'Artemisales'),
(987, 63, 3, 'Bañaderos o Guadalupe'),
(988, 63, 4, 'Berlín'),
(989, 63, 5, 'Buena Vista'),
(990, 63, 6, 'Buenos Aires de Bañaderos'),
(991, 63, 7, 'Campo La Mesa'),
(992, 63, 8, 'Cofradía'),
(993, 63, 9, 'Copén'),
(994, 63, 10, 'Corrientes'),
(995, 63, 11, 'Chotepe'),
(996, 63, 12, 'El Corbano'),
(997, 63, 13, 'El Gallito o Laguna de Tembladeros'),
(998, 63, 14, 'El Palmar'),
(999, 63, 15, 'El Zapotal Sur'),
(1000, 63, 16, 'Flor del Valle'),
(1001, 63, 17, 'La Ceibita'),
(1002, 63, 18, 'La Cuchilla de La Nueva Concepción'),
(1003, 63, 19, 'La Cumbre'),
(1004, 63, 20, 'La Fortuna'),
(1005, 63, 21, 'La Libertad'),
(1006, 63, 22, 'La Neblina de Miramar'),
(1007, 63, 23, 'La Pita'),
(1008, 63, 24, 'La Unión de Río Frío'),
(1009, 63, 25, 'La Virtud'),
(1010, 63, 26, 'Laguna de Bañaderos'),
(1011, 63, 27, 'Las Brisas del Merendón'),
(1012, 63, 28, 'Las Delicias'),
(1013, 63, 29, 'Las Flores de Río Frío'),
(1014, 63, 30, 'Las Juntas de Bañaderos'),
(1015, 63, 31, 'Mayén'),
(1016, 63, 32, 'Miramelinda'),
(1017, 63, 33, 'Naco'),
(1018, 63, 34, 'Nuevo Edén'),
(1019, 63, 35, 'Peñitas Abajo'),
(1020, 63, 36, 'Peñitas Arriba'),
(1021, 63, 37, 'Perú'),
(1022, 63, 38, 'Sabana de Jucutuma'),
(1023, 63, 39, 'San Antonio de Las Palmas'),
(1024, 63, 40, 'San Antonio del Perú o El Carmen'),
(1025, 63, 41, 'San Cristóbal'),
(1026, 63, 42, 'San José de Cortés'),
(1027, 63, 43, 'San José del Boquerón'),
(1028, 63, 44, 'San José de Manchaguala'),
(1029, 63, 45, 'San Lorenzo'),
(1030, 63, 46, 'San Martín'),
(1031, 63, 47, 'Santa Ana'),
(1032, 63, 48, 'Santa Elena'),
(1033, 63, 49, 'Santa Lucía'),
(1034, 63, 50, 'Santa Margarita o Guanales'),
(1035, 63, 51, 'Santa Marta'),
(1036, 63, 52, 'Santa Teresa de Bañaderos'),
(1037, 63, 53, 'Tomalá'),
(1038, 63, 54, 'Zapotal del Norte'),
(1039, 64, 1, 'Choloma'),
(1040, 64, 2, 'Banderas'),
(1041, 64, 3, 'Buenos Aires de California'),
(1042, 64, 4, 'El Barreal No.1'),
(1043, 64, 5, 'El Chorrerón'),
(1044, 64, 6, 'El Guanacaste'),
(1045, 64, 7, 'El Higuero'),
(1046, 64, 8, 'El Ocotillo Occidental'),
(1047, 64, 9, 'El Planchón de Lupo Viejo'),
(1048, 64, 10, 'El Portillo No.1'),
(1049, 64, 11, 'El Rancho'),
(1050, 64, 12, 'El Tamarindo'),
(1051, 64, 13, 'Finca Tibombo'),
(1052, 64, 14, 'La Bueso'),
(1053, 64, 15, 'La Ceibita'),
(1054, 64, 16, 'La Danta No.1'),
(1055, 64, 17, 'La Davis'),
(1056, 64, 18, 'La Funez'),
(1057, 64, 19, 'La Gálvez'),
(1058, 64, 20, 'La Hicaca o San Isidro'),
(1059, 64, 21, 'La Jutosa'),
(1060, 64, 22, 'La Lechuga No.1'),
(1061, 64, 23, 'La Protección'),
(1062, 64, 24, 'Las Delicias'),
(1063, 64, 25, 'Las Flores'),
(1064, 64, 26, 'Los Caraos'),
(1065, 64, 27, 'Los Planes'),
(1066, 64, 28, 'Montañuela'),
(1067, 64, 29, 'Monterrey'),
(1068, 64, 30, 'Nueva Florida'),
(1069, 64, 31, 'Poza del Riel'),
(1070, 64, 32, 'Quebrada Seca'),
(1071, 64, 33, 'Río Arriba'),
(1072, 64, 34, 'Río Bijao'),
(1073, 64, 35, 'Río Blanquito'),
(1074, 64, 36, 'San José de Los Laureles'),
(1075, 64, 37, 'San Marcos de Majaine'),
(1076, 64, 38, 'Santa Marta'),
(1077, 64, 39, 'Ticamaya'),
(1078, 64, 40, 'Victoria de Cristales'),
(1079, 64, 41, 'Waler Adentro'),
(1080, 64, 42, 'Waler Bordo'),
(1081, 65, 1, 'Omoa'),
(1082, 65, 2, 'Barbas Cheles'),
(1083, 65, 3, 'Barra de Cuyamel'),
(1084, 65, 4, 'Barra del Motagua'),
(1085, 65, 5, 'Corinto'),
(1086, 65, 6, 'Cortesito'),
(1087, 65, 7, 'Cuyamel'),
(1088, 65, 8, 'Cuyamelito'),
(1089, 65, 9, 'Chachaguala o Col. Tegucigalpita'),
(1090, 65, 10, 'Chivana'),
(1091, 65, 11, 'El Paraíso'),
(1092, 65, 12, 'La Camisa'),
(1093, 65, 13, 'Los Laureles'),
(1094, 65, 14, 'Masca'),
(1095, 65, 15, 'Milla Cuatro'),
(1096, 65, 16, 'Milla Tres'),
(1097, 65, 17, 'Muchilena'),
(1098, 65, 18, 'Nuevo Tulián'),
(1099, 65, 19, 'Potrerillos'),
(1100, 65, 20, 'Pueblo Nuevo'),
(1101, 65, 21, 'Río Coto'),
(1102, 65, 22, 'Río Chiquito'),
(1103, 65, 23, 'San Carlos'),
(1104, 65, 24, 'San José de Jalisco'),
(1105, 65, 25, 'Suyapa o García'),
(1106, 65, 26, 'Tulian Campo'),
(1107, 65, 27, 'Tegucigalpita'),
(1108, 65, 28, 'Veracruz'),
(1109, 66, 1, 'Pimienta'),
(1110, 66, 2, 'Santiago'),
(1111, 67, 1, 'Potrerillos'),
(1112, 67, 2, 'Bejuco'),
(1113, 67, 3, 'Blanco Caserío'),
(1114, 67, 4, 'El Caracol'),
(1115, 67, 5, 'El Manacal'),
(1116, 67, 6, 'Higuerito Central'),
(1117, 67, 7, 'La Garroba'),
(1118, 67, 8, 'San Miguel'),
(1119, 68, 1, 'Puerto Cortés'),
(1120, 68, 2, 'Agua Caliente'),
(1121, 68, 3, 'Bajamar'),
(1122, 68, 4, 'Baracoa'),
(1123, 68, 5, 'Barra de Chamelecón'),
(1124, 68, 6, 'Bulichampa'),
(1125, 68, 7, 'Calán'),
(1126, 68, 8, 'Cedros'),
(1127, 68, 9, 'Colonia Gracias a Dios'),
(1128, 68, 10, 'Concordia'),
(1129, 68, 11, 'Chameleconcito'),
(1130, 68, 12, 'El Bálsamo'),
(1131, 68, 13, 'El Bún'),
(1132, 68, 14, 'El Chile'),
(1133, 68, 15, 'El Níspero'),
(1134, 68, 16, 'El Seis'),
(1135, 68, 17, 'Guanacastales'),
(1136, 68, 18, 'Kele Kele'),
(1137, 68, 19, 'La Campana'),
(1138, 68, 20, 'La Caoba'),
(1139, 68, 20, 'La Caoba'),
(1140, 68, 21, 'La Junta'),
(1141, 68, 22, 'La Pita'),
(1142, 68, 23, 'La Sabana'),
(1143, 68, 24, 'Las Delicias'),
(1144, 68, 25, 'Manacalito'),
(1145, 68, 26, 'Medina Abajo'),
(1146, 68, 27, 'Nisperales'),
(1147, 68, 28, 'Nola'),
(1148, 68, 29, 'Paleto'),
(1149, 68, 30, 'Puente Alto'),
(1150, 68, 31, 'Puente Baracoa'),
(1151, 68, 32, 'Río Arriba'),
(1152, 68, 33, 'Robles'),
(1153, 68, 34, 'Santa Inés'),
(1154, 68, 35, 'Saraguayna'),
(1155, 68, 36, 'Sauce'),
(1156, 68, 37, 'Ticamaya'),
(1157, 68, 38, 'Travesia'),
(1158, 69, 1, 'San Antonio de Cortes'),
(1159, 69, 2, 'Buenos Aires'),
(1160, 69, 3, 'El Aguacate'),
(1161, 69, 4, 'El Encanto'),
(1162, 69, 5, 'El Picacho'),
(1163, 69, 6, 'El Sitio'),
(1164, 69, 7, 'La Calera o Buena Vista'),
(1165, 69, 8, 'La Ceibita'),
(1166, 69, 9, 'La Chachona o El Paraíso'),
(1167, 69, 10, 'La Masica'),
(1168, 69, 11, 'La Providencia'),
(1169, 69, 12, 'Las Casitas'),
(1170, 69, 13, 'Las Colmenas'),
(1171, 69, 14, 'Las Crucitas'),
(1172, 69, 15, 'Las Margaritas'),
(1173, 69, 16, 'Las Palomas'),
(1174, 69, 17, 'Loma Larga'),
(1175, 69, 18, 'Nueva Granada'),
(1176, 69, 19, 'Quebrada Seca'),
(1177, 69, 20, 'San José de Cortés o Cordoncillos'),
(1178, 69, 21, 'San Luis'),
(1179, 69, 22, 'Santa Rita'),
(1180, 69, 23, 'Vallecito'),
(1181, 70, 1, 'San Francisco de Yojoa'),
(1182, 70, 2, 'Cañaveral'),
(1183, 70, 3, 'La Virtud'),
(1184, 70, 4, 'Los Hules'),
(1185, 70, 5, 'Pedernales'),
(1186, 70, 6, 'Quebrada de Agua'),
(1187, 70, 7, 'Río Lindo'),
(1188, 70, 8, 'San Buenaventura'),
(1189, 70, 9, 'Tapiquilares'),
(1190, 71, 1, 'San Manuel'),
(1191, 71, 2, 'Campo Casenave'),
(1192, 71, 3, 'Col. La Democracia'),
(1193, 71, 4, 'Col. La Guadalupe'),
(1194, 71, 5, 'Col. Pineda'),
(1195, 71, 6, 'Coulee'),
(1196, 71, 7, 'El Plan'),
(1197, 71, 8, 'El Porvenir'),
(1198, 71, 9, 'La Libertad o Las Lomas'),
(1199, 71, 10, 'La Sabana'),
(1200, 71, 11, 'Omonita'),
(1201, 72, 1, 'Santa Cruz de Yojoa'),
(1202, 72, 2, 'Achiotal'),
(1203, 72, 3, 'Agua Azul Rancho'),
(1204, 72, 4, 'Agua Azul Sierra'),
(1205, 72, 5, 'Buena Vista'),
(1206, 72, 6, 'Campo Llano'),
(1207, 72, 7, 'Campo Olivo'),
(1208, 72, 8, 'Casas Viejas'),
(1209, 72, 9, 'Concepción'),
(1210, 72, 10, 'Cordoncillo'),
(1211, 72, 11, 'El Cacao'),
(1212, 72, 12, 'El Chaguitón'),
(1213, 72, 13, 'El Edén'),
(1214, 72, 14, 'El Jaral'),
(1215, 72, 15, 'El Llano'),
(1216, 72, 16, 'El Olivar'),
(1217, 72, 17, 'El Plan Grande'),
(1218, 72, 18, 'El Tigre'),
(1219, 72, 19, 'El Zapote'),
(1220, 72, 20, 'La Barca'),
(1221, 72, 21, 'La Ceiba'),
(1222, 72, 22, 'La Ceibita'),
(1223, 72, 23, 'La Danta'),
(1224, 72, 24, 'La Estribana'),
(1225, 72, 25, 'La Guama'),
(1226, 72, 26, 'La Jutosa'),
(1227, 72, 27, 'La Laguna'),
(1228, 72, 28, 'La Quesera o El Paraíso'),
(1229, 72, 29, 'Las Cañas'),
(1230, 72, 30, 'Las Delicias'),
(1231, 72, 31, 'Las Marías'),
(1232, 72, 32, 'Los Caminos'),
(1233, 72, 33, 'Los Mangos'),
(1234, 72, 34, 'Los Naranjos'),
(1235, 72, 35, 'Montaña de La Reina'),
(1236, 72, 36, 'Monte Verde'),
(1237, 72, 37, 'Nueva Esperanza'),
(1238, 72, 38, 'Oropéndolas'),
(1239, 72, 39, 'Peña Blanca'),
(1240, 72, 40, 'Pinolapa'),
(1241, 72, 41, 'Pueblo Quemado'),
(1242, 72, 42, 'San Antonio'),
(1243, 72, 43, 'San Isidro'),
(1244, 72, 44, 'San José de Balincito'),
(1245, 72, 45, 'San Luis de Zacatales'),
(1246, 72, 46, 'Santa Elena'),
(1247, 72, 47, 'Terreritos de La Libertad'),
(1248, 72, 48, 'Victoria'),
(1249, 72, 49, 'Yojoa'),
(1250, 73, 1, 'Villanueva'),
(1251, 73, 2, 'Buenos Aires'),
(1252, 73, 3, 'Calán'),
(1253, 73, 4, 'Campo Dos Caminos'),
(1254, 73, 5, 'El Cuábano'),
(1255, 73, 6, 'El Marañón'),
(1256, 73, 7, 'El Milagro'),
(1257, 73, 8, 'El Sauce'),
(1258, 73, 9, 'Guaruma Dos'),
(1259, 73, 10, 'La Bolsa'),
(1260, 73, 11, 'La Cebadilla'),
(1261, 73, 12, 'La Coroza'),
(1262, 73, 13, 'La Esperanza o El Venado'),
(1263, 73, 14, 'Las Cañadas'),
(1264, 73, 15, 'Nuevo Chamelecón'),
(1265, 73, 16, 'Palos Blancos'),
(1266, 73, 17, 'Pueblo Nuevo'),
(1267, 73, 18, 'San Francisco o El Coyolón'),
(1268, 73, 19, 'San Isidro'),
(1269, 73, 20, 'Santa Ana de Chasnigua'),
(1270, 74, 1, 'La Lima'),
(1271, 74, 2, 'Cruz de Valencia'),
(1272, 74, 3, 'El Paraíso'),
(1273, 74, 4, 'Flor de Oriente'),
(1274, 75, 1, 'Choluteca'),
(1275, 75, 2, 'Agua Caliente de Linaca'),
(1276, 75, 3, 'Copal Abajo'),
(1277, 75, 4, 'Copal Arriba'),
(1278, 75, 5, 'El Apintal'),
(1279, 75, 6, 'El Carrizo'),
(1280, 75, 7, 'El Palenque'),
(1281, 75, 8, 'El Papalón'),
(1282, 75, 9, 'El Pillado'),
(1283, 75, 10, 'El Terrero Blanco'),
(1284, 75, 11, 'El Trapiche'),
(1285, 75, 12, 'Fray Lázaro'),
(1286, 75, 13, 'Hato Nuevo'),
(1287, 75, 14, 'La Castaña o Santa Cruz de Yarile'),
(1288, 75, 15, 'La Picota'),
(1289, 75, 16, 'Linaca'),
(1290, 75, 17, 'Madrial'),
(1291, 75, 18, 'Pavana'),
(1292, 75, 19, 'San José de La Landa'),
(1293, 75, 20, 'San Martín'),
(1294, 75, 21, 'San Rafael'),
(1295, 75, 22, 'San Ramón Abajo'),
(1296, 75, 23, 'San Ramon Arriba'),
(1297, 75, 24, 'Santa Rosa de Sampile'),
(1298, 75, 25, 'Tapaire'),
(1299, 75, 26, 'Tapatoca'),
(1300, 76, 1, 'Apacilagua'),
(1301, 76, 2, 'La Albarrada'),
(1302, 76, 3, 'La Garza'),
(1303, 76, 4, 'Los Limones'),
(1304, 76, 5, 'Los Mezcales'),
(1305, 76, 6, 'Monte Grande'),
(1306, 76, 7, 'San Felipe'),
(1307, 76, 8, 'Somuina'),
(1308, 77, 1, 'Concepción de Maria'),
(1309, 77, 2, 'Cerro Colorado'),
(1310, 77, 3, 'El Aguacatal'),
(1311, 77, 4, 'El Cacao'),
(1312, 77, 5, 'El Cerrón'),
(1313, 77, 6, 'El Jicarito'),
(1314, 77, 7, 'El Pacón'),
(1315, 77, 8, 'El Palito'),
(1316, 77, 9, 'El Papalón'),
(1317, 77, 10, 'El Peñón'),
(1318, 77, 11, 'El Potrerito'),
(1319, 77, 12, 'El Sunzapote'),
(1320, 77, 13, 'El Tejar'),
(1321, 77, 14, 'El Terrero'),
(1322, 77, 15, 'Guanacaste'),
(1323, 77, 16, 'La Guaruma'),
(1324, 77, 17, 'La Joya'),
(1325, 77, 18, 'La Majada'),
(1326, 77, 19, 'La Montaña'),
(1327, 77, 20, 'La Pabellona'),
(1328, 77, 21, 'La Plomosa No.2'),
(1329, 77, 22, 'La Veta'),
(1330, 77, 23, 'Las Chapernas'),
(1331, 77, 24, 'Las Mesas'),
(1332, 77, 25, 'Las Pintadas'),
(1333, 77, 26, 'Los Espaveles'),
(1334, 77, 27, 'Los Llanitos'),
(1335, 77, 28, 'Los Matapalos'),
(1336, 77, 29, 'Nance Dulce'),
(1337, 77, 30, 'Palo Solo'),
(1338, 77, 31, 'Santa Rosa'),
(1339, 77, 32, 'San Benito Nuevo'),
(1340, 77, 33, 'San Benito Viejo'),
(1341, 78, 1, 'Duyure'),
(1342, 78, 2, 'Arado Grande'),
(1343, 78, 3, 'El Carrizal Prieto'),
(1344, 78, 4, 'El Horno'),
(1345, 78, 5, 'Liraqui'),
(1346, 78, 6, 'Tierra Colorada'),
(1347, 79, 1, 'El Corpus'),
(1348, 79, 2, 'Agua Fría'),
(1349, 79, 3, 'Calaire'),
(1350, 79, 4, 'Cayanini'),
(1351, 79, 5, 'El Baldoquín'),
(1352, 79, 6, 'El Banquito'),
(1353, 79, 7, 'El Despoblado'),
(1354, 79, 8, 'El Naranjal'),
(1355, 79, 9, 'El Pedregal'),
(1356, 79, 10, 'El Zapotal'),
(1357, 79, 11, 'La Albarrada'),
(1358, 79, 12, 'La Fortuna'),
(1359, 79, 13, 'La Galera'),
(1360, 79, 14, 'San Isidro'),
(1361, 79, 15, 'San Juan Abajo'),
(1362, 79, 16, 'San Juan Arriba'),
(1363, 79, 17, 'San Judas'),
(1364, 80, 1, 'El Triunfo'),
(1365, 80, 2, 'Azacualpa'),
(1366, 80, 3, 'El Cedrito'),
(1367, 80, 4, 'El Perico'),
(1368, 80, 5, 'La Calera'),
(1369, 80, 6, 'Las Haciendas'),
(1370, 80, 7, 'Nance Dulce'),
(1371, 80, 8, 'Río Grande'),
(1372, 80, 9, 'San Juan'),
(1373, 80, 10, 'Santa Maria'),
(1374, 80, 11, 'Santa Teresa'),
(1375, 81, 1, 'Marcovia'),
(1376, 81, 2, 'Cedeño'),
(1377, 81, 3, 'Colonia Buena Vista'),
(1378, 81, 4, 'El Botadero'),
(1379, 81, 5, 'El Obraje'),
(1380, 81, 6, 'El Papalón'),
(1381, 81, 7, 'Guapinol'),
(1382, 81, 8, 'La Gervacia'),
(1383, 81, 9, 'La Joyada'),
(1384, 81, 10, 'Las Arenas'),
(1385, 81, 11, 'Las Pozas'),
(1386, 81, 12, 'Los Llanitos'),
(1387, 81, 13, 'Los Mangles'),
(1388, 81, 14, 'Monjarás'),
(1389, 81, 15, 'Piedra de Agua'),
(1390, 81, 16, 'Pueblo Nuevo'),
(1391, 81, 17, 'Punta Ratón'),
(1392, 81, 18, 'San Jose de Las Conchas'),
(1393, 81, 19, 'San Juan Bosco No.2'),
(1394, 81, 20, 'Santa Cruz'),
(1395, 81, 21, 'Tambor Abajo'),
(1396, 82, 1, 'Morolica'),
(1397, 82, 2, 'Agualcaguaire'),
(1398, 82, 3, 'Cerco de Piedra'),
(1399, 82, 4, 'El Potrero'),
(1400, 82, 5, 'La Enea'),
(1401, 82, 6, 'San Marquitos'),
(1402, 83, 1, 'Namasigue'),
(1403, 83, 2, 'San Bernardo'),
(1404, 83, 3, 'San Francisco'),
(1405, 83, 4, 'San Isidro'),
(1406, 83, 5, 'San Jerónimo'),
(1407, 83, 6, 'San Rafael'),
(1408, 83, 7, 'Santa Irene'),
(1409, 83, 8, 'Tierra Blanca'),
(1410, 83, 9, 'Yorolán'),
(1411, 84, 1, 'Orocuina'),
(1412, 84, 2, 'Concepción'),
(1413, 84, 3, 'El Barreal'),
(1414, 84, 4, 'Mal Paso'),
(1415, 84, 5, 'San Andrés'),
(1416, 84, 6, 'San José'),
(1417, 84, 7, 'Santa Ana'),
(1418, 84, 8, 'Santa Cruz'),
(1419, 84, 9, 'Santa Lucía'),
(1420, 85, 1, 'Pespire'),
(1421, 85, 2, 'Cacautare'),
(1422, 85, 3, 'Concepción El Brasilar'),
(1423, 85, 4, 'El Espinal'),
(1424, 85, 5, 'El Guayabo'),
(1425, 85, 6, 'Esquimay Arriba o La Ermita'),
(1426, 85, 7, 'Marilica'),
(1427, 85, 8, 'San Antonio de Padua'),
(1428, 85, 9, 'San Juan Bautista'),
(1429, 85, 10, 'San Juan Bosco'),
(1430, 86, 1, 'San Antonio de Flores'),
(1431, 86, 2, 'El Jícaro'),
(1432, 86, 3, 'Las Playitas'),
(1433, 86, 4, 'Moramulca'),
(1434, 87, 1, 'San Isidro'),
(1435, 87, 2, 'El Caulote'),
(1436, 87, 3, 'El Obrajito'),
(1437, 87, 4, 'Sonit'),
(1438, 88, 1, 'San José'),
(1439, 88, 2, 'Coraycito'),
(1440, 88, 3, 'El Cacao'),
(1441, 88, 4, 'El Macuelizo'),
(1442, 88, 5, 'La Crucita'),
(1443, 88, 6, 'Las Marías'),
(1444, 89, 1, 'San Marcos de Colón'),
(1445, 89, 2, 'Cacamuya'),
(1446, 89, 3, 'Caire'),
(1447, 89, 4, 'Comalí'),
(1448, 89, 5, 'El Inventario'),
(1449, 89, 6, 'El Ojo de Agua'),
(1450, 89, 7, 'El Rodeo'),
(1451, 89, 8, 'Jayacayán'),
(1452, 89, 9, 'La Joya'),
(1453, 89, 10, 'La Quesera'),
(1454, 89, 11, 'Las Mesas de Colón'),
(1455, 89, 12, 'Los Encuentros'),
(1456, 89, 13, 'Los Maicillales'),
(1457, 89, 14, 'Oyoto'),
(1458, 89, 15, 'San Diego'),
(1459, 89, 16, 'San Francisco'),
(1460, 89, 17, 'San Juan de Duyusupo'),
(1461, 89, 18, 'Santa Rita'),
(1462, 90, 1, 'Santa Ana de Yusguare'),
(1463, 90, 2, 'Cerco de Piedra'),
(1464, 90, 3, 'El Cerro'),
(1465, 90, 4, 'La Tajeada'),
(1466, 90, 5, 'Pueblo Nuevo'),
(1467, 90, 6, 'Tablones Abajo'),
(1468, 90, 7, 'Tablones Arriba'),
(1469, 91, 1, 'Yuscarán'),
(1470, 91, 2, 'El Barro'),
(1471, 91, 3, 'El Cordoncillo'),
(1472, 91, 4, 'El Chaguite de Oriente'),
(1473, 91, 5, 'El Chaguite Sur'),
(1474, 91, 6, 'El Ocotal'),
(1475, 91, 7, 'El Pericón'),
(1476, 91, 8, 'El Rancho del Obispo'),
(1477, 91, 9, 'El Robledal'),
(1478, 91, 10, 'El Rodeo'),
(1479, 91, 11, 'El Teñidero'),
(1480, 91, 12, 'El Zarzal'),
(1481, 91, 13, 'La Ciénega'),
(1482, 91, 14, 'La Insula'),
(1483, 91, 15, 'Las Crucitas'),
(1484, 91, 16, 'Los Laínez'),
(1485, 91, 17, 'Ojo de Agua'),
(1486, 91, 18, 'Sabana Redonda'),
(1487, 92, 1, 'Alauca'),
(1488, 92, 2, 'Buena Vista'),
(1489, 92, 3, 'Chaguite Grande'),
(1490, 92, 4, 'Chinampa o Chilampa'),
(1491, 92, 5, 'El Jícaro'),
(1492, 92, 6, 'El Matapalo'),
(1493, 92, 7, 'El Pedregalito'),
(1494, 92, 8, 'La Chichigua'),
(1495, 92, 9, 'La Jagua'),
(1496, 92, 10, 'La Manzanilla'),
(1497, 92, 11, 'Las Limas'),
(1498, 92, 12, 'Las Manos'),
(1499, 92, 13, 'Los Matasanos de Río Arriba'),
(1500, 92, 14, 'San Antonio'),
(1501, 93, 1, 'Danlí'),
(1502, 93, 2, 'Agua Fría'),
(1503, 93, 3, 'Apalí'),
(1504, 93, 4, 'Araulí'),
(1505, 93, 5, 'Bañaderos'),
(1506, 93, 6, 'Buena Esperanza de Azabache'),
(1507, 93, 7, 'Chirinos'),
(1508, 93, 8, 'El Arenal'),
(1509, 93, 9, 'El Barro'),
(1510, 93, 10, 'El Chichicaste'),
(1511, 93, 11, 'El Maguelar'),
(1512, 93, 12, 'El Matasano'),
(1513, 93, 13, 'El Obraje'),
(1514, 93, 14, 'El Olingo o El Porvenir'),
(1515, 93, 15, 'El Pataste'),
(1516, 93, 16, 'El Pescadero'),
(1517, 93, 17, 'El Porvenir'),
(1518, 93, 18, 'El Pozo Bendito'),
(1519, 93, 19, 'El Tablón'),
(1520, 93, 20, 'El Zamorano'),
(1521, 93, 21, 'El Zapotillo'),
(1522, 93, 22, 'El Zarzal'),
(1523, 93, 23, 'Gualiqueme'),
(1524, 93, 24, 'Jutiapa'),
(1525, 93, 25, 'La Lima'),
(1526, 93, 26, 'La Lodosa'),
(1527, 93, 27, 'La Trinidad o Sartenejas'),
(1528, 93, 28, 'Las Animas'),
(1529, 93, 29, 'Linaca'),
(1530, 93, 30, 'Palmillas'),
(1531, 93, 31, 'Quebrada Arriba u Oculí'),
(1532, 93, 32, 'Quebrada Larga'),
(1533, 93, 33, 'San Diego'),
(1534, 93, 34, 'San Julian'),
(1535, 93, 35, 'San Marcos Abajo'),
(1536, 93, 36, 'Santa María'),
(1537, 93, 38, 'Villa Santa'),
(1538, 94, 1, 'El Paraíso'),
(1539, 94, 2, 'Cuyalí'),
(1540, 94, 3, 'Dificultades'),
(1541, 94, 4, 'Granadillos'),
(1542, 94, 5, 'La Unión'),
(1543, 94, 6, 'Las Cañas'),
(1544, 94, 7, 'Las Flores'),
(1545, 94, 8, 'Las Manos'),
(1546, 94, 9, 'Las Selvas'),
(1547, 94, 10, 'Los Terrones'),
(1548, 94, 11, 'Los Volcanes'),
(1549, 94, 12, 'San Antonio de Conchagua'),
(1550, 94, 13, 'Santa Cruz'),
(1551, 95, 1, 'Guinope'),
(1552, 95, 2, 'Arrayanes'),
(1553, 95, 3, 'Casitas'),
(1554, 95, 4, 'Galeras'),
(1555, 95, 5, 'Las Liquidámbas'),
(1556, 95, 6, 'Lavanderos'),
(1557, 95, 7, 'Mansaragua'),
(1558, 95, 8, 'Pacayas'),
(1559, 95, 9, 'Santa Rosa'),
(1560, 95, 10, 'Silisgualagua'),
(1561, 96, 1, 'Jacaleapa'),
(1562, 96, 2, 'La Chorrera'),
(1563, 96, 3, 'Lomas Limpias'),
(1564, 97, 1, 'Liure'),
(1565, 97, 2, 'Asunción'),
(1566, 97, 3, 'Bocuire'),
(1567, 97, 4, 'Monte Grande'),
(1568, 97, 5, 'San Ramón'),
(1569, 97, 6, 'Santa Cruz'),
(1570, 98, 1, 'Morocelí'),
(1571, 98, 2, 'Buena Vista'),
(1572, 98, 3, 'El Chile o Quebrada Grande'),
(1573, 98, 5, 'El Llano'),
(1574, 98, 6, 'El Plan'),
(1575, 98, 7, 'El Retiro'),
(1576, 98, 8, 'El Suyate'),
(1577, 98, 9, 'Guadalajara'),
(1578, 98, 10, 'Hoya Grande'),
(1579, 98, 11, 'Los Limones'),
(1580, 98, 12, 'Los Liquidámbos'),
(1581, 98, 13, 'Los Pozos'),
(1582, 98, 14, 'Mata de Plátano'),
(1583, 98, 15, 'Valle Arriba'),
(1584, 99, 1, 'Oropolí'),
(1585, 99, 2, 'Chaguite Grande'),
(1586, 99, 3, 'El Barro'),
(1587, 99, 4, 'El Corralito'),
(1588, 99, 5, 'El Deshecho'),
(1589, 99, 6, 'El Jícaro'),
(1590, 99, 7, 'La Mesa'),
(1591, 99, 8, 'Las Casitas'),
(1592, 99, 9, 'Las Crucitas'),
(1593, 99, 10, 'Orealí'),
(1594, 99, 11, 'Samayare'),
(1595, 100, 1, 'Potrerillos'),
(1596, 100, 2, 'El Junquillo'),
(1597, 100, 3, 'El Limoncillo'),
(1598, 100, 4, 'Las Crucitas'),
(1599, 100, 5, 'Las Delicias'),
(1600, 100, 6, 'Loma de Enmedio'),
(1601, 100, 7, 'Lomanillos'),
(1602, 100, 8, 'Sabana Redonda'),
(1603, 101, 1, 'San Antonio de Flores'),
(1604, 101, 2, 'Apalípi'),
(1605, 101, 3, 'Comunidad'),
(1606, 101, 4, 'El Chaguite'),
(1607, 101, 5, 'El Espinal'),
(1608, 101, 6, 'Mandasta'),
(1609, 101, 7, 'Orlica'),
(1610, 101, 8, 'Quebrada Grande'),
(1611, 101, 9, 'Tolobrito'),
(1612, 102, 1, 'San Lucas'),
(1613, 102, 2, 'Apalípi'),
(1614, 102, 3, 'Candelaria'),
(1615, 102, 4, 'Junacatal'),
(1616, 102, 5, 'La Montañita'),
(1617, 102, 6, 'Los Quebrachos'),
(1618, 102, 7, 'Mactuca'),
(1619, 102, 8, 'Navijupe'),
(1620, 102, 9, 'Surule'),
(1621, 102, 10, 'Tapahuasca'),
(1622, 103, 1, 'San Matías'),
(1623, 103, 2, 'Corral Falso'),
(1624, 103, 3, 'El Espinito'),
(1625, 103, 4, 'El Guayacán'),
(1626, 103, 5, 'El Robledal'),
(1627, 103, 6, 'La Concepción'),
(1628, 103, 7, 'Las Tunas'),
(1629, 103, 8, 'San Jerónimo'),
(1630, 103, 9, 'Santa Rosa'),
(1631, 104, 1, 'Soledad'),
(1632, 104, 2, 'La Paz o Rodeíto'),
(1633, 104, 3, 'La Victoria'),
(1634, 104, 4, 'Las Marías'),
(1635, 104, 5, 'Los Alpes'),
(1636, 104, 6, 'San Diego'),
(1637, 104, 7, 'San Marcos'),
(1638, 104, 8, 'Santo Domingo'),
(1639, 105, 1, 'Teupasenti'),
(1640, 105, 2, 'Agua Fría'),
(1641, 105, 3, 'Bañaderos'),
(1642, 105, 4, 'El Cantón'),
(1643, 105, 5, 'El Corralito'),
(1644, 105, 6, 'El Chelón No.1'),
(1645, 105, 7, 'El Chilito'),
(1646, 105, 8, 'El Encino'),
(1647, 105, 9, 'El Jute'),
(1648, 105, 10, 'El Ocotal'),
(1649, 105, 11, 'El Riíto No.1'),
(1650, 105, 12, 'El Riíto No.2'),
(1651, 105, 13, 'El Riíto del Esquillal'),
(1652, 105, 14, 'El Rodeo'),
(1653, 105, 15, 'El Suyatal'),
(1654, 105, 16, 'Escobas Amarillas'),
(1655, 105, 17, 'La Aguja'),
(1656, 105, 18, 'La Cebadilla'),
(1657, 105, 19, 'La Comunidad'),
(1658, 105, 20, 'La Granja'),
(1659, 105, 21, 'La Laguna No.1'),
(1660, 105, 22, 'La Laguna No.2'),
(1661, 105, 23, 'La Zacatera'),
(1662, 105, 24, 'Las Cortinas'),
(1663, 105, 25, 'Las Delicias'),
(1664, 105, 26, 'Las Flores'),
(1665, 105, 27, 'Las Uvas'),
(1666, 105, 28, 'Los Plancitos'),
(1667, 105, 29, 'Paso Hondo'),
(1668, 105, 30, 'Pedríos'),
(1669, 105, 31, 'Peña Blanca'),
(1670, 105, 32, 'Potrerillos'),
(1671, 105, 33, 'Quebrada del Zapotillo'),
(1672, 105, 34, 'Saladino No.1'),
(1673, 105, 35, 'San Isidro'),
(1674, 105, 36, 'San José del Potrero'),
(1675, 105, 37, 'Santa Cruz'),
(1676, 105, 38, 'Santa Rosa No.1'),
(1677, 105, 39, 'Santa Rosa No.2'),
(1678, 106, 1, 'Texiguat'),
(1679, 106, 2, 'Asunción'),
(1680, 106, 3, 'El Zapotal'),
(1681, 106, 4, 'Guinopito'),
(1682, 106, 5, 'Jamayupe'),
(1683, 106, 6, 'Río Arriba'),
(1684, 106, 7, 'San Lorenzo'),
(1685, 106, 8, 'San Sebastián'),
(1686, 107, 1, 'Vado Ancho'),
(1687, 107, 2, 'Apausupo'),
(1688, 107, 3, 'Las Uvillas'),
(1689, 107, 4, 'San Jerónimo de Vado Ancho'),
(1690, 107, 5, 'Tolobre'),
(1691, 108, 1, 'Yauyupe'),
(1692, 108, 2, 'El Chaguitillo'),
(1693, 108, 3, 'El Hornito'),
(1694, 109, 1, 'Trojes'),
(1695, 109, 2, 'Arenales'),
(1696, 109, 3, 'Capire'),
(1697, 109, 4, 'Cifuentes'),
(1698, 109, 5, 'El Guineo'),
(1699, 109, 6, 'Talpachí'),
(1700, 109, 7, 'Yamales'),
(1701, 110, 1, 'Distrito Central'),
(1702, 110, 2, 'Amarateca'),
(1703, 110, 3, 'Azacualpa'),
(1704, 110, 4, 'Carpintero'),
(1705, 110, 5, 'Cerro Grande'),
(1706, 110, 6, 'Coa Abajo'),
(1707, 110, 7, 'Coa Arriba'),
(1708, 110, 8, 'Cofradía'),
(1709, 110, 9, 'Concepción de Río Grande'),
(1710, 110, 10, 'El Naranjal'),
(1711, 110, 11, 'El Piliguín'),
(1712, 110, 12, 'El Tizatillo'),
(1713, 110, 13, 'Germania'),
(1714, 110, 14, 'Guangololo'),
(1715, 110, 15, 'Guasculile'),
(1716, 110, 16, 'Jacaleapa'),
(1717, 110, 17, 'Jutiapa'),
(1718, 110, 18, 'La Calera'),
(1719, 110, 19, 'La Cuesta No.2'),
(1720, 110, 20, 'La Montañita'),
(1721, 110, 21, 'La Sábana'),
(1722, 110, 22, 'La Venta'),
(1723, 110, 23, 'Las Casitas'),
(1724, 110, 24, 'Las Flores'),
(1725, 110, 25, 'Las Tapias'),
(1726, 110, 26, 'Los Jutes'),
(1727, 110, 27, 'Mateo'),
(1728, 110, 28, 'Monte Redondo'),
(1729, 110, 29, 'Nueva Aldea'),
(1730, 110, 30, 'Río Abajo'),
(1731, 110, 31, 'Río Hondo'),
(1732, 110, 32, 'San Francisco de Soroguara'),
(1733, 110, 33, 'San Juancito'),
(1734, 110, 34, 'San Juan del Rancho'),
(1735, 110, 35, 'San Juan del Río Grande'),
(1736, 110, 36, 'San Matías');
INSERT INTO `tbl_general_aldea` (`cod_aldea`, `cod_municipio`, `num_municipio_depart_aldea`, `aldea`) VALUES
(1737, 110, 37, 'Santa Cruz Abajo'),
(1738, 110, 38, 'Santa Cruz Arriba'),
(1739, 110, 39, 'Santa Rosa'),
(1740, 110, 40, 'Soroguara'),
(1741, 110, 41, 'Támara'),
(1742, 110, 42, 'Villa Nueva'),
(1743, 110, 43, 'Yaguacire'),
(1744, 110, 44, 'Zambrano'),
(1745, 111, 1, 'Alubarén'),
(1746, 111, 2, 'La Concepción'),
(1747, 111, 3, 'Los Tablones'),
(1748, 111, 4, 'Río Arriba'),
(1749, 112, 1, 'Cedros'),
(1750, 112, 2, 'Agalteca'),
(1751, 112, 3, 'Cedros Abajo'),
(1752, 112, 4, 'El Guante'),
(1753, 112, 5, 'El Suyatal'),
(1754, 112, 6, 'El Tablón'),
(1755, 112, 7, 'La Guadalupe'),
(1756, 112, 8, 'Las Animas'),
(1757, 112, 9, 'Mata de Plátano'),
(1758, 112, 10, 'Pueblo Nuevo'),
(1759, 112, 11, 'Siria'),
(1760, 112, 12, 'Tamarindo'),
(1761, 113, 1, 'Curarén'),
(1762, 113, 2, 'Cartagua'),
(1763, 113, 3, 'Cunimisca'),
(1764, 113, 4, 'El Portillo de San Juan Bosco'),
(1765, 113, 5, 'El Porvenir'),
(1766, 113, 6, 'Emituca'),
(1767, 113, 7, 'Hato Viejo'),
(1768, 113, 8, 'La Costita'),
(1769, 113, 9, 'La Manzanilla'),
(1770, 113, 10, 'La Victorina'),
(1771, 113, 11, 'Lodo Negro'),
(1772, 113, 12, 'Macancicre'),
(1773, 113, 13, 'Mandasta'),
(1774, 113, 14, 'San José del Potrero'),
(1775, 113, 15, 'San Marcos'),
(1776, 113, 16, 'Toncontín'),
(1777, 114, 1, 'El Porvenir'),
(1778, 114, 2, 'El Agua Caliente'),
(1779, 114, 3, 'El Escanito'),
(1780, 114, 4, 'El Guantillo'),
(1781, 114, 5, 'El Pedernal'),
(1782, 114, 6, 'El Terrero'),
(1783, 114, 7, 'Guayabillas'),
(1784, 114, 8, 'Pueblo Nuevo'),
(1785, 115, 1, 'Guaimaca'),
(1786, 115, 2, 'Casas Viejas'),
(1787, 115, 3, 'Cerro Bonito'),
(1788, 115, 4, 'El Guanacaste'),
(1789, 115, 5, 'El Tomate'),
(1790, 115, 6, 'Gones'),
(1791, 115, 7, 'La Aserradera'),
(1792, 115, 8, 'La Laguna No.1'),
(1793, 115, 9, 'Río Abajo'),
(1794, 115, 10, 'Sabana Grande'),
(1795, 115, 11, 'San José'),
(1796, 115, 12, 'San Marcos'),
(1797, 115, 13, 'Sanquín'),
(1798, 116, 1, 'La Libertad'),
(1799, 116, 2, 'El Pedrero'),
(1800, 116, 3, 'Quebrachal'),
(1801, 117, 1, 'La Venta'),
(1802, 117, 2, 'El Porvenir'),
(1803, 117, 3, 'Ojos de Agua'),
(1804, 117, 4, 'Opimuca'),
(1805, 117, 5, 'San Jorge'),
(1806, 118, 1, 'Lepaterique'),
(1807, 118, 2, 'Culguaque'),
(1808, 118, 3, 'El Carrizal'),
(1809, 118, 4, 'El Espino'),
(1810, 118, 5, 'Hierbabuena'),
(1811, 118, 6, 'La Brea'),
(1812, 118, 7, 'Mulhuaca o El Llano'),
(1813, 119, 1, 'Maraita'),
(1814, 119, 2, 'Coato'),
(1815, 119, 3, 'El Chaguite'),
(1816, 119, 4, 'El Retiro'),
(1817, 119, 5, 'La Unión'),
(1818, 119, 6, 'Lizapa'),
(1819, 119, 7, 'Reducto'),
(1820, 119, 8, 'San Pedro'),
(1821, 119, 9, 'Terrero Blanco'),
(1822, 119, 10, 'Terrero Prieto'),
(1823, 120, 1, 'Marale'),
(1824, 120, 2, 'El Carrizal'),
(1825, 120, 3, 'El Panal'),
(1826, 120, 4, 'El Paraíso'),
(1827, 120, 5, 'La Esperanza o El Cacao'),
(1828, 120, 6, 'La Travesía'),
(1829, 120, 7, 'Las Casitas'),
(1830, 120, 8, 'Las Lagunas'),
(1831, 120, 9, 'Los Naranjos'),
(1832, 120, 10, 'Los Planes'),
(1833, 120, 11, 'Río Abajo'),
(1834, 121, 1, 'Nueva Armenia'),
(1835, 121, 2, 'Adurasta'),
(1836, 121, 3, 'Barajana'),
(1837, 121, 4, 'Cuesta Chiquita'),
(1838, 121, 5, 'El Platanar o Platanal'),
(1839, 121, 6, 'Las Piñuelas'),
(1840, 121, 7, 'Salalica'),
(1841, 122, 1, 'Ojojona'),
(1842, 122, 2, 'Aragua'),
(1843, 122, 3, 'El Aguacatal'),
(1844, 122, 4, 'El Circulo'),
(1845, 122, 5, 'El Jícaro'),
(1846, 122, 6, 'Guasucarán'),
(1847, 122, 7, 'Guerisne'),
(1848, 122, 8, 'Santa Cruz'),
(1849, 122, 9, 'Saracarán'),
(1850, 122, 10, 'Surcos de Caña'),
(1851, 123, 1, 'Orica'),
(1852, 123, 2, 'El Encino'),
(1853, 123, 3, 'El Nance'),
(1854, 123, 4, 'Guatemalita'),
(1855, 123, 5, 'La Joya del Quebracho'),
(1856, 123, 6, 'San Francisco de Orica'),
(1857, 123, 7, 'San Marquitos'),
(1858, 124, 1, 'Reitoca'),
(1859, 124, 2, 'Azacualpa'),
(1860, 124, 3, 'Cerro del Señor'),
(1861, 124, 4, 'El Rodeo'),
(1862, 124, 5, 'La Guadalupe'),
(1863, 124, 6, 'Sabanetas'),
(1864, 124, 7, 'San Carlos'),
(1865, 124, 8, 'San José del Naranjo'),
(1866, 124, 9, 'Santa Cruz'),
(1867, 124, 10, 'Saracarán'),
(1868, 125, 1, 'Sabanagrande'),
(1869, 125, 2, 'Apasinigua'),
(1870, 125, 3, 'Dulce Nombre'),
(1871, 125, 4, 'El Calvario No.1'),
(1872, 125, 5, 'El Calvario No.2'),
(1873, 125, 6, 'El Carrizal'),
(1874, 125, 7, 'El Divisadero'),
(1875, 125, 8, 'El Vino'),
(1876, 125, 9, 'La Ceiba'),
(1877, 125, 10, 'La Trinidad'),
(1878, 125, 11, 'Los Nanzales'),
(1879, 125, 12, 'Sacahuato'),
(1880, 125, 13, 'San Antonio'),
(1881, 125, 14, 'San Nicolas o El Zapote'),
(1882, 126, 1, 'San Antonio de Oriente'),
(1883, 126, 2, 'El Jicarito'),
(1884, 126, 3, 'El Limón'),
(1885, 126, 4, 'Hoya Grande'),
(1886, 126, 5, 'La Ciénega'),
(1887, 126, 6, 'Las Mesas'),
(1888, 126, 7, 'Las Playas'),
(1889, 126, 8, 'Los Ranchos de Flor Azul'),
(1890, 126, 9, 'San Antonio de Occidente'),
(1891, 126, 10, 'San Francisco'),
(1892, 126, 11, 'Santa Inés'),
(1893, 126, 12, 'S.O.S. (Aldeas)'),
(1894, 126, 13, 'Tabla Grande'),
(1895, 127, 1, 'San Buenaventura'),
(1896, 127, 2, 'El Calvario'),
(1897, 127, 3, 'El Ciruelo'),
(1898, 127, 4, 'El Horno'),
(1899, 128, 1, 'San Ignacio'),
(1900, 128, 2, 'El Escano de Tepale'),
(1901, 128, 3, 'El Naranjal'),
(1902, 128, 4, 'El Portillo de Siale'),
(1903, 128, 5, 'San Miguel de Barrosa'),
(1904, 128, 6, 'Urrutia'),
(1905, 128, 7, 'Yoculateca'),
(1906, 129, 1, 'San Juan de Flores'),
(1907, 129, 2, 'Cerro Bonito'),
(1908, 129, 3, 'Cofradía'),
(1909, 129, 4, 'Chandala'),
(1910, 129, 5, 'El Carbón'),
(1911, 129, 6, 'El Jicarito'),
(1912, 129, 7, 'El Ocote'),
(1913, 129, 8, 'El Zarzal'),
(1914, 129, 9, 'El Zurzular'),
(1915, 129, 10, 'Joyas de Carballo'),
(1916, 129, 11, 'La Cruz o Suyapa'),
(1917, 129, 12, 'Las Delicias'),
(1918, 129, 13, 'Marcos'),
(1919, 129, 14, 'Miravalle'),
(1920, 129, 15, 'Pacayas'),
(1921, 129, 16, 'Pajarillos'),
(1922, 129, 17, 'San José de Ramos'),
(1923, 129, 18, 'San Luis'),
(1924, 129, 19, 'Sicaguara'),
(1925, 129, 20, 'Yamaguare'),
(1926, 130, 1, 'San Miguelito'),
(1927, 130, 2, 'El Hato'),
(1928, 130, 3, 'Santa Marta'),
(1929, 131, 1, 'Santa Ana'),
(1930, 131, 2, 'Cicatacare'),
(1931, 131, 3, 'El Limón'),
(1932, 131, 4, 'La Bodega'),
(1933, 131, 5, 'Nueva Arcadia'),
(1934, 131, 6, 'San Isidro de Hisopo'),
(1935, 132, 1, 'Santa Lucía'),
(1936, 132, 2, 'El Chimbo'),
(1937, 132, 3, 'El Edén'),
(1938, 132, 4, 'El Piliguín'),
(1939, 132, 5, 'Montaña Grande o de Los Lagos'),
(1940, 132, 6, 'Zarabanda'),
(1941, 133, 1, 'Talanga'),
(1942, 133, 2, 'Agua Blanca'),
(1943, 133, 3, 'Corralitos'),
(1944, 133, 4, 'El Ocotal'),
(1945, 133, 5, 'El Rosario o Laja Picada'),
(1946, 133, 6, 'Jalaca'),
(1947, 133, 7, 'La Ermita'),
(1948, 133, 8, 'La Esperanza'),
(1949, 133, 9, 'La Labranza'),
(1950, 133, 10, 'La Majada Verde'),
(1951, 133, 11, 'Las Quebradas'),
(1952, 133, 12, 'Los Charcos'),
(1953, 133, 13, 'Palmira'),
(1954, 133, 14, 'Río Dulce'),
(1955, 133, 15, 'San Antonio de Pastos'),
(1956, 133, 16, 'Valle Arriba'),
(1957, 134, 1, 'Tatumbla'),
(1958, 134, 2, 'Cofradía'),
(1959, 134, 3, 'Cuesta Grande'),
(1960, 134, 4, 'La Lima'),
(1961, 134, 5, 'La Unión'),
(1962, 134, 6, 'Linaca'),
(1963, 135, 1, 'Valle de Angeles'),
(1964, 135, 2, 'Cerro Grande'),
(1965, 135, 3, 'El Guanacaste'),
(1966, 135, 4, 'El Liquidámbar'),
(1967, 135, 5, 'La Sabaneta'),
(1968, 135, 6, 'Las Cañadas'),
(1969, 135, 7, 'Río Abajo o Playas'),
(1970, 136, 1, 'Villa de San Francisco'),
(1971, 136, 2, 'El Coyolito'),
(1972, 136, 3, 'El Hato'),
(1973, 136, 4, 'El Pedregal'),
(1974, 136, 5, 'Guarumas'),
(1975, 137, 1, 'Vallecillo'),
(1976, 137, 2, 'Trinidad de Quebradas'),
(1977, 138, 1, 'Puerto Lempira'),
(1978, 138, 2, 'Ahuas'),
(1979, 138, 3, 'Ahuasbila'),
(1980, 138, 4, 'Auka'),
(1981, 138, 5, 'Aurata'),
(1982, 138, 6, 'Barra de Caratasca'),
(1983, 138, 7, 'Benck'),
(1984, 138, 8, 'Canco'),
(1985, 138, 9, 'Cauquira'),
(1986, 138, 10, 'Clupki'),
(1987, 138, 11, 'Cruta o Walpatara'),
(1988, 138, 12, 'Iralaya'),
(1989, 138, 13, 'Islas del Cisne'),
(1990, 138, 14, 'Karasunta o Karasuatla'),
(1991, 138, 15, 'Kalpo'),
(1992, 138, 16, 'Krata'),
(1993, 138, 17, 'Krupunta'),
(1994, 138, 18, 'Kuri'),
(1995, 138, 19, 'Kurpa'),
(1996, 138, 21, 'Laca Tabila'),
(1997, 138, 22, 'Leimus'),
(1998, 138, 23, 'Mangotara'),
(1999, 138, 24, 'Mistruck'),
(2000, 138, 25, 'Mocorón'),
(2001, 138, 26, 'Pakui'),
(2002, 138, 27, 'Palkaka'),
(2003, 138, 28, 'Paptalaya'),
(2004, 138, 29, 'Pimienta'),
(2005, 138, 30, 'Prunnitara'),
(2006, 138, 31, 'Ratlaya'),
(2007, 138, 32, 'Raya'),
(2008, 138, 33, 'Rus-Rus'),
(2009, 138, 34, 'Siakualaya'),
(2010, 138, 35, 'Sirsirtara'),
(2011, 138, 36, 'Suji'),
(2012, 138, 37, 'Tansin'),
(2013, 138, 38, 'Tikiraya'),
(2014, 138, 39, 'Tipilalma'),
(2015, 138, 40, 'Tuburus'),
(2016, 138, 41, 'Tuimawala'),
(2017, 138, 42, 'Tukrun'),
(2018, 138, 43, 'Tuntuntara'),
(2019, 138, 44, 'Tusidaksa'),
(2020, 138, 45, 'Uji'),
(2021, 138, 46, 'Usibila'),
(2022, 138, 47, 'Walpata'),
(2023, 138, 48, 'Wampú Sirpe'),
(2024, 138, 49, 'Wankiawala o San Bernardo'),
(2025, 138, 50, 'Warunta'),
(2026, 138, 51, 'Wasma'),
(2027, 138, 52, 'Wauplaya'),
(2028, 138, 53, 'Wawina'),
(2029, 138, 54, 'Yahurabila'),
(2030, 138, 55, 'Yamanta'),
(2031, 139, 1, 'Brus Laguna'),
(2032, 139, 2, 'Barra Patuca'),
(2033, 139, 3, 'Batalla'),
(2034, 139, 4, 'Belén'),
(2035, 139, 5, 'Cocobila'),
(2036, 139, 6, 'Ibans'),
(2037, 139, 7, 'Krausirpi'),
(2038, 139, 8, 'Las Marías'),
(2039, 139, 9, 'Nueva Jerusalén'),
(2040, 139, 10, 'Palacios'),
(2041, 139, 11, 'Plaplaya'),
(2042, 139, 12, 'Río Plátano'),
(2043, 144, 1, 'La Esperanza'),
(2044, 144, 2, 'Chogola'),
(2045, 144, 3, 'El Pelón'),
(2046, 144, 4, 'La Pimienta'),
(2047, 144, 5, 'Nueva Esperanza'),
(2048, 145, 1, 'Camasca'),
(2049, 145, 2, 'Agua Zarca'),
(2050, 145, 3, 'El Carmen'),
(2051, 145, 4, 'El Rosario'),
(2052, 145, 5, 'Hacienda Sta. Lucía'),
(2053, 145, 6, 'San Antonio del Monte'),
(2054, 145, 7, 'San Ignacio'),
(2055, 145, 8, 'San Isidro'),
(2056, 145, 9, 'San Juan de Dios'),
(2057, 145, 10, 'San Lucas'),
(2058, 145, 11, 'Santa Catarina'),
(2059, 145, 12, 'Santa Cruz'),
(2060, 146, 1, 'Colomoncagua'),
(2061, 146, 2, 'El Picacho'),
(2062, 146, 3, 'Las Lomas'),
(2063, 146, 4, 'Los Amates'),
(2064, 146, 5, 'Llano Grande'),
(2065, 146, 6, 'Mal Paso'),
(2066, 146, 7, 'San Marcos'),
(2067, 146, 8, 'Santa Ana'),
(2068, 146, 9, 'Santo Domingo'),
(2069, 146, 10, 'Vados de San Antonio'),
(2070, 147, 1, 'Concepción'),
(2071, 147, 2, 'Calucica'),
(2072, 147, 3, 'Colomarigua o El Tablón'),
(2073, 147, 4, 'El Guachipilincito'),
(2074, 147, 5, 'El Guajiniquil'),
(2075, 147, 6, 'El Rodeo'),
(2076, 147, 7, 'Jiquinlaca'),
(2077, 147, 8, 'San Nicolás'),
(2078, 147, 9, 'Santiago'),
(2079, 148, 1, 'Dolores'),
(2080, 148, 2, 'Azacualpa o Llano de San Antonio'),
(2081, 148, 3, 'San José'),
(2082, 148, 4, 'Toco'),
(2083, 149, 1, 'Intibucá'),
(2084, 149, 2, 'Azacualpa'),
(2085, 149, 3, 'El Naranjo'),
(2086, 149, 4, 'El Pelón de Ologosí'),
(2087, 149, 5, 'La Laguna de Chiligatoro'),
(2088, 149, 6, 'La Sorto'),
(2089, 149, 7, 'Malguara'),
(2090, 149, 8, 'Manazapa'),
(2091, 149, 9, 'Mixcure'),
(2092, 149, 10, 'Monquecagua'),
(2093, 149, 11, 'Pueblo Viejo'),
(2094, 149, 12, 'Quebrada Honda'),
(2095, 149, 13, 'Río Blanco'),
(2096, 149, 14, 'Río Colorado'),
(2097, 149, 15, 'Río Grande o El Nance'),
(2098, 149, 16, 'San José'),
(2099, 149, 17, 'San Nicolás'),
(2100, 149, 18, 'San Pedro'),
(2101, 149, 19, 'Santa Catarina'),
(2102, 149, 20, 'Togopala'),
(2103, 150, 1, 'Jesús de Otoro'),
(2104, 150, 2, 'Coclán'),
(2105, 150, 3, 'El Junquillo'),
(2106, 150, 4, 'San Antonio'),
(2107, 150, 5, 'San Jerónimo'),
(2108, 150, 6, 'San Rafael'),
(2109, 151, 1, 'Magdalena'),
(2110, 151, 2, 'San Juan'),
(2111, 152, 1, 'Masaguara'),
(2112, 152, 2, 'Guasore'),
(2113, 152, 3, 'Lagunetas'),
(2114, 152, 4, 'Potrerito o El Rosario'),
(2115, 152, 5, 'Quiraguira'),
(2116, 152, 6, 'Santa Cruz de Horcones'),
(2117, 153, 1, 'San Antonio'),
(2118, 153, 2, 'Bañaderos'),
(2119, 153, 3, 'El Cacahuatal'),
(2120, 153, 4, 'San Francisco'),
(2121, 153, 5, 'San Jacinto'),
(2122, 153, 6, 'San José'),
(2123, 153, 7, 'San Sebastián'),
(2124, 153, 8, 'Santa Teresa'),
(2125, 154, 1, 'San Isidro'),
(2126, 154, 2, 'Macuelizo o Hato Viejo'),
(2127, 154, 3, 'Suyapa'),
(2128, 155, 1, 'San Juan'),
(2129, 155, 2, 'Llano Redondo'),
(2130, 155, 3, 'Peloncitos'),
(2131, 155, 4, 'San José de Cataulaca'),
(2132, 156, 1, 'San Marcos de Sierra'),
(2133, 156, 2, 'Las Delicias'),
(2134, 156, 3, 'San José'),
(2135, 156, 4, 'San Luis'),
(2136, 157, 1, 'San Miguelito'),
(2137, 157, 2, 'Cofradía'),
(2138, 157, 3, 'Chupucay o Resina'),
(2139, 157, 4, 'San Antonio'),
(2140, 157, 5, 'Segua'),
(2141, 158, 1, 'Santa Lucía'),
(2142, 158, 2, 'Bañaderos'),
(2143, 158, 3, 'El Jicaral'),
(2144, 158, 4, 'Palacios'),
(2145, 158, 5, 'San Marcos'),
(2146, 158, 6, 'Santa Rita'),
(2147, 159, 1, 'Yamaranguila'),
(2148, 159, 2, 'Azacualpa'),
(2149, 159, 3, 'Cofradía'),
(2150, 159, 4, 'El Carrizal'),
(2151, 159, 5, 'El Cerrón'),
(2152, 159, 6, 'El Membrillo No. 1'),
(2153, 159, 7, 'El Pelón'),
(2154, 159, 8, 'El Picacho'),
(2155, 159, 9, 'Las Lajas'),
(2156, 159, 10, 'Oloas'),
(2157, 159, 11, 'Planes'),
(2158, 159, 12, 'Semane'),
(2159, 159, 13, 'Sequire'),
(2160, 159, 14, 'Zacate Blanco'),
(2161, 160, 1, 'San Francisco de Opalaca o Monte Verde'),
(2162, 160, 2, 'Agua Sucia'),
(2163, 160, 3, 'El Naranjo o Santa Lucía'),
(2164, 160, 4, 'El Zacatal o Zuyapa'),
(2165, 160, 5, 'La Ceibita'),
(2166, 160, 6, 'La Chorrera Aspera'),
(2167, 160, 7, 'Ojos de Agua'),
(2168, 160, 8, 'Plan de Barrios'),
(2169, 161, 1, 'Roatan'),
(2170, 161, 2, 'Cayos Cochinos'),
(2171, 161, 3, 'Corozal'),
(2172, 161, 4, 'Crawfish Rock'),
(2173, 161, 5, 'Flowers Bay'),
(2174, 161, 6, 'French Harbor'),
(2175, 161, 7, 'Sandy Bay'),
(2176, 161, 8, 'Thatch Point'),
(2177, 161, 9, 'West End'),
(2178, 162, 1, 'Guanaja'),
(2179, 162, 2, 'East End'),
(2180, 162, 3, 'Mangrove Bight'),
(2181, 162, 4, 'Savannah Bight'),
(2182, 163, 1, 'José Santos Guardiola'),
(2183, 163, 2, 'Calabash Bight'),
(2184, 163, 3, 'Isla de Barbareta'),
(2185, 163, 4, 'Jonesville Point'),
(2186, 163, 5, 'Long The Shore'),
(2187, 163, 6, 'Pollytilly Bight'),
(2188, 163, 7, 'Punta Gorda'),
(2189, 163, 8, 'Santa Elena o Banda Sur'),
(2190, 163, 9, 'Six Huts'),
(2191, 164, 1, 'Utila'),
(2192, 165, 1, 'La Paz'),
(2193, 165, 2, 'Concepción de Soluteca'),
(2194, 165, 3, 'Matasano'),
(2195, 165, 4, 'Potrerillos'),
(2196, 165, 5, 'San José del Playón'),
(2197, 165, 6, 'San Rafael'),
(2198, 165, 7, 'Tepanguare'),
(2199, 165, 8, 'Tierra Prieta'),
(2200, 165, 9, 'Yarumela'),
(2201, 166, 1, 'Aguanqueterique'),
(2202, 166, 2, 'Barrancaray'),
(2203, 167, 1, 'Cabañas'),
(2204, 167, 2, 'Azacualpa'),
(2205, 167, 3, 'El Bailadero'),
(2206, 167, 4, 'El Palmar'),
(2207, 167, 5, 'Las Lajitas'),
(2208, 168, 1, 'Cane'),
(2209, 168, 2, 'Las Calabazas'),
(2210, 169, 1, 'Chinacla'),
(2211, 169, 2, 'El Trapiche'),
(2212, 169, 3, 'La Piedrona'),
(2213, 169, 4, 'Las Pilas'),
(2214, 169, 5, 'Planes de Muyen'),
(2215, 169, 6, 'Portillo del Norte'),
(2216, 169, 7, 'San Marcos de Linderos'),
(2217, 169, 8, 'Tierra Colorada'),
(2218, 170, 1, 'Guajiquiro'),
(2219, 170, 2, 'Dolores'),
(2220, 170, 3, 'El Guapinol'),
(2221, 170, 4, 'Guajiquirito'),
(2222, 170, 5, 'Ingrula'),
(2223, 170, 6, 'La Crucita'),
(2224, 170, 7, 'Las Delicias'),
(2225, 170, 8, 'Las Vegas del Paraíso'),
(2226, 170, 9, 'San Antonio'),
(2227, 170, 10, 'San José'),
(2228, 170, 11, 'San Marcos'),
(2229, 170, 12, 'San Matías o Las Joyas'),
(2230, 170, 13, 'San Pedro'),
(2231, 170, 14, 'Santa Rosita'),
(2232, 171, 1, 'Lauterique'),
(2233, 171, 2, 'El Amate'),
(2234, 171, 3, 'Las Minitas'),
(2235, 171, 4, 'Ojo de Agua'),
(2236, 172, 1, 'Marcala'),
(2237, 172, 2, 'Sabaneta'),
(2238, 172, 3, 'Santa Cruz'),
(2239, 173, 1, 'Mercedes de Oriente'),
(2240, 173, 2, 'La Golondrina'),
(2241, 173, 3, 'Las Lomas'),
(2242, 174, 1, 'Opatoro'),
(2243, 174, 2, 'El Cedro'),
(2244, 174, 3, 'El Paraíso'),
(2245, 174, 4, 'La Florida'),
(2246, 174, 5, 'San Isidro'),
(2247, 174, 6, 'Santa Cruz'),
(2248, 174, 7, 'Valle de Angeles'),
(2249, 175, 1, 'San Antonio del Norte'),
(2250, 175, 2, 'Hato del Viejo'),
(2251, 175, 3, 'Las Cañas'),
(2252, 175, 4, 'Matapalo'),
(2253, 175, 5, 'Pitahayas'),
(2254, 176, 1, 'San José'),
(2255, 176, 2, 'El Aguacatal'),
(2256, 176, 3, 'El Pedernal'),
(2257, 176, 4, 'La Florida'),
(2258, 177, 1, 'San Juan'),
(2259, 177, 2, 'El Quebrachal'),
(2260, 177, 3, 'Horcones'),
(2261, 177, 4, 'Las Trancas'),
(2262, 177, 5, 'Ocotillos'),
(2263, 178, 1, 'San Pedro de Tutule'),
(2264, 178, 2, 'El Guayabal'),
(2265, 178, 3, 'Laguna Seca'),
(2266, 178, 4, 'Las Huertas'),
(2267, 178, 5, 'San Miguel'),
(2268, 179, 1, 'Santa Ana'),
(2269, 179, 2, 'Estancia'),
(2270, 179, 3, 'Juniguara'),
(2271, 179, 4, 'Los Hornos'),
(2272, 179, 5, 'San Antonio'),
(2273, 179, 6, 'San Isidro'),
(2274, 179, 7, 'San Miguel'),
(2275, 179, 8, 'Santiago'),
(2276, 180, 1, 'Santa Elena'),
(2277, 180, 2, 'Aguanqueterique'),
(2278, 180, 3, 'El Carrizal'),
(2279, 180, 4, 'Los Patios'),
(2280, 180, 5, 'Llano Alegre'),
(2281, 180, 6, 'Monte Copado'),
(2282, 180, 7, 'Soloara'),
(2283, 180, 8, 'Nahuaterique'),
(2284, 181, 1, 'Santa María'),
(2285, 181, 2, 'El Naranjo'),
(2286, 181, 3, 'El Ocotal'),
(2287, 181, 4, 'Las Crucitas o Barrio Nuevo'),
(2288, 181, 5, 'Las Pavas'),
(2289, 181, 6, 'Linderos'),
(2290, 181, 7, 'Los Planes'),
(2291, 181, 8, 'Miratoro'),
(2292, 181, 9, 'San Francisco'),
(2293, 182, 1, 'Santiago de Puringla'),
(2294, 182, 2, 'Cedritos'),
(2295, 182, 3, 'El Higuito'),
(2296, 182, 4, 'El Ocotal'),
(2297, 182, 5, 'El Rancho de Jesús'),
(2298, 182, 6, 'Gualazara'),
(2299, 182, 7, 'Hornitos'),
(2300, 182, 8, 'Huertas'),
(2301, 182, 9, 'Las Delicias'),
(2302, 182, 10, 'San Antonio'),
(2303, 183, 1, 'Yarula'),
(2304, 183, 2, 'Las Huertas'),
(2305, 183, 3, 'Las Lajas'),
(2306, 183, 4, 'Tierra Colorada'),
(2307, 183, 5, 'El Zancudo'),
(2308, 184, 1, 'Gracias'),
(2309, 184, 2, 'Arcilaca'),
(2310, 184, 3, 'Azacualpita'),
(2311, 184, 4, 'Campuca o El Camalote'),
(2312, 184, 5, 'Catulaca'),
(2313, 184, 6, 'Cedros de Mejicapa'),
(2314, 184, 7, 'El Caral'),
(2315, 184, 8, 'El Ojo de Agua de La Misión o Rancho de La Misión'),
(2316, 184, 9, 'El Pinal'),
(2317, 184, 10, 'El Refugio'),
(2318, 184, 11, 'El Rodeo'),
(2319, 184, 12, 'El Rodeo de Quelacasque'),
(2320, 184, 13, 'El Sile'),
(2321, 184, 14, 'El Tablón'),
(2322, 184, 15, 'El Zapote'),
(2323, 184, 16, 'Jacan o San Isidro'),
(2324, 184, 17, 'La Asomada'),
(2325, 184, 18, 'La Lima'),
(2326, 184, 19, 'Mejocote'),
(2327, 184, 20, 'Platanares'),
(2328, 184, 21, 'San José del Alto'),
(2329, 184, 22, 'Villami'),
(2330, 184, 23, 'Montaña Verde'),
(2331, 185, 1, 'Belén'),
(2332, 185, 2, 'El Carrizal'),
(2333, 185, 3, 'El Naranjo o La Penca'),
(2334, 185, 4, 'Las Cañadas'),
(2335, 185, 5, 'Los Planes de Ojuera'),
(2336, 186, 1, 'Candelaria'),
(2337, 186, 2, 'La Arada'),
(2338, 186, 3, 'San Francisco'),
(2339, 186, 4, 'San José'),
(2340, 186, 5, 'San Lorenzo'),
(2341, 187, 1, 'Cololaca'),
(2342, 187, 2, 'Casitas'),
(2343, 187, 3, 'Las Flores'),
(2344, 187, 4, 'Malsincales'),
(2345, 187, 5, 'San Isidro Canguacota'),
(2346, 188, 1, 'Erandique'),
(2347, 188, 2, 'Azacualpa Grande'),
(2348, 188, 3, 'Azacualpa Montaña'),
(2349, 188, 4, 'Concepción o Barrio Nuevo'),
(2350, 188, 5, 'El Carrizal'),
(2351, 188, 6, 'El Conal'),
(2352, 188, 7, 'El Chimisal'),
(2353, 188, 8, 'El Rodeo'),
(2354, 188, 9, 'Gualguire'),
(2355, 188, 10, 'Guatincara'),
(2356, 188, 11, 'La Laguna'),
(2357, 188, 12, 'San Antonio Montaña'),
(2358, 188, 13, 'San Antonio Valle'),
(2359, 188, 14, 'Valle de La Cruz'),
(2360, 188, 15, 'Yolomón'),
(2361, 189, 1, 'Gualcince'),
(2362, 189, 2, 'Congolón'),
(2363, 189, 3, 'Guacual'),
(2364, 189, 4, 'Gualcea'),
(2365, 189, 5, 'Guatemalita'),
(2366, 189, 6, 'Quesungual'),
(2367, 189, 7, 'Santa Cruz'),
(2368, 189, 8, 'Santo Tomás'),
(2369, 189, 9, 'San Marcos Cerique'),
(2370, 189, 10, 'San Marcos Mora'),
(2371, 189, 11, 'Tenango'),
(2372, 189, 12, 'Tixila'),
(2373, 190, 1, 'Guarita'),
(2374, 190, 2, 'Chapulín Santa Lucía'),
(2375, 190, 3, 'San Antonio'),
(2376, 190, 4, 'San José Olosingo'),
(2377, 190, 5, 'San Juan Junigual'),
(2378, 190, 6, 'San Pablo'),
(2379, 190, 7, 'Santa Cruz del Repasteadero'),
(2380, 190, 8, 'Santa Cruz Queruco'),
(2381, 190, 9, 'Santo Tomás Chinquín'),
(2382, 190, 10, 'Terlaca'),
(2383, 191, 1, 'La Campa'),
(2384, 191, 2, 'El Mezcalillo'),
(2385, 191, 3, 'Las Cañadas'),
(2386, 191, 4, 'Nueva Esperanza'),
(2387, 191, 5, 'Santa Catarina'),
(2388, 192, 1, 'La Iguala'),
(2389, 192, 2, 'Chusquín'),
(2390, 192, 3, 'El Juncal'),
(2391, 192, 4, 'El Mango'),
(2392, 192, 5, 'El Matasano'),
(2393, 192, 6, 'El Rodeíto'),
(2394, 192, 7, 'El Zapote'),
(2395, 192, 8, 'La Guadalupe'),
(2396, 192, 9, 'Lagunas'),
(2397, 192, 10, 'Las Pilas'),
(2398, 192, 11, 'Las Playas'),
(2399, 192, 12, 'Las Olominas'),
(2400, 192, 13, 'Las Vegas'),
(2401, 192, 14, 'Los Llanos'),
(2402, 192, 15, 'Los Tablones'),
(2403, 192, 16, 'Llano Largo'),
(2404, 192, 18, 'Monte Largo'),
(2405, 192, 19, 'Nueva Paz'),
(2406, 192, 20, 'Ojaca'),
(2407, 192, 21, 'Potrerillos'),
(2408, 192, 22, 'Quioco'),
(2409, 192, 23, 'Río Blanco'),
(2410, 192, 24, 'San Isidro de Jacan'),
(2411, 192, 25, 'San José de Curunate'),
(2412, 192, 26, 'San Miguel'),
(2413, 192, 27, 'Taragual'),
(2414, 193, 1, 'Las Flores'),
(2415, 193, 2, 'Coalaca'),
(2416, 193, 3, 'El Socorro o La Loma de La Cueva'),
(2417, 193, 4, 'Guanas'),
(2418, 193, 5, 'Las Mercedes'),
(2419, 193, 6, 'Mariposas'),
(2420, 193, 7, 'Mongual'),
(2421, 193, 8, 'Monte de La Virgen'),
(2422, 193, 9, 'Nueva Esperanza'),
(2423, 193, 10, 'Tepusuna'),
(2424, 194, 1, 'La Unión'),
(2425, 194, 2, 'Agua Zarca'),
(2426, 194, 3, 'El Sitio'),
(2427, 194, 4, 'Gualciras'),
(2428, 194, 5, 'Las Peñas'),
(2429, 194, 6, 'San Bartolo'),
(2430, 195, 1, 'La Virtud'),
(2431, 195, 2, 'Catulaca'),
(2432, 195, 3, 'El Amatillo'),
(2433, 195, 4, 'El Cacahuatal o La Majada'),
(2434, 195, 5, 'El Limón'),
(2435, 195, 6, 'Guajiniquil'),
(2436, 195, 7, 'Gualcimaca'),
(2437, 195, 8, 'La Cuesta'),
(2438, 195, 9, 'La Haciendita'),
(2439, 195, 10, 'La Trinidad'),
(2440, 195, 11, 'Los Hernández'),
(2441, 195, 12, 'San Francisco'),
(2442, 195, 13, 'San José'),
(2443, 196, 1, 'Lepaera'),
(2444, 196, 2, 'Alegrías'),
(2445, 196, 3, 'Arenales'),
(2446, 196, 4, 'Brisas del Ocotillo'),
(2447, 196, 5, 'Buenos Aires'),
(2448, 196, 6, 'Cementera'),
(2449, 196, 7, 'Consolación'),
(2450, 196, 8, 'El Aguacatal'),
(2451, 196, 9, 'El Barrio'),
(2452, 196, 10, 'El Carmen'),
(2453, 196, 11, 'El Chaguite'),
(2454, 196, 12, 'El Matasanito'),
(2455, 196, 13, 'El Rosario'),
(2456, 196, 14, 'Estancias'),
(2457, 196, 15, 'Gualán'),
(2458, 196, 16, 'La Jagua'),
(2459, 196, 17, 'La Laguna del Pedernal'),
(2460, 196, 18, 'La Libertad'),
(2461, 196, 19, 'La Lima'),
(2462, 196, 20, 'La Rinconada'),
(2463, 196, 21, 'Laguna de Pajapas'),
(2464, 196, 22, 'Las Crucitas'),
(2465, 196, 23, 'Las Dantas'),
(2466, 196, 24, 'Las Pilas del Canmaya'),
(2467, 196, 25, 'Las Tejeras'),
(2468, 196, 26, 'Loma Alta'),
(2469, 196, 27, 'Los Cerritos No.1'),
(2470, 196, 28, 'Los Cerritos No.2'),
(2471, 196, 29, 'Mercedes Ocotillo o Loma Alta'),
(2472, 196, 30, 'Misiora'),
(2473, 196, 31, 'Nueva Edén'),
(2474, 196, 32, 'Ocote Chacho'),
(2475, 196, 33, 'Ocotillo Tierra Colorada'),
(2476, 196, 34, 'Pajapas'),
(2477, 196, 35, 'Plan de La Pua'),
(2478, 196, 36, 'Plan del Jarro o Santa Eduviges'),
(2479, 196, 37, 'Plan del Ocotal'),
(2480, 196, 38, 'Plan del Socorro o El Cerrón'),
(2481, 196, 39, 'Plan Grande'),
(2482, 196, 40, 'Playitas'),
(2483, 196, 41, 'San Isidro El Belloto'),
(2484, 196, 42, 'Santa Rita'),
(2485, 196, 43, 'Tierra Colorada'),
(2486, 196, 44, 'Yuena'),
(2487, 196, 45, 'Yuenita'),
(2488, 197, 1, 'Mapulaca'),
(2489, 197, 2, 'El Sitio'),
(2490, 197, 3, 'Los Planes'),
(2491, 197, 4, 'El Llano de La Hamaca'),
(2492, 197, 5, 'San Antonio'),
(2493, 198, 1, 'Piraera'),
(2494, 198, 2, 'Las Moras'),
(2495, 198, 3, 'Quisimaca'),
(2496, 198, 4, 'San Felipe'),
(2497, 198, 5, 'San Jerónimo'),
(2498, 198, 6, 'San José'),
(2499, 198, 7, 'San Pedro'),
(2500, 198, 8, 'San Sebastián'),
(2501, 198, 9, 'Santa Lucía o Guasquín'),
(2502, 198, 10, 'Suyapita o Pichagual'),
(2503, 199, 1, 'San Andrés'),
(2504, 199, 2, 'Caona'),
(2505, 199, 3, 'Cenalaca'),
(2506, 199, 4, 'Esquimpara'),
(2507, 199, 5, 'San Simón'),
(2508, 199, 6, 'Santiago'),
(2509, 199, 7, 'Sosoal'),
(2510, 199, 8, 'Sunsunlaca'),
(2511, 200, 1, 'San Francisco'),
(2512, 200, 2, 'Concordia'),
(2513, 200, 3, 'Jelpoa'),
(2514, 200, 4, 'Magdalena'),
(2515, 200, 5, 'Marquira'),
(2516, 200, 6, 'Rorruca'),
(2517, 200, 7, 'San Lucas'),
(2518, 201, 1, 'San Juan Guarita'),
(2519, 201, 2, 'El Rodeo'),
(2520, 201, 3, 'Los Horcones'),
(2521, 201, 4, 'Portillo del Frayle o del Aguacate'),
(2522, 201, 5, 'Pueblo Viejo'),
(2523, 201, 6, 'Sazalapa'),
(2524, 202, 1, 'San Manuel Colohete'),
(2525, 202, 2, 'Corante'),
(2526, 202, 3, 'Guacutao'),
(2527, 202, 4, 'Piedra Larga'),
(2528, 202, 5, 'Pulaje'),
(2529, 202, 6, 'San Antonio'),
(2530, 202, 7, 'San Antonio del Aguacatillo'),
(2531, 202, 8, 'San Pedro'),
(2532, 202, 9, 'Santa Teresa'),
(2533, 202, 10, 'Tierra Colorada'),
(2534, 203, 1, 'San Rafael'),
(2535, 203, 2, 'Concepción'),
(2536, 203, 3, 'El Campanario'),
(2537, 203, 4, 'El Edén'),
(2538, 203, 5, 'Queruco'),
(2539, 203, 6, 'San Antonio'),
(2540, 203, 7, 'San José de La Montaña'),
(2541, 203, 8, 'San Pedrito'),
(2542, 203, 9, 'Suyapa'),
(2543, 204, 1, 'San Sebastián'),
(2544, 204, 2, 'Agua Fría'),
(2545, 204, 3, 'El Cutal'),
(2546, 204, 4, 'El Sucte'),
(2547, 204, 5, 'El Volcancito'),
(2548, 204, 6, 'San Antonio'),
(2549, 204, 7, 'San Isidro'),
(2550, 205, 1, 'Santa Cruz'),
(2551, 205, 2, 'Candelaria'),
(2552, 205, 3, 'Loma Limpia'),
(2553, 205, 4, 'Pajapas'),
(2554, 205, 5, 'San Pedro'),
(2555, 205, 6, 'Santa Rosa'),
(2556, 206, 1, 'Talgua'),
(2557, 206, 2, 'Cansincamón'),
(2558, 206, 3, 'El Aguacate'),
(2559, 206, 4, 'El Camalote'),
(2560, 206, 5, 'El Ciruelito'),
(2561, 206, 6, 'El Higuito o Ciliantuque'),
(2562, 206, 7, 'El Matasano'),
(2563, 206, 8, 'El Pinabetal'),
(2564, 206, 9, 'La Cafetalera'),
(2565, 206, 10, 'La Peña'),
(2566, 206, 11, 'La Rinconada'),
(2567, 206, 12, 'San Ramon'),
(2568, 207, 1, 'Tambla'),
(2569, 207, 2, 'El Zarzal'),
(2570, 207, 3, 'San Francisco del Aceituno'),
(2571, 207, 4, 'Santa Guadalupe o Chorrera'),
(2572, 208, 1, 'Tomalá'),
(2573, 208, 2, 'Azacualpa'),
(2574, 208, 3, 'El Copante'),
(2575, 208, 4, 'La Soledad del Morro'),
(2576, 208, 5, 'Los Horconcillos'),
(2577, 208, 6, 'Los Zuncuyos'),
(2578, 208, 7, 'San Cristóbal'),
(2579, 208, 8, 'San Juan'),
(2580, 208, 9, 'San Lorenzo'),
(2581, 208, 10, 'San Marquitos'),
(2582, 208, 11, 'San Pablo de Consolación'),
(2583, 208, 12, 'Santo Domingo'),
(2584, 209, 1, 'Valladolid'),
(2585, 209, 2, 'Agua Zarca'),
(2586, 209, 3, 'Chancoyote'),
(2587, 209, 4, 'El Cordoncillo'),
(2588, 209, 5, 'El Socorro'),
(2589, 209, 6, 'El Yupural'),
(2590, 209, 7, 'Gualcixe'),
(2591, 209, 8, 'Los Patios'),
(2592, 209, 9, 'Los Reales'),
(2593, 209, 10, 'San Lorenzo o La Hacienda'),
(2594, 209, 11, 'Santa Bárbara'),
(2595, 209, 12, 'Tierra Blanca'),
(2596, 210, 1, 'Virginia'),
(2597, 210, 2, 'Agua Zarca'),
(2598, 210, 3, 'Celilac'),
(2599, 210, 4, 'El Rodeo'),
(2600, 210, 5, 'Guaquincora'),
(2601, 211, 1, 'Caiquin'),
(2602, 211, 2, 'Coalaca'),
(2603, 211, 3, 'Guanajulque'),
(2604, 211, 4, 'Laguna Seca'),
(2605, 212, 1, 'Ocotepeque'),
(2606, 212, 2, 'Antigua Ocotepeque'),
(2607, 212, 3, 'El Barreal'),
(2608, 212, 4, 'El Volcán'),
(2609, 212, 5, 'La Comunidad'),
(2610, 212, 6, 'Pie del Cerro'),
(2611, 212, 7, 'San José de La Reunión'),
(2612, 212, 8, 'San Miguel'),
(2613, 212, 9, 'San Rafael'),
(2614, 213, 1, 'Belén Gualcho'),
(2615, 213, 2, 'Cerro Grande'),
(2616, 213, 3, 'Cerro Verde'),
(2617, 213, 4, 'El Ciprés'),
(2618, 213, 5, 'El Magueyal'),
(2619, 213, 6, 'El Paraíso'),
(2620, 213, 7, 'Jualaca'),
(2621, 213, 8, 'La Gocia'),
(2622, 213, 9, 'La Moaga'),
(2623, 213, 10, 'La Tejera'),
(2624, 213, 11, 'Palos Blancos'),
(2625, 213, 12, 'Suyande'),
(2626, 213, 13, 'Yaruchel'),
(2627, 214, 1, 'Concepción'),
(2628, 214, 2, 'San José'),
(2629, 214, 3, 'Santa Anita'),
(2630, 214, 4, 'Tulas'),
(2631, 215, 1, 'Dolores Merendón'),
(2632, 215, 2, 'San Jerónimo'),
(2633, 216, 1, 'Fraternidad'),
(2634, 216, 2, 'Las Cruces'),
(2635, 216, 3, 'Los Vados'),
(2636, 216, 4, 'San Francisco'),
(2637, 217, 1, 'La Encarnación'),
(2638, 217, 2, 'Cuajo Seco o Las Delicias'),
(2639, 217, 3, 'El Limoncito'),
(2640, 217, 4, 'El Naranjo'),
(2641, 217, 5, 'San Antonio de Limoncito'),
(2642, 217, 6, 'Sesesmiles'),
(2643, 218, 1, 'La Labor'),
(2644, 218, 2, 'El Ingenio'),
(2645, 218, 3, 'El Rosario'),
(2646, 218, 4, 'Llano Largo'),
(2647, 218, 5, 'Montepeque'),
(2648, 218, 6, 'Pashapa'),
(2649, 218, 7, 'Santa Efigenia'),
(2650, 218, 8, 'Santa Lucía'),
(2651, 219, 1, 'Lucerna'),
(2652, 219, 2, 'La Concordia'),
(2653, 219, 3, 'Río Hondo'),
(2654, 219, 4, 'Santa Rosita'),
(2655, 220, 1, 'Mercedes'),
(2656, 220, 2, 'Concepción'),
(2657, 220, 3, 'El Coral'),
(2658, 220, 4, 'El Limoncito'),
(2659, 220, 5, 'Laguna Seca'),
(2660, 220, 6, 'Las Vegas del Río Chiquito'),
(2661, 220, 7, 'Plan del Rosario'),
(2662, 220, 8, 'San Antonio'),
(2663, 220, 9, 'San José de Jocotán'),
(2664, 220, 10, 'Yuscarán'),
(2665, 221, 1, 'San Fernando'),
(2666, 221, 2, 'El Manzano'),
(2667, 221, 3, 'El Rosario'),
(2668, 221, 4, 'Nuevo Espíritu'),
(2669, 221, 5, 'Queseras'),
(2670, 221, 6, 'San Antonio de Curarén'),
(2671, 221, 7, 'San José de Curarén'),
(2672, 221, 8, 'Santa Inés'),
(2673, 221, 9, 'Sulay'),
(2674, 222, 1, 'San Francisco del Valle'),
(2675, 222, 2, 'Coloal'),
(2676, 222, 3, 'El Sile'),
(2677, 222, 4, 'El Tablón'),
(2678, 222, 5, 'La Laguna'),
(2679, 222, 6, 'Santa Teresa'),
(2680, 223, 1, 'San Jorge'),
(2681, 223, 2, 'El Rastrojón o Nueva Esperanza'),
(2682, 223, 3, 'El Socorro'),
(2683, 223, 4, 'Las Lagunas'),
(2684, 223, 5, 'Los Planes'),
(2685, 223, 6, 'Río Blanco'),
(2686, 223, 7, 'Santa Elena'),
(2687, 224, 1, 'San Marcos'),
(2688, 224, 2, 'Callejones'),
(2689, 224, 3, 'Cunce'),
(2690, 224, 4, 'El Carrizal'),
(2691, 224, 5, 'El Granzal'),
(2692, 224, 6, 'El Jaralón o Nueva Aldea'),
(2693, 224, 7, 'El Refugio'),
(2694, 224, 8, 'El Tránsito'),
(2695, 224, 9, 'La Ascensión'),
(2696, 224, 10, 'Potrerillos'),
(2697, 224, 11, 'Sabana Larga'),
(2698, 224, 12, 'San Juan'),
(2699, 224, 13, 'San Luis'),
(2700, 224, 14, 'Santa Marta'),
(2701, 225, 1, 'Santa Fe'),
(2702, 225, 2, 'Agua Caliente'),
(2703, 225, 3, 'El Mojanal'),
(2704, 225, 4, 'La Quesera'),
(2705, 225, 5, 'Los Encinos'),
(2706, 225, 6, 'Piedras Bonitas'),
(2707, 225, 7, 'Piñuelas'),
(2708, 225, 8, 'Sulnete'),
(2709, 226, 1, 'Sensenti'),
(2710, 226, 2, 'Azacualpa'),
(2711, 226, 3, 'Colonia Santa Cruz'),
(2712, 226, 4, 'El Matasano'),
(2713, 226, 5, 'Gualtaya'),
(2714, 226, 6, 'La Loma o San Felipe'),
(2715, 226, 7, 'Las Mesitas'),
(2716, 226, 8, 'Los Planes'),
(2717, 226, 9, 'San Antonio'),
(2718, 226, 10, 'San Francisco de Cones'),
(2719, 227, 1, 'Sinuapa'),
(2720, 227, 2, 'Cacalguapa'),
(2721, 227, 3, 'El Carrizal'),
(2722, 227, 4, 'El Moral'),
(2723, 227, 5, 'El Ocotillo'),
(2724, 227, 6, 'El Peñasco'),
(2725, 227, 7, 'El Tepeizcuinte'),
(2726, 227, 8, 'La Laborcita'),
(2727, 227, 9, 'Plan del Rancho'),
(2728, 227, 10, 'Valle de Mercedes'),
(2729, 227, 11, 'Veracruz'),
(2730, 228, 1, 'Juticalpa'),
(2731, 228, 3, 'Arimis'),
(2732, 228, 4, 'Azacualpa'),
(2733, 228, 5, 'Bijagual'),
(2734, 228, 6, 'Calpules No.1'),
(2735, 228, 7, 'Calpules No.2'),
(2736, 228, 8, 'Casas Viejas'),
(2737, 228, 9, 'Cayo Blanco'),
(2738, 228, 10, 'El Bijao'),
(2739, 228, 11, 'El Carbonal'),
(2740, 228, 12, 'El Chaparro'),
(2741, 228, 13, 'El Encinal No.1'),
(2742, 228, 14, 'El Encinal No.2'),
(2743, 228, 15, 'El Espinal'),
(2744, 228, 16, 'El Higuerito'),
(2745, 228, 18, 'El Plan de Los Ciruelos'),
(2746, 228, 19, 'El Plomo'),
(2747, 228, 20, 'El Potrero de Las Casas o Santa Cruz del Potrero'),
(2748, 228, 21, 'El Rincón de Mamisaca'),
(2749, 228, 22, 'El Rusio'),
(2750, 228, 23, 'El Tigre'),
(2751, 228, 24, 'El Zarzal'),
(2752, 228, 25, 'Guacamaya'),
(2753, 228, 28, 'Jutiquile'),
(2754, 228, 29, 'La Concepción'),
(2755, 228, 30, 'La Empalizada'),
(2756, 228, 33, 'La Puerta'),
(2757, 228, 34, 'La Sierra Lepaguare'),
(2758, 228, 35, 'La Venta'),
(2759, 228, 36, 'Las Flores'),
(2760, 228, 37, 'Las Lomas'),
(2761, 228, 38, 'Las Llaves'),
(2762, 228, 39, 'Las Minas'),
(2763, 228, 41, 'Limones'),
(2764, 228, 45, 'Panuaya'),
(2765, 228, 46, 'Potrerillos o Campo'),
(2766, 228, 47, 'Pueblo Nuevo'),
(2767, 228, 48, 'Punuare'),
(2768, 228, 49, 'Pusunca o San Agustín'),
(2769, 228, 50, 'Quilinchuche'),
(2770, 228, 51, 'Rancho Quemado'),
(2771, 228, 52, 'San Antonio de Sara'),
(2772, 228, 54, 'San Juan'),
(2773, 228, 55, 'San Marcos'),
(2774, 228, 56, 'San Nicolás'),
(2775, 228, 57, 'San Pedro de La Joya'),
(2776, 228, 58, 'Santa Inés o Las Parras'),
(2777, 228, 59, 'Sincuyapa'),
(2778, 228, 60, 'Tapiquile'),
(2779, 228, 61, 'Telica'),
(2780, 228, 64, 'Trojas Arriba'),
(2781, 228, 65, 'Zopilotepe'),
(2782, 229, 1, 'Campamento'),
(2783, 229, 2, 'El Barro'),
(2784, 229, 3, 'El Carrizal'),
(2785, 229, 4, 'El Nance'),
(2786, 229, 5, 'La Libertad'),
(2787, 229, 6, 'La Lima'),
(2788, 229, 7, 'La Manaca'),
(2789, 229, 8, 'Los Cortés'),
(2790, 229, 9, 'Morán'),
(2791, 229, 10, 'Quebrada Grande'),
(2792, 230, 1, 'Catacamas'),
(2793, 230, 2, 'Bacadía'),
(2794, 230, 3, 'Concepción de Río Tinto'),
(2795, 230, 4, 'El Cerro'),
(2796, 230, 5, 'El Pataste'),
(2797, 230, 6, 'La Bodega'),
(2798, 230, 7, 'La Colonia Agrícola'),
(2799, 230, 8, 'La Colonia de Poncaya'),
(2800, 230, 9, 'La Cruz'),
(2801, 230, 10, 'La Gloria del Pataste'),
(2802, 230, 11, 'La Sosa'),
(2803, 230, 12, 'Las Mesetas'),
(2804, 230, 13, 'San José de Río Tinto'),
(2805, 230, 14, 'San Pedro de Catacamas'),
(2806, 230, 15, 'Siguate'),
(2807, 231, 1, 'Concordia'),
(2808, 231, 2, 'Amaranguiles'),
(2809, 231, 3, 'El Portillo'),
(2810, 231, 4, 'Juan Francisco'),
(2811, 231, 5, 'La Laguna'),
(2812, 231, 6, 'Las Animas'),
(2813, 231, 7, 'Lavaderos'),
(2814, 231, 8, 'Pedernales'),
(2815, 231, 9, 'Terreros Blancos'),
(2816, 231, 10, 'Villa de Fátima o El Tablón'),
(2817, 231, 11, 'Villa Vieja'),
(2818, 232, 1, 'Dulce Nombre de Culmí'),
(2819, 232, 2, 'Agua Blanca'),
(2820, 232, 3, 'Agua Buena'),
(2821, 232, 4, 'Aguaquire'),
(2822, 232, 5, 'El Cerro'),
(2823, 232, 6, 'El Zapote'),
(2824, 232, 7, 'La Campana'),
(2825, 232, 8, 'La Colonia'),
(2826, 232, 9, 'La Esperanza o Plan de Los Blancos'),
(2827, 232, 10, 'La Llorona'),
(2828, 232, 11, 'La Pimienta'),
(2829, 232, 12, 'La Unión o El Guano'),
(2830, 232, 13, 'Las Casitas'),
(2831, 232, 14, 'Las Flores'),
(2832, 232, 15, 'Las Marías'),
(2833, 232, 16, 'Las Minas'),
(2834, 232, 17, 'Los Angeles'),
(2835, 232, 18, 'Nueva Esperanza'),
(2836, 232, 19, 'Paulaya'),
(2837, 232, 20, 'Pueblo Viejo'),
(2838, 232, 21, 'Río Negro'),
(2839, 232, 22, 'San Jose de La Montaña'),
(2840, 232, 23, 'San Pedro de Pisijire'),
(2841, 232, 24, 'Subirana'),
(2842, 232, 25, 'Suyapita'),
(2843, 232, 26, 'Tropical Plywood'),
(2844, 232, 27, 'Vallecito'),
(2845, 233, 1, 'El Rosario'),
(2846, 233, 2, 'El Ocotal'),
(2847, 233, 3, 'El Salitre'),
(2848, 233, 4, 'La Ceiba'),
(2849, 233, 5, 'Las Lajas'),
(2850, 233, 6, 'Los Zapotes'),
(2851, 233, 7, 'Río Tabaco'),
(2852, 233, 8, 'Yupite'),
(2853, 234, 1, 'Esquipulas del Norte'),
(2854, 234, 2, 'El Carrizal'),
(2855, 234, 3, 'El Encino'),
(2856, 234, 4, 'El Río'),
(2857, 234, 5, 'La Zuncuya'),
(2858, 234, 6, 'Los Encuentros'),
(2859, 234, 7, 'Miramar'),
(2860, 234, 8, 'Palmira'),
(2861, 235, 1, 'Gualaco'),
(2862, 235, 2, 'Chindona'),
(2863, 235, 3, 'Jicalapa'),
(2864, 235, 4, 'La Boca'),
(2865, 235, 5, 'La Venta'),
(2866, 235, 6, 'Las Lomas'),
(2867, 235, 7, 'Saguay'),
(2868, 235, 9, 'San Antonio'),
(2869, 235, 10, 'San Antonio de Pacura'),
(2870, 235, 11, 'San Buenaventura'),
(2871, 235, 12, 'San Pedro'),
(2872, 235, 13, 'Vargas'),
(2873, 236, 1, 'Guarizama'),
(2874, 236, 2, 'El Zapotal'),
(2875, 236, 3, 'La Carta'),
(2876, 236, 4, 'Los Cajones'),
(2877, 236, 5, 'Trinidad'),
(2878, 237, 1, 'Guata'),
(2879, 237, 2, 'Azacualpita'),
(2880, 237, 3, 'Corralitos'),
(2881, 237, 4, 'La Ensenada'),
(2882, 237, 5, 'La Estancia'),
(2883, 237, 6, 'Pueblo Viejo'),
(2884, 238, 1, 'Guayape'),
(2885, 238, 2, 'Coyoles'),
(2886, 238, 3, 'El Coyol'),
(2887, 238, 4, 'El Coyolar'),
(2888, 238, 5, 'El Paraíso'),
(2889, 238, 6, 'El Paso de La Hoya'),
(2890, 238, 7, 'El Rodeo'),
(2891, 238, 8, 'Jucurunca'),
(2892, 238, 9, 'La Concepción'),
(2893, 238, 10, 'Monte Grande'),
(2894, 238, 11, 'San José'),
(2895, 238, 12, 'Santa Cruz de Guayape'),
(2896, 238, 13, 'Suyapita'),
(2897, 238, 14, 'Tabloncitos'),
(2898, 238, 15, 'Vallecito'),
(2899, 239, 1, 'Jano'),
(2900, 239, 2, 'Comayaguela'),
(2901, 239, 3, 'El Zapotillo'),
(2902, 239, 4, 'La Pita'),
(2903, 239, 5, 'La Victoria'),
(2904, 239, 6, 'Las Labranzas'),
(2905, 239, 7, 'Pacaya'),
(2906, 239, 8, 'Pintora'),
(2907, 240, 1, 'La Unión'),
(2908, 240, 2, 'El Díctamo'),
(2909, 240, 3, 'La Pita'),
(2910, 240, 4, 'Los Encuentros'),
(2911, 240, 5, 'Palala'),
(2912, 241, 1, 'Mangulile'),
(2913, 241, 2, 'Camalotillo'),
(2914, 241, 3, 'El Aguila'),
(2915, 241, 4, 'El Cerro'),
(2916, 241, 5, 'El Potrero'),
(2917, 241, 6, 'El Terrero'),
(2918, 241, 7, 'Guata'),
(2919, 241, 8, 'Julián'),
(2920, 241, 9, 'La Chinga'),
(2921, 241, 10, 'La Peña o Portillo de La Peña'),
(2922, 241, 11, 'Lomitas'),
(2923, 241, 12, 'Los Blancos'),
(2924, 241, 13, 'Mangulilito'),
(2925, 241, 14, 'Quebrada Grande'),
(2926, 241, 15, 'San Antonio'),
(2927, 241, 16, 'Silaca'),
(2928, 242, 1, 'Manto'),
(2929, 242, 2, 'Amacuapa'),
(2930, 242, 3, 'Boca del Monte'),
(2931, 242, 4, 'El Bebedero'),
(2932, 242, 5, 'El Cerro'),
(2933, 242, 6, 'Jimasque'),
(2934, 242, 7, 'Sabana Larga'),
(2935, 242, 8, 'San Antonio'),
(2936, 242, 9, 'Uluapa'),
(2937, 243, 1, 'Salamá'),
(2938, 243, 2, 'Cofradía'),
(2939, 243, 3, 'Jutiapa'),
(2940, 243, 4, 'La Jagua'),
(2941, 243, 5, 'Méndez'),
(2942, 243, 6, 'Pozo Zarco'),
(2943, 243, 7, 'Sabana Grande'),
(2944, 243, 8, 'Talgua'),
(2945, 244, 1, 'San Esteban'),
(2946, 244, 2, 'Agua Blanca'),
(2947, 244, 3, 'Carnizuelar'),
(2948, 244, 4, 'Conquire'),
(2949, 244, 5, 'Coronado'),
(2950, 244, 6, 'Corral Viejo'),
(2951, 244, 7, 'El Aguacate'),
(2952, 244, 8, 'El Ciruelo'),
(2953, 244, 9, 'El Limonal'),
(2954, 244, 10, 'El Ocote'),
(2955, 244, 11, 'El Quebrachal'),
(2956, 244, 12, 'El Tunal'),
(2957, 244, 13, 'La Concepción'),
(2958, 244, 14, 'Las Manzanas'),
(2959, 244, 15, 'Las Trojas'),
(2960, 244, 16, 'Moreno'),
(2961, 244, 17, 'Río Abajo'),
(2962, 244, 18, 'San Agustín Abajo'),
(2963, 244, 19, 'San Martín'),
(2964, 244, 20, 'Santa María'),
(2965, 244, 21, 'Santa María del Carbón'),
(2966, 244, 22, 'Toro Muerto'),
(2967, 245, 1, 'San Francisco de Becerra'),
(2968, 245, 2, 'Bella Vista'),
(2969, 245, 3, 'El Guineo'),
(2970, 245, 4, 'Laguna Seca'),
(2971, 245, 5, 'Las Tres Ceibas'),
(2972, 245, 6, 'San Luis'),
(2973, 245, 7, 'Santa Marta'),
(2974, 246, 1, 'San Francisco de La Paz'),
(2975, 246, 2, 'El Carrizal'),
(2976, 246, 3, 'El Guapinol'),
(2977, 246, 4, 'El Nance'),
(2978, 246, 5, 'El Ocotal'),
(2979, 246, 6, 'El Ocote'),
(2980, 246, 7, 'El Pedregal'),
(2981, 246, 8, 'Guacoca'),
(2982, 246, 9, 'La Cruz'),
(2983, 246, 10, 'Regadío'),
(2984, 246, 11, 'San Agustín'),
(2985, 246, 12, 'Santa Ana'),
(2986, 246, 13, 'Tilapa'),
(2987, 247, 1, 'Santa María del Real'),
(2988, 247, 2, 'El Guayabito'),
(2989, 247, 3, 'San Carlos de Las Flores'),
(2990, 248, 1, 'Silca'),
(2991, 248, 2, 'El Carbonal'),
(2992, 248, 3, 'La Cruz'),
(2993, 248, 4, 'Panuaya'),
(2994, 248, 5, 'Parumble Nuevo'),
(2995, 248, 6, 'Santa Elena'),
(2996, 249, 1, 'Yocón'),
(2997, 249, 2, 'Cañada Galana'),
(2998, 249, 3, 'El Cuábano'),
(2999, 249, 4, 'El Potrero'),
(3000, 249, 5, 'La Empalizada'),
(3001, 249, 6, 'Ocotal del Naipe'),
(3002, 249, 7, 'San Antonio'),
(3003, 249, 8, 'San Pedro'),
(3004, 249, 9, 'Santa Rita o Plan del Conejo'),
(3005, 250, 1, 'Froilan Turcios (Nueva Palestina Patuca)'),
(3006, 250, 2, 'Arenas Blancas'),
(3007, 250, 3, 'El Ocotillal'),
(3008, 250, 4, 'Guineo Abajo'),
(3009, 250, 5, 'Guineo Arriba'),
(3010, 250, 6, 'La Laguna'),
(3011, 250, 7, 'La Libertad'),
(3012, 250, 8, 'Las Planchas'),
(3013, 250, 9, 'Nueva Choluteca'),
(3014, 250, 10, 'Onofio'),
(3015, 250, 11, 'San Fernando'),
(3016, 250, 12, 'Tepemechín'),
(3017, 250, 13, 'Terrero Blanco'),
(3018, 251, 1, 'Santa Bárbara'),
(3019, 251, 2, 'Agua Blanquita'),
(3020, 251, 3, 'Cerro Grande'),
(3021, 251, 4, 'El Diez y Ocho o Miraflores'),
(3022, 251, 5, 'El Moguete'),
(3023, 251, 6, 'Gualjoco'),
(3024, 251, 7, 'La Ceibita'),
(3025, 251, 8, 'La Cuesta'),
(3026, 251, 9, 'La Estancia'),
(3027, 251, 10, 'La Unión del Dorado'),
(3028, 251, 11, 'Las Crucitas'),
(3029, 251, 12, 'Las Quebradas'),
(3030, 251, 13, 'Los Anises'),
(3031, 251, 14, 'Los Bancos'),
(3032, 251, 15, 'Los Laureles'),
(3033, 251, 16, 'Macholoa'),
(3034, 251, 17, 'Río Seco'),
(3035, 251, 18, 'San Gaspar de Tablones'),
(3036, 251, 19, 'San Luis de Planes'),
(3037, 251, 20, 'Santa Rita de Oriente'),
(3038, 252, 1, 'Arada'),
(3039, 252, 3, 'Candelaria'),
(3040, 252, 4, 'Caulotales'),
(3041, 252, 5, 'El Ocotal'),
(3042, 252, 6, 'El Ocotillo'),
(3043, 252, 7, 'El Palmo'),
(3044, 252, 8, 'El Tular'),
(3045, 252, 9, 'Las Brisas de Oro'),
(3046, 252, 10, 'Los Planes'),
(3047, 252, 11, 'Sorca'),
(3048, 253, 1, 'Atima'),
(3049, 253, 2, 'Berlín'),
(3050, 253, 3, 'Lempa'),
(3051, 253, 4, 'Nueva Victoria'),
(3052, 253, 5, 'San José de Buena Vista'),
(3053, 253, 6, 'San Pedrito'),
(3054, 253, 7, 'San Rafael'),
(3055, 253, 8, 'Talanga'),
(3056, 254, 1, 'Azacualpa'),
(3057, 254, 2, 'Agualote'),
(3058, 254, 3, 'Buenos Aires'),
(3059, 254, 4, 'El Naranjo'),
(3060, 254, 5, 'El Pinabete'),
(3061, 254, 6, 'Joconal'),
(3062, 254, 7, 'Laguna Verde'),
(3063, 254, 8, 'La Puerta'),
(3064, 254, 9, 'Loma Alta'),
(3065, 254, 10, 'San Antonio'),
(3066, 255, 1, 'Ceguaca'),
(3067, 255, 2, 'El Edén'),
(3068, 255, 3, 'La Libertad'),
(3069, 255, 4, 'San Juan'),
(3070, 255, 5, 'Santa Ana o Las Lomas'),
(3071, 256, 1, 'Concepción del Norte'),
(3072, 256, 2, 'Agua Dulce'),
(3073, 256, 3, 'Buena Vista'),
(3074, 256, 4, 'Concordia'),
(3075, 256, 5, 'Cuchilla Alta'),
(3076, 256, 6, 'El Cerrón'),
(3077, 256, 7, 'El Macuelizo'),
(3078, 256, 8, 'El Robledal'),
(3079, 256, 9, 'El Volcán'),
(3080, 256, 10, 'La Laguna de Protección'),
(3081, 256, 11, 'Las Flores'),
(3082, 256, 12, 'Santa Ana'),
(3083, 256, 13, 'Suyapa'),
(3084, 257, 1, 'Concepción del Sur'),
(3085, 257, 2, 'El Aguaje'),
(3086, 257, 3, 'El Playón'),
(3087, 257, 4, 'La Vueltosa'),
(3088, 257, 5, 'Nueva Esperanza'),
(3089, 258, 1, 'Chinda'),
(3090, 258, 2, 'Barrio Nuevo o Chiquiguite'),
(3091, 258, 3, 'El Limón'),
(3092, 258, 4, 'El Retiro'),
(3093, 258, 5, 'El Tule'),
(3094, 258, 6, 'La Brea'),
(3095, 258, 7, 'La Cuchilla'),
(3096, 258, 8, 'Platanares'),
(3097, 258, 9, 'Río Cañas'),
(3098, 258, 10, 'San Rafael'),
(3099, 259, 1, 'El Níspero'),
(3100, 259, 2, 'El Paraíso'),
(3101, 259, 3, 'El Tontolo'),
(3102, 259, 4, 'Nejapa'),
(3103, 259, 5, 'Nueva York'),
(3104, 259, 6, 'San Jerónimo'),
(3105, 259, 7, 'Santa Cruz'),
(3106, 260, 1, 'Gualala'),
(3107, 260, 2, 'Arenales'),
(3108, 260, 3, 'El Carrizal'),
(3109, 260, 4, 'Guacamaya'),
(3110, 260, 5, 'Gualjoquito'),
(3111, 260, 6, 'Platanares'),
(3112, 260, 7, 'Quebrada Arriba'),
(3113, 260, 8, 'Santa Rosita'),
(3114, 261, 1, 'Ilama'),
(3115, 261, 2, 'Agua Zarca'),
(3116, 261, 3, 'Cececapa'),
(3117, 261, 4, 'La Cañada'),
(3118, 261, 5, 'La Cuchilla'),
(3119, 261, 6, 'La Estancia'),
(3120, 261, 7, 'La Fe'),
(3121, 261, 8, 'La Mica'),
(3122, 261, 9, 'La Montañita'),
(3123, 261, 10, 'San José de Oriente'),
(3124, 261, 11, 'San Juan de La Cruz'),
(3125, 261, 12, 'San Vicente de Las Nieves'),
(3126, 261, 13, 'Uncana'),
(3127, 262, 1, 'Macuelizo'),
(3128, 262, 2, 'Agua Helada'),
(3129, 262, 3, 'Aldea Nueva'),
(3130, 262, 4, 'Buena Vista'),
(3131, 262, 5, 'Callejones o La Libertad'),
(3132, 262, 6, 'Casa Quemada'),
(3133, 262, 7, 'Chiquila'),
(3134, 262, 8, 'El Barranco'),
(3135, 262, 9, 'El Ciruelo'),
(3136, 262, 10, 'El Ermitaño'),
(3137, 262, 11, 'El Manguito'),
(3138, 262, 12, 'El Oro'),
(3139, 262, 13, 'El Pital'),
(3140, 262, 14, 'El Rosario'),
(3141, 262, 15, 'La Cumbre de Palmichal'),
(3142, 262, 16, 'La Cunta'),
(3143, 262, 17, 'La Flecha'),
(3144, 262, 18, 'La Vegona'),
(3145, 262, 19, 'La Virtud'),
(3146, 262, 20, 'Laguna Seca'),
(3147, 262, 21, 'Las Delicias'),
(3148, 262, 22, 'Las Flores'),
(3149, 262, 23, 'Las Minas'),
(3150, 262, 24, 'Las Varas'),
(3151, 262, 25, 'Mata de Plátano'),
(3152, 262, 26, 'Ojos de Agua'),
(3153, 262, 27, 'Piladeros'),
(3154, 262, 28, 'Piñuelas'),
(3155, 262, 29, 'Pueblo Nuevo'),
(3156, 262, 30, 'Río Blanco'),
(3157, 262, 31, 'Sabanetas'),
(3158, 262, 32, 'San Antonio de La Cumbre'),
(3159, 262, 33, 'San Antonio de Macuelizo'),
(3160, 262, 34, 'San José de Tarros'),
(3161, 262, 35, 'San Miguelito'),
(3162, 262, 36, 'Sula'),
(3163, 262, 37, 'Trascerros'),
(3164, 262, 38, 'Zapotales o El Zapotalito'),
(3165, 263, 1, 'Naranjito'),
(3166, 263, 2, 'Camacal'),
(3167, 263, 3, 'El Nisperal'),
(3168, 263, 4, 'El Portillo'),
(3169, 263, 5, 'Jimilile'),
(3170, 263, 6, 'Las Crucitas'),
(3171, 263, 7, 'Los Corrales'),
(3172, 263, 8, 'Quebrada del Rancho'),
(3173, 263, 9, 'San Isidro'),
(3174, 263, 10, 'San Juan'),
(3175, 263, 11, 'Santa Ana'),
(3176, 263, 12, 'Santiago de Posta'),
(3177, 263, 13, 'Ulapa'),
(3178, 264, 1, 'Nuevo Celilac'),
(3179, 264, 2, 'La Aradita'),
(3180, 264, 3, 'Las Crucitas'),
(3181, 264, 4, 'Nueva Jalapa o Tierra Blanca'),
(3182, 264, 5, 'San Jerónimo del Pinal'),
(3183, 264, 6, 'San Nicolasito'),
(3184, 264, 7, 'Valle de La Cruz'),
(3185, 265, 1, 'Petoa'),
(3186, 265, 2, 'Barandillales'),
(3187, 265, 3, 'Camalotales'),
(3188, 265, 4, 'El Paraíso'),
(3189, 265, 5, 'El Plan de Olola'),
(3190, 265, 6, 'Las Flores'),
(3191, 265, 7, 'Mezcalito'),
(3192, 265, 8, 'Pueblo Nuevo'),
(3193, 265, 9, 'Quebraditas'),
(3194, 265, 10, 'San Antonio de La Majada'),
(3195, 265, 11, 'San Joaquín'),
(3196, 265, 12, 'San José de La Majada'),
(3197, 265, 13, 'Santa Clara'),
(3198, 265, 14, 'Santo Domingo'),
(3199, 266, 1, 'Protección'),
(3200, 266, 2, 'Buenos Aires'),
(3201, 266, 3, 'El Chile'),
(3202, 266, 4, 'El Encanto'),
(3203, 266, 5, 'El Ocote'),
(3204, 266, 6, 'El Triunfo'),
(3205, 266, 7, 'La Jaguilla o Loma Encerrada'),
(3206, 266, 8, 'La Laguna'),
(3207, 266, 9, 'La Reina'),
(3208, 266, 10, 'La Ruidosa'),
(3209, 266, 11, 'Las Delicias o Las Loras'),
(3210, 266, 12, 'Las Vueltas'),
(3211, 266, 13, 'Pueblo Nuevo'),
(3212, 266, 14, 'Zambrano'),
(3213, 267, 1, 'Quimistán'),
(3214, 267, 2, 'Agua Sucia'),
(3215, 267, 3, 'Aldea Nueva'),
(3216, 267, 4, 'Buenos Aires'),
(3217, 267, 5, 'Camalote'),
(3218, 267, 6, 'Correderos'),
(3219, 267, 7, 'El Aguacate'),
(3220, 267, 8, 'El Chaguite'),
(3221, 267, 9, 'El Higuerito'),
(3222, 267, 10, 'El Tablón'),
(3223, 267, 11, 'La Acequia'),
(3224, 267, 12, 'La Ceibita'),
(3225, 267, 13, 'La Guasma'),
(3226, 267, 14, 'La Mina'),
(3227, 267, 15, 'La Montañita'),
(3228, 267, 16, 'La Ruidosa o Nueva Esperanza'),
(3229, 267, 17, 'Laguna del Carmen'),
(3230, 267, 18, 'Las Crucitas'),
(3231, 267, 19, 'Las Flores de Río Chiquito'),
(3232, 267, 20, 'Milpa Arada'),
(3233, 267, 21, 'Naco'),
(3234, 267, 22, 'Nueva Esperanza de Río Chiquito'),
(3235, 267, 23, 'Ocotal Tupido'),
(3236, 267, 24, 'Pichinel'),
(3237, 267, 25, 'Pinalejo'),
(3238, 267, 26, 'Río Blanco'),
(3239, 267, 27, 'San Isidro'),
(3240, 267, 28, 'San José del Cacao'),
(3241, 267, 29, 'San Juan del Sitio'),
(3242, 267, 30, 'San Miguel del Paso Viejo'),
(3243, 267, 31, 'Santa Cruz Minas'),
(3244, 267, 32, 'Tierra Amarilla'),
(3245, 268, 1, 'San Francisco de Ojuera'),
(3246, 268, 2, 'El Diviso'),
(3247, 268, 3, 'El Gavilán'),
(3248, 268, 4, 'El Pilón'),
(3249, 268, 5, 'La Chorrera'),
(3250, 268, 6, 'La Palca'),
(3251, 268, 7, 'La Vega'),
(3252, 268, 8, 'Plan de Los Cedros'),
(3253, 268, 9, 'Pueblo Nuevo'),
(3254, 268, 10, 'San Isidro'),
(3255, 268, 11, 'San Ramón'),
(3256, 268, 12, 'Santa Ana'),
(3257, 268, 13, 'Santa Fe'),
(3258, 269, 1, 'San José de Colinas'),
(3259, 269, 2, 'Agua Helada'),
(3260, 269, 3, 'Cacahulapa'),
(3261, 269, 4, 'El Ceibón'),
(3262, 269, 5, 'El Encanto'),
(3263, 269, 6, 'El Jicaral'),
(3264, 269, 7, 'El Pacayalito'),
(3265, 269, 8, 'El Pastorero'),
(3266, 269, 9, 'El Pinabete'),
(3267, 269, 10, 'El Porvenir o El Zapote'),
(3268, 269, 11, 'El Triunfo'),
(3269, 269, 12, 'Hundiciones'),
(3270, 269, 13, 'La Alianza'),
(3271, 269, 14, 'La Comunidad'),
(3272, 269, 15, 'La Isla'),
(3273, 269, 16, 'La Libertad'),
(3274, 269, 17, 'La Nueva Florida'),
(3275, 269, 18, 'La Unión'),
(3276, 269, 19, 'Laguna Colorada'),
(3277, 269, 20, 'Laguna Inea'),
(3278, 269, 21, 'Las Joyas'),
(3279, 269, 22, 'Loma Larga'),
(3280, 269, 23, 'Nueva Esperanza'),
(3281, 269, 24, 'Peña Blanca'),
(3282, 269, 25, 'Piedra Grande'),
(3283, 269, 26, 'San Francisco del Carrizal'),
(3284, 269, 27, 'San José de Colón'),
(3285, 269, 28, 'San Luis del Pacayal'),
(3286, 269, 29, 'San Luis Planes'),
(3287, 269, 30, 'San Miguel de Lajas'),
(3288, 269, 31, 'Santa Cruz Cuchilla'),
(3289, 269, 32, 'Victoria'),
(3290, 170, 1, 'San Luis'),
(3291, 170, 2, 'Calpules'),
(3292, 170, 3, 'El Sauce'),
(3293, 170, 4, 'El Regadío'),
(3294, 170, 5, 'Las Flores'),
(3295, 170, 6, 'Las Rosas'),
(3296, 170, 7, 'La Unión o El Playón'),
(3297, 170, 8, 'Nisperales'),
(3298, 170, 9, 'Palma Real o El Banco'),
(3299, 170, 10, 'San Francisco'),
(3300, 170, 11, 'San Isidro'),
(3301, 170, 12, 'San Juan'),
(3302, 170, 13, 'San Miguel Cuabanales'),
(3303, 170, 14, 'Santa Elena'),
(3304, 170, 15, 'Tejutales'),
(3305, 170, 16, 'Tatoca o El Barro'),
(3306, 170, 17, 'Villa Luz'),
(3307, 271, 1, 'San Marcos'),
(3308, 271, 2, 'Agua Tapada'),
(3309, 271, 3, 'Bella Vista'),
(3310, 271, 4, 'Campo Alegre'),
(3311, 271, 5, 'Corralito'),
(3312, 271, 6, 'Chumbagua'),
(3313, 271, 7, 'El Chorro'),
(3314, 271, 8, 'El Llano de Los Panales'),
(3315, 271, 9, 'El Robledal'),
(3316, 271, 10, 'La Presa'),
(3317, 271, 11, 'La Puerta'),
(3318, 271, 12, 'Las Minitas'),
(3319, 271, 13, 'Piletas'),
(3320, 271, 14, 'Plan de Lola'),
(3321, 271, 15, 'Potrerillos'),
(3322, 271, 16, 'Regadío'),
(3323, 271, 17, 'San Francisco de Los Valles'),
(3324, 271, 18, 'Sitio Viejo'),
(3325, 271, 19, 'Zapote No.1'),
(3326, 271, 20, 'Zapote No.2'),
(3327, 272, 1, 'San Nicolás'),
(3328, 272, 2, 'Cruz Grande'),
(3329, 272, 3, 'Choloma'),
(3330, 272, 4, 'El Descansadero'),
(3331, 272, 5, 'El Pinalejo'),
(3332, 272, 6, 'El Porvenir'),
(3333, 272, 7, 'El Resumidero'),
(3334, 272, 8, 'La Cuchilla'),
(3335, 272, 9, 'San Manuel del Triunfo'),
(3336, 272, 10, 'Santa Cruz'),
(3337, 273, 1, 'San Pedro Zacapa'),
(3338, 273, 2, 'Agua Caliente'),
(3339, 273, 3, 'Azacualpa'),
(3340, 273, 4, 'Canculuncos'),
(3341, 273, 5, 'El Mogote'),
(3342, 273, 6, 'El Ocote'),
(3343, 273, 7, 'Horconcitos'),
(3344, 273, 8, 'La Boquita'),
(3345, 273, 9, 'Mojarras'),
(3346, 273, 10, 'San Antonio de Chuchepeque'),
(3347, 274, 1, 'San Vicente Centenario'),
(3348, 275, 1, 'Santa Rita'),
(3349, 275, 2, 'El Aguaje'),
(3350, 275, 3, 'El Jengibral'),
(3351, 275, 4, 'El Teuxinte'),
(3352, 275, 5, 'San Fernando'),
(3353, 276, 1, 'Trinidad'),
(3354, 276, 2, 'Cebadilla'),
(3355, 276, 3, 'Chimizales'),
(3356, 276, 4, 'El Carmen'),
(3357, 276, 5, 'El Corozal'),
(3358, 276, 6, 'El Diviso'),
(3359, 276, 7, 'El Guineal'),
(3360, 276, 8, 'El Higuito'),
(3361, 276, 9, 'El Rodeo'),
(3362, 276, 10, 'El Tigre'),
(3363, 276, 11, 'El Tumbo'),
(3364, 276, 12, 'La Alegría'),
(3365, 276, 13, 'La Angostura'),
(3366, 276, 14, 'La Huerta'),
(3367, 276, 15, 'La Unión'),
(3368, 276, 16, 'Las Delicias'),
(3369, 276, 17, 'Las Trojes'),
(3370, 276, 18, 'Matasanales'),
(3371, 276, 19, 'Pinabete o Loma Limpia'),
(3372, 276, 20, 'San Francisco'),
(3373, 276, 21, 'Santa Rosita'),
(3374, 276, 22, 'Tascalapa'),
(3375, 277, 1, 'Las Vegas'),
(3376, 277, 2, 'El Carreto'),
(3377, 277, 3, 'El Mochito o Mocho Arriba'),
(3378, 277, 4, 'El Sauce'),
(3379, 277, 5, 'Flores del Bijao'),
(3380, 277, 6, 'La Unión Suyapa'),
(3381, 277, 7, 'San José de Los Andes'),
(3382, 278, 1, 'Nueva Frontera'),
(3383, 278, 2, 'San José de Tarros'),
(3384, 278, 3, 'El Oro'),
(3385, 278, 4, 'Piladeros'),
(3386, 278, 5, 'Zapotales'),
(3387, 278, 6, 'San Miguel'),
(3388, 278, 7, 'Terreritos'),
(3389, 278, 8, 'La Coroza'),
(3390, 278, 9, 'Colonia Los Pinos'),
(3391, 278, 10, 'Colonia El Buen '),
(3392, 278, 11, 'Samaritano'),
(3393, 278, 12, 'Calpules'),
(3394, 278, 13, 'La Fortuna'),
(3395, 278, 14, 'Pueblo Nuevo'),
(3396, 278, 15, 'Aldea Nueva'),
(3397, 278, 16, 'Buena Vista'),
(3398, 278, 17, 'Los Leones'),
(3399, 278, 18, 'Las Brisas'),
(3400, 278, 19, 'Buenos Aires'),
(3401, 278, 20, 'Col.15 Septiembre'),
(3402, 278, 21, 'Piedras De Plata'),
(3403, 278, 22, 'Ermitaño'),
(3404, 278, 23, 'El Pino'),
(3405, 278, 24, 'El Barranco'),
(3406, 278, 25, 'El Cedral'),
(3407, 278, 26, 'Piedras Negras'),
(3408, 278, 27, 'Los Laureles'),
(3409, 278, 28, 'El Profundo'),
(3410, 278, 29, 'La Cumbre'),
(3411, 278, 30, 'El Guanal'),
(3412, 278, 31, 'La Reina');
INSERT INTO `tbl_general_aldea` (`cod_aldea`, `cod_municipio`, `num_municipio_depart_aldea`, `aldea`) VALUES
(3413, 278, 32, 'Las Pilas'),
(3414, 278, 33, 'Los Positos'),
(3415, 278, 34, 'La Esperanza'),
(3416, 279, 1, 'Nacaome'),
(3417, 279, 2, 'Agua Caliente'),
(3418, 279, 3, 'El Rosario'),
(3419, 279, 4, 'El Tabacal'),
(3420, 279, 5, 'El Tular'),
(3421, 279, 6, 'Guacirope'),
(3422, 279, 7, 'Moropocay'),
(3423, 279, 8, 'San Antonio'),
(3424, 279, 9, 'San Nicolás Arriba'),
(3425, 279, 10, 'San Rafael'),
(3426, 280, 1, 'Alianza'),
(3427, 280, 2, 'Alto de Jesús'),
(3428, 280, 3, 'Los Amates'),
(3429, 280, 4, 'San Jerónimo'),
(3430, 280, 5, 'San Pedro Calero'),
(3431, 280, 6, 'Sonora'),
(3432, 281, 1, 'Amapala'),
(3433, 281, 2, 'Coyolito'),
(3434, 281, 3, 'El Zope'),
(3435, 281, 4, 'Gualorita'),
(3436, 281, 5, 'La Flor'),
(3437, 281, 6, 'La Pintadillera'),
(3438, 281, 7, 'Los Langues'),
(3439, 281, 8, 'Playa Grande'),
(3440, 281, 9, 'Playa Negra'),
(3441, 281, 10, 'Playa o Punta Novillo'),
(3442, 281, 11, 'Puerto Grande'),
(3443, 281, 12, 'San Carlos o El Garrobo'),
(3444, 281, 13, 'San Pablo'),
(3445, 282, 1, 'Aramecina'),
(3446, 282, 2, 'El Cantíl'),
(3447, 282, 3, 'El Pedregal'),
(3448, 282, 4, 'El Tablón'),
(3449, 282, 5, 'La Peña'),
(3450, 282, 6, 'Las Pozas'),
(3451, 282, 7, 'Los Terreros'),
(3452, 282, 8, 'Macuelizo'),
(3453, 282, 9, 'Sampito'),
(3454, 282, 10, 'Santa Lucía'),
(3455, 282, 11, 'Solubre'),
(3456, 282, 12, 'Tierra Blanca'),
(3457, 283, 1, 'Caridad'),
(3458, 283, 2, 'Hondable No.1'),
(3459, 283, 3, 'La Esperanza'),
(3460, 283, 4, 'Las Delicias'),
(3461, 283, 5, 'San Antonio'),
(3462, 284, 1, 'Goascorán'),
(3463, 284, 2, 'El Picacho'),
(3464, 284, 3, 'La Arada'),
(3465, 284, 4, 'Llano de Jesús'),
(3466, 284, 5, 'Piedras Blancas'),
(3467, 284, 6, 'San Andrés'),
(3468, 284, 7, 'Santa Inés'),
(3469, 284, 8, 'Santa Rita'),
(3470, 285, 1, 'Langue'),
(3471, 285, 2, 'Candelaria'),
(3472, 285, 3, 'Concepción de María o Potrero Grande'),
(3473, 285, 4, 'Los Llanos'),
(3474, 285, 5, 'San Francisco No.2'),
(3475, 285, 6, 'San Marcos o Tamayo'),
(3476, 286, 1, 'San Francisco de Coray'),
(3477, 286, 2, 'Caleas No.2'),
(3478, 286, 3, 'Cerro Grande'),
(3479, 286, 4, 'El Espino'),
(3480, 286, 5, 'El Guayabo'),
(3481, 286, 6, 'El Rodeo'),
(3482, 286, 7, 'El Salitre'),
(3483, 286, 8, 'La Cañada o Calea No.1'),
(3484, 286, 9, 'La Laguna No.1'),
(3485, 286, 10, 'La Laguna No.2'),
(3486, 286, 11, 'Las Delicias'),
(3487, 286, 12, 'Las Mesas'),
(3488, 286, 13, 'Los Amates'),
(3489, 286, 14, 'Montecristo'),
(3490, 286, 15, 'Panasacarán'),
(3491, 286, 16, 'Talpetates'),
(3492, 287, 1, 'San Lorenzo'),
(3493, 287, 2, 'El Caimito'),
(3494, 287, 3, 'El Comercio'),
(3495, 287, 4, 'El Matiaral'),
(3496, 287, 5, 'Guanacastales'),
(3497, 287, 6, 'La Criba'),
(3498, 287, 7, 'La Cuesta'),
(3499, 287, 8, 'Laure Abajo'),
(3500, 287, 9, 'Laure Arriba'),
(3501, 287, 10, 'San Jerónimo'),
(3502, 288, 1, 'Yoro'),
(3503, 288, 2, 'Ayapa'),
(3504, 288, 3, 'Chalmeca'),
(3505, 288, 4, 'Guare'),
(3506, 288, 5, 'La Capa'),
(3507, 288, 6, 'La Guata'),
(3508, 288, 7, 'La Laguna'),
(3509, 288, 8, 'La Laguna de La Capa'),
(3510, 288, 9, 'La Rosa'),
(3511, 288, 10, 'La Trinidad'),
(3512, 288, 11, 'Las Quebradas'),
(3513, 288, 12, 'Locomapa No.1'),
(3514, 288, 13, 'Locomapa No.2'),
(3515, 288, 14, 'Mejía'),
(3516, 288, 15, 'Nueva Florida'),
(3517, 288, 16, 'San Diego'),
(3518, 288, 17, 'San José de Texiguat'),
(3519, 288, 18, 'Subirana'),
(3520, 288, 19, 'Tulanguare'),
(3521, 289, 1, 'Arenal'),
(3522, 289, 2, 'Campo El Cayo'),
(3523, 289, 3, 'Champerío El Cayo'),
(3524, 289, 4, 'El Retiro'),
(3525, 289, 5, 'Santa Cruz'),
(3526, 289, 6, 'Teguajal'),
(3527, 289, 7, 'Tierra Blanca'),
(3528, 290, 1, 'El Negrito'),
(3529, 290, 2, 'Battán'),
(3530, 290, 3, 'Campo Paujil'),
(3531, 290, 4, 'Campo Perdíz'),
(3532, 290, 5, 'Cerro Prieto No.1'),
(3533, 290, 6, 'Cerro Prieto No.2'),
(3534, 290, 7, 'El Jocomico'),
(3535, 290, 8, 'El Junco'),
(3536, 290, 9, 'El Naranjo'),
(3537, 290, 10, 'El Pate'),
(3538, 290, 11, 'El Robledal'),
(3539, 290, 12, 'El Rodeo'),
(3540, 290, 13, 'Estero Indio'),
(3541, 290, 14, 'Finca Treinta y Cinco'),
(3542, 290, 15, 'Finca Treinta y Seis'),
(3543, 290, 16, 'Guaymón No.1'),
(3544, 290, 17, 'La Laguna'),
(3545, 290, 18, 'La Majada'),
(3546, 290, 19, 'La Veinte y Nueve'),
(3547, 290, 20, 'La Veinte y Ocho'),
(3548, 290, 21, 'Las Delicias'),
(3549, 290, 22, 'Nueva San Antonio'),
(3550, 290, 23, 'Samar'),
(3551, 290, 24, 'San Jerónimo'),
(3552, 290, 25, 'San José del Negrito'),
(3553, 290, 26, 'Toyos'),
(3554, 290, 27, 'Villa del Carmen o Finca Treinta y Siete'),
(3555, 291, 1, 'El Progreso'),
(3556, 291, 2, 'Agua Blanca del Norte'),
(3557, 291, 3, 'Agua Blanca Sur'),
(3558, 291, 4, 'Arenas Blancas'),
(3559, 291, 5, 'Buenos Aires del Norte'),
(3560, 291, 6, 'Buenos Aires o Paujiles'),
(3561, 291, 7, 'Campo Amapa'),
(3562, 291, 8, 'Campo Birichiche o Las Palomas'),
(3563, 291, 9, 'Campo Buena Vista'),
(3564, 291, 10, 'Campo Coob'),
(3565, 291, 11, 'Campo Diez y Seis o Buenos Amigos'),
(3566, 291, 12, 'Campo Diez Alboroto'),
(3567, 291, 13, 'Campo Diez Asunohsa'),
(3568, 291, 14, 'Campo Doce'),
(3569, 291, 15, 'Campo La Fragua'),
(3570, 291, 16, 'Campo Las Flores'),
(3571, 291, 17, 'Campo Mocula'),
(3572, 291, 18, 'Campo Monterrey'),
(3573, 291, 19, 'Campo Naranjo Chino'),
(3574, 291, 20, 'Campo Nueve'),
(3575, 291, 21, 'Campo Once'),
(3576, 291, 22, 'Campo Palos Blancos o Breck'),
(3577, 291, 23, 'Colonia Brisas de La Libertad'),
(3578, 291, 24, 'Col. Cohbasa'),
(3579, 291, 25, 'Col. Guanchías'),
(3580, 291, 26, 'Col. San José o La Treinta y Nueve'),
(3581, 291, 27, 'Cuatro de Marzo'),
(3582, 291, 28, 'El Bálsamo'),
(3583, 291, 29, 'El Porvenir del Norte o El Camalote'),
(3584, 291, 30, 'Finca Quince'),
(3585, 291, 31, 'Guanchía Cerro'),
(3586, 291, 32, 'Guaymitas'),
(3587, 291, 33, 'Guaymitas Viejo o El Castaño'),
(3588, 291, 34, 'La Colorada'),
(3589, 291, 35, 'La Cuarenta'),
(3590, 291, 36, 'La Curva o Kilómetro Cuarenta y Cinco'),
(3591, 291, 37, 'La Guacamaya'),
(3592, 291, 38, 'La Mina'),
(3593, 291, 39, 'La Ocho o El Socorro'),
(3594, 291, 40, 'La Sarrosa'),
(3595, 291, 41, 'Las Brisas del Norte'),
(3596, 291, 42, 'Las Chumbas'),
(3597, 291, 43, 'Las Delicias del Jute'),
(3598, 291, 44, 'Las Golondrinas'),
(3599, 291, 45, 'Mealer'),
(3600, 291, 46, 'Mico Quemado'),
(3601, 291, 47, 'Ojo de Agua'),
(3602, 291, 48, 'Quebrada de Yoro'),
(3603, 291, 49, 'San Antonio'),
(3604, 291, 50, 'San Luis Seis'),
(3605, 291, 51, 'Santa Elena'),
(3606, 291, 52, 'Santa Inés'),
(3607, 291, 53, 'Suyapa o Kilómetro Setenta'),
(3608, 291, 54, 'Urraco Pueblo'),
(3609, 291, 55, 'Urraco Sur'),
(3610, 291, 56, 'Veracruz Paloma'),
(3611, 292, 1, 'Jocón'),
(3612, 292, 2, 'Agua Fría'),
(3613, 292, 3, 'Alta Cruz'),
(3614, 292, 4, 'La Dalia'),
(3615, 292, 5, 'La Loma'),
(3616, 292, 6, 'La Rosa'),
(3617, 292, 7, 'Lama'),
(3618, 292, 8, 'Macora'),
(3619, 292, 9, 'Puente Grande'),
(3620, 292, 10, 'Tapiquil'),
(3621, 293, 1, 'Morazán'),
(3622, 293, 2, 'Agua Blanca'),
(3623, 293, 3, 'Buena Vista'),
(3624, 293, 4, 'Candelaria'),
(3625, 293, 5, 'Caridad'),
(3626, 293, 6, 'Cuyamapa'),
(3627, 293, 7, 'Chililenga'),
(3628, 293, 8, 'El Filón del Porvenir'),
(3629, 293, 9, 'La Bolsita'),
(3630, 293, 10, 'La Cruz'),
(3631, 293, 11, 'La Estancia'),
(3632, 293, 12, 'Lempira'),
(3633, 293, 13, 'Los Prietos o San Martín'),
(3634, 293, 14, 'Mango Seco'),
(3635, 293, 15, 'Mojimán'),
(3636, 293, 16, 'Nombre de Dios'),
(3637, 293, 17, 'Nueva Esperanza'),
(3638, 293, 18, 'Nueva Florida'),
(3639, 293, 19, 'Ocote Paulino'),
(3640, 293, 20, 'Paya'),
(3641, 293, 21, 'Portillo González'),
(3642, 293, 22, 'Rompidos o Los Lirios de Guayma'),
(3643, 293, 23, 'San Antonio o Palmar'),
(3644, 293, 24, 'San Juan de Camalote'),
(3645, 293, 25, 'San Rafael de Aguacatales'),
(3646, 294, 1, 'Olanchito'),
(3647, 294, 2, 'Agalteca'),
(3648, 294, 3, 'Agua Caliente'),
(3649, 294, 4, 'Armenia'),
(3650, 294, 5, 'Bálsamo Oriental'),
(3651, 294, 6, 'Barranco'),
(3652, 294, 7, 'Boca de Mame'),
(3653, 294, 8, 'Briones'),
(3654, 294, 9, 'Calpules'),
(3655, 294, 10, 'Campo Agua Buena'),
(3656, 294, 11, 'Campo Bálsamo'),
(3657, 294, 12, 'Campo Calpules'),
(3658, 294, 13, 'Campo El Chorro'),
(3659, 294, 14, 'Campo Limones No.4'),
(3660, 294, 15, 'Campo Limones No.6'),
(3661, 294, 16, 'Campo Nerones'),
(3662, 294, 17, 'Campo Nuevo'),
(3663, 294, 18, 'Campo Palo Verde No.2'),
(3664, 294, 19, 'Campo Rosario'),
(3665, 294, 20, 'Campo Trojas No.2'),
(3666, 294, 21, 'Campo Trojas No.3'),
(3667, 294, 22, 'Carbajales'),
(3668, 294, 23, 'Clifton'),
(3669, 294, 24, 'Cooperativa Brisas de Cuyamapa'),
(3670, 294, 25, 'Cooperativa Doce de Diciembre'),
(3671, 294, 26, 'Coyoles'),
(3672, 294, 27, 'Coyoles Central'),
(3673, 294, 28, 'Chorrera'),
(3674, 294, 29, 'El Carril'),
(3675, 294, 30, 'El Cerro'),
(3676, 294, 31, 'El Coyolar'),
(3677, 294, 32, 'El Chaparral'),
(3678, 294, 33, 'El Juncal'),
(3679, 294, 34, 'El Nance'),
(3680, 294, 35, 'El Ocote'),
(3681, 294, 36, 'El Terrero'),
(3682, 294, 37, 'El Urraco'),
(3683, 294, 38, 'La América'),
(3684, 294, 39, 'La Florida'),
(3685, 294, 40, 'La Hicaca'),
(3686, 294, 41, 'La Libertad'),
(3687, 294, 42, 'La Reforma'),
(3688, 294, 43, 'La Sabana de San Carlos'),
(3689, 294, 44, 'La Veguita'),
(3690, 294, 45, 'Las Flores'),
(3691, 294, 46, 'Las Hicoteas'),
(3692, 294, 47, 'Las Jaguas'),
(3693, 294, 48, 'Las Minas'),
(3694, 294, 49, 'Maloa'),
(3695, 294, 50, 'Medina'),
(3696, 294, 51, 'Méndez'),
(3697, 294, 52, 'Nombre de Jesús'),
(3698, 294, 53, 'Potrerillos'),
(3699, 294, 54, 'Puerto Escondido'),
(3700, 294, 55, 'Sabanetas'),
(3701, 294, 56, 'San Carlos'),
(3702, 294, 57, 'San Dimas'),
(3703, 294, 58, 'San Francisco'),
(3704, 294, 59, 'San Jerónimo'),
(3705, 294, 60, 'San José'),
(3706, 294, 61, 'San Juan'),
(3707, 294, 62, 'San Lorenzo Abajo'),
(3708, 294, 63, 'San Lorenzo Arriba'),
(3709, 294, 64, 'San Marcos'),
(3710, 294, 65, 'Santa Bárbara'),
(3711, 294, 66, 'Tacualtuste'),
(3712, 294, 67, 'Teguajinal'),
(3713, 294, 68, 'Tejeras'),
(3714, 294, 69, 'Tepusteca'),
(3715, 294, 70, 'Trojas'),
(3716, 295, 1, 'Santa Rita'),
(3717, 295, 2, 'Cangrejales'),
(3718, 295, 3, 'Casiano'),
(3719, 295, 4, 'El Caliche'),
(3720, 295, 5, 'El Capulín'),
(3721, 295, 6, 'El Remolino'),
(3722, 295, 7, 'El Santuario de Plácido'),
(3723, 295, 8, 'El Vertiente'),
(3724, 295, 9, 'Finca Diez y Nueve'),
(3725, 295, 10, 'Guanchías Crique'),
(3726, 295, 11, 'Plácido'),
(3727, 295, 12, 'Plan Grande'),
(3728, 295, 13, 'Tapiquilares'),
(3729, 295, 14, 'Terrero Negro'),
(3730, 296, 1, 'Sulaco'),
(3731, 296, 2, 'El Desmonte'),
(3732, 296, 3, 'El Jaral'),
(3733, 296, 4, 'La Albardilla'),
(3734, 296, 5, 'Las Cañas'),
(3735, 296, 6, 'San Antonio'),
(3736, 296, 7, 'San Juan'),
(3737, 297, 1, 'Victoria'),
(3738, 297, 2, 'Bajo Grande'),
(3739, 297, 3, 'Buenos Aires'),
(3740, 297, 4, 'Coyolito'),
(3741, 297, 5, 'El Jicaro'),
(3742, 297, 6, 'El Mango'),
(3743, 297, 7, 'El Pataste'),
(3744, 297, 8, 'Guarabuqui'),
(3745, 297, 9, 'Jacagua'),
(3746, 297, 10, 'La Zarza'),
(3747, 297, 11, 'Las Flores'),
(3748, 297, 12, 'Las Lomas'),
(3749, 297, 13, 'Las Vegas'),
(3750, 297, 14, 'Lomas del Jícaro'),
(3751, 297, 15, 'Los Cacaos'),
(3752, 297, 16, 'Méndez'),
(3753, 297, 17, 'San Isidro'),
(3754, 297, 18, 'Santa Lucía'),
(3755, 297, 19, 'Tierra Amarilla'),
(3756, 298, 1, 'Yorito'),
(3757, 298, 2, 'El Destino'),
(3758, 298, 3, 'El Portillo'),
(3759, 298, 4, 'Jalapa'),
(3760, 298, 5, 'La Esperanza'),
(3761, 298, 6, 'Luquigue'),
(3762, 298, 7, 'Pueblo Viejo'),
(3763, 298, 8, 'Santa Marta'),
(3764, 298, 9, 'Vallecillos'),
(3765, 294, 99, 'MI ALDEA FAVORITA'),
(3766, 294, 99, 'MI ALDEA FAVORITA');

-- --------------------------------------------------------

--
-- Estructura de tabla para la tabla `tbl_general_departamento`
--

CREATE TABLE `tbl_general_departamento` (
  `cod_depart` bigint(11) NOT NULL,
  `departamento` varchar(17) NOT NULL,
  `depar_value` varchar(20) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

--
-- Volcado de datos para la tabla `tbl_general_departamento`
--

INSERT INTO `tbl_general_departamento` (`cod_depart`, `departamento`, `depar_value`) VALUES
(1, 'Atlantida', ''),
(2, 'Colon', ''),
(3, 'Comayagua', ''),
(4, 'Copan', ''),
(5, 'Cortes', ''),
(6, 'Choluteca', ''),
(7, 'El Paraiso', ''),
(8, 'Francisco Morazan', ''),
(9, 'Gracias a Dios', ''),
(10, 'Intibuca', ''),
(11, 'Islas de la Bahia', ''),
(12, 'La Paz', ''),
(13, 'Lempira', ''),
(14, 'Ocotepeque', ''),
(15, 'Olancho', ''),
(16, 'Santa Barbara', ''),
(17, 'Valle', ''),
(18, 'Yoro', '');

-- --------------------------------------------------------

--
-- Estructura de tabla para la tabla `tbl_general_escolaridad`
--

CREATE TABLE `tbl_general_escolaridad` (
  `cod_escolaridad` bigint(20) NOT NULL,
  `escolaridad` int(2) NOT NULL,
  `descripcion` varchar(100) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

--
-- Volcado de datos para la tabla `tbl_general_escolaridad`
--

INSERT INTO `tbl_general_escolaridad` (`cod_escolaridad`, `escolaridad`, `descripcion`) VALUES
(1, 1, 'primer grado'),
(2, 6, 'sexto grado'),
(3, 9, 'ciclo'),
(4, 12, 'bachiller'),
(5, 0, 'pendiente');

-- --------------------------------------------------------

--
-- Estructura de tabla para la tabla `tbl_general_estado_civil`
--

CREATE TABLE `tbl_general_estado_civil` (
  `cod_estado_civil` bigint(20) NOT NULL,
  `estado_civil` varchar(15) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

--
-- Volcado de datos para la tabla `tbl_general_estado_civil`
--

INSERT INTO `tbl_general_estado_civil` (`cod_estado_civil`, `estado_civil`) VALUES
(1, 'CASADO(A)'),
(2, 'SOLTERO(A)'),
(3, 'UNION LIBRE'),
(4, 'PENDIENTE');

-- --------------------------------------------------------

--
-- Estructura de tabla para la tabla `tbl_general_etnias`
--

CREATE TABLE `tbl_general_etnias` (
  `cod_etnias` bigint(20) NOT NULL,
  `etnias` varchar(50) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

--
-- Volcado de datos para la tabla `tbl_general_etnias`
--

INSERT INTO `tbl_general_etnias` (`cod_etnias`, `etnias`) VALUES
(1, 'Lenca'),
(2, 'Tolupan'),
(3, 'Garifuna'),
(4, 'Chortis'),
(5, 'Pech'),
(6, 'Tawahkas'),
(7, 'Miskito'),
(8, 'No Aplica'),
(9, 'PENDIENTE');

-- --------------------------------------------------------

--
-- Estructura de tabla para la tabla `tbl_general_finca`
--

CREATE TABLE `tbl_general_finca` (
  `cod_finca` varchar(22) NOT NULL,
  `finca` varchar(50) NOT NULL,
  `latitud` double NOT NULL,
  `longitud` double NOT NULL,
  `cod_identidad` varchar(20) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- --------------------------------------------------------

--
-- Estructura de tabla para la tabla `tbl_general_genero`
--

CREATE TABLE `tbl_general_genero` (
  `cod_genero` bigint(20) NOT NULL,
  `genero` varchar(10) NOT NULL,
  `abreviatura` varchar(1) NOT NULL,
  `abreviatura2` varchar(1) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

--
-- Volcado de datos para la tabla `tbl_general_genero`
--

INSERT INTO `tbl_general_genero` (`cod_genero`, `genero`, `abreviatura`, `abreviatura2`) VALUES
(1, 'Hombre', 'h', 'm'),
(2, 'Mujer', 'm', 'f');

-- --------------------------------------------------------

--
-- Estructura de tabla para la tabla `tbl_general_h_actividad_pro`
--

CREATE TABLE `tbl_general_h_actividad_pro` (
  `cod_h_actividad` bigint(20) NOT NULL,
  `cod_actividad_pro` bigint(20) NOT NULL,
  `cod_identidad` varchar(20) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- --------------------------------------------------------

--
-- Estructura de tabla para la tabla `tbl_general_meses`
--

CREATE TABLE `tbl_general_meses` (
  `cod_mes` int(2) UNSIGNED ZEROFILL NOT NULL,
  `mes` varchar(255) DEFAULT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

--
-- Volcado de datos para la tabla `tbl_general_meses`
--

INSERT INTO `tbl_general_meses` (`cod_mes`, `mes`) VALUES
(01, 'ENERO'),
(02, 'FEBRERO'),
(03, 'MARZO'),
(04, 'ABRIL'),
(05, 'MAYO'),
(06, 'JUNIO'),
(07, 'JULIO'),
(08, 'AGOSTO'),
(09, 'SEPTIEMBRE'),
(10, 'OBTUBRE'),
(11, 'NOVIEMBRE'),
(12, 'DICIEMBRE');

-- --------------------------------------------------------

--
-- Estructura de tabla para la tabla `tbl_general_municipio`
--

CREATE TABLE `tbl_general_municipio` (
  `cod_municipio` bigint(11) NOT NULL,
  `cod_depart` bigint(11) NOT NULL,
  `num_municipio_depart` int(2) NOT NULL,
  `municipio` varchar(45) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

--
-- Volcado de datos para la tabla `tbl_general_municipio`
--

INSERT INTO `tbl_general_municipio` (`cod_municipio`, `cod_depart`, `num_municipio_depart`, `municipio`) VALUES
(1, 1, 1, 'La Ceiba'),
(2, 1, 1, 'El Porvenir'),
(3, 1, 1, 'Esparta'),
(4, 1, 1, 'Jutiapa'),
(5, 1, 1, 'La Masica'),
(6, 1, 1, 'San Francisco'),
(7, 1, 1, 'Tela'),
(8, 1, 1, 'Arizona'),
(9, 2, 2, 'Trujillo'),
(10, 2, 2, 'Balfate'),
(11, 2, 2, 'Iriona'),
(12, 2, 2, 'Limon'),
(13, 2, 2, 'Saba'),
(14, 2, 2, 'Santa Fe'),
(15, 2, 2, 'Santa Rosa de Aguan'),
(16, 2, 2, 'Sonaguera'),
(17, 2, 2, 'Tocoa'),
(18, 2, 2, 'Bonito Oriental'),
(19, 3, 3, 'Comayagua'),
(20, 3, 3, 'Ajuterique'),
(21, 3, 3, 'El Rosario'),
(22, 3, 3, 'Esquías'),
(23, 3, 3, 'Humuya'),
(24, 3, 3, 'La Libertad'),
(25, 3, 3, 'Lamani'),
(26, 3, 3, 'La Trinidad'),
(27, 3, 3, 'Lejamani'),
(28, 3, 3, 'Meambar'),
(29, 3, 3, 'Minas de Oro'),
(30, 3, 3, 'Ojos de Agua'),
(31, 3, 3, 'San Jeronimo'),
(32, 3, 3, 'San Jose de Comayagua'),
(33, 3, 3, 'San Jose del Potrero'),
(34, 3, 3, 'San Luis'),
(35, 3, 3, 'San Sebastian'),
(36, 3, 3, 'Siguatepeque'),
(37, 3, 3, 'Villa de San Antonio'),
(38, 3, 3, 'Las Lajas'),
(39, 3, 3, 'Taulabe'),
(40, 4, 4, 'Santa Rosa de Copan'),
(41, 4, 4, 'Cabañas'),
(42, 4, 4, 'Concepcion'),
(43, 4, 4, 'Copan Ruinas'),
(44, 4, 4, 'Corquin'),
(45, 4, 4, 'Cucuyagua'),
(46, 4, 4, 'Dolores'),
(47, 4, 4, 'Dulce Nombre'),
(48, 4, 4, 'El Paraiso'),
(49, 4, 4, 'Florida'),
(50, 4, 4, 'La Jigua'),
(51, 4, 4, 'La Union'),
(52, 4, 4, 'Nueva Arcadia'),
(53, 4, 4, 'San Agustin'),
(54, 4, 4, 'San Antonio'),
(55, 4, 4, 'San Jerónimo'),
(56, 4, 4, 'San Jose'),
(57, 4, 4, 'San Juan de Opoa'),
(58, 4, 4, 'San Nicolas'),
(59, 4, 4, 'San Pedro de Copan'),
(60, 4, 4, 'Santa Rita'),
(61, 4, 4, 'Trinidad de Copan'),
(62, 4, 4, 'Veracruz'),
(63, 5, 5, 'San Pedro Sula'),
(64, 5, 5, 'Choloma'),
(65, 5, 5, 'Omoa'),
(66, 5, 5, 'Pimienta'),
(67, 5, 5, 'Potrerillos'),
(68, 5, 5, 'Puerto Cortes'),
(69, 5, 5, 'San Antonio de Cortes'),
(70, 5, 5, 'San Francisco de Yojoa'),
(71, 5, 5, 'San Manuel'),
(72, 5, 5, 'Santa Cruz de Yojoa'),
(73, 5, 5, 'Villanueva'),
(74, 5, 5, 'La Lima'),
(75, 6, 6, 'Choluteca'),
(76, 6, 6, 'Apacilagua'),
(77, 6, 6, 'Concepcion de Maria'),
(78, 6, 6, 'Duyure'),
(79, 6, 6, 'El Corpus'),
(80, 6, 6, 'El Triunfo'),
(81, 6, 6, 'Marcovia'),
(82, 6, 6, 'Morolica'),
(83, 6, 6, 'Namasigue'),
(84, 6, 6, 'Orocuina'),
(85, 6, 6, 'Pespire'),
(86, 6, 6, 'San Antonio de Flores'),
(87, 6, 6, 'San Isidro'),
(88, 6, 6, 'San José'),
(89, 6, 6, 'San Marcos de Colon'),
(90, 6, 6, 'Santa Ana de Yusguare'),
(91, 7, 7, 'Yuscaran'),
(92, 7, 7, 'Alauca'),
(93, 7, 7, 'Danlí'),
(94, 7, 7, 'El Paraiso'),
(95, 7, 7, 'Guinope'),
(96, 7, 7, 'Jacaleapa'),
(97, 7, 7, 'Liure'),
(98, 7, 7, 'Moroceli'),
(99, 7, 7, 'Oropoli'),
(100, 7, 7, 'Potrerillos'),
(101, 7, 7, 'San Antonio de Flores'),
(102, 7, 7, 'San Lucas'),
(103, 7, 7, 'San Matias'),
(104, 7, 7, 'Soledad'),
(105, 7, 7, 'Teupasenti'),
(106, 7, 7, 'Texiguat'),
(107, 7, 7, 'Vado Ancho'),
(108, 7, 7, 'Yauyupe'),
(109, 7, 7, 'Trojes'),
(110, 8, 8, 'Distrito Central'),
(111, 8, 8, 'Alubaren'),
(112, 8, 8, 'Cedros'),
(113, 8, 8, 'Curaren'),
(114, 8, 8, 'El Porvenir'),
(115, 8, 8, 'Guaimaca'),
(116, 8, 8, 'La Libertad'),
(117, 8, 8, 'La Venta'),
(118, 8, 8, 'Lepaterique'),
(119, 8, 8, 'Maraita'),
(120, 8, 8, 'Marale'),
(121, 8, 8, 'Nueva Armenia'),
(122, 8, 8, 'Ojojona'),
(123, 8, 8, 'Orica'),
(124, 8, 8, 'Reitoca'),
(125, 8, 8, 'Sabanagrande'),
(126, 8, 8, 'San Antonio de Oriente'),
(127, 8, 8, 'San Buenaventura'),
(128, 8, 8, 'San Ignacio'),
(129, 8, 8, 'San Juan de Flores'),
(130, 8, 8, 'San Miguelito'),
(131, 8, 8, 'Santa Ana'),
(132, 8, 8, 'Santa Lucia'),
(133, 8, 8, 'Talanga'),
(134, 8, 8, 'Tatumbla'),
(135, 8, 8, 'Valle de Angeles'),
(136, 8, 8, 'Villa de San Francisco'),
(137, 8, 8, 'Vallecillo'),
(138, 9, 9, 'Puerto Lempira'),
(139, 9, 9, 'Brus Laguna'),
(140, 9, 9, 'Ahuas'),
(141, 9, 9, 'Juan Francisco Bulnes'),
(142, 9, 9, 'Villeda Morales'),
(143, 9, 9, 'Wampusirpi'),
(144, 10, 10, 'La Esperanza'),
(145, 10, 10, 'Camasca'),
(146, 10, 10, 'Colomoncagua'),
(147, 10, 10, 'Concepcion'),
(148, 10, 10, 'Dolores'),
(149, 10, 10, 'Intibuca'),
(150, 10, 10, 'Jesus de Otoro'),
(151, 10, 10, 'Magdalena'),
(152, 10, 10, 'Masaguara'),
(153, 10, 10, 'San Antonio'),
(154, 10, 10, 'San Isidro'),
(155, 10, 10, 'San Juan'),
(156, 10, 10, 'San Marcos de La Sierra'),
(157, 10, 10, 'San Miguelito'),
(158, 10, 10, 'Santa Lucía'),
(159, 10, 10, 'Yamaranguila'),
(160, 10, 10, 'San Francisco de Opalaca'),
(161, 11, 11, 'Roatan'),
(162, 11, 11, 'Guanaja'),
(163, 11, 11, 'Jose Santos Guardiola'),
(164, 11, 11, 'Utila'),
(165, 12, 12, 'La Paz'),
(166, 12, 12, 'Aguanqueterique'),
(167, 12, 12, 'Cabañas'),
(168, 12, 12, 'Cane'),
(169, 12, 12, 'Chinacla'),
(170, 12, 12, 'Guajiquiro'),
(171, 12, 12, 'Lauterique'),
(172, 12, 12, 'Marcala'),
(173, 12, 12, 'Mercedes de Oriente'),
(174, 12, 12, 'Opatoro'),
(175, 12, 12, 'San Antonio del Norte'),
(176, 12, 12, 'San Jose'),
(177, 12, 12, 'San Juan'),
(178, 12, 12, 'San Pedro de Tutule'),
(179, 12, 12, 'Santa Ana'),
(180, 12, 12, 'Santa Elena'),
(181, 12, 12, 'Santa Maria'),
(182, 12, 12, 'Santiago de Puringla'),
(183, 12, 12, 'Yarula'),
(184, 13, 13, 'Gracias'),
(185, 13, 13, 'Belen'),
(186, 13, 13, 'Candelaria'),
(187, 13, 13, 'Cololaca'),
(188, 13, 13, 'Erandique'),
(189, 13, 13, 'Gualcince'),
(190, 13, 13, 'Guarita'),
(191, 13, 13, 'La Campa'),
(192, 13, 13, 'La Iguala'),
(193, 13, 13, 'Las Flores'),
(194, 13, 13, 'La Unión'),
(195, 13, 13, 'La Virtud'),
(196, 13, 13, 'Lepaera'),
(197, 13, 13, 'Mapulaca'),
(198, 13, 13, 'Piraera'),
(199, 13, 13, 'San Andres'),
(200, 13, 13, 'San Francisco'),
(201, 13, 13, 'San Juan Guarita'),
(202, 13, 13, 'San Manuel Colohete'),
(203, 13, 13, 'San Rafael'),
(204, 13, 13, 'San Sebastian'),
(205, 13, 13, 'Santa Cruz'),
(206, 13, 13, 'Talgua'),
(207, 13, 13, 'Tambla'),
(208, 13, 13, 'Tomala'),
(209, 13, 13, 'Valladolid'),
(210, 13, 13, 'Virginia'),
(211, 13, 13, 'San Marcos de Caiquin'),
(212, 14, 14, 'Ocotepeque'),
(213, 14, 14, 'Belen Gualcho'),
(214, 14, 14, 'Concepcion'),
(215, 14, 14, 'Dolores Merendon'),
(216, 14, 14, 'Fraternidad'),
(217, 14, 14, 'La Encarnación'),
(218, 14, 14, 'La Labor'),
(219, 14, 14, 'Lucerna'),
(220, 14, 14, 'Mercedes'),
(221, 14, 14, 'San Fernando'),
(222, 14, 14, 'San Francisco del Valle'),
(223, 14, 14, 'San Jorge'),
(224, 14, 14, 'San Marcos'),
(225, 14, 14, 'Santa Fe'),
(226, 14, 14, 'Sensenti'),
(227, 14, 14, 'Sinuapa'),
(228, 15, 15, 'Juticalpa'),
(229, 15, 15, 'Campamento'),
(230, 15, 15, 'Catacamas'),
(231, 15, 15, 'Concordia'),
(232, 15, 15, 'Dulce Nombre de Culmí'),
(233, 15, 15, 'El Rosario'),
(234, 15, 15, 'Esquipulas del Norte'),
(235, 15, 15, 'Gualaco'),
(236, 15, 15, 'Guarizama'),
(237, 15, 15, 'Guata'),
(238, 15, 15, 'Guayape'),
(239, 15, 15, 'Jano'),
(240, 15, 15, 'La Union'),
(241, 15, 15, 'Mangulile'),
(242, 15, 15, 'Manto'),
(243, 15, 15, 'Salama'),
(244, 15, 15, 'San Esteban'),
(245, 15, 15, 'San Francisco de Becerra'),
(246, 15, 15, 'San Francisco de La Paz'),
(247, 15, 15, 'Santa Maria del Real'),
(248, 15, 15, 'Silca'),
(249, 15, 15, 'Yocón'),
(250, 15, 15, 'Patuca'),
(251, 16, 16, 'Santa Barbara'),
(252, 16, 16, 'Arada'),
(253, 16, 16, 'Atima'),
(254, 16, 16, 'Azacualpa'),
(255, 16, 16, 'Ceguaca'),
(256, 16, 16, 'Concepcion del Norte'),
(257, 16, 16, 'Concepcion del Sur'),
(258, 16, 16, 'Chinda'),
(259, 16, 16, 'El Níspero'),
(260, 16, 16, 'Gualala'),
(261, 16, 16, 'Ilama'),
(262, 16, 16, 'Macuelizo'),
(263, 16, 16, 'Naranjito'),
(264, 16, 16, 'Nuevo Celilac'),
(265, 16, 16, 'Petoa'),
(266, 16, 16, 'Proteccion'),
(267, 16, 16, 'Quimistan'),
(268, 16, 16, 'San Francisco de Ojuera'),
(269, 16, 16, 'San Jose de Colinas'),
(270, 16, 16, 'San Luis'),
(271, 16, 16, 'San Marcos'),
(272, 16, 16, 'San Nicolas'),
(273, 16, 16, 'San Pedro Zacapa'),
(274, 16, 16, 'San Vicente Centenario'),
(275, 16, 16, 'Santa Rita'),
(276, 16, 16, 'Trinidad'),
(277, 17, 17, 'Las Vegas'),
(278, 17, 17, 'Nueva Frontera'),
(279, 17, 17, 'Nacaome'),
(280, 17, 17, 'Alianza'),
(281, 17, 17, 'Amapala'),
(282, 17, 17, 'Aramecina'),
(283, 17, 17, 'Caridad'),
(284, 17, 17, 'Goascoran'),
(285, 17, 17, 'Langue'),
(286, 17, 17, 'San Francisco de Coray'),
(287, 17, 17, 'San Lorenzo'),
(288, 18, 18, 'Yoro'),
(289, 18, 18, 'Arenal'),
(290, 18, 18, 'El Negrito'),
(291, 18, 18, 'El Progreso'),
(292, 18, 18, 'Jocon'),
(293, 18, 18, 'Morazan'),
(294, 18, 18, 'Olanchito'),
(295, 18, 18, 'Santa Rita'),
(296, 18, 18, 'Sulaco'),
(297, 18, 18, 'Victoria'),
(298, 18, 18, 'Yorito');

-- --------------------------------------------------------

--
-- Estructura de tabla para la tabla `tbl_general_pais`
--

CREATE TABLE `tbl_general_pais` (
  `cod_pais` bigint(20) NOT NULL,
  `pais` varchar(40) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

--
-- Volcado de datos para la tabla `tbl_general_pais`
--

INSERT INTO `tbl_general_pais` (`cod_pais`, `pais`) VALUES
(1, 'Australia'),
(2, 'Austria'),
(3, 'Azerbaiyán'),
(4, 'Anguilla'),
(5, 'Argentina'),
(6, 'Armenia'),
(7, 'Bielorrusia'),
(8, 'Belice'),
(9, 'Bélgica'),
(10, 'Bermudas'),
(11, 'Bulgaria'),
(12, 'Brasil'),
(13, 'Reino Unido'),
(14, 'Hungría'),
(15, 'Vietnam'),
(16, 'Haiti'),
(17, 'Guadalupe'),
(18, 'Alemania'),
(19, 'Países Bajos, Holanda'),
(20, 'Grecia'),
(21, 'Georgia'),
(22, 'Dinamarca'),
(23, 'Egipto'),
(24, 'Israel'),
(25, 'India'),
(26, 'Irán'),
(27, 'Irlanda'),
(28, 'España'),
(29, 'Italia'),
(30, 'Kazajstán'),
(31, 'Camerún'),
(32, 'Canadá'),
(33, 'Chipre'),
(34, 'Kirguistán'),
(35, 'China'),
(36, 'Costa Rica'),
(37, 'Kuwait'),
(38, 'Letonia'),
(39, 'Libia'),
(40, 'Lituania'),
(41, 'Luxemburgo'),
(42, 'México'),
(43, 'Moldavia'),
(44, 'Mónaco'),
(45, 'Nueva Zelanda'),
(46, 'Noruega'),
(47, 'Polonia'),
(48, 'Portugal'),
(49, 'Reunión'),
(50, 'Rusia'),
(51, 'El Salvador'),
(52, 'Eslovaquia'),
(53, 'Eslovenia'),
(54, 'Surinam'),
(55, 'Estados Unidos'),
(56, 'Tadjikistan'),
(57, 'Turkmenistan'),
(58, 'Islas Turcas y Caicos'),
(59, 'Turquía'),
(60, 'Uganda'),
(61, 'Uzbekistán'),
(62, 'Ucrania'),
(63, 'Finlandia'),
(64, 'Francia'),
(65, 'República Checa'),
(66, 'Suiza'),
(67, 'Suecia'),
(68, 'Estonia'),
(69, 'Corea del Sur'),
(70, 'Japón'),
(71, 'Croacia'),
(72, 'Rumanía'),
(73, 'Hong Kong'),
(74, 'Indonesia'),
(75, 'Jordania'),
(76, 'Malasia'),
(77, 'Singapur'),
(78, 'Taiwan'),
(79, 'Bosnia y Herzegovina'),
(80, 'Bahamas'),
(81, 'Chile'),
(82, 'Colombia'),
(83, 'Islandia'),
(84, 'Corea del Norte'),
(85, 'Macedonia'),
(86, 'Malta'),
(87, 'Pakistán'),
(88, 'Papúa-Nueva Guinea'),
(89, 'Perú'),
(90, 'Filipinas'),
(91, 'Arabia Saudita'),
(92, 'Tailandia'),
(93, 'Emiratos árabes Unidos'),
(94, 'Groenlandia'),
(95, 'Venezuela'),
(96, 'Zimbabwe'),
(97, 'Kenia'),
(98, 'Algeria'),
(99, 'Líbano'),
(100, 'Botsuana'),
(101, 'Tanzania'),
(102, 'Namibia'),
(103, 'Ecuador'),
(104, 'Marruecos'),
(105, 'Ghana'),
(106, 'Siria'),
(107, 'Nepal'),
(108, 'Mauritania'),
(109, 'Seychelles'),
(110, 'Paraguay'),
(111, 'Uruguay'),
(112, 'Congo (Brazzaville)'),
(113, 'Cuba'),
(114, 'Albania'),
(115, 'Nigeria'),
(116, 'Zambia'),
(117, 'Mozambique'),
(119, 'Angola'),
(120, 'Sri Lanka'),
(121, 'Etiopía'),
(122, 'Túnez'),
(123, 'Bolivia'),
(124, 'Panamá'),
(125, 'Malawi'),
(126, 'Liechtenstein'),
(127, 'Bahrein'),
(128, 'Barbados'),
(130, 'Chad'),
(131, 'Man, Isla de'),
(132, 'Jamaica'),
(133, 'Malí'),
(134, 'Madagascar'),
(135, 'Senegal'),
(136, 'Togo'),
(137, 'Honduras'),
(138, 'República Dominicana'),
(139, 'Mongolia'),
(140, 'Irak'),
(141, 'Sudáfrica'),
(142, 'Aruba'),
(143, 'Gibraltar'),
(144, 'Afganistán'),
(145, 'Andorra'),
(147, 'Antigua y Barbuda'),
(149, 'Bangladesh'),
(151, 'Benín'),
(152, 'Bután'),
(154, 'Islas Virgenes Británicas'),
(155, 'Brunéi'),
(156, 'Burkina Faso'),
(157, 'Burundi'),
(158, 'Camboya'),
(159, 'Cabo Verde'),
(164, 'Comores'),
(165, 'Congo (Kinshasa)'),
(166, 'Cook, Islas'),
(168, 'Costa de Marfil'),
(169, 'Djibouti, Yibuti'),
(171, 'Timor Oriental'),
(172, 'Guinea Ecuatorial'),
(173, 'Eritrea'),
(175, 'Feroe, Islas'),
(176, 'Fiyi'),
(178, 'Polinesia Francesa'),
(180, 'Gabón'),
(181, 'Gambia'),
(184, 'Granada'),
(185, 'Guatemala'),
(186, 'Guernsey'),
(187, 'Guinea'),
(188, 'Guinea-Bissau'),
(189, 'Guyana'),
(193, 'Jersey'),
(195, 'Kiribati'),
(196, 'Laos'),
(197, 'Lesotho'),
(198, 'Liberia'),
(200, 'Maldivas'),
(201, 'Martinica'),
(202, 'Mauricio'),
(205, 'Myanmar'),
(206, 'Nauru'),
(207, 'Antillas Holandesas'),
(208, 'Nueva Caledonia'),
(209, 'Nicaragua'),
(210, 'Níger'),
(212, 'Norfolk Island'),
(213, 'Omán'),
(215, 'Isla Pitcairn'),
(216, 'Qatar'),
(217, 'Ruanda'),
(218, 'Santa Elena'),
(219, 'San Cristobal y Nevis'),
(220, 'Santa Lucía'),
(221, 'San Pedro y Miquelón'),
(222, 'San Vincente y Granadinas'),
(223, 'Samoa'),
(224, 'San Marino'),
(225, 'San Tomé y Príncipe'),
(226, 'Serbia y Montenegro'),
(227, 'Sierra Leona'),
(228, 'Islas Salomón'),
(229, 'Somalia'),
(232, 'Sudán'),
(234, 'Swazilandia'),
(235, 'Tokelau'),
(236, 'Tonga'),
(237, 'Trinidad y Tobago'),
(239, 'Tuvalu'),
(240, 'Vanuatu'),
(241, 'Wallis y Futuna'),
(242, 'Sáhara Occidental'),
(243, 'Yemen'),
(246, 'Puerto Rico');

-- --------------------------------------------------------

--
-- Estructura de tabla para la tabla `tbl_general_productor`
--

CREATE TABLE `tbl_general_productor` (
  `cod_identidad` varchar(20) NOT NULL,
  `clave` varchar(15) DEFAULT NULL,
  `nombre` varchar(45) NOT NULL,
  `cod_genero` bigint(1) NOT NULL,
  `celular` varchar(9) DEFAULT NULL,
  `nacimiento` date DEFAULT NULL,
  `cod_pais` bigint(20) NOT NULL,
  `cod_municipio` bigint(20) NOT NULL,
  `cod_agencia` bigint(20) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- --------------------------------------------------------

--
-- Estructura de tabla para la tabla `tbl_general_puesto`
--

CREATE TABLE `tbl_general_puesto` (
  `cod_puesto` bigint(11) NOT NULL,
  `puesto` varchar(45) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

--
-- Volcado de datos para la tabla `tbl_general_puesto`
--

INSERT INTO `tbl_general_puesto` (`cod_puesto`, `puesto`) VALUES
(1, 'TECNICO');

-- --------------------------------------------------------

--
-- Estructura de tabla para la tabla `tbl_general_regional`
--

CREATE TABLE `tbl_general_regional` (
  `cod_regional` bigint(20) NOT NULL,
  `regional` varchar(45) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

--
-- Volcado de datos para la tabla `tbl_general_regional`
--

INSERT INTO `tbl_general_regional` (`cod_regional`, `regional`) VALUES
(1, 'Regional Santa Barbara'),
(2, 'Regional Copan'),
(3, 'Regional Cortes - Yoro'),
(4, 'Regional El Paraiso'),
(5, 'Regional Comayagua'),
(6, 'Regional Olancho'),
(7, 'Regional Centro Sur'),
(8, 'PENDIENTE');

-- --------------------------------------------------------

--
-- Estructura de tabla para la tabla `tbl_general_tecnico`
--

CREATE TABLE `tbl_general_tecnico` (
  `cod_tecnico` bigint(11) NOT NULL,
  `cod_puesto` bigint(20) NOT NULL,
  `nombre` varchar(45) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

--
-- Volcado de datos para la tabla `tbl_general_tecnico`
--

INSERT INTO `tbl_general_tecnico` (`cod_tecnico`, `cod_puesto`, `nombre`) VALUES
(1, 1, 'ALEX ARNALDO REYES TREJO'),
(2, 1, 'ALFONSO HERIBERTO MERLO'),
(3, 1, 'ANGEL CLEMENTE ENAMORADO MEJIA'),
(4, 1, 'ARNOLD LEMUS AGUILAR'),
(5, 1, 'ATILIA ELENA LANDAVERDE'),
(6, 1, 'AXEL LENIN BUESO PERDOMO'),
(7, 1, 'BLAS ENRIQUE HERRERA PAGUADA'),
(8, 1, 'BORIS FERNANDO BUEZO JUAREZ'),
(9, 1, 'CARLOS ARMANDO PASCUA FERNANDEZ'),
(10, 1, 'CARLOS HUMBERTO RIVERA'),
(11, 1, 'CARLOS MAGDIEL ARRIAGA LOPEZ'),
(12, 1, 'CARMEN NOEL PAZ PEREZ'),
(13, 1, 'CELSO NAPOLEON ALVARADO BAUTISTA'),
(14, 1, 'CESAR EMILIO BUEZO BUEZO'),
(15, 1, 'CESAR NOE CANO CHAVER'),
(16, 1, 'CLAUDIA LIZZETH MOLINA'),
(17, 1, 'CRISTIAN YIZARD LIZARDO CHAVEZ'),
(18, 1, 'DANILO RIVERA'),
(19, 1, 'DAVID ANTONIO DIAZ PORTILLO'),
(20, 1, 'DAVID ORLANDO RAMOS AGUILAR'),
(21, 1, 'DENIS ENCARNACION SALINAS MORAZAN'),
(22, 1, 'DEYLIN TEODULO MARTINEZ OLIVA'),
(23, 1, 'EBIS ESAU MEDINA'),
(24, 1, 'EDUIN ORLAN VELASQUEZ HERNANDEZ'),
(25, 1, 'EDWIN ESPINOZA'),
(26, 1, 'EDWIN GEOVANNY VENTURA LARA'),
(27, 1, 'EDWIN ROLANDO BAUTISTA DEL CID'),
(28, 1, 'ELDYN ROEL PAZ'),
(29, 1, 'ELIAS ROBERTO VELASQUEZ ORTEGA'),
(30, 1, 'ELIEZER RIVERA VILLANUEVA'),
(31, 1, 'ELLAN ALFREDO MONCADA CADENAS'),
(32, 1, 'ELVIN ANTONIO HERNANDEZ'),
(33, 1, 'ERICK ORLANDO GONZALEZ'),
(34, 1, 'ESMELIN SABILLON RODRIGUEZ'),
(35, 1, 'EUGENIO PAZ ZALDIVAR'),
(36, 1, 'EXOR FREDESVINDO HERNANDEZ'),
(37, 1, 'FAUSTO ROBERTO PADILLA RIVAS'),
(38, 1, 'FAVIO EDGARDO TERCERO ESPINOZA'),
(39, 1, 'FRANK JOSEPH HERNANDEZ RAMOS'),
(40, 1, 'FRANKLIN MAYORGA DEL CID'),
(41, 1, 'FRANKLIN VIRGILIO DIAZ REYES'),
(42, 1, 'FREDY ARTURO AGUIRIANO MARTINEZ'),
(43, 1, 'GARDEL JARED VASQUEZ NICOLAS'),
(44, 1, 'GERSON OSMARO CONTRERAS BAIDE'),
(45, 1, 'GLENDA SELENE SANTOS CARBAJAL'),
(46, 1, 'GREVIL DARIO HERNANDEZ TERUEL'),
(47, 1, 'GUILLERMO ANTONIO TERCERO ESPINOZA'),
(48, 1, 'HECTOR TROCHEZ TREJO'),
(49, 1, 'HECTOR VALLEJO'),
(50, 1, 'HENRY ADALBERTO LOPEZ CHINCHILLA'),
(51, 1, 'HENRY ROBERTO RODRIGUEZ RODRIGUEZ'),
(52, 1, 'HERMES REYES INESTROZA'),
(53, 1, 'IVIS MANUEL RODRIGUEZ BARAHONA'),
(54, 1, 'JAVIER FRANCISCO ARDON RODRIGUEZ'),
(55, 1, 'JESER NOE DE JESUS MEJIA'),
(56, 1, 'JESUS EDMUNDO REYES LARA'),
(57, 1, 'JESUS MARIANO NOLASCO ARGUETA'),
(58, 1, 'JOHNNY ALFREDO CASTILLO MEJIA'),
(59, 1, 'JORGE ARQUIMIDES ZALDIVAR BOBADILLA'),
(60, 1, 'JORGE LUIS HERNANDEZ MATUTE'),
(61, 1, 'JORGE LUIS OYUELA OLIVERA'),
(62, 1, 'JOSE ABEL HERNANDEZ ALEMAN'),
(63, 1, 'JOSE ADAN OYUELA MORALES'),
(64, 1, 'JOSE ARNALDO GIRON BENITEZ'),
(65, 1, 'JOSE LUIS MUNOZ RODRIGUEZ'),
(66, 1, 'JOSE MANUEL JUAREZ GONZALEZ'),
(67, 1, 'JOSE MERCEDES HERNANDEZ VASQUEZ'),
(68, 1, 'JOSE SERGIO AGUILAR'),
(69, 1, 'JOSE ARNOLD PINEDA'),
(70, 1, 'JUAN GABRIEL LOZANO MATA'),
(71, 1, 'JUAN HUMBERTO SEVILLA RODRIGUEZ'),
(72, 1, 'JUAN LUIS HERNANDEZ MENCIA'),
(73, 1, 'JUAN MANUEL RODRIGUEZ ESCOTO'),
(74, 1, 'JUAN MIGUEL BENITEZ MENDOZA'),
(75, 1, 'JUAN RAMON ROMERO ROMERO'),
(76, 1, 'JULIO CESAR CACERES ZUNIGA'),
(77, 1, 'JULIO CESAR SALGADO AGUILUZ'),
(78, 1, 'KARLA MARIA CALIDONIO'),
(79, 1, 'KEILA DINORA MATUTE MATUTE'),
(80, 1, 'KELVIN MEJIA'),
(81, 1, 'LUIS ANTONIO REDONDO'),
(82, 1, 'LUIS ARTURO GARCIA ZAVALA'),
(83, 1, 'LUIS CARLOS NAVARRO'),
(84, 1, 'LUISA ONDINA GRIJALVA CHIRINOS'),
(85, 1, 'MARCIO ROLANDO BAUTISTA PORTILLO'),
(86, 1, 'MARCO TULIO CARRILLO PEREZ'),
(87, 1, 'MARIO RODOLFO ALCANTARA'),
(88, 1, 'MARLON DANERY SEVILLA ALONZO'),
(89, 1, 'MARLON JEOVANY GOMEZ IZAGUIRRE'),
(90, 1, 'NELSON FABRICIO DONAIRE ZUNIGA'),
(91, 1, 'NELSON RENE TERCERO VALLEJO'),
(92, 1, 'NEPTALY MONTOYA'),
(93, 1, 'NOLVIA GABRIELA JIMENEZ NEHRING'),
(94, 1, 'ODIR BOANERGES ROJAS SALINAS'),
(95, 1, 'OLBAN ANTONIO LANZA RAMOS'),
(96, 1, 'OLBIN DANILO GUARDADO VASQUEZ'),
(97, 1, 'OLBIN ORLANDO CASTELLANOS MIRANDA'),
(98, 1, 'ORLIN ALVARADO'),
(99, 1, 'OSCAR  RENE BONILLA MATUTE'),
(100, 1, 'OSMAR MATUTE'),
(101, 1, 'RAFAEL VELASQUEZ'),
(102, 1, 'RAINEL OBED CASTELLANOS BARRIENTOS'),
(103, 1, 'RENAN MUNGUIA'),
(104, 1, 'RICARDO ALONSO MACHADO'),
(105, 1, 'RICARDO ALONSO VELASQUEZ PADILLA'),
(106, 1, 'RICARDO ANTONIO MONTOYA TOSTA'),
(107, 1, 'ROBERTO CARLOS ORDONEZ MEJIA'),
(108, 1, 'ROGER WILMAN CABALLERO  SAGASTUME'),
(109, 1, 'ROMAN MATAMOROS'),
(110, 1, 'RUDHIS DONAY MORAN GONZALEZ'),
(111, 1, 'SANTOS OMAR GAMEZ GAMEZ'),
(112, 1, 'SANTOS ORACIO PINEDA'),
(113, 1, 'SELVIN SADI MARQUEZ EUCEDA'),
(114, 1, 'SHEILA FRANSELIA VELASQUEZ'),
(115, 1, 'SONIA ISAMAR BUEZO'),
(116, 1, 'WALTHER ADAN MONCADA HERNANDEZ'),
(117, 1, 'WILLIAM DIOMED  PADILLA SORTO'),
(118, 1, 'WILLIAM WALTER ALVARADO RODRIGUEZ'),
(119, 1, 'WILLIANS ARMANDO GOMEZ GOMEZ'),
(120, 1, 'WILMAN OMAR PORTILLO JUSTINIANO'),
(121, 1, 'WILSON DANILO DOMINGUEZ'),
(122, 1, 'WUALTER ORLANDO FUNEZ ALONZO'),
(123, 1, 'YOANY FUENTES PERAZA'),
(124, 1, 'YONI   GERARDO SANCHEZ EUCEDA'),
(125, 1, 'YONI ARIEL ALBERTO ROMERO'),
(126, 1, 'ZUHERIA AZULAY ZUNIGA ZUNIGA'),
(127, 1, 'HRNS GERSON LOPEZ'),
(128, 1, 'HRNS MIRTALA GUERRA'),
(129, 1, 'HRNS PREVIN VALDIVIESO'),
(130, 1, 'HRNS NOLVIA MURCIA'),
(131, 1, 'HRNS JUAN SALGUERO'),
(132, 1, 'HRNS MARVIN PINTO'),
(133, 1, 'EDGARDO VIDAL FIGUEROA SANDOVAL'),
(134, 1, 'CLAUDIO ADONIS HERNANDEZ LINARES'),
(135, 1, 'HRNS KARINA ORELLANA'),
(136, 1, 'HRNS BELKIS VICENTE'),
(137, 1, 'HRNS SANTOS FLORES'),
(138, 1, 'HRNS MARCO PEREZ'),
(139, 1, 'HRNS ALEX HERNANDEZ'),
(140, 1, 'NORA MICHELL GUERRERO RAMOS'),
(141, 1, 'DARWIN JAVIER VASQUEZ'),
(142, 1, 'JOSE ALEXIS HERNANDEZ MENCIA'),
(143, 1, 'JORGE LUIS SANTOS ACEITUNO'),
(144, 1, 'ALEJANDRO DAVID PAZ SABILLON'),
(145, 1, 'HRNS CLAUDIA DIAZ'),
(146, 1, 'HRNS MERLIN PEÑA'),
(147, 1, 'HRNS DIMAS GUEVARA'),
(148, 1, 'HRNS DORA VILLEDA'),
(149, 1, 'Pendiente');

-- --------------------------------------------------------

--
-- Estructura de tabla para la tabla `tbl_h_respuestas`
--

CREATE TABLE `tbl_h_respuestas` (
  `cod_h_respuesta` bigint(20) NOT NULL,
  `cod_respuesta` bigint(20) NOT NULL,
  `cod_finca` varchar(22) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- --------------------------------------------------------

--
-- Estructura de tabla para la tabla `tbl_lideres_ficha`
--

CREATE TABLE `tbl_lideres_ficha` (
  `cod_ficha` bigint(20) NOT NULL,
  `cod_tecnico` bigint(20) NOT NULL,
  `cod_grupo` bigint(20) NOT NULL,
  `cod_problema` bigint(20) NOT NULL,
  `cod_identidad` varchar(20) NOT NULL,
  `cod_pro_beneficia` bigint(20) NOT NULL,
  `n_coasosicados` int(5) NOT NULL,
  `fecha_visita` date NOT NULL,
  `fecha_registro` date NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- --------------------------------------------------------

--
-- Estructura de tabla para la tabla `tbl_lider_coasociados`
--

CREATE TABLE `tbl_lider_coasociados` (
  `cod_coasociado` bigint(20) NOT NULL,
  `nombre` varchar(20) NOT NULL,
  `coa_identidad` varchar(20) NOT NULL,
  `cod_genero` bigint(20) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- --------------------------------------------------------

--
-- Estructura de tabla para la tabla `tbl_lider_fincas`
--

CREATE TABLE `tbl_lider_fincas` (
  `cod_finca` varchar(20) NOT NULL,
  `ubicacion` varchar(20) NOT NULL,
  `latitud` double NOT NULL,
  `longitud` double NOT NULL,
  `cod_identidad` varchar(20) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- --------------------------------------------------------

--
-- Estructura de tabla para la tabla `tbl_lider_grupo`
--

CREATE TABLE `tbl_lider_grupo` (
  `cod_grupo` bigint(20) NOT NULL,
  `grupo` varchar(50) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

--
-- Volcado de datos para la tabla `tbl_lider_grupo`
--

INSERT INTO `tbl_lider_grupo` (`cod_grupo`, `grupo`) VALUES
(1, 'Caficultura Sostenible'),
(2, 'Gerencia de Negocios y Empresas Agrocafetaleras'),
(3, 'ECA LOCAL');

-- --------------------------------------------------------

--
-- Estructura de tabla para la tabla `tbl_lider_grupo_comunal`
--

CREATE TABLE `tbl_lider_grupo_comunal` (
  `cod_comunal` bigint(20) NOT NULL,
  `comunal` varchar(30) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

--
-- Volcado de datos para la tabla `tbl_lider_grupo_comunal`
--

INSERT INTO `tbl_lider_grupo_comunal` (`cod_comunal`, `comunal`) VALUES
(1, 'Cooperativa Cafetalera'),
(2, 'Patronato'),
(3, 'Otra'),
(4, 'Ninguna');

-- --------------------------------------------------------

--
-- Estructura de tabla para la tabla `tbl_lider_h_coasociados`
--

CREATE TABLE `tbl_lider_h_coasociados` (
  `cod_h_coasociado` bigint(20) NOT NULL,
  `cod_identidad` varchar(20) NOT NULL,
  `cod_coasociado` bigint(20) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- --------------------------------------------------------

--
-- Estructura de tabla para la tabla `tbl_lider_h_comunal`
--

CREATE TABLE `tbl_lider_h_comunal` (
  `cod_h_comunal` bigint(20) NOT NULL,
  `cod_ficha` bigint(20) NOT NULL,
  `cod_comunal` bigint(20) NOT NULL,
  `especificacion` varchar(30) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- --------------------------------------------------------

--
-- Estructura de tabla para la tabla `tbl_lider_parcela`
--

CREATE TABLE `tbl_lider_parcela` (
  `cod_parcela` bigint(20) NOT NULL,
  `cod_finca` varchar(20) NOT NULL,
  `area_total` varchar(15) NOT NULL,
  `area_produccion` varchar(25) NOT NULL,
  `cod_variedad` bigint(20) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- --------------------------------------------------------

--
-- Estructura de tabla para la tabla `tbl_lider_problema`
--

CREATE TABLE `tbl_lider_problema` (
  `cod_problema` bigint(20) NOT NULL,
  `problema` varchar(40) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

--
-- Volcado de datos para la tabla `tbl_lider_problema`
--

INSERT INTO `tbl_lider_problema` (`cod_problema`, `problema`) VALUES
(1, 'Acceso al credito'),
(2, 'Falta de asistencia Tecnica'),
(3, 'Falta de apoyo a la comercializacion');

-- --------------------------------------------------------

--
-- Estructura de tabla para la tabla `tbl_lider_productor`
--

CREATE TABLE `tbl_lider_productor` (
  `cod_identidad` varchar(20) NOT NULL,
  `nombre` varchar(45) NOT NULL,
  `clave` varchar(15) DEFAULT NULL,
  `cod_genero` bigint(1) NOT NULL,
  `celular` varchar(9) DEFAULT NULL,
  `nacimiento` int(4) DEFAULT NULL,
  `cod_pais` bigint(20) NOT NULL,
  `cod_municipio` bigint(20) NOT NULL,
  `cod_agencia` bigint(20) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- --------------------------------------------------------

--
-- Estructura de tabla para la tabla `tbl_vulnerabilidades_ficha`
--

CREATE TABLE `tbl_vulnerabilidades_ficha` (
  `cod_vulnerabilidad` bigint(20) NOT NULL,
  `cod_identidad` varchar(20) NOT NULL,
  `cod_municipio` bigint(20) NOT NULL,
  `pendiente` decimal(10,2) DEFAULT NULL,
  `area_total_finca` decimal(10,2) NOT NULL,
  `area_total_cafe` decimal(10,2) NOT NULL,
  `p_promedio` decimal(11,2) NOT NULL,
  `edad_cafetal` int(11) NOT NULL,
  `cod_finca` varchar(22) NOT NULL,
  `cod_tecnico` bigint(11) NOT NULL,
  `num_meses_seco` int(3) DEFAULT NULL,
  `fecha_visita` date NOT NULL,
  `sitio` varchar(60) NOT NULL,
  `observacion` varchar(255) DEFAULT NULL,
  `fecha_i` date NOT NULL,
  `fecha_sistema` date NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- --------------------------------------------------------

--
-- Estructura de tabla para la tabla `tbl_vulnerabilidad_desicion`
--

CREATE TABLE `tbl_vulnerabilidad_desicion` (
  `cod_desicion` bigint(20) NOT NULL,
  `desisicon` varchar(255) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

--
-- Volcado de datos para la tabla `tbl_vulnerabilidad_desicion`
--

INSERT INTO `tbl_vulnerabilidad_desicion` (`cod_desicion`, `desisicon`) VALUES
(1, 'SI'),
(2, 'NO'),
(3, 'QUIZAS');

-- --------------------------------------------------------

--
-- Estructura de tabla para la tabla `tbl_vulnerabilidad_h_variedad`
--

CREATE TABLE `tbl_vulnerabilidad_h_variedad` (
  `cod_h_variedad` bigint(20) NOT NULL,
  `cod_variedad` bigint(20) NOT NULL,
  `cod_vulnerabilidad` bigint(20) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- --------------------------------------------------------

--
-- Estructura de tabla para la tabla `tbl_vulnerabilidad_pregunta`
--

CREATE TABLE `tbl_vulnerabilidad_pregunta` (
  `cod_pregunta` bigint(20) NOT NULL,
  `pregunta` varchar(200) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

--
-- Volcado de datos para la tabla `tbl_vulnerabilidad_pregunta`
--

INSERT INTO `tbl_vulnerabilidad_pregunta` (`cod_pregunta`, `pregunta`) VALUES
(1, '¿Han habido cambios en la temperatura en los últimos 10 años?'),
(2, ' ¿ En los últimos años las lluvias han sido irregulares?'),
(3, '¿ Hay un aumento de lluvia con inundaciones y derrumbes?'),
(4, ' ¿Hay riesgo de huracanes y tormentas tropicales?'),
(5, ' ¿Han habido sequías en los últimos años. Ha habido disminución en la cantidad de agua disponible para la finca?'),
(6, ' ¿Hay vientos fuertes y/o incrementos de estos en los últimos años?'),
(7, '¿La mayoría de los suelos en los cafetales y otros usos de la tierra en la finca presentan señales de erosión?'),
(8, '¿La fertilidad de los suelos viene bajando?'),
(9, '¿Faltan prácticas de conservación de suelo en la mayoría del área?'),
(10, ' ¿En los suelos de los cafetales (entre filas de plantas) está ausente cobertura de hierbas y hojarascas?'),
(11, '¿Hay floración irregular de café?'),
(12, '¿Hay incremento de caída de flores y frutos de café y/o hay un aumento en la defoliación de las plantas de café?'),
(13, ' ¿Ha incrementado el daño de plagas y enfermedades en los cafetales?'),
(14, ' ¿ La diversificación del cafetal (maderables, frutales y otros cultivos) y/o de la finca es baja o no existe?'),
(15, '¿Hay áreas de cafetales a pleno sol o con menos de 20% de cobertura de sombra o con exceso > 70 %.?'),
(16, '¿ Los cafetales son viejos? (con más de 15 años).'),
(17, ' ¿Está ausente variedades de café resistentes a sequía, altas temperaturas y/o está ausente variedades resistentes a enfermedades importantes como roya, ojo de gallo.?'),
(18, '¿Está ausente la práctica anual de poda y deshijas de cafetos?'),
(19, ' ¿Está ausente a cada año la resiembra de cafetos?'),
(20, '¿La producción viene bajando en los últimos años?'),
(21, '¿Se aplica más de 200 kg de N/ha/año de origen sintética (química)?'),
(22, '¿Está ausente la práctica de aplicación de abonos orgánicos?'),
(23, ' ¿La mayoría de las quebradas y fuentes de agua están sin cobertura forestal?'),
(24, ' ¿La mayoría de las áreas de otros usos de la finca están sin asocio con árboles?'),
(25, ' ¿Están ausentes procesos organizativos sobre mitigación y adaptación al cambio climático?');

-- --------------------------------------------------------

--
-- Estructura de tabla para la tabla `tbl_vulnerabilidad_respuesta`
--

CREATE TABLE `tbl_vulnerabilidad_respuesta` (
  `cod_respuesta` bigint(20) NOT NULL,
  `cod_pregunta` bigint(20) NOT NULL,
  `respuesta` varchar(255) DEFAULT NULL,
  `cod_desicion` bigint(20) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

--
-- Volcado de datos para la tabla `tbl_vulnerabilidad_respuesta`
--

INSERT INTO `tbl_vulnerabilidad_respuesta` (`cod_respuesta`, `cod_pregunta`, `respuesta`, `cod_desicion`) VALUES
(1, 1, '1)     Variedades Tolerantes (A, M.).', 1),
(2, 1, '2)  Sistemas de producción adaptados y diversificados (A,M.)', 1),
(3, 1, '3) Implementar sistemas agroforestales y reforestación (A,M.).', 1),
(4, 1, '', 2),
(5, 1, '', 3),
(6, 2, '1)    Cosecha de agua en finca (A).', 1),
(7, 2, '2) Riego adecuado (A).', 1),
(8, 2, '3) Aplicación frecuente de foliares durante seguías (A).', 1),
(9, 2, '', 2),
(10, 2, '', 3),
(11, 3, '1)     Prácticas de conservación de suelos (A, M).', 1),
(12, 3, '2)     Diseño y manejo adecuado sombra café (A, M).', 1),
(13, 3, '3) Evitar cultivos en áreas de alto riesgo (A, M) (pendientes muy fuertes, márgenes de ríos).', 1),
(14, 3, '', 2),
(15, 3, '', 3),
(16, 4, '1)     Mantenerse informado por sistemas de alerta temprano para tomar medidas de seguridad anticipadamente (A).', 1),
(17, 4, '2) Evitar cultivos en áreas de alto riesgo (A, M) (pendientes muy fuertes, márgenes de ríos, p.j).', 1),
(18, 4, '', 2),
(19, 4, '', 3),
(20, 5, '1)     Cosecha de agua en finca (A).', 1),
(21, 5, '2)     Diseño y manejo adecuado de sombra (A, M).', 1),
(22, 5, '3) Buena cobertura de suelo (A, M).', 1),
(23, 5, '', 2),
(24, 5, '', 3),
(25, 6, '1)     Barreras rompevientos con árboles (A, M).', 1),
(26, 6, '2) Diseño y manejo adecuado de sombra (A, M).', 1),
(27, 6, '', 2),
(28, 6, '', 3),
(29, 7, '1)     Prácticas de conservación de suelos (A, M) (curvas de nivel, barreras vivas y muertas, mantener cobertura del', 1),
(30, 7, '2)     suelo, manejo selectivo de hierbas priorizando buenas coberturas).', 1),
(31, 7, '3) Diseño y manejo adecuado de sombra (A, M).', 1),
(32, 7, '', 2),
(33, 7, '', 3),
(34, 8, '1)     Programación de fertilización según análisis químico del suelo (A).', 1),
(35, 8, '2)     Aportes de materia orgánica (A, M).', 1),
(36, 8, '3) Diseño y manejo adecuado de sombra con fuerte aporte de leguminosas (A, M).', 1),
(37, 8, '', 2),
(38, 8, '', 3),
(39, 9, '1)     Prácticas de conservación de suelos (A, M).', 1),
(40, 9, '', 2),
(41, 9, '', 3),
(42, 10, '1)     Manejo selectivo de hierbas priorizando buenas coberturas (A, M).', 1),
(43, 10, ' Diseño y manejo de sombra para aportes de materia orgánica en cantidad (A, M).', 1),
(44, 10, '', 2),
(45, 10, '', 3),
(46, 11, '1)     Programa de fertilización adecuado (A, M).', 1),
(47, 11, '2)     Riego adecuado y oportuno (A).', 1),
(48, 11, '3) Diseño y manejo adecuado de la sombra (A, M).', 1),
(49, 11, '', 2),
(50, 11, '', 3),
(51, 12, '1)     Programa de fertilización adecuado (Análisis de suelos) (A, M).', 1),
(52, 12, '2)     Riego adecuado y oportuno (A).', 1),
(53, 12, '3) Diseño y manejo adecuado de sombra con fuerte aporte de leguminosas (A, M).', 1),
(54, 12, '', 2),
(55, 12, '', 3),
(56, 13, '1)     Diagnósticos oportunos para determinar niveles de incidencia (A, M).', 1),
(57, 13, '2)     Medidas de control ajustadas al comportamiento de clima, carga fructífera (A, M).', 1),
(58, 13, '3)     Mantenerse informado por sistemas de alerta temprano para tomar medidas de prevención y control (A).', 1),
(59, 13, '4)     Manejo integral de cafetales (A, M).', 1),
(60, 13, '5)     Diseño y manejo adecuado de sombra (A, M).', 1),
(61, 13, '6) Combinación de lotes con diferentes variedades resistentes a enfermedades distintas claves (A, M).', 1),
(62, 13, '', 2),
(63, 13, '', 3),
(64, 14, '1) Diseño y manejo adecuado de sistemas agroforestales que combinen maderables, frutales y otros cultivos en asocio con buenas densidades de árboles leguminosos (A, M).', 1),
(65, 14, '', 2),
(66, 14, '', 3),
(67, 15, '1) Diseñar y manejar sistemas agroforestales adecuados y apropiados a cada condición. Buscar las mejores condiciones de sombra con niveles entre el 30 y 55% con buena distribución en todo el cafetal (A, M).', 1),
(68, 15, '', 2),
(69, 15, '', 3),
(70, 16, '1) Programar renovaciones acordes a las condiciones del productor (si no es posible renovar de una sola vez toda el área programar renovaciones por etapas, las áreas de café viejos mantener bajo adecuado manejo de podas, deshijas, manejo de sombra...', 1),
(71, 16, '', 2),
(72, 16, '', 3),
(73, 17, '1)     Identificar disponibilidad de variedades autorizadas de alto potencial (Robustas, Híbridos F1, Obata, Catimores, etc.) (A, M).', 1),
(74, 17, '2)     Tener lotes de variedades diferentes con tolerancia/ resistencia a enfermedades distintas (A, M).', 1),
(75, 17, '', 2),
(76, 17, '', 3),
(77, 18, '1) Poscosecha iniciar programa de podas y deshijas. De manera ideal mínimo dos deshijas al año (A).', 1),
(78, 18, '', 2),
(79, 18, '', 3),
(80, 19, '1) Contar con resiembras anuales para reponer plantas que mueren. Contar siempre con un vivero para producir plantas de calidad (A).', 1),
(81, 19, '', 2),
(82, 19, '', 3),
(83, 20, '1)     Diagnóstico integral de cafetales (productivo, plagas y enfermedades, sombra, cobertura del suelo) (A, M).', 1),
(84, 20, '2)     Análisis químico del suelo y de ser posible análisis foliar (A, M).', 1),
(85, 20, '3)     Revisar programa de fertilización, y manejo de sombra (A).', 1),
(86, 20, '4)     Revisar la necesidad de sustituir o incorporar nuevas variedades de café (A, M).', 1),
(87, 20, '', 2),
(88, 20, '', 3),
(89, 21, '1)   Sustituir adecuadamente o complementar los programas de fertilización química con abonos orgánicos (idealmente producidos en la propia finca) (A, M).', 1),
(90, 21, '2) Buscar niveles de productividad relativamente constantes y rentables con aplicaciones moderadas de Nitrógeno (A, M).', 1),
(91, 21, '', 2),
(92, 21, '', 3),
(93, 22, '1)     Incorporar abonos orgánicos de calidad en programa de fertilización (A, M).', 1),
(94, 22, '2) Elaboración en fincas de abonos orgánicos (A, M).', 1),
(95, 22, '', 2),
(96, 22, '', 3),
(97, 23, '1) Recuperación de cobertura forestal de las nacientes. Si hay fuentes de agua dentro de cafetales protegerlas con sistemas agroforestales, mantenimiento de coberturas del suelo y sin aplicación de químicos (A, M).', 1),
(98, 23, '', 2),
(99, 23, '', 3),
(100, 24, '1) Utilizar diferentes arreglos de sistemas agroforestales en combinación con la reforestación y la regeneración natural garantizar producción agrícola diversificada y servicios ambientales (A, M).', 1),
(101, 24, '', 2),
(102, 24, '', 3),
(103, 25, '1)     Establecer y/o fortalecer acciones organizadas (capacitación, asistencia técnica, procesos de comunicación, etc.) que brinden apoyo a establecimiento y seguimiento a programas de adaptación y mitigación A, M).', 1),
(104, 25, '', 2),
(105, 25, '', 3);

-- --------------------------------------------------------

--
-- Estructura de tabla para la tabla `tbl_vulnerabilidad_variedades`
--

CREATE TABLE `tbl_vulnerabilidad_variedades` (
  `cod_variedad` bigint(20) NOT NULL,
  `variedad` varchar(45) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

--
-- Volcado de datos para la tabla `tbl_vulnerabilidad_variedades`
--

INSERT INTO `tbl_vulnerabilidad_variedades` (`cod_variedad`, `variedad`) VALUES
(1, 'Catimor'),
(2, 'Catuai'),
(3, 'Caturra'),
(4, 'Ihcafe 90'),
(5, 'Lempira'),
(6, 'Pacas'),
(7, 'Parainema'),
(8, 'Típica'),
(9, 'Icatu'),
(10, 'Obata'),
(11, 'pendiente'),
(12, 'Pacamara'),
(13, 'Bourbon'),
(14, 'ANACAFE 14'),
(15, 'Maragogipe'),
(16, 'Geisha'),
(17, 'H27'),
(18, 'Otra');

--
-- Índices para tablas volcadas
--

--
-- Indices de la tabla `tbl_beneficiario_ficha`
--
ALTER TABLE `tbl_beneficiario_ficha`
  ADD PRIMARY KEY (`cod_beneficiario`),
  ADD KEY `cod_grupo` (`cod_grupo`),
  ADD KEY `cod_identidad` (`cod_identidad`),
  ADD KEY `cod_org_cafetalera` (`cod_org_cafetalera`),
  ADD KEY `cod_tipo_apoyo` (`fecha_ingreso`),
  ADD KEY `cod_pro_beneficia` (`cod_pro_beneficia`),
  ADD KEY `cod_tecnico` (`cod_tecnico`),
  ADD KEY `cod_finca` (`cod_finca`);

--
-- Indices de la tabla `tbl_bene_finca`
--
ALTER TABLE `tbl_bene_finca`
  ADD PRIMARY KEY (`cod_finca`),
  ADD KEY `cod_tenencia` (`cod_tenencia`),
  ADD KEY `cod_identidad` (`cod_identidad`);

--
-- Indices de la tabla `tbl_bene_grupo_comunitario`
--
ALTER TABLE `tbl_bene_grupo_comunitario`
  ADD PRIMARY KEY (`cod_grupo`);

--
-- Indices de la tabla `tbl_bene_h_rubros`
--
ALTER TABLE `tbl_bene_h_rubros`
  ADD PRIMARY KEY (`cod_h_rubros`),
  ADD KEY `tbl_bene_h_rubros_ibfk_1` (`cod_rubro`),
  ADD KEY `cod_finca` (`cod_finca`);

--
-- Indices de la tabla `tbl_bene_h_tipo_apoyo`
--
ALTER TABLE `tbl_bene_h_tipo_apoyo`
  ADD PRIMARY KEY (`cod_h_tipo_apoyo`),
  ADD KEY `cod_vivienda` (`cod_vivienda`),
  ADD KEY `cod_tipo_apoyo` (`cod_tipo_apoyo`);

--
-- Indices de la tabla `tbl_bene_h_tipo_estufa`
--
ALTER TABLE `tbl_bene_h_tipo_estufa`
  ADD PRIMARY KEY (`cod_h_estufa`),
  ADD KEY `cod_vivienda` (`cod_vivienda`),
  ADD KEY `cod_tipo_estufa` (`cod_tipo_estufa`);

--
-- Indices de la tabla `tbl_bene_h_tipo_servicios_p`
--
ALTER TABLE `tbl_bene_h_tipo_servicios_p`
  ADD PRIMARY KEY (`cod_h_tipo_servicio`),
  ADD KEY `tbl_bene_h_tipo_servicios_p_ibfk_2` (`cod_vivienda`),
  ADD KEY `cod_tipo_servicio` (`cod_tipo_servicio`);

--
-- Indices de la tabla `tbl_bene_h_variedades`
--
ALTER TABLE `tbl_bene_h_variedades`
  ADD PRIMARY KEY (`cod_h_variedad`),
  ADD KEY `cod_finca` (`cod_finca`),
  ADD KEY `cod_variedad` (`cod_variedad`);

--
-- Indices de la tabla `tbl_bene_org_cafetalera`
--
ALTER TABLE `tbl_bene_org_cafetalera`
  ADD PRIMARY KEY (`cod_org_cafetalera`);

--
-- Indices de la tabla `tbl_bene_productor`
--
ALTER TABLE `tbl_bene_productor`
  ADD PRIMARY KEY (`cod_identidad`),
  ADD KEY `fk_id_genero` (`cod_genero`),
  ADD KEY `fk_id_pais` (`cod_pais`),
  ADD KEY `fk_id_aldea` (`cod_municipio`),
  ADD KEY `fk_id_agencia` (`cod_agencia`),
  ADD KEY `cod_etnias` (`cod_etnias`);

--
-- Indices de la tabla `tbl_bene_proyecto_beneficia`
--
ALTER TABLE `tbl_bene_proyecto_beneficia`
  ADD PRIMARY KEY (`cod_pro_beneficia`);

--
-- Indices de la tabla `tbl_bene_rubro`
--
ALTER TABLE `tbl_bene_rubro`
  ADD PRIMARY KEY (`cod_rubro`);

--
-- Indices de la tabla `tbl_bene_tenencia`
--
ALTER TABLE `tbl_bene_tenencia`
  ADD PRIMARY KEY (`cod_tenencia`);

--
-- Indices de la tabla `tbl_bene_tipo_apoyo`
--
ALTER TABLE `tbl_bene_tipo_apoyo`
  ADD PRIMARY KEY (`cod_tipo_apoyo`);

--
-- Indices de la tabla `tbl_bene_tipo_documentacion`
--
ALTER TABLE `tbl_bene_tipo_documentacion`
  ADD PRIMARY KEY (`cod_tipo_doc`);

--
-- Indices de la tabla `tbl_bene_tipo_estufa`
--
ALTER TABLE `tbl_bene_tipo_estufa`
  ADD PRIMARY KEY (`cod_tipo_estufa`);

--
-- Indices de la tabla `tbl_bene_tipo_pared`
--
ALTER TABLE `tbl_bene_tipo_pared`
  ADD PRIMARY KEY (`cod_tipo_pared`);

--
-- Indices de la tabla `tbl_bene_tipo_piso`
--
ALTER TABLE `tbl_bene_tipo_piso`
  ADD PRIMARY KEY (`cod_tipo_piso`);

--
-- Indices de la tabla `tbl_bene_tipo_servicio`
--
ALTER TABLE `tbl_bene_tipo_servicio`
  ADD PRIMARY KEY (`cod_tipo_servicio`);

--
-- Indices de la tabla `tbl_bene_tipo_techo`
--
ALTER TABLE `tbl_bene_tipo_techo`
  ADD PRIMARY KEY (`cod_tipo_techo`);

--
-- Indices de la tabla `tbl_bene_tipo_vivienda`
--
ALTER TABLE `tbl_bene_tipo_vivienda`
  ADD PRIMARY KEY (`cod_tipo_vivienda`);

--
-- Indices de la tabla `tbl_bene_vivienda`
--
ALTER TABLE `tbl_bene_vivienda`
  ADD PRIMARY KEY (`cod_vivienda`),
  ADD KEY `fk_cod_beneficiario_v` (`cod_beneficiario`),
  ADD KEY `cod_tipo_doc` (`cod_tipo_doc`),
  ADD KEY `cod_tipo_pared` (`cod_tipo_pared`),
  ADD KEY `cod_tipo_piso` (`cod_tipo_piso`),
  ADD KEY `cod_tipo_techo` (`cod_tipo_techo`),
  ADD KEY `cod_tipo_vivienda` (`cod_tipo_vivienda`);

--
-- Indices de la tabla `tbl_div_decision`
--
ALTER TABLE `tbl_div_decision`
  ADD PRIMARY KEY (`cod_dicision`);

--
-- Indices de la tabla `tbl_div_dicision_pertenece`
--
ALTER TABLE `tbl_div_dicision_pertenece`
  ADD PRIMARY KEY (`cod_decision_per`);

--
-- Indices de la tabla `tbl_div_ficha`
--
ALTER TABLE `tbl_div_ficha`
  ADD PRIMARY KEY (`cod_ficha`),
  ADD KEY `cod_dicision` (`cod_dicision`),
  ADD KEY `cod_identidad` (`cod_identidad`),
  ADD KEY `cod_pro_beneficia` (`cod_pro_beneficia`),
  ADD KEY `cod_tecnico` (`cod_tecnico`),
  ADD KEY `cod_decision_per` (`cod_decision_per`),
  ADD KEY `cod_rubro` (`cod_rubro`),
  ADD KEY `cod_modo` (`cod_modo`);

--
-- Indices de la tabla `tbl_div_finca`
--
ALTER TABLE `tbl_div_finca`
  ADD PRIMARY KEY (`cod_finca`),
  ADD KEY `cod_identidad` (`cod_identidad`),
  ADD KEY `cod_tipo_suelo` (`cod_tipo_suelo`),
  ADD KEY `cod_porcentaje` (`cod_porcentaje`);

--
-- Indices de la tabla `tbl_div_frutas`
--
ALTER TABLE `tbl_div_frutas`
  ADD PRIMARY KEY (`cod_frutas`);

--
-- Indices de la tabla `tbl_div_h_familia_mes`
--
ALTER TABLE `tbl_div_h_familia_mes`
  ADD PRIMARY KEY (`cod_h_familia_mes`),
  ADD KEY `cod_mes` (`cod_mes`),
  ADD KEY `cod_ficha` (`cod_ficha`);

--
-- Indices de la tabla `tbl_div_h_frutas`
--
ALTER TABLE `tbl_div_h_frutas`
  ADD PRIMARY KEY (`cod_h_frutales`),
  ADD KEY `cod_ficha` (`cod_ficha`),
  ADD KEY `cod_fruta` (`cod_fruta`);

--
-- Indices de la tabla `tbl_div_h_ingresos`
--
ALTER TABLE `tbl_div_h_ingresos`
  ADD PRIMARY KEY (`cod_h_ingreso`),
  ADD KEY `cod_ingreso` (`cod_ingreso`),
  ADD KEY `cod_ficha` (`cod_ficha`);

--
-- Indices de la tabla `tbl_div_h_meses`
--
ALTER TABLE `tbl_div_h_meses`
  ADD PRIMARY KEY (`cod_div_h_meses`),
  ADD KEY `cod_mes` (`cod_mes`),
  ADD KEY `cod_finca` (`cod_finca`);

--
-- Indices de la tabla `tbl_div_modo_imp`
--
ALTER TABLE `tbl_div_modo_imp`
  ADD PRIMARY KEY (`cod_modo`);

--
-- Indices de la tabla `tbl_div_parentesco`
--
ALTER TABLE `tbl_div_parentesco`
  ADD PRIMARY KEY (`cod_parentesco`);

--
-- Indices de la tabla `tbl_div_porcentajes`
--
ALTER TABLE `tbl_div_porcentajes`
  ADD PRIMARY KEY (`cod_porcentaje`);

--
-- Indices de la tabla `tbl_div_productor`
--
ALTER TABLE `tbl_div_productor`
  ADD PRIMARY KEY (`cod_identidad`),
  ADD KEY `fk_id_genero` (`cod_genero`),
  ADD KEY `fk_id_pais` (`cod_pais`),
  ADD KEY `fk_id_aldea` (`cod_municipio`),
  ADD KEY `fk_id_agencia` (`cod_agencia`);

--
-- Indices de la tabla `tbl_div_recomendacion`
--
ALTER TABLE `tbl_div_recomendacion`
  ADD PRIMARY KEY (`cod_recomendacion`),
  ADD KEY `cod_ficha` (`cod_ficha`),
  ADD KEY `cod_parentesco` (`cod_parentesco`);

--
-- Indices de la tabla `tbl_div_rubro`
--
ALTER TABLE `tbl_div_rubro`
  ADD PRIMARY KEY (`cod_rubro`);

--
-- Indices de la tabla `tbl_div_tipo_ingreso`
--
ALTER TABLE `tbl_div_tipo_ingreso`
  ADD PRIMARY KEY (`cod_ingreso`);

--
-- Indices de la tabla `tbl_div_tipo_suelo`
--
ALTER TABLE `tbl_div_tipo_suelo`
  ADD PRIMARY KEY (`cod_tipo_suelo`);

--
-- Indices de la tabla `tbl_general_actividad_pro`
--
ALTER TABLE `tbl_general_actividad_pro`
  ADD PRIMARY KEY (`cod_actividad_pro`);

--
-- Indices de la tabla `tbl_general_agencia`
--
ALTER TABLE `tbl_general_agencia`
  ADD PRIMARY KEY (`cod_agencia`),
  ADD KEY `fk_id_regional` (`cod_regional`);

--
-- Indices de la tabla `tbl_general_aldea`
--
ALTER TABLE `tbl_general_aldea`
  ADD PRIMARY KEY (`cod_aldea`),
  ADD KEY `fk_id_municipio` (`cod_municipio`);

--
-- Indices de la tabla `tbl_general_departamento`
--
ALTER TABLE `tbl_general_departamento`
  ADD PRIMARY KEY (`cod_depart`);

--
-- Indices de la tabla `tbl_general_escolaridad`
--
ALTER TABLE `tbl_general_escolaridad`
  ADD PRIMARY KEY (`cod_escolaridad`);

--
-- Indices de la tabla `tbl_general_estado_civil`
--
ALTER TABLE `tbl_general_estado_civil`
  ADD PRIMARY KEY (`cod_estado_civil`);

--
-- Indices de la tabla `tbl_general_etnias`
--
ALTER TABLE `tbl_general_etnias`
  ADD PRIMARY KEY (`cod_etnias`);

--
-- Indices de la tabla `tbl_general_finca`
--
ALTER TABLE `tbl_general_finca`
  ADD PRIMARY KEY (`cod_finca`),
  ADD KEY `fk_id_productor_fi` (`cod_identidad`);

--
-- Indices de la tabla `tbl_general_genero`
--
ALTER TABLE `tbl_general_genero`
  ADD PRIMARY KEY (`cod_genero`);

--
-- Indices de la tabla `tbl_general_h_actividad_pro`
--
ALTER TABLE `tbl_general_h_actividad_pro`
  ADD PRIMARY KEY (`cod_h_actividad`),
  ADD KEY `cod_actividad_pro` (`cod_actividad_pro`),
  ADD KEY `cod_identidad` (`cod_identidad`);

--
-- Indices de la tabla `tbl_general_meses`
--
ALTER TABLE `tbl_general_meses`
  ADD PRIMARY KEY (`cod_mes`);

--
-- Indices de la tabla `tbl_general_municipio`
--
ALTER TABLE `tbl_general_municipio`
  ADD PRIMARY KEY (`cod_municipio`),
  ADD KEY `fk_id_depar` (`cod_depart`);

--
-- Indices de la tabla `tbl_general_pais`
--
ALTER TABLE `tbl_general_pais`
  ADD PRIMARY KEY (`cod_pais`);

--
-- Indices de la tabla `tbl_general_productor`
--
ALTER TABLE `tbl_general_productor`
  ADD PRIMARY KEY (`cod_identidad`),
  ADD KEY `fk_id_genero` (`cod_genero`),
  ADD KEY `fk_id_pais` (`cod_pais`),
  ADD KEY `fk_id_aldea` (`cod_municipio`),
  ADD KEY `fk_id_agencia` (`cod_agencia`);

--
-- Indices de la tabla `tbl_general_puesto`
--
ALTER TABLE `tbl_general_puesto`
  ADD PRIMARY KEY (`cod_puesto`);

--
-- Indices de la tabla `tbl_general_regional`
--
ALTER TABLE `tbl_general_regional`
  ADD UNIQUE KEY `cod_regional` (`cod_regional`) USING BTREE;

--
-- Indices de la tabla `tbl_general_tecnico`
--
ALTER TABLE `tbl_general_tecnico`
  ADD PRIMARY KEY (`cod_tecnico`),
  ADD KEY `fk_id_puesto` (`cod_puesto`);

--
-- Indices de la tabla `tbl_h_respuestas`
--
ALTER TABLE `tbl_h_respuestas`
  ADD PRIMARY KEY (`cod_h_respuesta`),
  ADD KEY `fk_id_respuesta` (`cod_respuesta`),
  ADD KEY `fk_id_finca_v` (`cod_finca`);

--
-- Indices de la tabla `tbl_lideres_ficha`
--
ALTER TABLE `tbl_lideres_ficha`
  ADD PRIMARY KEY (`cod_ficha`),
  ADD KEY `cod_grupo` (`cod_grupo`),
  ADD KEY `cod_identidad` (`cod_identidad`),
  ADD KEY `cod_pro_beneficia` (`cod_pro_beneficia`),
  ADD KEY `cod_tecnico` (`cod_tecnico`),
  ADD KEY `cod_problema` (`cod_problema`);

--
-- Indices de la tabla `tbl_lider_coasociados`
--
ALTER TABLE `tbl_lider_coasociados`
  ADD PRIMARY KEY (`cod_coasociado`),
  ADD KEY `cod_genero` (`cod_genero`);

--
-- Indices de la tabla `tbl_lider_fincas`
--
ALTER TABLE `tbl_lider_fincas`
  ADD PRIMARY KEY (`cod_finca`),
  ADD KEY `cod_identidad` (`cod_identidad`);

--
-- Indices de la tabla `tbl_lider_grupo`
--
ALTER TABLE `tbl_lider_grupo`
  ADD PRIMARY KEY (`cod_grupo`);

--
-- Indices de la tabla `tbl_lider_grupo_comunal`
--
ALTER TABLE `tbl_lider_grupo_comunal`
  ADD PRIMARY KEY (`cod_comunal`);

--
-- Indices de la tabla `tbl_lider_h_coasociados`
--
ALTER TABLE `tbl_lider_h_coasociados`
  ADD PRIMARY KEY (`cod_h_coasociado`),
  ADD KEY `cod_identidad` (`cod_identidad`),
  ADD KEY `cod_coasociado` (`cod_coasociado`);

--
-- Indices de la tabla `tbl_lider_h_comunal`
--
ALTER TABLE `tbl_lider_h_comunal`
  ADD PRIMARY KEY (`cod_h_comunal`),
  ADD KEY `cod_ficha` (`cod_ficha`),
  ADD KEY `cod_comunal` (`cod_comunal`);

--
-- Indices de la tabla `tbl_lider_parcela`
--
ALTER TABLE `tbl_lider_parcela`
  ADD PRIMARY KEY (`cod_parcela`),
  ADD KEY `cod_variedad` (`cod_variedad`),
  ADD KEY `tbl_lider_parcela_ibfk_1` (`cod_finca`);

--
-- Indices de la tabla `tbl_lider_problema`
--
ALTER TABLE `tbl_lider_problema`
  ADD PRIMARY KEY (`cod_problema`);

--
-- Indices de la tabla `tbl_lider_productor`
--
ALTER TABLE `tbl_lider_productor`
  ADD PRIMARY KEY (`cod_identidad`),
  ADD KEY `fk_id_genero` (`cod_genero`),
  ADD KEY `fk_id_pais` (`cod_pais`),
  ADD KEY `fk_id_aldea` (`cod_municipio`),
  ADD KEY `fk_id_agencia` (`cod_agencia`);

--
-- Indices de la tabla `tbl_vulnerabilidades_ficha`
--
ALTER TABLE `tbl_vulnerabilidades_ficha`
  ADD PRIMARY KEY (`cod_vulnerabilidad`),
  ADD KEY `fk_aldea_v` (`cod_municipio`),
  ADD KEY `fk_id_tecnico_v_f` (`cod_tecnico`),
  ADD KEY `fk_id_finca_v_f` (`cod_finca`),
  ADD KEY `fk_identidad_vf` (`cod_identidad`);

--
-- Indices de la tabla `tbl_vulnerabilidad_desicion`
--
ALTER TABLE `tbl_vulnerabilidad_desicion`
  ADD PRIMARY KEY (`cod_desicion`);

--
-- Indices de la tabla `tbl_vulnerabilidad_h_variedad`
--
ALTER TABLE `tbl_vulnerabilidad_h_variedad`
  ADD PRIMARY KEY (`cod_h_variedad`),
  ADD KEY `cod_variedad` (`cod_variedad`),
  ADD KEY `cod_vulnerabilidad` (`cod_vulnerabilidad`);

--
-- Indices de la tabla `tbl_vulnerabilidad_pregunta`
--
ALTER TABLE `tbl_vulnerabilidad_pregunta`
  ADD PRIMARY KEY (`cod_pregunta`);

--
-- Indices de la tabla `tbl_vulnerabilidad_respuesta`
--
ALTER TABLE `tbl_vulnerabilidad_respuesta`
  ADD PRIMARY KEY (`cod_respuesta`),
  ADD KEY `fk_id_pregunta` (`cod_pregunta`),
  ADD KEY `fk_desicion_respuesta` (`cod_desicion`);

--
-- Indices de la tabla `tbl_vulnerabilidad_variedades`
--
ALTER TABLE `tbl_vulnerabilidad_variedades`
  ADD PRIMARY KEY (`cod_variedad`) USING BTREE;

--
-- AUTO_INCREMENT de las tablas volcadas
--

--
-- AUTO_INCREMENT de la tabla `tbl_beneficiario_ficha`
--
ALTER TABLE `tbl_beneficiario_ficha`
  MODIFY `cod_beneficiario` bigint(20) NOT NULL AUTO_INCREMENT;

--
-- AUTO_INCREMENT de la tabla `tbl_bene_grupo_comunitario`
--
ALTER TABLE `tbl_bene_grupo_comunitario`
  MODIFY `cod_grupo` bigint(20) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=7;

--
-- AUTO_INCREMENT de la tabla `tbl_bene_h_rubros`
--
ALTER TABLE `tbl_bene_h_rubros`
  MODIFY `cod_h_rubros` bigint(20) NOT NULL AUTO_INCREMENT;

--
-- AUTO_INCREMENT de la tabla `tbl_bene_h_tipo_apoyo`
--
ALTER TABLE `tbl_bene_h_tipo_apoyo`
  MODIFY `cod_h_tipo_apoyo` bigint(20) NOT NULL AUTO_INCREMENT;

--
-- AUTO_INCREMENT de la tabla `tbl_bene_h_tipo_estufa`
--
ALTER TABLE `tbl_bene_h_tipo_estufa`
  MODIFY `cod_h_estufa` bigint(20) NOT NULL AUTO_INCREMENT;

--
-- AUTO_INCREMENT de la tabla `tbl_bene_h_tipo_servicios_p`
--
ALTER TABLE `tbl_bene_h_tipo_servicios_p`
  MODIFY `cod_h_tipo_servicio` bigint(20) NOT NULL AUTO_INCREMENT;

--
-- AUTO_INCREMENT de la tabla `tbl_bene_h_variedades`
--
ALTER TABLE `tbl_bene_h_variedades`
  MODIFY `cod_h_variedad` bigint(20) NOT NULL AUTO_INCREMENT;

--
-- AUTO_INCREMENT de la tabla `tbl_bene_org_cafetalera`
--
ALTER TABLE `tbl_bene_org_cafetalera`
  MODIFY `cod_org_cafetalera` bigint(20) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=6;

--
-- AUTO_INCREMENT de la tabla `tbl_bene_proyecto_beneficia`
--
ALTER TABLE `tbl_bene_proyecto_beneficia`
  MODIFY `cod_pro_beneficia` bigint(20) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=7;

--
-- AUTO_INCREMENT de la tabla `tbl_bene_rubro`
--
ALTER TABLE `tbl_bene_rubro`
  MODIFY `cod_rubro` bigint(20) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=14;

--
-- AUTO_INCREMENT de la tabla `tbl_bene_tenencia`
--
ALTER TABLE `tbl_bene_tenencia`
  MODIFY `cod_tenencia` bigint(20) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=6;

--
-- AUTO_INCREMENT de la tabla `tbl_bene_tipo_apoyo`
--
ALTER TABLE `tbl_bene_tipo_apoyo`
  MODIFY `cod_tipo_apoyo` bigint(20) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=9;

--
-- AUTO_INCREMENT de la tabla `tbl_bene_tipo_documentacion`
--
ALTER TABLE `tbl_bene_tipo_documentacion`
  MODIFY `cod_tipo_doc` bigint(20) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=7;

--
-- AUTO_INCREMENT de la tabla `tbl_bene_tipo_estufa`
--
ALTER TABLE `tbl_bene_tipo_estufa`
  MODIFY `cod_tipo_estufa` bigint(20) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=6;

--
-- AUTO_INCREMENT de la tabla `tbl_bene_tipo_pared`
--
ALTER TABLE `tbl_bene_tipo_pared`
  MODIFY `cod_tipo_pared` bigint(20) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=5;

--
-- AUTO_INCREMENT de la tabla `tbl_bene_tipo_piso`
--
ALTER TABLE `tbl_bene_tipo_piso`
  MODIFY `cod_tipo_piso` bigint(20) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=6;

--
-- AUTO_INCREMENT de la tabla `tbl_bene_tipo_servicio`
--
ALTER TABLE `tbl_bene_tipo_servicio`
  MODIFY `cod_tipo_servicio` bigint(20) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=6;

--
-- AUTO_INCREMENT de la tabla `tbl_bene_tipo_techo`
--
ALTER TABLE `tbl_bene_tipo_techo`
  MODIFY `cod_tipo_techo` bigint(20) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=6;

--
-- AUTO_INCREMENT de la tabla `tbl_bene_tipo_vivienda`
--
ALTER TABLE `tbl_bene_tipo_vivienda`
  MODIFY `cod_tipo_vivienda` bigint(20) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=4;

--
-- AUTO_INCREMENT de la tabla `tbl_bene_vivienda`
--
ALTER TABLE `tbl_bene_vivienda`
  MODIFY `cod_vivienda` bigint(20) NOT NULL AUTO_INCREMENT;

--
-- AUTO_INCREMENT de la tabla `tbl_div_decision`
--
ALTER TABLE `tbl_div_decision`
  MODIFY `cod_dicision` bigint(20) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=3;

--
-- AUTO_INCREMENT de la tabla `tbl_div_dicision_pertenece`
--
ALTER TABLE `tbl_div_dicision_pertenece`
  MODIFY `cod_decision_per` bigint(20) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=3;

--
-- AUTO_INCREMENT de la tabla `tbl_div_ficha`
--
ALTER TABLE `tbl_div_ficha`
  MODIFY `cod_ficha` bigint(20) NOT NULL AUTO_INCREMENT;

--
-- AUTO_INCREMENT de la tabla `tbl_div_frutas`
--
ALTER TABLE `tbl_div_frutas`
  MODIFY `cod_frutas` bigint(20) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=6;

--
-- AUTO_INCREMENT de la tabla `tbl_div_h_familia_mes`
--
ALTER TABLE `tbl_div_h_familia_mes`
  MODIFY `cod_h_familia_mes` bigint(20) NOT NULL AUTO_INCREMENT;

--
-- AUTO_INCREMENT de la tabla `tbl_div_h_frutas`
--
ALTER TABLE `tbl_div_h_frutas`
  MODIFY `cod_h_frutales` bigint(20) NOT NULL AUTO_INCREMENT;

--
-- AUTO_INCREMENT de la tabla `tbl_div_h_ingresos`
--
ALTER TABLE `tbl_div_h_ingresos`
  MODIFY `cod_h_ingreso` bigint(20) NOT NULL AUTO_INCREMENT;

--
-- AUTO_INCREMENT de la tabla `tbl_div_h_meses`
--
ALTER TABLE `tbl_div_h_meses`
  MODIFY `cod_div_h_meses` bigint(20) NOT NULL AUTO_INCREMENT;

--
-- AUTO_INCREMENT de la tabla `tbl_div_modo_imp`
--
ALTER TABLE `tbl_div_modo_imp`
  MODIFY `cod_modo` bigint(20) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=3;

--
-- AUTO_INCREMENT de la tabla `tbl_div_parentesco`
--
ALTER TABLE `tbl_div_parentesco`
  MODIFY `cod_parentesco` bigint(20) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=4;

--
-- AUTO_INCREMENT de la tabla `tbl_div_porcentajes`
--
ALTER TABLE `tbl_div_porcentajes`
  MODIFY `cod_porcentaje` bigint(20) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=4;

--
-- AUTO_INCREMENT de la tabla `tbl_div_recomendacion`
--
ALTER TABLE `tbl_div_recomendacion`
  MODIFY `cod_recomendacion` bigint(20) NOT NULL AUTO_INCREMENT;

--
-- AUTO_INCREMENT de la tabla `tbl_div_rubro`
--
ALTER TABLE `tbl_div_rubro`
  MODIFY `cod_rubro` bigint(20) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=13;

--
-- AUTO_INCREMENT de la tabla `tbl_div_tipo_ingreso`
--
ALTER TABLE `tbl_div_tipo_ingreso`
  MODIFY `cod_ingreso` bigint(20) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=7;

--
-- AUTO_INCREMENT de la tabla `tbl_div_tipo_suelo`
--
ALTER TABLE `tbl_div_tipo_suelo`
  MODIFY `cod_tipo_suelo` bigint(20) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=5;

--
-- AUTO_INCREMENT de la tabla `tbl_general_actividad_pro`
--
ALTER TABLE `tbl_general_actividad_pro`
  MODIFY `cod_actividad_pro` bigint(20) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=6;

--
-- AUTO_INCREMENT de la tabla `tbl_general_agencia`
--
ALTER TABLE `tbl_general_agencia`
  MODIFY `cod_agencia` bigint(20) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=54;

--
-- AUTO_INCREMENT de la tabla `tbl_general_aldea`
--
ALTER TABLE `tbl_general_aldea`
  MODIFY `cod_aldea` bigint(20) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=3767;

--
-- AUTO_INCREMENT de la tabla `tbl_general_departamento`
--
ALTER TABLE `tbl_general_departamento`
  MODIFY `cod_depart` bigint(11) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=21;

--
-- AUTO_INCREMENT de la tabla `tbl_general_escolaridad`
--
ALTER TABLE `tbl_general_escolaridad`
  MODIFY `cod_escolaridad` bigint(20) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=6;

--
-- AUTO_INCREMENT de la tabla `tbl_general_estado_civil`
--
ALTER TABLE `tbl_general_estado_civil`
  MODIFY `cod_estado_civil` bigint(20) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=5;

--
-- AUTO_INCREMENT de la tabla `tbl_general_etnias`
--
ALTER TABLE `tbl_general_etnias`
  MODIFY `cod_etnias` bigint(20) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=10;

--
-- AUTO_INCREMENT de la tabla `tbl_general_genero`
--
ALTER TABLE `tbl_general_genero`
  MODIFY `cod_genero` bigint(20) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=3;

--
-- AUTO_INCREMENT de la tabla `tbl_general_h_actividad_pro`
--
ALTER TABLE `tbl_general_h_actividad_pro`
  MODIFY `cod_h_actividad` bigint(20) NOT NULL AUTO_INCREMENT;

--
-- AUTO_INCREMENT de la tabla `tbl_general_meses`
--
ALTER TABLE `tbl_general_meses`
  MODIFY `cod_mes` int(2) UNSIGNED ZEROFILL NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=14;

--
-- AUTO_INCREMENT de la tabla `tbl_general_municipio`
--
ALTER TABLE `tbl_general_municipio`
  MODIFY `cod_municipio` bigint(11) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=299;

--
-- AUTO_INCREMENT de la tabla `tbl_general_pais`
--
ALTER TABLE `tbl_general_pais`
  MODIFY `cod_pais` bigint(20) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=247;

--
-- AUTO_INCREMENT de la tabla `tbl_general_regional`
--
ALTER TABLE `tbl_general_regional`
  MODIFY `cod_regional` bigint(20) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=9;

--
-- AUTO_INCREMENT de la tabla `tbl_h_respuestas`
--
ALTER TABLE `tbl_h_respuestas`
  MODIFY `cod_h_respuesta` bigint(20) NOT NULL AUTO_INCREMENT;

--
-- AUTO_INCREMENT de la tabla `tbl_lideres_ficha`
--
ALTER TABLE `tbl_lideres_ficha`
  MODIFY `cod_ficha` bigint(20) NOT NULL AUTO_INCREMENT;

--
-- AUTO_INCREMENT de la tabla `tbl_lider_coasociados`
--
ALTER TABLE `tbl_lider_coasociados`
  MODIFY `cod_coasociado` bigint(20) NOT NULL AUTO_INCREMENT;

--
-- AUTO_INCREMENT de la tabla `tbl_lider_grupo`
--
ALTER TABLE `tbl_lider_grupo`
  MODIFY `cod_grupo` bigint(20) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=4;

--
-- AUTO_INCREMENT de la tabla `tbl_lider_grupo_comunal`
--
ALTER TABLE `tbl_lider_grupo_comunal`
  MODIFY `cod_comunal` bigint(20) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=5;

--
-- AUTO_INCREMENT de la tabla `tbl_lider_h_coasociados`
--
ALTER TABLE `tbl_lider_h_coasociados`
  MODIFY `cod_h_coasociado` bigint(20) NOT NULL AUTO_INCREMENT;

--
-- AUTO_INCREMENT de la tabla `tbl_lider_h_comunal`
--
ALTER TABLE `tbl_lider_h_comunal`
  MODIFY `cod_h_comunal` bigint(20) NOT NULL AUTO_INCREMENT;

--
-- AUTO_INCREMENT de la tabla `tbl_lider_parcela`
--
ALTER TABLE `tbl_lider_parcela`
  MODIFY `cod_parcela` bigint(20) NOT NULL AUTO_INCREMENT;

--
-- AUTO_INCREMENT de la tabla `tbl_lider_problema`
--
ALTER TABLE `tbl_lider_problema`
  MODIFY `cod_problema` bigint(20) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=4;

--
-- AUTO_INCREMENT de la tabla `tbl_vulnerabilidades_ficha`
--
ALTER TABLE `tbl_vulnerabilidades_ficha`
  MODIFY `cod_vulnerabilidad` bigint(20) NOT NULL AUTO_INCREMENT;

--
-- AUTO_INCREMENT de la tabla `tbl_vulnerabilidad_h_variedad`
--
ALTER TABLE `tbl_vulnerabilidad_h_variedad`
  MODIFY `cod_h_variedad` bigint(20) NOT NULL AUTO_INCREMENT;

--
-- AUTO_INCREMENT de la tabla `tbl_vulnerabilidad_pregunta`
--
ALTER TABLE `tbl_vulnerabilidad_pregunta`
  MODIFY `cod_pregunta` bigint(20) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=27;

--
-- AUTO_INCREMENT de la tabla `tbl_vulnerabilidad_variedades`
--
ALTER TABLE `tbl_vulnerabilidad_variedades`
  MODIFY `cod_variedad` bigint(20) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=19;

--
-- Restricciones para tablas volcadas
--

--
-- Filtros para la tabla `tbl_beneficiario_ficha`
--
ALTER TABLE `tbl_beneficiario_ficha`
  ADD CONSTRAINT `tbl_beneficiario_ficha_ibfk_1` FOREIGN KEY (`cod_grupo`) REFERENCES `tbl_bene_grupo_comunitario` (`cod_grupo`),
  ADD CONSTRAINT `tbl_beneficiario_ficha_ibfk_2` FOREIGN KEY (`cod_identidad`) REFERENCES `tbl_bene_productor` (`cod_identidad`),
  ADD CONSTRAINT `tbl_beneficiario_ficha_ibfk_3` FOREIGN KEY (`cod_org_cafetalera`) REFERENCES `tbl_bene_org_cafetalera` (`cod_org_cafetalera`),
  ADD CONSTRAINT `tbl_beneficiario_ficha_ibfk_5` FOREIGN KEY (`cod_pro_beneficia`) REFERENCES `tbl_bene_proyecto_beneficia` (`cod_pro_beneficia`),
  ADD CONSTRAINT `tbl_beneficiario_ficha_ibfk_6` FOREIGN KEY (`cod_tecnico`) REFERENCES `tbl_general_tecnico` (`cod_tecnico`),
  ADD CONSTRAINT `tbl_beneficiario_ficha_ibfk_7` FOREIGN KEY (`cod_finca`) REFERENCES `tbl_bene_finca` (`cod_finca`);

--
-- Filtros para la tabla `tbl_bene_finca`
--
ALTER TABLE `tbl_bene_finca`
  ADD CONSTRAINT `tbl_bene_finca_ibfk_1` FOREIGN KEY (`cod_tenencia`) REFERENCES `tbl_bene_tenencia` (`cod_tenencia`),
  ADD CONSTRAINT `tbl_bene_finca_ibfk_2` FOREIGN KEY (`cod_identidad`) REFERENCES `tbl_bene_productor` (`cod_identidad`);

--
-- Filtros para la tabla `tbl_bene_h_rubros`
--
ALTER TABLE `tbl_bene_h_rubros`
  ADD CONSTRAINT `tbl_bene_h_rubros_ibfk_1` FOREIGN KEY (`cod_rubro`) REFERENCES `tbl_bene_rubro` (`cod_rubro`),
  ADD CONSTRAINT `tbl_bene_h_rubros_ibfk_2` FOREIGN KEY (`cod_finca`) REFERENCES `tbl_bene_finca` (`cod_finca`);

--
-- Filtros para la tabla `tbl_bene_h_tipo_apoyo`
--
ALTER TABLE `tbl_bene_h_tipo_apoyo`
  ADD CONSTRAINT `tbl_bene_h_tipo_apoyo_ibfk_1` FOREIGN KEY (`cod_vivienda`) REFERENCES `tbl_bene_vivienda` (`cod_vivienda`),
  ADD CONSTRAINT `tbl_bene_h_tipo_apoyo_ibfk_2` FOREIGN KEY (`cod_tipo_apoyo`) REFERENCES `tbl_bene_tipo_apoyo` (`cod_tipo_apoyo`);

--
-- Filtros para la tabla `tbl_bene_h_tipo_estufa`
--
ALTER TABLE `tbl_bene_h_tipo_estufa`
  ADD CONSTRAINT `tbl_bene_h_tipo_estufa_ibfk_3` FOREIGN KEY (`cod_vivienda`) REFERENCES `tbl_bene_vivienda` (`cod_vivienda`),
  ADD CONSTRAINT `tbl_bene_h_tipo_estufa_ibfk_4` FOREIGN KEY (`cod_tipo_estufa`) REFERENCES `tbl_bene_tipo_estufa` (`cod_tipo_estufa`);

--
-- Filtros para la tabla `tbl_bene_h_tipo_servicios_p`
--
ALTER TABLE `tbl_bene_h_tipo_servicios_p`
  ADD CONSTRAINT `tbl_bene_h_tipo_servicios_p_ibfk_2` FOREIGN KEY (`cod_vivienda`) REFERENCES `tbl_bene_vivienda` (`cod_vivienda`),
  ADD CONSTRAINT `tbl_bene_h_tipo_servicios_p_ibfk_3` FOREIGN KEY (`cod_tipo_servicio`) REFERENCES `tbl_bene_tipo_servicio` (`cod_tipo_servicio`);

--
-- Filtros para la tabla `tbl_bene_h_variedades`
--
ALTER TABLE `tbl_bene_h_variedades`
  ADD CONSTRAINT `tbl_bene_h_variedades_ibfk_1` FOREIGN KEY (`cod_finca`) REFERENCES `tbl_bene_finca` (`cod_finca`),
  ADD CONSTRAINT `tbl_bene_h_variedades_ibfk_2` FOREIGN KEY (`cod_variedad`) REFERENCES `tbl_vulnerabilidad_variedades` (`cod_variedad`);

--
-- Filtros para la tabla `tbl_bene_productor`
--
ALTER TABLE `tbl_bene_productor`
  ADD CONSTRAINT `tbl_bene_productor_ibfk_1` FOREIGN KEY (`cod_agencia`) REFERENCES `tbl_general_agencia` (`cod_agencia`),
  ADD CONSTRAINT `tbl_bene_productor_ibfk_2` FOREIGN KEY (`cod_genero`) REFERENCES `tbl_general_genero` (`cod_genero`),
  ADD CONSTRAINT `tbl_bene_productor_ibfk_3` FOREIGN KEY (`cod_municipio`) REFERENCES `tbl_general_municipio` (`cod_municipio`),
  ADD CONSTRAINT `tbl_bene_productor_ibfk_4` FOREIGN KEY (`cod_pais`) REFERENCES `tbl_general_pais` (`cod_pais`),
  ADD CONSTRAINT `tbl_bene_productor_ibfk_5` FOREIGN KEY (`cod_etnias`) REFERENCES `tbl_general_etnias` (`cod_etnias`);

--
-- Filtros para la tabla `tbl_bene_vivienda`
--
ALTER TABLE `tbl_bene_vivienda`
  ADD CONSTRAINT `fk_cod_beneficiario_v` FOREIGN KEY (`cod_beneficiario`) REFERENCES `tbl_beneficiario_ficha` (`cod_beneficiario`),
  ADD CONSTRAINT `tbl_bene_vivienda_ibfk_2` FOREIGN KEY (`cod_tipo_doc`) REFERENCES `tbl_bene_tipo_documentacion` (`cod_tipo_doc`),
  ADD CONSTRAINT `tbl_bene_vivienda_ibfk_3` FOREIGN KEY (`cod_tipo_pared`) REFERENCES `tbl_bene_tipo_pared` (`cod_tipo_pared`),
  ADD CONSTRAINT `tbl_bene_vivienda_ibfk_4` FOREIGN KEY (`cod_tipo_piso`) REFERENCES `tbl_bene_tipo_piso` (`cod_tipo_piso`),
  ADD CONSTRAINT `tbl_bene_vivienda_ibfk_5` FOREIGN KEY (`cod_tipo_techo`) REFERENCES `tbl_bene_tipo_techo` (`cod_tipo_techo`),
  ADD CONSTRAINT `tbl_bene_vivienda_ibfk_6` FOREIGN KEY (`cod_tipo_vivienda`) REFERENCES `tbl_bene_tipo_vivienda` (`cod_tipo_vivienda`);

--
-- Filtros para la tabla `tbl_div_ficha`
--
ALTER TABLE `tbl_div_ficha`
  ADD CONSTRAINT `tbl_div_ficha_ibfk_2` FOREIGN KEY (`cod_dicision`) REFERENCES `tbl_div_decision` (`cod_dicision`),
  ADD CONSTRAINT `tbl_div_ficha_ibfk_3` FOREIGN KEY (`cod_identidad`) REFERENCES `tbl_div_productor` (`cod_identidad`),
  ADD CONSTRAINT `tbl_div_ficha_ibfk_4` FOREIGN KEY (`cod_pro_beneficia`) REFERENCES `tbl_bene_proyecto_beneficia` (`cod_pro_beneficia`),
  ADD CONSTRAINT `tbl_div_ficha_ibfk_6` FOREIGN KEY (`cod_tecnico`) REFERENCES `tbl_general_tecnico` (`cod_tecnico`),
  ADD CONSTRAINT `tbl_div_ficha_ibfk_7` FOREIGN KEY (`cod_decision_per`) REFERENCES `tbl_div_dicision_pertenece` (`cod_decision_per`),
  ADD CONSTRAINT `tbl_div_ficha_ibfk_8` FOREIGN KEY (`cod_rubro`) REFERENCES `tbl_div_rubro` (`cod_rubro`),
  ADD CONSTRAINT `tbl_div_ficha_ibfk_9` FOREIGN KEY (`cod_modo`) REFERENCES `tbl_div_modo_imp` (`cod_modo`);

--
-- Filtros para la tabla `tbl_div_finca`
--
ALTER TABLE `tbl_div_finca`
  ADD CONSTRAINT `tbl_div_finca_ibfk_1` FOREIGN KEY (`cod_identidad`) REFERENCES `tbl_div_productor` (`cod_identidad`),
  ADD CONSTRAINT `tbl_div_finca_ibfk_2` FOREIGN KEY (`cod_tipo_suelo`) REFERENCES `tbl_div_tipo_suelo` (`cod_tipo_suelo`),
  ADD CONSTRAINT `tbl_div_finca_ibfk_3` FOREIGN KEY (`cod_porcentaje`) REFERENCES `tbl_div_porcentajes` (`cod_porcentaje`);

--
-- Filtros para la tabla `tbl_div_h_familia_mes`
--
ALTER TABLE `tbl_div_h_familia_mes`
  ADD CONSTRAINT `tbl_div_h_familia_mes_ibfk_2` FOREIGN KEY (`cod_mes`) REFERENCES `tbl_general_meses` (`cod_mes`),
  ADD CONSTRAINT `tbl_div_h_familia_mes_ibfk_3` FOREIGN KEY (`cod_ficha`) REFERENCES `tbl_div_ficha` (`cod_ficha`);

--
-- Filtros para la tabla `tbl_div_h_frutas`
--
ALTER TABLE `tbl_div_h_frutas`
  ADD CONSTRAINT `tbl_div_h_frutas_ibfk_1` FOREIGN KEY (`cod_ficha`) REFERENCES `tbl_div_ficha` (`cod_ficha`),
  ADD CONSTRAINT `tbl_div_h_frutas_ibfk_2` FOREIGN KEY (`cod_fruta`) REFERENCES `tbl_div_frutas` (`cod_frutas`);

--
-- Filtros para la tabla `tbl_div_h_ingresos`
--
ALTER TABLE `tbl_div_h_ingresos`
  ADD CONSTRAINT `tbl_div_h_ingresos_ibfk_1` FOREIGN KEY (`cod_ingreso`) REFERENCES `tbl_div_tipo_ingreso` (`cod_ingreso`),
  ADD CONSTRAINT `tbl_div_h_ingresos_ibfk_2` FOREIGN KEY (`cod_ficha`) REFERENCES `tbl_div_ficha` (`cod_ficha`);

--
-- Filtros para la tabla `tbl_div_h_meses`
--
ALTER TABLE `tbl_div_h_meses`
  ADD CONSTRAINT `tbl_div_h_meses_ibfk_1` FOREIGN KEY (`cod_mes`) REFERENCES `tbl_general_meses` (`cod_mes`),
  ADD CONSTRAINT `tbl_div_h_meses_ibfk_2` FOREIGN KEY (`cod_finca`) REFERENCES `tbl_div_finca` (`cod_finca`);

--
-- Filtros para la tabla `tbl_div_productor`
--
ALTER TABLE `tbl_div_productor`
  ADD CONSTRAINT `tbl_div_productor_ibfk_1` FOREIGN KEY (`cod_agencia`) REFERENCES `tbl_general_agencia` (`cod_agencia`),
  ADD CONSTRAINT `tbl_div_productor_ibfk_2` FOREIGN KEY (`cod_genero`) REFERENCES `tbl_general_genero` (`cod_genero`),
  ADD CONSTRAINT `tbl_div_productor_ibfk_3` FOREIGN KEY (`cod_municipio`) REFERENCES `tbl_general_municipio` (`cod_municipio`),
  ADD CONSTRAINT `tbl_div_productor_ibfk_4` FOREIGN KEY (`cod_pais`) REFERENCES `tbl_general_pais` (`cod_pais`);

--
-- Filtros para la tabla `tbl_div_recomendacion`
--
ALTER TABLE `tbl_div_recomendacion`
  ADD CONSTRAINT `tbl_div_recomendacion_ibfk_1` FOREIGN KEY (`cod_ficha`) REFERENCES `tbl_div_ficha` (`cod_ficha`),
  ADD CONSTRAINT `tbl_div_recomendacion_ibfk_2` FOREIGN KEY (`cod_parentesco`) REFERENCES `tbl_div_parentesco` (`cod_parentesco`);

--
-- Filtros para la tabla `tbl_general_agencia`
--
ALTER TABLE `tbl_general_agencia`
  ADD CONSTRAINT `fk_id_regional` FOREIGN KEY (`cod_regional`) REFERENCES `tbl_general_regional` (`cod_regional`);

--
-- Filtros para la tabla `tbl_general_aldea`
--
ALTER TABLE `tbl_general_aldea`
  ADD CONSTRAINT `fk_id_municipio` FOREIGN KEY (`cod_municipio`) REFERENCES `tbl_general_municipio` (`cod_municipio`);

--
-- Filtros para la tabla `tbl_general_finca`
--
ALTER TABLE `tbl_general_finca`
  ADD CONSTRAINT `fk_id_productor_fi` FOREIGN KEY (`cod_identidad`) REFERENCES `tbl_general_productor` (`cod_identidad`);

--
-- Filtros para la tabla `tbl_general_h_actividad_pro`
--
ALTER TABLE `tbl_general_h_actividad_pro`
  ADD CONSTRAINT `tbl_general_h_actividad_pro_ibfk_1` FOREIGN KEY (`cod_actividad_pro`) REFERENCES `tbl_general_actividad_pro` (`cod_actividad_pro`),
  ADD CONSTRAINT `tbl_general_h_actividad_pro_ibfk_2` FOREIGN KEY (`cod_identidad`) REFERENCES `tbl_bene_productor` (`cod_identidad`);

--
-- Filtros para la tabla `tbl_general_municipio`
--
ALTER TABLE `tbl_general_municipio`
  ADD CONSTRAINT `fk_id_depar` FOREIGN KEY (`cod_depart`) REFERENCES `tbl_general_departamento` (`cod_depart`);

--
-- Filtros para la tabla `tbl_general_productor`
--
ALTER TABLE `tbl_general_productor`
  ADD CONSTRAINT `fk_id_agencia` FOREIGN KEY (`cod_agencia`) REFERENCES `tbl_general_agencia` (`cod_agencia`),
  ADD CONSTRAINT `fk_id_genero` FOREIGN KEY (`cod_genero`) REFERENCES `tbl_general_genero` (`cod_genero`),
  ADD CONSTRAINT `fk_id_municipio_p` FOREIGN KEY (`cod_municipio`) REFERENCES `tbl_general_municipio` (`cod_municipio`),
  ADD CONSTRAINT `fk_id_pais` FOREIGN KEY (`cod_pais`) REFERENCES `tbl_general_pais` (`cod_pais`);

--
-- Filtros para la tabla `tbl_general_tecnico`
--
ALTER TABLE `tbl_general_tecnico`
  ADD CONSTRAINT `fk_id_puesto` FOREIGN KEY (`cod_puesto`) REFERENCES `tbl_general_puesto` (`cod_puesto`);

--
-- Filtros para la tabla `tbl_h_respuestas`
--
ALTER TABLE `tbl_h_respuestas`
  ADD CONSTRAINT `fk_id_finca_v` FOREIGN KEY (`cod_finca`) REFERENCES `tbl_general_finca` (`cod_finca`),
  ADD CONSTRAINT `fk_id_respuesta` FOREIGN KEY (`cod_respuesta`) REFERENCES `tbl_vulnerabilidad_respuesta` (`cod_respuesta`);

--
-- Filtros para la tabla `tbl_lideres_ficha`
--
ALTER TABLE `tbl_lideres_ficha`
  ADD CONSTRAINT `tbl_lideres_ficha_ibfk_1` FOREIGN KEY (`cod_grupo`) REFERENCES `tbl_lider_grupo` (`cod_grupo`),
  ADD CONSTRAINT `tbl_lideres_ficha_ibfk_2` FOREIGN KEY (`cod_identidad`) REFERENCES `tbl_lider_productor` (`cod_identidad`),
  ADD CONSTRAINT `tbl_lideres_ficha_ibfk_3` FOREIGN KEY (`cod_pro_beneficia`) REFERENCES `tbl_bene_proyecto_beneficia` (`cod_pro_beneficia`),
  ADD CONSTRAINT `tbl_lideres_ficha_ibfk_4` FOREIGN KEY (`cod_tecnico`) REFERENCES `tbl_general_tecnico` (`cod_tecnico`),
  ADD CONSTRAINT `tbl_lideres_ficha_ibfk_5` FOREIGN KEY (`cod_problema`) REFERENCES `tbl_lider_problema` (`cod_problema`);

--
-- Filtros para la tabla `tbl_lider_coasociados`
--
ALTER TABLE `tbl_lider_coasociados`
  ADD CONSTRAINT `tbl_lider_coasociados_ibfk_1` FOREIGN KEY (`cod_genero`) REFERENCES `tbl_general_genero` (`cod_genero`);

--
-- Filtros para la tabla `tbl_lider_fincas`
--
ALTER TABLE `tbl_lider_fincas`
  ADD CONSTRAINT `tbl_lider_fincas_ibfk_1` FOREIGN KEY (`cod_identidad`) REFERENCES `tbl_lider_productor` (`cod_identidad`);

--
-- Filtros para la tabla `tbl_lider_h_coasociados`
--
ALTER TABLE `tbl_lider_h_coasociados`
  ADD CONSTRAINT `tbl_lider_h_coasociados_ibfk_1` FOREIGN KEY (`cod_identidad`) REFERENCES `tbl_lider_productor` (`cod_identidad`),
  ADD CONSTRAINT `tbl_lider_h_coasociados_ibfk_2` FOREIGN KEY (`cod_coasociado`) REFERENCES `tbl_lider_coasociados` (`cod_coasociado`);

--
-- Filtros para la tabla `tbl_lider_h_comunal`
--
ALTER TABLE `tbl_lider_h_comunal`
  ADD CONSTRAINT `tbl_lider_h_comunal_ibfk_1` FOREIGN KEY (`cod_ficha`) REFERENCES `tbl_lideres_ficha` (`cod_ficha`),
  ADD CONSTRAINT `tbl_lider_h_comunal_ibfk_2` FOREIGN KEY (`cod_comunal`) REFERENCES `tbl_lider_grupo_comunal` (`cod_comunal`);

--
-- Filtros para la tabla `tbl_lider_parcela`
--
ALTER TABLE `tbl_lider_parcela`
  ADD CONSTRAINT `tbl_lider_parcela_ibfk_1` FOREIGN KEY (`cod_finca`) REFERENCES `tbl_lider_fincas` (`cod_finca`),
  ADD CONSTRAINT `tbl_lider_parcela_ibfk_2` FOREIGN KEY (`cod_variedad`) REFERENCES `tbl_vulnerabilidad_variedades` (`cod_variedad`);

--
-- Filtros para la tabla `tbl_lider_productor`
--
ALTER TABLE `tbl_lider_productor`
  ADD CONSTRAINT `tbl_lider_productor_ibfk_1` FOREIGN KEY (`cod_agencia`) REFERENCES `tbl_general_agencia` (`cod_agencia`),
  ADD CONSTRAINT `tbl_lider_productor_ibfk_2` FOREIGN KEY (`cod_genero`) REFERENCES `tbl_general_genero` (`cod_genero`),
  ADD CONSTRAINT `tbl_lider_productor_ibfk_3` FOREIGN KEY (`cod_municipio`) REFERENCES `tbl_general_municipio` (`cod_municipio`),
  ADD CONSTRAINT `tbl_lider_productor_ibfk_4` FOREIGN KEY (`cod_pais`) REFERENCES `tbl_general_pais` (`cod_pais`);

--
-- Filtros para la tabla `tbl_vulnerabilidades_ficha`
--
ALTER TABLE `tbl_vulnerabilidades_ficha`
  ADD CONSTRAINT `fk_id_finca_v_f` FOREIGN KEY (`cod_finca`) REFERENCES `tbl_general_finca` (`cod_finca`),
  ADD CONSTRAINT `fk_id_municipio_vf` FOREIGN KEY (`cod_municipio`) REFERENCES `tbl_general_municipio` (`cod_municipio`),
  ADD CONSTRAINT `fk_id_tecnico_v_f` FOREIGN KEY (`cod_tecnico`) REFERENCES `tbl_general_tecnico` (`cod_tecnico`),
  ADD CONSTRAINT `fk_identidad_vf` FOREIGN KEY (`cod_identidad`) REFERENCES `tbl_general_productor` (`cod_identidad`);

--
-- Filtros para la tabla `tbl_vulnerabilidad_h_variedad`
--
ALTER TABLE `tbl_vulnerabilidad_h_variedad`
  ADD CONSTRAINT `tbl_vulnerabilidad_h_variedad_ibfk_1` FOREIGN KEY (`cod_variedad`) REFERENCES `tbl_vulnerabilidad_variedades` (`cod_variedad`),
  ADD CONSTRAINT `tbl_vulnerabilidad_h_variedad_ibfk_2` FOREIGN KEY (`cod_vulnerabilidad`) REFERENCES `tbl_vulnerabilidades_ficha` (`cod_vulnerabilidad`);

--
-- Filtros para la tabla `tbl_vulnerabilidad_respuesta`
--
ALTER TABLE `tbl_vulnerabilidad_respuesta`
  ADD CONSTRAINT `fk_desicion_respuesta` FOREIGN KEY (`cod_desicion`) REFERENCES `tbl_vulnerabilidad_desicion` (`cod_desicion`) ON DELETE NO ACTION ON UPDATE NO ACTION,
  ADD CONSTRAINT `fk_id_pregunta` FOREIGN KEY (`cod_pregunta`) REFERENCES `tbl_vulnerabilidad_pregunta` (`cod_pregunta`);
COMMIT;

/*!40101 SET CHARACTER_SET_CLIENT=@OLD_CHARACTER_SET_CLIENT */;
/*!40101 SET CHARACTER_SET_RESULTS=@OLD_CHARACTER_SET_RESULTS */;
/*!40101 SET COLLATION_CONNECTION=@OLD_COLLATION_CONNECTION */;
